<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Interactive World Clock</title>
    <style>
      :root {
        color-scheme: light;
        --bg: #0f172a;
        --panel: #1e293b;
        --text: #f8fafc;
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        font-family: "Space Grotesk", system-ui, sans-serif;
        background: var(--bg);
        color: var(--text);
        min-height: 100vh;
        padding: clamp(1rem, 5vw, 4rem);
      }
      header {
        text-align: center;
        margin-bottom: 2rem;
      }
      h1 {
        margin: 0 0 0.5rem;
      }
      .controls {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        justify-content: center;
        margin-bottom: 1.5rem;
      }
      select,
      button {
        border-radius: 999px;
        border: 1px solid rgba(255, 255, 255, 0.2);
        background: rgba(255, 255, 255, 0.05);
        color: var(--text);
        padding: 0.7rem 1.2rem;
        font: inherit;
      }
      button {
        cursor: pointer;
      }
      .toggle {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .grid {
        display: grid;
        gap: 1rem;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      }
      .card {
        border-radius: 1.5rem;
        padding: 1.2rem;
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        position: relative;
      }
      .card button {
        position: absolute;
        top: 0.5rem;
        right: 0.5rem;
        border-radius: 999px;
        width: 32px;
        height: 32px;
        padding: 0;
      }
      .time {
        font-size: 2rem;
        font-weight: 600;
      }
      .period {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>Interactive World Clock</h1>
      <p>Select cities and monitor their daylight rhythm.</p>
    </header>
    <div class="controls">
      <select id="citySelect"></select>
      <button id="addCity">Add city</button>
      <label class="toggle">
        <input type="checkbox" id="formatToggle" /> Use 24h
      </label>
    </div>
    <section class="grid" id="grid"></section>

    <script>
      const catalog = {
        "San Francisco": "America/Los_Angeles",
        "New York": "America/New_York",
        London: "Europe/London",
        Paris: "Europe/Paris",
        Dubai: "Asia/Dubai",
        Tokyo: "Asia/Tokyo",
        Sydney: "Australia/Sydney",
        "SÃ£o Paulo": "America/Sao_Paulo",
        Nairobi: "Africa/Nairobi",
      };
      const periods = [
        { label: "Night", icon: "ðŸŒ™", range: [0, 5], colors: ["#0f172a", "#1e293b"] },
        { label: "Morning", icon: "ðŸŒ…", range: [5, 11], colors: ["#ffafbd", "#ffc3a0"] },
        { label: "Afternoon", icon: "â˜€ï¸", range: [11, 17], colors: ["#f6d365", "#fda085"] },
        { label: "Evening", icon: "ðŸŒ†", range: [17, 21], colors: ["#667db6", "#764ba2"] },
        { label: "Night", icon: "ðŸŒ™", range: [21, 24], colors: ["#0f2027", "#203a43"] },
      ];
      const grid = document.getElementById("grid");
      const citySelect = document.getElementById("citySelect");
      const formatToggle = document.getElementById("formatToggle");
      const addCityBtn = document.getElementById("addCity");
      Object.keys(catalog).forEach((city) => {
        const option = document.createElement("option");
        option.value = city;
        option.textContent = city;
        citySelect.appendChild(option);
      });

      const active = [
        { name: "San Francisco", tz: catalog["San Francisco"] },
        { name: "London", tz: catalog["London"] },
        { name: "Tokyo", tz: catalog["Tokyo"] },
      ];

      function getPeriod(date, tz) {
        const hour = Number(
          new Intl.DateTimeFormat("en-US", { hour: "numeric", hour12: false, timeZone: tz }).format(date)
        );
        return periods.find((p) => hour >= p.range[0] && hour < p.range[1]) || periods[0];
      }

      function formatTime(date, tz) {
        const use24h = formatToggle.checked;
        return new Intl.DateTimeFormat("en-US", {
          hour: "2-digit",
          minute: "2-digit",
          hour12: !use24h,
          timeZone: tz,
        }).format(date);
      }

      function render() {
        const now = new Date();
        grid.innerHTML = "";
        active.forEach((city) => {
          const period = getPeriod(now, city.tz);
          const card = document.createElement("article");
          card.className = "card";
          card.style.background = `linear-gradient(135deg, ${period.colors[0]}, ${period.colors[1]})`;
          card.innerHTML = `
            <button aria-label="Remove">âœ•</button>
            <h2>${city.name}</h2>
            <div class="time">${formatTime(now, city.tz)}</div>
            <div class="period">${period.icon} ${period.label}</div>`;
          card.querySelector("button").addEventListener("click", () => {
            const index = active.indexOf(city);
            active.splice(index, 1);
            render();
          });
          grid.appendChild(card);
        });
      }

      addCityBtn.addEventListener("click", () => {
        const name = citySelect.value;
        if (!name) return;
        if (active.some((city) => city.name === name)) return;
        active.push({ name, tz: catalog[name] });
        render();
      });

      formatToggle.addEventListener("change", render);
      render();
      setInterval(render, 15000);
    </script>
  </body>
</html>
