<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typing Rain</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(to bottom, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            overflow: hidden;
            height: 100vh;
        }
        #gameCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .city {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 150px;
            background: linear-gradient(to bottom, transparent 0%, #0a0a0a 100%);
        }
        .building {
            position: absolute;
            bottom: 0;
            background: #1a1a1a;
            border-top: 2px solid #333;
        }
        .building::before {
            content: '';
            position: absolute;
            top: 10%;
            left: 10%;
            width: 30%;
            height: 20%;
            background: #ff0;
            opacity: 0.3;
        }
        .ui {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            font-size: 18px;
            z-index: 100;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }
        .stat {
            margin-bottom: 10px;
        }
        .input-field {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            background: rgba(0,0,0,0.8);
            padding: 15px 30px;
            border-radius: 10px;
            border: 2px solid #00ff00;
        }
        .input-field input {
            background: transparent;
            border: none;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            font-size: 24px;
            width: 400px;
            text-align: center;
            outline: none;
        }
        .game-over {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9);
            padding: 40px;
            border-radius: 20px;
            border: 3px solid #00ff00;
            text-align: center;
            color: white;
            z-index: 200;
        }
        .game-over.show { display: block; }
        .btn {
            padding: 12px 30px;
            background: #00ff00;
            color: black;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            margin-top: 20px;
        }
        .btn:hover { background: #00cc00; }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <div class="city" id="city"></div>
    <div class="ui">
        <div class="stat">Score: <span id="score">0</span></div>
        <div class="stat">Speed: <span id="speed">1.0x</span></div>
        <div class="stat">Accuracy: <span id="accuracy">100%</span></div>
    </div>
    <div class="input-field">
        <input type="text" id="input" placeholder="Type the words..." autocomplete="off">
    </div>
    <div class="game-over" id="gameOver">
        <h2 style="font-size: 36px; margin-bottom: 20px;">Game Over!</h2>
        <p style="font-size: 24px; margin-bottom: 10px;">Final Score: <span id="finalScore">0</span></p>
        <p style="font-size: 18px; margin-bottom: 20px;">Accuracy: <span id="finalAccuracy">100%</span></p>
        <button class="btn" onclick="restartGame()">Play Again</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const words = ['code', 'rain', 'type', 'fast', 'game', 'play', 'word', 'drop', 'fall', 'quick',
                       'speed', 'test', 'skill', 'focus', 'react', 'catch', 'score', 'level', 'power', 'boost'];

        let fallingWords = [];
        let score = 0;
        let totalTyped = 0;
        let correctTyped = 0;
        let gameActive = true;
        let speed = 1;
        let lastSpawn = 0;

        class FallingWord {
            constructor() {
                this.text = words[Math.floor(Math.random() * words.length)];
                this.x = Math.random() * (canvas.width - 100) + 50;
                this.y = -50;
                this.speed = 1 + (speed - 1) * 0.5;
                this.color = `hsl(${Math.random() * 60 + 180}, 70%, 60%)`;
            }

            update() {
                this.y += this.speed;
            }

            draw() {
                ctx.fillStyle = this.color;
                ctx.font = 'bold 24px Courier New';
                ctx.textAlign = 'center';
                ctx.shadowColor = this.color;
                ctx.shadowBlur = 10;
                ctx.fillText(this.text, this.x, this.y);
                ctx.shadowBlur = 0;
            }

            isOffScreen() {
                return this.y > canvas.height - 150;
            }
        }

        function spawnWord() {
            if (Date.now() - lastSpawn > 2000 / speed) {
                fallingWords.push(new FallingWord());
                lastSpawn = Date.now();
            }
        }

        function update() {
            if (!gameActive) return;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Update and draw words
            fallingWords.forEach((word, index) => {
                word.update();
                word.draw();

                if (word.isOffScreen()) {
                    fallingWords.splice(index, 1);
                    if (fallingWords.length === 0 && gameActive) {
                        endGame();
                    }
                }
            });

            spawnWord();

            // Increase difficulty
            if (score > 0 && score % 10 === 0 && speed < 3) {
                speed = 1 + (score / 50);
                document.getElementById('speed').textContent = speed.toFixed(1) + 'x';
            }

            requestAnimationFrame(update);
        }

        const input = document.getElementById('input');
        input.addEventListener('input', () => {
            const typed = input.value.toLowerCase().trim();

            if (typed.length === 0) return;

            const matchIndex = fallingWords.findIndex(word => word.text === typed);

            if (matchIndex !== -1) {
                score += 10;
                correctTyped++;
                totalTyped++;
                document.getElementById('score').textContent = score;
                updateAccuracy();

                // Remove the word with animation
                ctx.fillStyle = '#00ff00';
                ctx.font = 'bold 32px Courier New';
                ctx.textAlign = 'center';
                ctx.fillText('+10', fallingWords[matchIndex].x, fallingWords[matchIndex].y - 20);

                fallingWords.splice(matchIndex, 1);
                input.value = '';
            }
        });

        function updateAccuracy() {
            const accuracy = totalTyped > 0 ? Math.round((correctTyped / totalTyped) * 100) : 100;
            document.getElementById('accuracy').textContent = accuracy + '%';
        }

        function endGame() {
            gameActive = false;
            document.getElementById('finalScore').textContent = score;
            const accuracy = totalTyped > 0 ? Math.round((correctTyped / totalTyped) * 100) : 100;
            document.getElementById('finalAccuracy').textContent = accuracy + '%';
            document.getElementById('gameOver').classList.add('show');
        }

        function restartGame() {
            fallingWords = [];
            score = 0;
            totalTyped = 0;
            correctTyped = 0;
            speed = 1;
            gameActive = true;
            lastSpawn = 0;
            document.getElementById('score').textContent = '0';
            document.getElementById('speed').textContent = '1.0x';
            document.getElementById('accuracy').textContent = '100%';
            document.getElementById('gameOver').classList.remove('show');
            input.value = '';
            input.focus();
            update();
        }

        // Generate city buildings
        const cityEl = document.getElementById('city');
        for (let i = 0; i < 20; i++) {
            const building = document.createElement('div');
            building.className = 'building';
            building.style.left = (i * 60) + 'px';
            building.style.width = '50px';
            building.style.height = Math.random() * 80 + 50 + 'px';
            cityEl.appendChild(building);
        }

        input.focus();
        update();
    </script>
</body>
</html>