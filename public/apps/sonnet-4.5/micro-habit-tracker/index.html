<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Micro Habit Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        * {
            font-family: 'Inter', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }

        .habit-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%);
            border: 2px solid #e5e7eb;
            border-radius: 16px;
            transition: all 0.3s ease;
        }

        .habit-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.1);
            border-color: #667eea;
        }

        .check-button {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: 3px solid #d1d5db;
            background: white;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .check-button:hover {
            transform: scale(1.1);
            border-color: #667eea;
        }

        .check-button.checked {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: #667eea;
            color: white;
        }

        .check-button.skipped {
            background: #fbbf24;
            border-color: #f59e0b;
            color: white;
        }

        .streak-badge {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .add-button {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .add-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(16, 185, 129, 0.3);
        }

        .delete-button {
            background: #ef4444;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .delete-button:hover {
            background: #dc2626;
        }

        .edit-button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .edit-button:hover {
            background: #2563eb;
        }

        .skip-button {
            background: #fbbf24;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .skip-button:hover {
            background: #f59e0b;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 32px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        input[type="text"], textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        input[type="text"]:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .chart-container {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
            margin-top: 12px;
        }

        .chart-day {
            aspect-ratio: 1;
            border-radius: 4px;
            background: #e5e7eb;
            transition: all 0.2s ease;
        }

        .chart-day.completed {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .chart-day.skipped {
            background: #fbbf24;
        }

        .chart-day:hover {
            transform: scale(1.1);
        }

        @media (max-width: 640px) {
            .habit-card {
                padding: 16px !important;
            }

            .check-button {
                width: 40px;
                height: 40px;
                font-size: 20px;
            }
        }

        .hero-title {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .export-button, .import-button {
            background: #8b5cf6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .export-button:hover, .import-button:hover {
            background: #7c3aed;
            transform: translateY(-2px);
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <div class="glass-card p-6 md:p-8 mb-6">
            <h1 class="text-4xl md:text-5xl font-bold hero-title mb-2">ðŸš€ Micro Habit Tracker</h1>
            <p class="text-gray-600 text-sm md:text-base">Build your best self, one day at a time</p>
            <div class="flex flex-wrap gap-2 mt-4">
                <button class="add-button" onclick="showAddModal()">+ Add Habit</button>
                <button class="export-button" onclick="exportData()">ðŸ“¤ Export</button>
                <button class="import-button" onclick="document.getElementById('importFile').click()">ðŸ“¥ Import</button>
                <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importData(event)">
            </div>
        </div>

        <!-- Habits Container -->
        <div id="habitsContainer" class="space-y-4"></div>

        <!-- Empty State -->
        <div id="emptyState" class="glass-card p-12 text-center" style="display: none;">
            <div class="text-6xl mb-4">ðŸŽ¯</div>
            <h2 class="text-2xl font-bold text-gray-700 mb-2">No habits yet!</h2>
            <p class="text-gray-600 mb-4">Start building your perfect routine</p>
            <button class="add-button" onclick="showAddModal()">Add Your First Habit</button>
        </div>
    </div>

    <!-- Add/Edit Modal -->
    <div id="habitModal" class="modal">
        <div class="modal-content">
            <h2 class="text-2xl font-bold mb-4" id="modalTitle">Add New Habit</h2>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Habit Name</label>
                    <input type="text" id="habitName" placeholder="e.g., Morning Meditation" maxlength="50">
                </div>
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Description (optional)</label>
                    <textarea id="habitDescription" rows="3" placeholder="Why is this important to you?"></textarea>
                </div>
                <div class="flex gap-2 pt-4">
                    <button class="add-button flex-1" onclick="saveHabit()">Save Habit</button>
                    <button class="delete-button flex-1" onclick="closeModal()">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize app state
        let habits = [];
        let editingHabitId = null;

        // Get today's date as YYYY-MM-DD
        function getToday() {
            return new Date().toISOString().split('T')[0];
        }

        // Get date N days ago
        function getDaysAgo(days) {
            const date = new Date();
            date.setDate(date.getDate() - days);
            return date.toISOString().split('T')[0];
        }

        // Initialize with demo data
        function initializeDemoData() {
            const today = getToday();
            habits = [
                {
                    id: Date.now() - 5,
                    name: "Morning Meditation",
                    description: "10 minutes of mindfulness",
                    createdAt: getDaysAgo(14),
                    completions: {
                        [getDaysAgo(6)]: 'completed',
                        [getDaysAgo(5)]: 'completed',
                        [getDaysAgo(4)]: 'completed',
                        [getDaysAgo(3)]: 'completed',
                        [getDaysAgo(2)]: 'completed',
                        [getDaysAgo(1)]: 'completed',
                        [today]: 'completed'
                    }
                },
                {
                    id: Date.now() - 4,
                    name: "Read 20 Pages",
                    description: "Expand my mind daily",
                    createdAt: getDaysAgo(10),
                    completions: {
                        [getDaysAgo(6)]: 'completed',
                        [getDaysAgo(5)]: 'completed',
                        [getDaysAgo(4)]: 'skipped',
                        [getDaysAgo(3)]: 'completed',
                        [getDaysAgo(2)]: 'completed',
                        [getDaysAgo(1)]: 'completed'
                    }
                },
                {
                    id: Date.now() - 3,
                    name: "Workout",
                    description: "30 minutes of exercise",
                    createdAt: getDaysAgo(8),
                    completions: {
                        [getDaysAgo(5)]: 'completed',
                        [getDaysAgo(4)]: 'completed',
                        [getDaysAgo(3)]: 'skipped',
                        [getDaysAgo(2)]: 'completed',
                        [getDaysAgo(1)]: 'completed'
                    }
                }
            ];
            saveToLocalStorage();
        }

        // Load data from localStorage
        function loadFromLocalStorage() {
            const stored = localStorage.getItem('microHabits');
            if (stored) {
                habits = JSON.parse(stored);
            } else {
                initializeDemoData();
            }
        }

        // Save data to localStorage
        function saveToLocalStorage() {
            localStorage.setItem('microHabits', JSON.stringify(habits));
        }

        // Calculate current streak
        function calculateStreak(habit) {
            let streak = 0;
            const today = new Date();

            for (let i = 0; i < 365; i++) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateStr = date.toISOString().split('T')[0];

                if (habit.completions[dateStr] === 'completed') {
                    streak++;
                } else if (habit.completions[dateStr] === 'skipped') {
                    // Skipped days don't break the streak
                    continue;
                } else {
                    break;
                }
            }

            return streak;
        }

        // Get last 7 days for chart
        function getLast7Days() {
            const days = [];
            for (let i = 6; i >= 0; i--) {
                days.push(getDaysAgo(i));
            }
            return days;
        }

        // Toggle habit completion
        function toggleHabit(habitId) {
            const habit = habits.find(h => h.id === habitId);
            if (!habit) return;

            const today = getToday();
            const currentStatus = habit.completions[today];

            if (currentStatus === 'completed') {
                delete habit.completions[today];
            } else {
                habit.completions[today] = 'completed';
            }

            saveToLocalStorage();
            renderHabits();
        }

        // Skip habit for today
        function skipHabit(habitId) {
            const habit = habits.find(h => h.id === habitId);
            if (!habit) return;

            const today = getToday();
            const currentStatus = habit.completions[today];

            if (currentStatus === 'skipped') {
                delete habit.completions[today];
            } else {
                habit.completions[today] = 'skipped';
            }

            saveToLocalStorage();
            renderHabits();
        }

        // Show add modal
        function showAddModal() {
            editingHabitId = null;
            document.getElementById('modalTitle').textContent = 'Add New Habit';
            document.getElementById('habitName').value = '';
            document.getElementById('habitDescription').value = '';
            document.getElementById('habitModal').classList.add('active');
        }

        // Show edit modal
        function showEditModal(habitId) {
            const habit = habits.find(h => h.id === habitId);
            if (!habit) return;

            editingHabitId = habitId;
            document.getElementById('modalTitle').textContent = 'Edit Habit';
            document.getElementById('habitName').value = habit.name;
            document.getElementById('habitDescription').value = habit.description || '';
            document.getElementById('habitModal').classList.add('active');
        }

        // Close modal
        function closeModal() {
            document.getElementById('habitModal').classList.remove('active');
            editingHabitId = null;
        }

        // Save habit
        function saveHabit() {
            const name = document.getElementById('habitName').value.trim();
            if (!name) {
                alert('Please enter a habit name');
                return;
            }

            if (!editingHabitId && habits.length >= 7) {
                alert('Maximum 7 habits allowed');
                return;
            }

            const description = document.getElementById('habitDescription').value.trim();

            if (editingHabitId) {
                // Edit existing habit
                const habit = habits.find(h => h.id === editingHabitId);
                if (habit) {
                    habit.name = name;
                    habit.description = description;
                }
            } else {
                // Add new habit
                habits.push({
                    id: Date.now(),
                    name: name,
                    description: description,
                    createdAt: getToday(),
                    completions: {}
                });
            }

            saveToLocalStorage();
            closeModal();
            renderHabits();
        }

        // Delete habit
        function deleteHabit(habitId) {
            if (!confirm('Are you sure you want to delete this habit?')) return;

            habits = habits.filter(h => h.id !== habitId);
            saveToLocalStorage();
            renderHabits();
        }

        // Render all habits
        function renderHabits() {
            const container = document.getElementById('habitsContainer');
            const emptyState = document.getElementById('emptyState');

            if (habits.length === 0) {
                container.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }

            emptyState.style.display = 'none';

            container.innerHTML = habits.map(habit => {
                const streak = calculateStreak(habit);
                const today = getToday();
                const todayStatus = habit.completions[today];
                const last7Days = getLast7Days();

                return `
                    <div class="habit-card p-6">
                        <div class="flex items-start justify-between gap-4 mb-4">
                            <div class="flex-1">
                                <h3 class="text-xl font-bold text-gray-800 mb-1">${habit.name}</h3>
                                ${habit.description ? `<p class="text-sm text-gray-600">${habit.description}</p>` : ''}
                                <div class="mt-2">
                                    ${streak > 0 ? `<span class="streak-badge">ðŸ”¥ ${streak} day streak</span>` : '<span class="text-xs text-gray-500">Start your streak today!</span>'}
                                </div>
                            </div>
                            <div class="flex flex-col gap-2 items-end">
                                <div class="check-button ${todayStatus === 'completed' ? 'checked' : ''} ${todayStatus === 'skipped' ? 'skipped' : ''}"
                                     onclick="toggleHabit(${habit.id})">
                                    ${todayStatus === 'completed' ? 'âœ“' : todayStatus === 'skipped' ? 'âŠ˜' : ''}
                                </div>
                                <button class="skip-button" onclick="skipHabit(${habit.id})">
                                    ${todayStatus === 'skipped' ? 'Unskip' : 'Skip Today'}
                                </button>
                            </div>
                        </div>

                        <div class="chart-container">
                            ${last7Days.map(date => {
                                const status = habit.completions[date];
                                return `<div class="chart-day ${status === 'completed' ? 'completed' : ''} ${status === 'skipped' ? 'skipped' : ''}"
                                            title="${date}"></div>`;
                            }).join('')}
                        </div>

                        <div class="flex gap-2 mt-4">
                            <button class="edit-button" onclick="showEditModal(${habit.id})">Edit</button>
                            <button class="delete-button" onclick="deleteHabit(${habit.id})">Delete</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Export data
        function exportData() {
            const dataStr = JSON.stringify(habits, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `habits-${getToday()}.json`;
            link.click();
            URL.revokeObjectURL(url);
        }

        // Import data
        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const imported = JSON.parse(e.target.result);
                    if (Array.isArray(imported)) {
                        if (confirm('This will replace all current habits. Continue?')) {
                            habits = imported;
                            saveToLocalStorage();
                            renderHabits();
                            alert('Import successful!');
                        }
                    } else {
                        alert('Invalid file format');
                    }
                } catch (error) {
                    alert('Error reading file: ' + error.message);
                }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        // Close modal on background click
        document.getElementById('habitModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // Handle Enter key in inputs
        document.getElementById('habitName').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                saveHabit();
            }
        });

        // Initialize app
        loadFromLocalStorage();
        renderHabits();
    </script>
</body>
</html>
