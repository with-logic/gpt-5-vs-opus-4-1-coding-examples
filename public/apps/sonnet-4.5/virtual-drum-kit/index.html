<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtual Drum Kit</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            color: #fff;
            overflow-x: hidden;
        }

        .studio-container {
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            animation: fadeInDown 0.8s ease-out;
        }

        h1 {
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 700;
            background: linear-gradient(45deg, #ff6b6b, #ffd93d, #6bcf7f, #4ecdc4);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientShift 5s ease infinite;
            text-shadow: 0 0 30px rgba(255, 107, 107, 0.3);
            letter-spacing: 2px;
        }

        .subtitle {
            margin-top: 10px;
            font-size: clamp(0.9rem, 2vw, 1.1rem);
            color: #a8dadc;
            opacity: 0.9;
        }

        .controls-panel {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 30px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            align-items: center;
            animation: fadeIn 1s ease-out;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .control-btn {
            padding: 12px 28px;
            font-size: 16px;
            font-weight: 600;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 50px;
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.2), rgba(78, 205, 196, 0.2));
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
            border-color: rgba(255, 107, 107, 0.6);
        }

        .control-btn:active {
            transform: translateY(0);
        }

        .control-btn.recording {
            background: linear-gradient(135deg, #ff6b6b, #ee5a6f);
            animation: pulse 1.5s ease-in-out infinite;
            border-color: #ff6b6b;
        }

        .control-btn.playing {
            background: linear-gradient(135deg, #6bcf7f, #4ecdc4);
            border-color: #6bcf7f;
        }

        .control-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .drum-kit {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            animation: fadeInUp 1s ease-out;
        }

        .drum-pad {
            position: relative;
            aspect-ratio: 1;
            min-height: 140px;
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3),
                        inset 0 1px 0 rgba(255, 255, 255, 0.1);
            overflow: hidden;
        }

        .drum-pad::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .drum-pad:hover::before {
            opacity: 1;
        }

        .drum-pad:hover {
            transform: translateY(-5px);
            border-color: rgba(255, 255, 255, 0.4);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.4),
                        0 0 40px rgba(255, 107, 107, 0.3);
        }

        .drum-pad.active {
            transform: scale(0.95);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5),
                        inset 0 0 30px rgba(255, 255, 255, 0.2);
        }

        .drum-pad.kick {
            background: linear-gradient(145deg, rgba(255, 107, 107, 0.3), rgba(238, 90, 111, 0.2));
        }

        .drum-pad.snare {
            background: linear-gradient(145deg, rgba(107, 207, 127, 0.3), rgba(78, 205, 196, 0.2));
        }

        .drum-pad.hihat {
            background: linear-gradient(145deg, rgba(255, 217, 61, 0.3), rgba(255, 195, 0, 0.2));
        }

        .drum-pad.tom {
            background: linear-gradient(145deg, rgba(138, 113, 255, 0.3), rgba(165, 94, 234, 0.2));
        }

        .drum-pad.crash {
            background: linear-gradient(145deg, rgba(255, 159, 64, 0.3), rgba(255, 107, 107, 0.2));
        }

        .drum-pad.ride {
            background: linear-gradient(145deg, rgba(78, 205, 196, 0.3), rgba(107, 207, 227, 0.2));
        }

        .drum-icon {
            font-size: 3rem;
            margin-bottom: 8px;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
        }

        .drum-label {
            font-size: 1rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-bottom: 4px;
        }

        .drum-key {
            font-size: 0.85rem;
            padding: 4px 12px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            font-weight: 500;
        }

        .visualizer {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 20px;
            height: 120px;
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            gap: 4px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            animation: fadeIn 1.2s ease-out;
        }

        .visualizer-bar {
            flex: 1;
            background: linear-gradient(to top, #ff6b6b, #ffd93d, #6bcf7f);
            border-radius: 4px 4px 0 0;
            min-width: 4px;
            height: 10%;
            transition: height 0.1s ease;
            box-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
        }

        .recording-indicator {
            display: none;
            align-items: center;
            gap: 10px;
            padding: 12px 20px;
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid rgba(255, 107, 107, 0.4);
            border-radius: 50px;
            font-size: 14px;
            font-weight: 600;
        }

        .recording-indicator.active {
            display: flex;
        }

        .rec-dot {
            width: 12px;
            height: 12px;
            background: #ff6b6b;
            border-radius: 50%;
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.2);
                opacity: 0.7;
            }
        }

        @keyframes gradientShift {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        footer {
            margin-top: 40px;
            text-align: center;
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .drum-kit {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }

            .drum-pad {
                min-height: 120px;
            }

            .drum-icon {
                font-size: 2.5rem;
            }

            .controls-panel {
                padding: 15px;
                gap: 10px;
            }

            .control-btn {
                padding: 10px 20px;
                font-size: 14px;
            }
        }

        @media (max-width: 480px) {
            .drum-kit {
                grid-template-columns: repeat(2, 1fr);
            }

            .drum-pad {
                min-height: 100px;
            }

            .drum-icon {
                font-size: 2rem;
            }

            .drum-label {
                font-size: 0.85rem;
            }

            .drum-key {
                font-size: 0.75rem;
                padding: 3px 8px;
            }
        }
    </style>
</head>
<body>
    <div class="studio-container">
        <header>
            <h1>ü•Å Virtual Drum Kit</h1>
            <p class="subtitle">Play with keyboard or tap the pads</p>
        </header>

        <div class="controls-panel">
            <button id="recordBtn" class="control-btn">‚è∫ Record</button>
            <button id="playBtn" class="control-btn" disabled>‚ñ∂ Play</button>
            <button id="clearBtn" class="control-btn">üóë Clear</button>
            <div class="recording-indicator" id="recordingIndicator">
                <div class="rec-dot"></div>
                <span>Recording...</span>
            </div>
        </div>

        <div class="drum-kit" id="drumKit">
            <div class="drum-pad kick" data-key="a" data-sound="kick">
                <div class="drum-icon">ü•æ</div>
                <div class="drum-label">Kick</div>
                <div class="drum-key">A</div>
            </div>
            <div class="drum-pad snare" data-key="s" data-sound="snare">
                <div class="drum-icon">üéØ</div>
                <div class="drum-label">Snare</div>
                <div class="drum-key">S</div>
            </div>
            <div class="drum-pad hihat" data-key="d" data-sound="hihat">
                <div class="drum-icon">üé©</div>
                <div class="drum-label">Hi-Hat</div>
                <div class="drum-key">D</div>
            </div>
            <div class="drum-pad tom" data-key="f" data-sound="tom">
                <div class="drum-icon">üé™</div>
                <div class="drum-label">Tom</div>
                <div class="drum-key">F</div>
            </div>
            <div class="drum-pad crash" data-key="j" data-sound="crash">
                <div class="drum-icon">üí•</div>
                <div class="drum-label">Crash</div>
                <div class="drum-key">J</div>
            </div>
            <div class="drum-pad ride" data-key="k" data-sound="ride">
                <div class="drum-icon">üåä</div>
                <div class="drum-label">Ride</div>
                <div class="drum-key">K</div>
            </div>
        </div>

        <div class="visualizer" id="visualizer">
            <div class="visualizer-bar"></div>
            <div class="visualizer-bar"></div>
            <div class="visualizer-bar"></div>
            <div class="visualizer-bar"></div>
            <div class="visualizer-bar"></div>
            <div class="visualizer-bar"></div>
            <div class="visualizer-bar"></div>
            <div class="visualizer-bar"></div>
            <div class="visualizer-bar"></div>
            <div class="visualizer-bar"></div>
            <div class="visualizer-bar"></div>
            <div class="visualizer-bar"></div>
            <div class="visualizer-bar"></div>
            <div class="visualizer-bar"></div>
            <div class="visualizer-bar"></div>
            <div class="visualizer-bar"></div>
            <div class="visualizer-bar"></div>
            <div class="visualizer-bar"></div>
            <div class="visualizer-bar"></div>
            <div class="visualizer-bar"></div>
        </div>

        <footer>
            <p>Press the keys or click/tap the pads to play ‚Ä¢ Record and playback your beats</p>
        </footer>
    </div>

    <script>
        // AudioContext setup
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        const audioContext = new AudioContext();

        // Drum sounds using Web Audio API
        const drumSounds = {
            kick: {
                frequency: 150,
                decay: 0.5,
                type: 'sine'
            },
            snare: {
                frequency: 200,
                decay: 0.2,
                type: 'triangle',
                noise: true
            },
            hihat: {
                frequency: 10000,
                decay: 0.1,
                type: 'highpass'
            },
            tom: {
                frequency: 220,
                decay: 0.3,
                type: 'sine'
            },
            crash: {
                frequency: 8000,
                decay: 1.5,
                type: 'highpass'
            },
            ride: {
                frequency: 5000,
                decay: 0.8,
                type: 'highpass'
            }
        };

        // Recording state
        let isRecording = false;
        let recordedBeats = [];
        let recordingStartTime = 0;
        let isPlaying = false;

        // Visualizer
        const visualizerBars = document.querySelectorAll('.visualizer-bar');

        function createOscillator(sound) {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            return { oscillator, gainNode };
        }

        function playDrumSound(soundType) {
            const sound = drumSounds[soundType];
            const now = audioContext.currentTime;

            if (soundType === 'kick') {
                const { oscillator, gainNode } = createOscillator(sound);
                oscillator.frequency.setValueAtTime(sound.frequency, now);
                oscillator.frequency.exponentialRampToValueAtTime(0.01, now + sound.decay);
                gainNode.gain.setValueAtTime(1, now);
                gainNode.gain.exponentialRampToValueAtTime(0.01, now + sound.decay);
                oscillator.start(now);
                oscillator.stop(now + sound.decay);
            } else if (soundType === 'snare') {
                // Tone
                const { oscillator: osc1, gainNode: gain1 } = createOscillator(sound);
                osc1.type = 'triangle';
                osc1.frequency.setValueAtTime(100, now);
                gain1.gain.setValueAtTime(0.3, now);
                gain1.gain.exponentialRampToValueAtTime(0.01, now + sound.decay);
                osc1.start(now);
                osc1.stop(now + sound.decay);

                // Noise
                const bufferSize = audioContext.sampleRate * sound.decay;
                const buffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
                const data = buffer.getChannelData(0);
                for (let i = 0; i < bufferSize; i++) {
                    data[i] = Math.random() * 2 - 1;
                }
                const noise = audioContext.createBufferSource();
                noise.buffer = buffer;
                const noiseGain = audioContext.createGain();
                const noiseFilter = audioContext.createBiquadFilter();
                noiseFilter.type = 'highpass';
                noiseFilter.frequency.setValueAtTime(1000, now);
                noise.connect(noiseFilter);
                noiseFilter.connect(noiseGain);
                noiseGain.connect(audioContext.destination);
                noiseGain.gain.setValueAtTime(0.5, now);
                noiseGain.gain.exponentialRampToValueAtTime(0.01, now + sound.decay);
                noise.start(now);
            } else if (soundType === 'hihat' || soundType === 'crash' || soundType === 'ride') {
                // White noise for cymbals
                const bufferSize = audioContext.sampleRate * sound.decay;
                const buffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
                const data = buffer.getChannelData(0);
                for (let i = 0; i < bufferSize; i++) {
                    data[i] = Math.random() * 2 - 1;
                }
                const noise = audioContext.createBufferSource();
                noise.buffer = buffer;
                const filter = audioContext.createBiquadFilter();
                filter.type = 'highpass';
                filter.frequency.setValueAtTime(sound.frequency, now);
                const gainNode = audioContext.createGain();
                noise.connect(filter);
                filter.connect(gainNode);
                gainNode.connect(audioContext.destination);
                gainNode.gain.setValueAtTime(0.5, now);
                gainNode.gain.exponentialRampToValueAtTime(0.01, now + sound.decay);
                noise.start(now);
            } else if (soundType === 'tom') {
                const { oscillator, gainNode } = createOscillator(sound);
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(sound.frequency, now);
                oscillator.frequency.exponentialRampToValueAtTime(0.01, now + sound.decay);
                gainNode.gain.setValueAtTime(0.7, now);
                gainNode.gain.exponentialRampToValueAtTime(0.01, now + sound.decay);
                oscillator.start(now);
                oscillator.stop(now + sound.decay);
            }

            // Visualizer animation
            animateVisualizer();
        }

        function animateVisualizer() {
            visualizerBars.forEach(bar => {
                const height = Math.random() * 90 + 10;
                bar.style.height = height + '%';
                setTimeout(() => {
                    bar.style.height = '10%';
                }, 100);
            });
        }

        function activatePad(pad) {
            pad.classList.add('active');
            setTimeout(() => {
                pad.classList.remove('active');
            }, 150);
        }

        function playDrum(soundType, padElement) {
            // Resume audio context on user interaction (required by browsers)
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }

            playDrumSound(soundType);
            if (padElement) {
                activatePad(padElement);
            }

            // Record if recording is active
            if (isRecording) {
                const timestamp = Date.now() - recordingStartTime;
                recordedBeats.push({ soundType, timestamp });
            }
        }

        // Drum pad click handlers
        const drumPads = document.querySelectorAll('.drum-pad');
        drumPads.forEach(pad => {
            pad.addEventListener('click', () => {
                const soundType = pad.dataset.sound;
                playDrum(soundType, pad);
            });

            // Touch support
            pad.addEventListener('touchstart', (e) => {
                e.preventDefault();
                const soundType = pad.dataset.sound;
                playDrum(soundType, pad);
            });
        });

        // Keyboard handlers
        document.addEventListener('keydown', (e) => {
            const key = e.key.toLowerCase();
            const pad = document.querySelector(`[data-key="${key}"]`);
            if (pad && !e.repeat) {
                const soundType = pad.dataset.sound;
                playDrum(soundType, pad);
            }
        });

        // Recording controls
        const recordBtn = document.getElementById('recordBtn');
        const playBtn = document.getElementById('playBtn');
        const clearBtn = document.getElementById('clearBtn');
        const recordingIndicator = document.getElementById('recordingIndicator');

        recordBtn.addEventListener('click', () => {
            if (!isRecording) {
                // Start recording
                isRecording = true;
                recordedBeats = [];
                recordingStartTime = Date.now();
                recordBtn.classList.add('recording');
                recordBtn.innerHTML = '‚èπ Stop';
                recordingIndicator.classList.add('active');
                playBtn.disabled = true;
            } else {
                // Stop recording
                isRecording = false;
                recordBtn.classList.remove('recording');
                recordBtn.innerHTML = '‚è∫ Record';
                recordingIndicator.classList.remove('active');
                playBtn.disabled = recordedBeats.length === 0;
            }
        });

        playBtn.addEventListener('click', () => {
            if (isPlaying || recordedBeats.length === 0) return;

            isPlaying = true;
            playBtn.classList.add('playing');
            playBtn.innerHTML = '‚è∏ Playing...';
            recordBtn.disabled = true;

            let lastTimestamp = 0;
            let beatIndex = 0;

            function playNextBeat() {
                if (beatIndex >= recordedBeats.length) {
                    isPlaying = false;
                    playBtn.classList.remove('playing');
                    playBtn.innerHTML = '‚ñ∂ Play';
                    recordBtn.disabled = false;
                    return;
                }

                const beat = recordedBeats[beatIndex];
                const delay = beat.timestamp - lastTimestamp;

                setTimeout(() => {
                    const pad = document.querySelector(`[data-sound="${beat.soundType}"]`);
                    playDrum(beat.soundType, pad);
                    lastTimestamp = beat.timestamp;
                    beatIndex++;
                    playNextBeat();
                }, delay);
            }

            playNextBeat();
        });

        clearBtn.addEventListener('click', () => {
            if (confirm('Clear recorded beats?')) {
                recordedBeats = [];
                playBtn.disabled = true;
                if (isRecording) {
                    isRecording = false;
                    recordBtn.classList.remove('recording');
                    recordBtn.innerHTML = '‚è∫ Record';
                    recordingIndicator.classList.remove('active');
                }
            }
        });

        // Initialize visualizer
        setInterval(() => {
            if (!isRecording && !isPlaying) {
                visualizerBars.forEach(bar => {
                    const height = Math.random() * 20 + 10;
                    bar.style.height = height + '%';
                });
            }
        }, 100);
    </script>
</body>
</html>
