<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typing Rain</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            overflow: hidden;
            background: linear-gradient(to bottom, #0a0e27 0%, #1a1d3d 50%, #2d3561 100%);
            color: white;
        }

        #game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
        }

        #city-skyline {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 30%;
            background: linear-gradient(to top, #0f1419 0%, transparent 100%);
            z-index: 1;
        }

        .building {
            position: absolute;
            bottom: 0;
            background: linear-gradient(to right, #1a1f2e 0%, #0f1419 100%);
            border-top: 2px solid #2a3f5f;
        }

        .window {
            position: absolute;
            background: rgba(255, 230, 150, 0.7);
            animation: windowFlicker 3s infinite;
        }

        @keyframes windowFlicker {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 0.3; }
        }

        #rain-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
        }

        .raindrop {
            position: absolute;
            font-size: 20px;
            font-weight: bold;
            color: #4dd0e1;
            text-shadow: 0 0 10px rgba(77, 208, 225, 0.8), 0 0 20px rgba(77, 208, 225, 0.4);
            cursor: default;
            user-select: none;
            transition: color 0.1s;
            letter-spacing: 2px;
        }

        .raindrop.typing {
            color: #ffd700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.8), 0 0 20px rgba(255, 215, 0, 0.4);
        }

        .raindrop .typed {
            color: #4caf50;
            text-shadow: 0 0 10px rgba(76, 175, 80, 0.8);
        }

        .raindrop .incorrect {
            color: #f44336;
            text-shadow: 0 0 10px rgba(244, 67, 54, 0.8);
        }

        #hud {
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 10;
            padding: 0 40px;
        }

        .hud-item {
            background: rgba(15, 20, 35, 0.8);
            padding: 15px 30px;
            border-radius: 10px;
            border: 2px solid #4dd0e1;
            box-shadow: 0 0 20px rgba(77, 208, 225, 0.3);
        }

        .hud-label {
            font-size: 12px;
            color: #4dd0e1;
            text-transform: uppercase;
            margin-bottom: 5px;
        }

        .hud-value {
            font-size: 28px;
            font-weight: bold;
            color: #ffffff;
        }

        #current-input {
            position: absolute;
            bottom: 60px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(15, 20, 35, 0.95);
            padding: 20px 40px;
            border-radius: 15px;
            border: 3px solid #4dd0e1;
            box-shadow: 0 0 30px rgba(77, 208, 225, 0.5);
            font-size: 24px;
            min-width: 300px;
            text-align: center;
            z-index: 10;
            letter-spacing: 3px;
        }

        #game-over-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 14, 39, 0.95);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }

        #game-over-screen.show {
            display: flex;
        }

        #game-over-screen h1 {
            font-size: 64px;
            color: #f44336;
            text-shadow: 0 0 20px rgba(244, 67, 54, 0.8);
            margin-bottom: 30px;
        }

        .stats-container {
            background: rgba(15, 20, 35, 0.9);
            padding: 40px 60px;
            border-radius: 20px;
            border: 3px solid #4dd0e1;
            margin-bottom: 40px;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            font-size: 24px;
        }

        .stat-label {
            color: #4dd0e1;
            margin-right: 40px;
        }

        .stat-value {
            color: #ffffff;
            font-weight: bold;
        }

        #restart-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 20px 60px;
            font-size: 24px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            transition: transform 0.2s, box-shadow 0.2s;
            font-family: 'Courier New', monospace;
        }

        #restart-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6);
        }

        #start-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 14, 39, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }

        #start-screen h1 {
            font-size: 72px;
            color: #4dd0e1;
            text-shadow: 0 0 30px rgba(77, 208, 225, 0.8);
            margin-bottom: 20px;
        }

        #start-screen p {
            font-size: 20px;
            color: #ffffff;
            margin-bottom: 50px;
            text-align: center;
            max-width: 600px;
            line-height: 1.6;
        }

        #start-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 20px 60px;
            font-size: 28px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            transition: transform 0.2s, box-shadow 0.2s;
            font-family: 'Courier New', monospace;
        }

        #start-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6);
        }

        .lightning {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.3);
            opacity: 0;
            pointer-events: none;
            z-index: 5;
        }

        @keyframes lightning {
            0%, 100% { opacity: 0; }
            50% { opacity: 1; }
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #4dd0e1;
            border-radius: 50%;
            pointer-events: none;
            z-index: 3;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div class="lightning" id="lightning"></div>
        <div id="rain-container"></div>
        <div id="city-skyline"></div>

        <div id="hud">
            <div class="hud-item">
                <div class="hud-label">Score</div>
                <div class="hud-value" id="score">0</div>
            </div>
            <div class="hud-item">
                <div class="hud-label">Level</div>
                <div class="hud-value" id="level">1</div>
            </div>
            <div class="hud-item">
                <div class="hud-label">Accuracy</div>
                <div class="hud-value" id="accuracy">100%</div>
            </div>
            <div class="hud-item">
                <div class="hud-label">Lives</div>
                <div class="hud-value" id="lives">5</div>
            </div>
        </div>

        <div id="current-input"></div>

        <div id="start-screen">
            <h1>TYPING RAIN</h1>
            <p>
                Type the falling words before they reach the city below!<br>
                Words fall faster as you progress. Stay sharp!<br><br>
                <strong>How to play:</strong> Just start typing any visible word
            </p>
            <button id="start-button">START GAME</button>
        </div>

        <div id="game-over-screen">
            <h1>GAME OVER</h1>
            <div class="stats-container">
                <div class="stat-row">
                    <span class="stat-label">Final Score:</span>
                    <span class="stat-value" id="final-score">0</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Level Reached:</span>
                    <span class="stat-value" id="final-level">1</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Final Accuracy:</span>
                    <span class="stat-value" id="final-accuracy">100%</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Words Typed:</span>
                    <span class="stat-value" id="words-typed">0</span>
                </div>
            </div>
            <button id="restart-button">PLAY AGAIN</button>
        </div>
    </div>

    <script>
        // Game state
        const gameState = {
            score: 0,
            level: 1,
            lives: 5,
            correctChars: 0,
            totalChars: 0,
            wordsTyped: 0,
            isPlaying: false,
            currentWord: null,
            currentInput: '',
            raindrops: [],
            spawnInterval: null,
            updateInterval: null
        };

        // Word lists by difficulty
        const wordLists = {
            easy: ['cat', 'dog', 'sun', 'moon', 'star', 'tree', 'bird', 'fish', 'book', 'pen'],
            medium: ['house', 'cloud', 'river', 'mountain', 'garden', 'forest', 'ocean', 'planet', 'castle', 'bridge'],
            hard: ['keyboard', 'computer', 'elephant', 'butterfly', 'adventure', 'champion', 'diamond', 'lightning', 'paradise', 'universe'],
            expert: ['magnificent', 'extraordinary', 'unstoppable', 'programming', 'spectacular', 'revolutionary', 'constellation', 'determination', 'imagination', 'sophisticated']
        };

        // Game elements
        const rainContainer = document.getElementById('rain-container');
        const currentInputDiv = document.getElementById('current-input');
        const scoreElement = document.getElementById('score');
        const levelElement = document.getElementById('level');
        const accuracyElement = document.getElementById('accuracy');
        const livesElement = document.getElementById('lives');
        const startScreen = document.getElementById('start-screen');
        const gameOverScreen = document.getElementById('game-over-screen');
        const startButton = document.getElementById('start-button');
        const restartButton = document.getElementById('restart-button');
        const lightning = document.getElementById('lightning');

        // Initialize city skyline
        function createCity() {
            const cityline = document.getElementById('city-skyline');
            const buildingCount = 15;

            for (let i = 0; i < buildingCount; i++) {
                const building = document.createElement('div');
                building.className = 'building';
                const width = 50 + Math.random() * 100;
                const height = 20 + Math.random() * 80;
                const left = (i / buildingCount) * 100;

                building.style.width = width + 'px';
                building.style.height = height + '%';
                building.style.left = left + '%';

                // Add windows
                const windowRows = Math.floor(height / 15);
                const windowCols = Math.floor(width / 20);

                for (let row = 0; row < windowRows; row++) {
                    for (let col = 0; col < windowCols; col++) {
                        if (Math.random() > 0.3) {
                            const window = document.createElement('div');
                            window.className = 'window';
                            window.style.width = '8px';
                            window.style.height = '12px';
                            window.style.left = (col * 20 + 6) + 'px';
                            window.style.bottom = (row * 15 + 5) + 'px';
                            window.style.animationDelay = Math.random() * 3 + 's';
                            building.appendChild(window);
                        }
                    }
                }

                cityline.appendChild(building);
            }
        }

        // Get word list based on level
        function getWordList() {
            if (gameState.level <= 2) return wordLists.easy;
            if (gameState.level <= 5) return wordLists.medium;
            if (gameState.level <= 8) return wordLists.hard;
            return wordLists.expert;
        }

        // Create raindrop
        function createRaindrop() {
            const wordList = getWordList();
            const word = wordList[Math.floor(Math.random() * wordList.length)];

            const raindrop = document.createElement('div');
            raindrop.className = 'raindrop';
            raindrop.textContent = word;
            raindrop.dataset.word = word;
            raindrop.dataset.typed = '';
            raindrop.style.left = Math.random() * (window.innerWidth - 100) + 'px';
            raindrop.style.top = '-50px';

            rainContainer.appendChild(raindrop);

            const dropData = {
                element: raindrop,
                word: word,
                typed: '',
                y: -50,
                speed: 0.5 + (gameState.level * 0.15)
            };

            gameState.raindrops.push(dropData);
        }

        // Update raindrop positions
        function updateRaindrops() {
            const cityHeight = window.innerHeight * 0.7;

            for (let i = gameState.raindrops.length - 1; i >= 0; i--) {
                const drop = gameState.raindrops[i];
                drop.y += drop.speed;
                drop.element.style.top = drop.y + 'px';

                // Check if reached bottom
                if (drop.y > cityHeight) {
                    removeRaindrop(i, true);
                    gameState.lives--;
                    livesElement.textContent = gameState.lives;
                    flashLightning();

                    if (gameState.lives <= 0) {
                        gameOver();
                    }
                }
            }
        }

        // Remove raindrop
        function removeRaindrop(index, missed = false) {
            const drop = gameState.raindrops[index];

            if (!missed) {
                createParticles(drop.element);
            }

            if (drop.element.parentNode) {
                drop.element.parentNode.removeChild(drop.element);
            }

            gameState.raindrops.splice(index, 1);

            if (gameState.currentWord === drop) {
                gameState.currentWord = null;
                gameState.currentInput = '';
                currentInputDiv.textContent = '';
            }
        }

        // Create particle effect
        function createParticles(element) {
            const rect = element.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;

            for (let i = 0; i < 12; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = centerX + 'px';
                particle.style.top = centerY + 'px';
                document.body.appendChild(particle);

                const angle = (Math.PI * 2 * i) / 12;
                const velocity = 2 + Math.random() * 2;
                const vx = Math.cos(angle) * velocity;
                const vy = Math.sin(angle) * velocity;

                let x = centerX;
                let y = centerY;
                let life = 30;

                const animateParticle = () => {
                    x += vx;
                    y += vy;
                    life--;

                    particle.style.left = x + 'px';
                    particle.style.top = y + 'px';
                    particle.style.opacity = life / 30;

                    if (life > 0) {
                        requestAnimationFrame(animateParticle);
                    } else {
                        particle.remove();
                    }
                };

                animateParticle();
            }
        }

        // Flash lightning
        function flashLightning() {
            lightning.style.animation = 'lightning 0.2s';
            setTimeout(() => {
                lightning.style.animation = '';
            }, 200);
        }

        // Handle typing
        function handleKeyPress(event) {
            if (!gameState.isPlaying) return;

            const key = event.key.toLowerCase();

            // Ignore special keys
            if (key.length !== 1 || event.ctrlKey || event.metaKey || event.altKey) return;

            gameState.totalChars++;

            // If no current word, find matching word
            if (!gameState.currentWord) {
                for (const drop of gameState.raindrops) {
                    if (drop.word[0].toLowerCase() === key) {
                        gameState.currentWord = drop;
                        gameState.currentInput = key;
                        drop.typed = key;
                        drop.element.classList.add('typing');
                        gameState.correctChars++;
                        updateWordDisplay(drop);
                        break;
                    }
                }
            } else {
                // Continue typing current word
                const expectedChar = gameState.currentWord.word[gameState.currentInput.length];

                if (expectedChar && expectedChar.toLowerCase() === key) {
                    gameState.currentInput += key;
                    gameState.currentWord.typed = gameState.currentInput;
                    gameState.correctChars++;
                    updateWordDisplay(gameState.currentWord);

                    // Check if word is complete
                    if (gameState.currentInput === gameState.currentWord.word) {
                        const wordLength = gameState.currentWord.word.length;
                        gameState.score += wordLength * 10 * gameState.level;
                        gameState.wordsTyped++;
                        scoreElement.textContent = gameState.score;

                        const index = gameState.raindrops.indexOf(gameState.currentWord);
                        if (index !== -1) {
                            removeRaindrop(index, false);
                        }

                        // Level up
                        if (gameState.wordsTyped % 10 === 0) {
                            gameState.level++;
                            levelElement.textContent = gameState.level;
                            adjustDifficulty();
                        }
                    }
                } else {
                    // Wrong key - cancel current word
                    if (gameState.currentWord) {
                        gameState.currentWord.element.classList.remove('typing');
                        gameState.currentWord = null;
                        gameState.currentInput = '';
                    }
                }
            }

            updateAccuracy();
            currentInputDiv.textContent = gameState.currentInput;
        }

        // Update word display
        function updateWordDisplay(drop) {
            let html = '';
            for (let i = 0; i < drop.word.length; i++) {
                if (i < drop.typed.length) {
                    html += `<span class="typed">${drop.word[i]}</span>`;
                } else {
                    html += drop.word[i];
                }
            }
            drop.element.innerHTML = html;
        }

        // Update accuracy
        function updateAccuracy() {
            const accuracy = gameState.totalChars > 0
                ? Math.round((gameState.correctChars / gameState.totalChars) * 100)
                : 100;
            accuracyElement.textContent = accuracy + '%';
        }

        // Adjust difficulty
        function adjustDifficulty() {
            clearInterval(gameState.spawnInterval);
            const spawnRate = Math.max(800 - (gameState.level * 50), 400);
            gameState.spawnInterval = setInterval(createRaindrop, spawnRate);
        }

        // Start game
        function startGame() {
            gameState.score = 0;
            gameState.level = 1;
            gameState.lives = 5;
            gameState.correctChars = 0;
            gameState.totalChars = 0;
            gameState.wordsTyped = 0;
            gameState.isPlaying = true;
            gameState.currentWord = null;
            gameState.currentInput = '';
            gameState.raindrops = [];

            rainContainer.innerHTML = '';
            currentInputDiv.textContent = '';
            scoreElement.textContent = '0';
            levelElement.textContent = '1';
            accuracyElement.textContent = '100%';
            livesElement.textContent = '5';

            startScreen.style.display = 'none';
            gameOverScreen.classList.remove('show');

            gameState.spawnInterval = setInterval(createRaindrop, 1500);
            gameState.updateInterval = setInterval(updateRaindrops, 16);
        }

        // Game over
        function gameOver() {
            gameState.isPlaying = false;
            clearInterval(gameState.spawnInterval);
            clearInterval(gameState.updateInterval);

            document.getElementById('final-score').textContent = gameState.score;
            document.getElementById('final-level').textContent = gameState.level;
            document.getElementById('final-accuracy').textContent = accuracyElement.textContent;
            document.getElementById('words-typed').textContent = gameState.wordsTyped;

            gameOverScreen.classList.add('show');
        }

        // Event listeners
        startButton.addEventListener('click', startGame);
        restartButton.addEventListener('click', startGame);
        document.addEventListener('keydown', handleKeyPress);

        // Initialize
        createCity();
    </script>
</body>
</html>