<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tea Dunkability Simulator</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            transition: background-color 0.3s ease;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .dark .glass-card {
            background: rgba(30, 30, 30, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .teacup {
            width: 200px;
            height: 150px;
            position: relative;
            margin: 0 auto;
        }

        .cup-body {
            width: 160px;
            height: 100px;
            background: linear-gradient(to bottom, #f0f0f0, #ffffff);
            border: 3px solid #333;
            border-radius: 0 0 60px 60px;
            position: absolute;
            bottom: 20px;
            left: 20px;
        }

        .dark .cup-body {
            background: linear-gradient(to bottom, #4a4a4a, #6a6a6a);
            border-color: #fff;
        }

        .cup-handle {
            width: 40px;
            height: 60px;
            border: 3px solid #333;
            border-left: none;
            border-radius: 0 30px 30px 0;
            position: absolute;
            right: 0;
            bottom: 40px;
        }

        .dark .cup-handle {
            border-color: #fff;
        }

        .tea-liquid {
            width: 140px;
            height: 60px;
            background: linear-gradient(to bottom, #c47722, #8b4513);
            position: absolute;
            bottom: 23px;
            left: 30px;
            border-radius: 0 0 50px 50px;
            animation: tea-shimmer 2s infinite;
        }

        @keyframes tea-shimmer {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.9; }
        }

        .steam {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
        }

        .steam-particle {
            position: absolute;
            width: 3px;
            height: 20px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            animation: steam-rise 3s infinite;
            filter: blur(2px);
        }

        .dark .steam-particle {
            background: rgba(200, 200, 200, 0.4);
        }

        .steam-particle:nth-child(1) {
            left: 20px;
            animation-delay: 0s;
        }

        .steam-particle:nth-child(2) {
            left: 40px;
            animation-delay: 0.5s;
        }

        .steam-particle:nth-child(3) {
            left: 60px;
            animation-delay: 1s;
        }

        @keyframes steam-rise {
            0% {
                transform: translateY(0) scale(1);
                opacity: 0;
            }
            10% {
                opacity: 0.7;
            }
            50% {
                opacity: 0.5;
            }
            100% {
                transform: translateY(-80px) scale(1.5);
                opacity: 0;
            }
        }

        .crumb {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #8b6914;
            border-radius: 50%;
            animation: crumb-fall 1.5s ease-in forwards;
        }

        .dark .crumb {
            background: #d4a574;
        }

        @keyframes crumb-fall {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(200px) rotate(360deg);
                opacity: 0;
            }
        }

        .slider-container {
            position: relative;
        }

        .slider {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: linear-gradient(to right, #ddd, #bbb);
            outline: none;
            transition: background 0.3s;
        }

        .dark .slider {
            background: linear-gradient(to right, #444, #666);
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            transition: transform 0.1s;
        }

        .slider::-webkit-slider-thumb:hover {
            transform: scale(1.1);
        }

        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            border: none;
            transition: transform 0.1s;
        }

        .slider::-moz-range-thumb:hover {
            transform: scale(1.1);
        }

        .crumble-meter {
            height: 200px;
            position: relative;
        }

        .meter-bar {
            position: absolute;
            bottom: 0;
            width: 40px;
            background: linear-gradient(to top, #10b981, #fbbf24, #ef4444);
            border-radius: 4px 4px 0 0;
            transition: height 0.5s ease;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
        }

        .biscuit-icon {
            font-size: 3rem;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .warning-pulse {
            animation: warning-pulse 1s infinite;
        }

        @keyframes warning-pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .kbd {
            display: inline-block;
            padding: 2px 6px;
            font-size: 0.75rem;
            font-family: monospace;
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
            border-radius: 3px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .dark .kbd {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .graph-line {
            stroke-width: 3;
            fill: none;
            stroke: #667eea;
            filter: drop-shadow(0 2px 4px rgba(102, 126, 234, 0.3));
        }

        .biscuit-dunk {
            position: absolute;
            top: 40px;
            left: 50%;
            transform: translateX(-50%);
            transition: top 0.5s ease;
        }

        .biscuit-rect {
            width: 60px;
            height: 80px;
            background: linear-gradient(135deg, #d4a574 0%, #8b6914 100%);
            border: 2px solid #654321;
            border-radius: 8px;
            position: relative;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .dark .biscuit-rect {
            border-color: #a0826d;
        }

        .biscuit-texture {
            position: absolute;
            width: 6px;
            height: 6px;
            background: rgba(101, 67, 33, 0.3);
            border-radius: 50%;
        }

        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.875rem;
            pointer-events: none;
            z-index: 100;
            white-space: nowrap;
        }

        .dark .tooltip {
            background: rgba(255, 255, 255, 0.9);
            color: #000;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const BISCUIT_TYPES = [
            { name: 'Digestive', baseIntegrity: 75, emoji: 'üç™' },
            { name: 'Rich Tea', baseIntegrity: 45, emoji: 'ü•†' },
            { name: 'Hobnob', baseIntegrity: 90, emoji: 'üçò' },
            { name: 'Custard Cream', baseIntegrity: 60, emoji: 'ü•Æ' },
            { name: 'Bourbon', baseIntegrity: 65, emoji: 'üç´' },
            { name: 'Ginger Nut', baseIntegrity: 95, emoji: 'üß°' }
        ];

        function App() {
            const [darkMode, setDarkMode] = useState(false);
            const [teaTemp, setTeaTemp] = useState(70);
            const [dunkTime, setDunkTime] = useState(2);
            const [biscuitType, setBiscuitType] = useState(0);
            const [structuralIntegrity, setStructuralIntegrity] = useState(100);
            const [crumbleFactor, setCrumbleFactor] = useState(0);
            const [crumbs, setCrumbs] = useState([]);
            const [historyData, setHistoryData] = useState([]);
            const [showTooltip, setShowTooltip] = useState(null);
            const crumbIdRef = useRef(0);

            useEffect(() => {
                document.documentElement.classList.toggle('dark', darkMode);
            }, [darkMode]);

            useEffect(() => {
                const biscuit = BISCUIT_TYPES[biscuitType];
                const tempFactor = Math.max(0, (teaTemp - 40) / 60);
                const timeFactor = Math.max(0, dunkTime / 10);
                const integrityLoss = (tempFactor * 30 + timeFactor * 40) * (100 / biscuit.baseIntegrity);

                const newIntegrity = Math.max(0, 100 - integrityLoss);
                setStructuralIntegrity(newIntegrity);

                const crumble = Math.max(0, Math.min(100, integrityLoss * 1.2));
                setCrumbleFactor(crumble);

                setHistoryData(prev => {
                    const newData = [...prev, { time: prev.length, integrity: newIntegrity }];
                    return newData.slice(-20);
                });

                if (newIntegrity < 30 && Math.random() > 0.7) {
                    const newCrumbs = Array.from({ length: 3 }, () => ({
                        id: crumbIdRef.current++,
                        left: Math.random() * 80 + 10,
                        animationDelay: Math.random() * 0.5
                    }));
                    setCrumbs(prev => [...prev, ...newCrumbs]);

                    setTimeout(() => {
                        setCrumbs(prev => prev.filter(c => !newCrumbs.find(nc => nc.id === c.id)));
                    }, 1500);
                }
            }, [teaTemp, dunkTime, biscuitType]);

            useEffect(() => {
                const handleKeyPress = (e) => {
                    if (e.key === 'd' || e.key === 'D') {
                        setDarkMode(prev => !prev);
                    } else if (e.key === 't' || e.key === 'T') {
                        setTeaTemp(prev => Math.min(100, prev + 5));
                    } else if (e.key === 'r' || e.key === 'R') {
                        setTeaTemp(prev => Math.max(40, prev - 5));
                    } else if (e.key === '+' || e.key === '=') {
                        setDunkTime(prev => Math.min(10, prev + 0.5));
                    } else if (e.key === '-' || e.key === '_') {
                        setDunkTime(prev => Math.max(0, prev - 0.5));
                    } else if (e.key === 'b' || e.key === 'B') {
                        setBiscuitType(prev => (prev + 1) % BISCUIT_TYPES.length);
                    } else if (e.key === 's' || e.key === 'S') {
                        setStructuralIntegrity(100);
                    }
                };

                window.addEventListener('keydown', handleKeyPress);
                return () => window.removeEventListener('keydown', handleKeyPress);
            }, []);

            const getStatusMessage = () => {
                if (structuralIntegrity > 80) return '‚òï Perfect Dunk!';
                if (structuralIntegrity > 60) return 'üòä Good Dunk';
                if (structuralIntegrity > 40) return 'üò¨ Risky!';
                if (structuralIntegrity > 20) return '‚ö†Ô∏è Danger Zone!';
                return 'üí• CRUMBLED!';
            };

            const getStatusColor = () => {
                if (structuralIntegrity > 80) return 'text-green-600 dark:text-green-400';
                if (structuralIntegrity > 60) return 'text-blue-600 dark:text-blue-400';
                if (structuralIntegrity > 40) return 'text-yellow-600 dark:text-yellow-400';
                if (structuralIntegrity > 20) return 'text-orange-600 dark:text-orange-400';
                return 'text-red-600 dark:text-red-400';
            };

            const biscuitDunkDepth = Math.min(70, (dunkTime / 10) * 70);

            return (
                <div className="min-h-screen p-4 md:p-8">
                    <div className="max-w-7xl mx-auto">
                        <header className="text-center mb-8">
                            <h1 className="text-4xl md:text-5xl font-bold text-gray-800 dark:text-white mb-2">
                                ‚òï Tea Dunkability Simulator
                            </h1>
                            <p className="text-gray-600 dark:text-gray-300">
                                Master the art of the perfect biscuit dunk
                            </p>
                            <button
                                onClick={() => setDarkMode(!darkMode)}
                                className="mt-4 px-4 py-2 rounded-lg glass-card text-gray-700 dark:text-gray-200 hover:scale-105 transition-transform"
                            >
                                {darkMode ? '‚òÄÔ∏è' : 'üåô'} Toggle Dark Mode
                            </button>
                        </header>

                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                            <div className="lg:col-span-2 space-y-6">
                                <div className="glass-card rounded-2xl p-6">
                                    <h2 className="text-2xl font-semibold mb-4 text-gray-800 dark:text-white">
                                        üéõÔ∏è Dunking Parameters
                                    </h2>

                                    <div className="space-y-6">
                                        <div>
                                            <div className="flex justify-between mb-2">
                                                <label className="text-gray-700 dark:text-gray-300 font-medium">
                                                    Tea Temperature <span className="kbd">T/R</span>
                                                </label>
                                                <span className="text-gray-800 dark:text-white font-bold">
                                                    {teaTemp}¬∞C
                                                </span>
                                            </div>
                                            <input
                                                type="range"
                                                min="40"
                                                max="100"
                                                value={teaTemp}
                                                onChange={(e) => setTeaTemp(Number(e.target.value))}
                                                className="slider"
                                            />
                                            <div className="flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1">
                                                <span>Lukewarm</span>
                                                <span>Boiling</span>
                                            </div>
                                        </div>

                                        <div>
                                            <div className="flex justify-between mb-2">
                                                <label className="text-gray-700 dark:text-gray-300 font-medium">
                                                    Dunk Time <span className="kbd">+/-</span>
                                                </label>
                                                <span className="text-gray-800 dark:text-white font-bold">
                                                    {dunkTime.toFixed(1)}s
                                                </span>
                                            </div>
                                            <input
                                                type="range"
                                                min="0"
                                                max="10"
                                                step="0.1"
                                                value={dunkTime}
                                                onChange={(e) => setDunkTime(Number(e.target.value))}
                                                className="slider"
                                            />
                                            <div className="flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1">
                                                <span>Quick Dip</span>
                                                <span>Extended Soak</span>
                                            </div>
                                        </div>

                                        <div>
                                            <div className="flex justify-between mb-2">
                                                <label className="text-gray-700 dark:text-gray-300 font-medium">
                                                    Biscuit Type <span className="kbd">B</span>
                                                </label>
                                                <span className="text-gray-800 dark:text-white font-bold">
                                                    {BISCUIT_TYPES[biscuitType].name}
                                                </span>
                                            </div>
                                            <div className="grid grid-cols-3 md:grid-cols-6 gap-2">
                                                {BISCUIT_TYPES.map((biscuit, idx) => (
                                                    <button
                                                        key={idx}
                                                        onClick={() => setBiscuitType(idx)}
                                                        onMouseEnter={() => setShowTooltip({ type: 'biscuit', idx })}
                                                        onMouseLeave={() => setShowTooltip(null)}
                                                        className={`p-3 rounded-lg transition-all relative ${
                                                            biscuitType === idx
                                                                ? 'bg-purple-500 dark:bg-purple-600 scale-110 shadow-lg'
                                                                : 'bg-gray-200 dark:bg-gray-700 hover:scale-105'
                                                        }`}
                                                    >
                                                        <div className="text-2xl">{biscuit.emoji}</div>
                                                        {showTooltip?.type === 'biscuit' && showTooltip?.idx === idx && (
                                                            <div className="tooltip" style={{ bottom: '100%', left: '50%', transform: 'translateX(-50%)', marginBottom: '8px' }}>
                                                                {biscuit.name}<br />
                                                                Strength: {biscuit.baseIntegrity}
                                                            </div>
                                                        )}
                                                    </button>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div className="glass-card rounded-2xl p-6">
                                    <h2 className="text-2xl font-semibold mb-4 text-gray-800 dark:text-white">
                                        üìä Crumble-O-Meter History
                                    </h2>
                                    <div className="bg-white dark:bg-gray-800 rounded-lg p-4" style={{ height: '240px' }}>
                                        <svg width="100%" height="100%" viewBox="0 0 400 200" preserveAspectRatio="none">
                                            <defs>
                                                <linearGradient id="graphGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                                    <stop offset="0%" stopColor="rgba(102, 126, 234, 0.3)" />
                                                    <stop offset="100%" stopColor="rgba(102, 126, 234, 0.05)" />
                                                </linearGradient>
                                            </defs>

                                            <line x1="0" y1="200" x2="400" y2="200" stroke="currentColor" strokeWidth="1" className="text-gray-300 dark:text-gray-600" />
                                            <line x1="0" y1="150" x2="400" y2="150" stroke="currentColor" strokeWidth="1" strokeDasharray="5,5" className="text-gray-200 dark:text-gray-700" />
                                            <line x1="0" y1="100" x2="400" y2="100" stroke="currentColor" strokeWidth="1" strokeDasharray="5,5" className="text-gray-200 dark:text-gray-700" />
                                            <line x1="0" y1="50" x2="400" y2="50" stroke="currentColor" strokeWidth="1" strokeDasharray="5,5" className="text-gray-200 dark:text-gray-700" />
                                            <line x1="0" y1="0" x2="400" y2="0" stroke="currentColor" strokeWidth="1" className="text-gray-300 dark:text-gray-600" />

                                            {historyData.length > 1 && (
                                                <>
                                                    <path
                                                        d={`M ${historyData.map((d, i) =>
                                                            `${(i / 19) * 400},${200 - (d.integrity / 100) * 200}`
                                                        ).join(' L ')} L ${((historyData.length - 1) / 19) * 400},200 L 0,200 Z`}
                                                        fill="url(#graphGradient)"
                                                    />
                                                    <polyline
                                                        points={historyData.map((d, i) =>
                                                            `${(i / 19) * 400},${200 - (d.integrity / 100) * 200}`
                                                        ).join(' ')}
                                                        className="graph-line"
                                                    />
                                                    {historyData.map((d, i) => (
                                                        <circle
                                                            key={i}
                                                            cx={(i / 19) * 400}
                                                            cy={200 - (d.integrity / 100) * 200}
                                                            r="3"
                                                            fill="#667eea"
                                                        />
                                                    ))}
                                                </>
                                            )}
                                        </svg>
                                    </div>
                                    <div className="flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-2">
                                        <span>Time ‚Üí</span>
                                        <span>‚Üë Integrity</span>
                                    </div>
                                </div>
                            </div>

                            <div className="space-y-6">
                                <div className="glass-card rounded-2xl p-6 relative">
                                    <h2 className="text-2xl font-semibold mb-4 text-gray-800 dark:text-white text-center">
                                        ‚òï Dunk Visualization
                                    </h2>

                                    <div className="relative" style={{ height: '300px' }}>
                                        <div className="teacup">
                                            <div className="steam">
                                                <div className="steam-particle"></div>
                                                <div className="steam-particle"></div>
                                                <div className="steam-particle"></div>
                                            </div>
                                            <div className="cup-body">
                                                <div className="tea-liquid"></div>
                                            </div>
                                            <div className="cup-handle"></div>

                                            <div className="biscuit-dunk" style={{ top: `${40 + biscuitDunkDepth}px` }}>
                                                <div className="biscuit-rect">
                                                    <div className="biscuit-texture" style={{ top: '20%', left: '30%' }}></div>
                                                    <div className="biscuit-texture" style={{ top: '40%', left: '60%' }}></div>
                                                    <div className="biscuit-texture" style={{ top: '60%', left: '40%' }}></div>
                                                    <div className="biscuit-texture" style={{ top: '70%', left: '70%' }}></div>
                                                </div>
                                            </div>
                                        </div>

                                        {crumbs.map(crumb => (
                                            <div
                                                key={crumb.id}
                                                className="crumb"
                                                style={{
                                                    left: `${crumb.left}%`,
                                                    top: '120px',
                                                    animationDelay: `${crumb.animationDelay}s`
                                                }}
                                            />
                                        ))}
                                    </div>

                                    <div className="text-center mt-4">
                                        <div className="biscuit-icon">
                                            {BISCUIT_TYPES[biscuitType].emoji}
                                        </div>
                                    </div>
                                </div>

                                <div className="glass-card rounded-2xl p-6">
                                    <h2 className="text-2xl font-semibold mb-4 text-gray-800 dark:text-white text-center">
                                        üí™ Structural Integrity
                                    </h2>

                                    <div className="flex justify-center items-end mb-4 crumble-meter">
                                        <div
                                            className="meter-bar"
                                            style={{
                                                height: `${structuralIntegrity * 2}px`,
                                                background: structuralIntegrity > 60
                                                    ? 'linear-gradient(to top, #10b981, #34d399)'
                                                    : structuralIntegrity > 30
                                                    ? 'linear-gradient(to top, #fbbf24, #fcd34d)'
                                                    : 'linear-gradient(to top, #ef4444, #f87171)'
                                            }}
                                        ></div>
                                    </div>

                                    <div className="text-center">
                                        <div className={`text-5xl font-bold mb-2 ${structuralIntegrity < 30 ? 'warning-pulse' : ''}`}>
                                            <span className={getStatusColor()}>
                                                {Math.round(structuralIntegrity)}%
                                            </span>
                                        </div>
                                        <div className={`text-xl font-semibold ${getStatusColor()}`}>
                                            {getStatusMessage()}
                                        </div>
                                        <div className="mt-4 text-sm text-gray-600 dark:text-gray-400">
                                            Crumble Factor: {Math.round(crumbleFactor)}%
                                        </div>
                                    </div>
                                </div>

                                <div className="glass-card rounded-2xl p-4">
                                    <h3 className="text-sm font-semibold mb-2 text-gray-700 dark:text-gray-300">
                                        ‚å®Ô∏è Keyboard Shortcuts
                                    </h3>
                                    <div className="text-xs text-gray-600 dark:text-gray-400 space-y-1">
                                        <div><span className="kbd">D</span> Dark Mode</div>
                                        <div><span className="kbd">T/R</span> Temp ¬±5¬∞</div>
                                        <div><span className="kbd">+/-</span> Time ¬±0.5s</div>
                                        <div><span className="kbd">B</span> Next Biscuit</div>
                                        <div><span className="kbd">S</span> Reset</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <footer className="text-center text-gray-600 dark:text-gray-400 text-sm">
                            <p>ü´ñ Perfect dunking requires patience, precision, and a good biscuit! üç™</p>
                        </footer>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
