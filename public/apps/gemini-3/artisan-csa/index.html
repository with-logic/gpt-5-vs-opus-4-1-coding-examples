<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Artisan CSA | Hand-Grown Harvest</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand+SC&family=Lora:ital,wght@0,400;0,500;0,600;1,400&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Tailwind Config for Custom Colors/Fonts -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        paper: '#f9f7f2',
                        ink: '#2c2c2c',
                        earth: {
                            100: '#e8e4d9',
                            200: '#d3cec0',
                            300: '#b0a990',
                            400: '#8c8468',
                            500: '#6b6348',
                        },
                        rust: '#c06c55',
                        sage: '#8fa084',
                        slate: '#748b97',
                        mustard: '#dcb858'
                    },
                    fontFamily: {
                        hand: ['"Patrick Hand SC"', 'cursive'],
                        serif: ['"Lora"', 'serif'],
                    },
                    backgroundImage: {
                        'watercolor-splash': "radial-gradient(circle at center, var(--tw-gradient-stops))",
                    }
                }
            }
        }
    </script>

    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üçÇ</text></svg>">

    <style>
        /* Global Styles & Textures */
        body {
            background-color: #f9f7f2;
            color: #2c2c2c;
            /* SVG Noise for Paper Texture */
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.08'/%3E%3C/svg%3E");
            overflow-x: hidden;
        }

        /* Hand-drawn Border Utility */
        .sketchy-border {
            border: 2px solid #2c2c2c;
            border-radius: 255px 15px 225px 15px / 15px 225px 15px 255px;
            transition: all 0.3s ease;
        }
        .sketchy-border:hover {
            border-radius: 15px 225px 15px 255px / 255px 15px 225px 15px;
        }

        /* Ink Effect for SVGs */
        .ink-stroke {
            stroke: #2c2c2c;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
        }
        
        .watercolor-fill {
            mix-blend-mode: multiply;
            filter: blur(0.5px);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track {
            background: #f1efe9; 
        }
        ::-webkit-scrollbar-thumb {
            background: #b0a990; 
            border-radius: 5px;
        }

        /* Parallax Animation */
        @keyframes float {
            0% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(1deg); }
            100% { transform: translateY(0px) rotate(0deg); }
        }
        .float-anim {
            animation: float 6s ease-in-out infinite;
        }
        
        /* Checkbox Toggle */
        .toggle-checkbox:checked {
            right: 0;
            border-color: #8fa084;
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #8fa084;
        }

        /* Accordion Transition */
        .accordion-content {
            transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            max-height: 0;
            overflow: hidden;
        }
        .accordion-content.open {
            max-height: 500px; /* Arbitrary large height */
        }
    </style>
</head>
<body class="font-serif antialiased selection:bg-sage selection:text-white">

    <div id="root"></div>

    <script type="text/babel">
        // --- Hooks ---
        const { useState, useEffect, useRef } = React;
        
        const useScrollReveal = (threshold = 0.1) => {
            const [isVisible, setIsVisible] = useState(false);
            const ref = useRef(null);
        
            useEffect(() => {
                const observer = new IntersectionObserver(
                    ([entry]) => {
                        if (entry.isIntersecting) {
                            setIsVisible(true);
                            observer.disconnect();
                        }
                    },
                    { threshold }
                );
        
                if (ref.current) {
                    observer.observe(ref.current);
                }
        
                return () => observer.disconnect();
            }, [threshold]);
        
            return [ref, isVisible];
        };

        const useParallax = (speed = 0.1) => {
            const [offset, setOffset] = useState(0);

            useEffect(() => {
                const handleScroll = () => {
                    setOffset(window.pageYOffset * speed);
                };

                window.addEventListener('scroll', handleScroll);
                return () => window.removeEventListener('scroll', handleScroll);
            }, [speed]);

            return offset;
        };

        const RevealSection = ({ children, className = "" }) => {
            const [ref, isVisible] = useScrollReveal();
            
            return (
                <div 
                    ref={ref} 
                    className={`transition-all duration-1000 transform ${isVisible ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10'} ${className}`}
                >
                    {children}
                </div>
            );
        };

        // --- SVGs as Components for cleanliness ---

        const IconLeaf = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M12 2C7 2 3 7 3 12C3 17 7 22 12 22C17 22 21 17 21 12C21 7 17 2 12 2Z" className="ink-stroke" style={{strokeWidth:1.5}} opacity="0.1"/>
                <path d="M12 21C8 18 4 14 4 9C4 5 7 2 12 2C17 2 20 5 20 9C20 14 16 18 12 21Z" className="ink-stroke" />
                <path d="M12 21V9" className="ink-stroke" />
                <path d="M12 9L9 6" className="ink-stroke" />
                <path d="M12 9L15 6" className="ink-stroke" />
            </svg>
        );

        const IconCarrot = ({ className }) => (
            <svg className={className} viewBox="0 0 100 100">
                <path d="M30 10 Q 50 0, 70 10 L 60 90 Q 50 100, 40 90 Z" fill="#e88c30" className="watercolor-fill" opacity="0.8"/>
                <path d="M30 10 Q 50 0, 70 10 L 60 90 Q 50 100, 40 90 Z" className="ink-stroke" />
                <path d="M35 10 L 25 0 M 50 5 L 50 -10 M 65 10 L 75 0" className="ink-stroke" stroke="#4a6741"/>
                <path d="M40 30 L 60 30 M 45 50 L 55 50 M 48 70 L 52 70" className="ink-stroke" opacity="0.5"/>
            </svg>
        );

        const IconTomato = ({ className }) => (
            <svg className={className} viewBox="0 0 100 100">
                <circle cx="50" cy="55" r="35" fill="#c04e4e" className="watercolor-fill" opacity="0.8"/>
                <circle cx="50" cy="55" r="35" className="ink-stroke" />
                <path d="M50 20 L 40 30 L 50 55 L 60 30 Z" fill="#4a6741" className="ink-stroke" stroke="#4a6741"/>
            </svg>
        );

        const IconBasket = ({ className }) => (
            <svg className={className} viewBox="0 0 200 160">
                {/* Back handle */}
                <path d="M50 60 C 50 0, 150 0, 150 60" className="ink-stroke" fill="none" />
                {/* Basket body */}
                <path d="M20 60 L 180 60 L 160 140 L 40 140 Z" fill="#b08d55" className="watercolor-fill" opacity="0.6"/>
                <path d="M20 60 L 180 60 L 160 140 L 40 140 Z" className="ink-stroke" />
                {/* Weave texture */}
                <path d="M30 80 L 170 80 M 35 100 L 165 100 M 40 120 L 160 120" className="ink-stroke" opacity="0.3"/>
            </svg>
        );

        const DoodleSun = ({ className }) => (
            <svg className={className} viewBox="0 0 100 100">
                 <circle cx="50" cy="50" r="20" fill="#dcb858" className="watercolor-fill" opacity="0.5"/>
                 <circle cx="50" cy="50" r="20" className="ink-stroke"/>
                 <g className="ink-stroke">
                    <line x1="50" y1="20" x2="50" y2="10" />
                    <line x1="50" y1="80" x2="50" y2="90" />
                    <line x1="20" y1="50" x2="10" y2="50" />
                    <line x1="80" y1="50" x2="90" y2="50" />
                    <line x1="28" y1="28" x2="21" y2="21" />
                    <line x1="72" y1="72" x2="79" y2="79" />
                    <line x1="28" y1="72" x2="21" y2="79" />
                    <line x1="72" y1="28" x2="79" y2="21" />
                 </g>
            </svg>
        );




        // --- Sub-Components ---

        const ZipChecker = () => {
            const [zip, setZip] = useState('');
            const [status, setStatus] = useState(null); // 'checking', 'success', 'fail', null

            const checkZip = (e) => {
                e.preventDefault();
                setStatus('checking');
                setTimeout(() => {
                    // Mock logic: ZIPs starting with 1, 9, or 0 are valid for this farm
                    const valid = /^[190]/.test(zip) && zip.length === 5;
                    setStatus(valid ? 'success' : 'fail');
                }, 800);
            };

            return (
                <div className="relative mt-8 max-w-sm mx-auto md:mx-0">
                    <form onSubmit={checkZip} className="relative z-10 flex items-center">
                        <input 
                            type="text" 
                            maxLength="5"
                            placeholder="Enter ZIP Code"
                            className="w-full bg-white/80 backdrop-blur-sm border-2 border-ink rounded-full py-3 px-6 text-lg font-serif focus:outline-none focus:ring-2 focus:ring-sage focus:border-transparent shadow-lg placeholder:text-gray-400"
                            value={zip}
                            onChange={(e) => {
                                setZip(e.target.value.replace(/\D/g,''));
                                setStatus(null);
                            }}
                        />
                        <button 
                            type="submit"
                            className="absolute right-1 top-1 bottom-1 bg-ink text-white rounded-full px-6 font-hand text-xl hover:bg-sage transition-colors"
                        >
                            Check
                        </button>
                    </form>
                    
                    {/* Feedback Message */}
                    {status === 'success' && (
                        <div className="absolute top-full mt-4 w-full text-center animate-fade-in z-20">
                            <div className="bg-sage/20 text-green-900 px-4 py-2 rounded-lg font-bold border border-sage mb-2">
                                üå± We deliver to you!
                            </div>
                            <a 
                                href="#plans"
                                className="block w-full bg-rust text-white font-hand text-2xl py-2 rounded-lg shadow-lg hover:bg-earth-500 hover:scale-105 transition-all"
                            >
                                Join the Harvest
                            </a>
                        </div>
                    )}
                    {status === 'fail' && (
                        <div className="absolute top-full mt-2 w-full text-center bg-rust/20 text-rust px-4 py-2 rounded-lg font-bold animate-fade-in border border-rust">
                            üçÇ Sorry, we're not there yet.
                        </div>
                    )}
                </div>
            );
        };

        const IconWheat = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor">
                 <path d="M12 20V4" className="ink-stroke" strokeWidth="1.5" />
                 <path d="M12 10L16 6" className="ink-stroke" strokeWidth="1.5" />
                 <path d="M12 14L8 10" className="ink-stroke" strokeWidth="1.5" />
                 <path d="M12 8L9 5" className="ink-stroke" strokeWidth="1.5" />
                 <circle cx="12" cy="12" r="10" className="ink-stroke" stroke="#c06c55" strokeWidth="2" opacity="0.3" />
                 <line x1="4" y1="20" x2="20" y2="4" stroke="#c06c55" strokeWidth="2" />
            </svg>
        );

        const IconDairy = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M7 6H17V16C17 19 14 20 12 20C10 20 7 19 7 16V6Z" className="ink-stroke" strokeWidth="1.5" />
                <path d="M7 6L5 3" className="ink-stroke" />
                <path d="M17 6L19 3" className="ink-stroke" />
                <circle cx="12" cy="12" r="10" className="ink-stroke" stroke="#c06c55" strokeWidth="2" opacity="0.3" />
                <line x1="4" y1="20" x2="20" y2="4" stroke="#c06c55" strokeWidth="2" />
            </svg>
        );

        const IconSprout = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M12 22V8" className="ink-stroke" strokeWidth="1.5"/>
                <path d="M12 18L10 22M12 18L14 22" className="ink-stroke"/>
                <path d="M12 8C12 8 6 6 6 12C6 15 12 16 12 16" className="ink-stroke" fill="rgba(143, 160, 132, 0.2)"/>
                <path d="M12 8C12 8 18 6 18 12C18 15 12 16 12 16" className="ink-stroke" fill="rgba(143, 160, 132, 0.2)"/>
            </svg>
        );

        const IconSnowflake = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M12 2V22" className="ink-stroke" strokeWidth="1"/>
                <path d="M2 12H22" className="ink-stroke" strokeWidth="1"/>
                <path d="M5 5L19 19" className="ink-stroke" strokeWidth="1"/>
                <path d="M19 5L5 19" className="ink-stroke" strokeWidth="1"/>
                <circle cx="12" cy="12" r="3" className="ink-stroke" fill="rgba(116, 139, 151, 0.2)"/>
            </svg>
        );

        const SeasonCard = ({ season, produce, color, Icon }) => {
            return (
                <div 
                    className="group relative p-6 bg-white/60 backdrop-blur-sm sketchy-border hover:bg-white focus-within:bg-white transition-all duration-300 focus:outline-none" 
                    tabIndex="0"
                >
                    <h3 className={`text-3xl font-hand text-center mb-4 ${color}`}>{season}</h3>
                    <div className="h-32 flex items-center justify-center opacity-80 group-hover:opacity-100 group-focus:opacity-100 transition-opacity">
                         <div className={`w-20 h-20 rounded-full ${color.replace('text-', 'bg-')}/20 flex items-center justify-center`}>
                             <Icon className={`w-12 h-12 ${color}`} />
                         </div>
                    </div>
                    
                    {/* Tooltip-like overlay for content */}
                    <ul className="text-center space-y-2 mt-4 text-ink/80 font-medium">
                        {produce.slice(0, 3).map((p, i) => <li key={i}>{p}</li>)}
                    </ul>

                    {/* Full list hover/focus tooltip */}
                    <div className="absolute inset-0 bg-paper/95 flex flex-col items-center justify-center opacity-0 group-hover:opacity-100 group-focus:opacity-100 transition-opacity p-4 text-center z-20 pointer-events-none group-hover:pointer-events-auto group-focus:pointer-events-auto rounded-[inherit]">
                        <h4 className="font-hand text-2xl mb-2 text-ink underline decoration-wavy decoration-sage">In the Box</h4>
                        <div className="flex flex-wrap justify-center gap-2">
                            {produce.map((p, i) => (
                                <span key={i} className="text-sm bg-earth-200 px-2 py-1 rounded-md">{p}</span>
                            ))}
                        </div>
                        <div className="mt-6 flex gap-4 text-xs text-ink/70 font-bold uppercase tracking-wider justify-center">
                            <div className="flex flex-col items-center gap-1" title="Dairy Free">
                                <IconDairy className="w-6 h-6 text-rust" />
                                <span>No Dairy</span>
                            </div>
                            <div className="flex flex-col items-center gap-1" title="Gluten Free">
                                <IconWheat className="w-6 h-6 text-rust" />
                                <span>No Gluten</span>
                            </div>
                        </div>
                    </div>
                </div>
            )
        }

        const PricingConfigurator = ({ onSubscribe }) => {
            const [frequency, setFrequency] = useState(1); // 0 = Bi-weekly, 1 = Weekly
            const [addons, setAddons] = useState({
                eggs: false,
                flowers: false,
                bread: false,
                cheese: false
            });
            const [isSubmitting, setIsSubmitting] = useState(false);

            const basePrice = 35;
            const addonPrices = { eggs: 6, flowers: 18, bread: 9, cheese: 12 };
            
            const calculateTotal = () => {
                let weeklyTotal = basePrice;
                if (addons.eggs) weeklyTotal += addonPrices.eggs;
                if (addons.flowers) weeklyTotal += addonPrices.flowers;
                if (addons.bread) weeklyTotal += addonPrices.bread;
                if (addons.cheese) weeklyTotal += addonPrices.cheese;
                
                // Weekly = 4 boxes/mo, Bi-weekly = 2 boxes/mo
                const boxesPerMonth = frequency === 1 ? 4 : 2;
                return weeklyTotal * boxesPerMonth;
            };

            const handleSubscribe = () => {
                setIsSubmitting(true);
                setTimeout(() => {
                    setIsSubmitting(false);
                    onSubscribe();
                }, 1500);
            };

            return (
                <div className="max-w-4xl mx-auto bg-white sketchy-border p-8 md:p-12 shadow-xl relative overflow-hidden">
                    {/* Background decoration */}
                    <div className="absolute -top-10 -right-10 w-40 h-40 bg-mustard/10 rounded-full blur-3xl"></div>
                    <div className="absolute -bottom-10 -left-10 w-40 h-40 bg-sage/10 rounded-full blur-3xl"></div>

                    <div className="grid md:grid-cols-2 gap-12 relative z-10">
                        {/* Left: Controls */}
                        <div className="space-y-8">
                            <div>
                                <h3 className="text-2xl font-hand mb-4 flex items-center gap-2">
                                    <span>üìÖ</span> Frequency
                                </h3>
                                <div className="flex items-center justify-between bg-earth-100 rounded-full p-1 border border-ink/10 relative">
                                    <div 
                                        className={`absolute left-0 top-0 bottom-0 w-1/2 bg-white rounded-full shadow-md border border-ink/20 transition-all duration-300 transform ${frequency === 1 ? 'translate-x-full' : 'translate-x-0'}`}
                                    ></div>
                                    <button 
                                        className={`relative z-10 w-1/2 py-2 text-center font-bold transition-colors ${frequency === 0 ? 'text-ink' : 'text-ink/50'}`}
                                        onClick={() => setFrequency(0)}
                                    >
                                        Bi-Weekly
                                    </button>
                                    <button 
                                        className={`relative z-10 w-1/2 py-2 text-center font-bold transition-colors ${frequency === 1 ? 'text-ink' : 'text-ink/50'}`}
                                        onClick={() => setFrequency(1)}
                                    >
                                        Weekly
                                    </button>
                                </div>
                                <p className="text-sm text-center mt-2 text-ink/60 italic">
                                    {frequency === 1 ? '4 deliveries per month' : '2 deliveries per month'}
                                </p>
                            </div>

                            <div>
                                <h3 className="text-2xl font-hand mb-4 flex items-center gap-2">
                                    <span>üçØ</span> Farm Add-ons
                                </h3>
                                <div className="space-y-3">
                                    {Object.keys(addonPrices).map(key => (
                                        <label key={key} className="flex items-center justify-between group cursor-pointer hover:bg-earth-100/50 p-2 rounded-lg transition-colors">
                                            <div className="flex items-center gap-3">
                                                <div className={`w-5 h-5 border-2 border-ink rounded flex items-center justify-center transition-colors ${addons[key] ? 'bg-sage border-sage' : 'bg-transparent'}`}>
                                                    {addons[key] && <span className="text-white text-xs">‚úì</span>}
                                                </div>
                                                <span className="capitalize text-lg">{key}</span>
                                            </div>
                                            <span className="font-hand text-lg text-rust">+${addonPrices[key]}</span>
                                            <input 
                                                type="checkbox" 
                                                className="hidden"
                                                checked={addons[key]}
                                                onChange={() => setAddons({...addons, [key]: !addons[key]})}
                                            />
                                        </label>
                                    ))}
                                </div>
                            </div>
                        </div>

                        {/* Right: Summary */}
                        <div className="flex flex-col justify-center items-center border-l-2 border-dashed border-ink/20 pl-0 md:pl-12 mt-8 md:mt-0">
                            <h3 className="text-2xl font-serif text-ink/60 mb-2">Estimated Monthly Total</h3>
                            <div className="text-7xl font-hand text-ink mb-2 relative">
                                <span className="text-3xl absolute top-2 -left-6">$</span>
                                <AnimatedCounter value={calculateTotal()} />
                            </div>
                            <p className="text-center text-ink/70 mb-8 max-w-xs">
                                Includes free delivery to your doorstep or local pickup point.
                            </p>
                            <button 
                                onClick={handleSubscribe}
                                disabled={isSubmitting}
                                className={`bg-ink text-white font-hand text-2xl px-12 py-3 rounded-md hover:bg-rust transform hover:-translate-y-1 transition-all shadow-lg hover:shadow-xl w-full md:w-auto flex items-center justify-center ${isSubmitting ? 'opacity-80 cursor-wait' : ''}`}
                            >
                                {isSubmitting ? (
                                    <span className="flex items-center gap-2">
                                        <svg className="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                            <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                                            <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                        </svg>
                                        Processing...
                                    </span>
                                ) : "Subscribe Now"}
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const MapSection = () => {
            const [activeId, setActiveId] = useState(null);
            
            const locations = [
                 {id: 1, x: '30%', y: '40%', name: 'Downtown Market', dist: '5mi', detail: 'Sat 9am-1pm'},
                 {id: 2, x: '70%', y: '60%', name: 'Community Center', dist: '8mi', detail: 'Wed 4pm-7pm'},
                 {id: 3, x: '60%', y: '30%', name: 'The Co-op', dist: '12mi', detail: 'Daily 10am-8pm'}
            ];

            return (
                <div className="grid lg:grid-cols-3 gap-0 border-t-2 border-b-2 border-ink sketchy-border rounded-none my-12 overflow-hidden shadow-xl">
                    {/* Map Area */}
                    <div className="lg:col-span-2 relative h-[500px] bg-[#e6e2d3] overflow-hidden border-b-2 lg:border-b-0 lg:border-r-2 border-ink">
                        {/* Abstract Map Background */}
                         <svg className="absolute inset-0 w-full h-full opacity-30" preserveAspectRatio="none">
                            <path d="M-10,100 Q150,50 300,150 T600,100 T900,200 T1200,50 V500 H-10 Z" fill="#d4cebc" />
                            <path d="M-10,300 Q200,250 400,350 T800,300 T1200,400 V500 H-10 Z" fill="#c4bea8" />
                            {/* River */}
                            <path d="M500,0 Q550,200 450,500" stroke="#a4b8c4" strokeWidth="15" fill="none" />
                         </svg>
                         
                         {/* Delivery Radius */}
                         <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[300px] h-[300px] md:w-[400px] md:h-[400px] bg-sage/20 rounded-full border-2 border-dashed border-sage flex items-center justify-center animate-pulse pointer-events-none">
                            <div className="bg-sage text-white font-hand px-3 py-1 rounded text-sm absolute -top-3">Delivery Zone</div>
                         </div>

                         {/* Farm Location */}
                         <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-20 flex flex-col items-center">
                             <div className="text-4xl filter drop-shadow-md">üè°</div>
                             <span className="font-bold text-ink bg-white/90 px-3 py-1 rounded mt-1 shadow-sm border border-ink/10">Artisan Farm</span>
                         </div>

                         {/* Pins */}
                         {locations.map((loc) => (
                             <div 
                                key={loc.id} 
                                className="absolute group cursor-pointer transition-all duration-300 z-30" 
                                style={{
                                    left: loc.x, 
                                    top: loc.y, 
                                    transform: activeId === loc.id ? 'scale(1.2) translateY(-5px)' : 'scale(1)'
                                }}
                                onMouseEnter={() => setActiveId(loc.id)}
                                onMouseLeave={() => setActiveId(null)}
                             >
                                 <div className={`w-6 h-6 rounded-full border-2 border-white shadow-md transition-colors ${activeId === loc.id ? 'bg-rust' : 'bg-ink'}`}></div>
                                 {/* Tooltip on map as well */}
                                 <div className={`absolute bottom-full mb-2 left-1/2 transform -translate-x-1/2 bg-white px-3 py-1 rounded shadow-lg text-xs whitespace-nowrap pointer-events-none transition-opacity ${activeId === loc.id ? 'opacity-100' : 'opacity-0'}`}>
                                     {loc.name}
                                 </div>
                             </div>
                         ))}
                    </div>

                    {/* List Area */}
                    <div className="bg-paper p-8 flex flex-col justify-center relative">
                        <div className="absolute top-0 right-0 p-4 opacity-10 pointer-events-none">
                            <IconBasket className="w-32 h-32" />
                        </div>
                        
                        <h3 className="text-3xl font-hand text-ink mb-6 relative z-10">Pickup Locations</h3>
                        <div className="space-y-4 relative z-10">
                            {locations.map((loc) => (
                                <div 
                                    key={loc.id}
                                    onMouseEnter={() => setActiveId(loc.id)}
                                    onMouseLeave={() => setActiveId(null)}
                                    className={`p-4 rounded-lg border-2 transition-all cursor-pointer ${activeId === loc.id ? 'border-sage bg-white shadow-md scale-105' : 'border-transparent hover:bg-white/50'}`}
                                >
                                    <div className="flex justify-between items-center mb-1">
                                        <h4 className="font-bold text-lg font-serif text-ink">{loc.name}</h4>
                                        <span className="bg-earth-200 text-ink text-xs px-2 py-1 rounded-full font-bold uppercase tracking-wide">{loc.dist}</span>
                                    </div>
                                    <div className="flex items-center gap-2 text-ink/60 text-sm">
                                        <span>üïí</span>
                                        <span>{loc.detail}</span>
                                    </div>
                                </div>
                            ))}
                        </div>
                        <div className="mt-8 p-4 bg-sage/10 rounded border border-sage/30 text-center relative z-10">
                            <p className="font-hand text-xl text-sage">Home Delivery?</p>
                            <p className="text-sm opacity-80">Free for orders over $50 within 15 miles of the farm.</p>
                        </div>
                    </div>
                </div>
            )
        }

        const SketchyFace = ({ seed, className }) => {
            // Simple procedural face generation
            return (
                <svg className={className} viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="45" className="ink-stroke" strokeWidth="1.5" fill="none" />
                    {/* Eyes */}
                    <circle cx="35" cy="40" r="3" className="ink-stroke" fill="currentColor"/>
                    <circle cx="65" cy="40" r="3" className="ink-stroke" fill="currentColor"/>
                    {/* Smile/Expression based on seed */}
                    {seed % 2 === 0 ? (
                        <path d="M30 65 Q 50 80, 70 65" className="ink-stroke" strokeWidth="2" fill="none" />
                    ) : (
                         <path d="M30 70 Q 50 85, 70 70" className="ink-stroke" strokeWidth="2" fill="none" />
                    )}
                    {/* Hair strands */}
                    {seed % 3 === 0 ? (
                        <path d="M20 20 Q 50 5, 80 20" className="ink-stroke" fill="none" />
                    ) : (
                         <path d="M30 15 Q 50 30, 70 15" className="ink-stroke" fill="none" />
                    )}
                </svg>
            )
        }

        const Testimonials = () => {
            const reviews = [
                {
                    text: "The tomatoes actually taste like tomatoes. I'd forgotten what that was like! The weekly surprise is the highlight of my cooking.",
                    author: "Sarah J.",
                    role: "Member since 2023",
                    seed: 1
                },
                {
                    text: "Knowing my money goes directly to the family that grew the food makes every bite sweeter. The flower bouquets are stunning too.",
                    author: "Marcus T.",
                    role: "Member since 2021",
                    seed: 2
                },
                {
                    text: "My kids used to hate vegetables. Now they fight over the purple carrots. Simply magic.",
                    author: "Elena R.",
                    role: "Member since 2024",
                    seed: 3
                }
            ];
            
            const [current, setCurrent] = useState(0);

            return (
                <div className="max-w-3xl mx-auto text-center px-4">
                    <h2 className="text-5xl font-hand text-ink mb-12">Farm Family Stories</h2>
                    
                    <div className="relative bg-white p-8 md:p-12 sketchy-border shadow-lg min-h-[300px] flex flex-col justify-center items-center">
                        <div className="w-24 h-24 mb-6 opacity-80">
                            <SketchyFace seed={reviews[current].seed} className="w-full h-full text-ink" />
                        </div>
                        <p className="text-xl md:text-2xl italic font-serif text-ink/80 mb-6 leading-relaxed">
                            "{reviews[current].text}"
                        </p>
                        <div className="font-bold text-sage text-lg">{reviews[current].author}</div>
                        <div className="text-sm text-gray-400 uppercase tracking-widest">{reviews[current].role}</div>
                        
                        {/* Navigation */}
                        <div className="flex gap-4 mt-8">
                            {reviews.map((_, i) => (
                                <button 
                                    key={i}
                                    onClick={() => setCurrent(i)}
                                    className={`w-3 h-3 rounded-full transition-all ${current === i ? 'bg-rust scale-125' : 'bg-gray-300'}`}
                                />
                            ))}
                        </div>
                    </div>
                </div>
            )
        }

        const AccordionItem = ({ question, answer, isOpen, onClick }) => {
            return (
                <div className="border-b border-ink/10 last:border-0">
                    <button 
                        className="w-full text-left py-4 px-2 flex justify-between items-center hover:bg-white/50 transition-colors"
                        onClick={onClick}
                    >
                        <span className="font-serif text-lg font-medium text-ink">{question}</span>
                        <span className={`transform transition-transform duration-300 text-sage text-2xl ${isOpen ? 'rotate-180' : ''}`}>
                            ‚Üì
                        </span>
                    </button>
                    <div className={`accordion-content ${isOpen ? 'open' : ''}`}>
                        <div className="p-4 pt-0 text-ink/70 leading-relaxed">
                            {answer}
                        </div>
                    </div>
                </div>
            );
        };

        const SuccessModal = ({ isOpen, onClose, title, message }) => {
            if (!isOpen) return null;
            return (
                <div className="fixed inset-0 z-[60] flex items-center justify-center p-4">
                    <div className="absolute inset-0 bg-ink/20 backdrop-blur-sm" onClick={onClose}></div>
                    <div className="bg-paper relative z-10 max-w-md w-full p-8 rounded-lg shadow-2xl sketchy-border transform transition-all animate-bounce-in text-center">
                        <div className="text-6xl mb-4">üå±</div>
                        <h3 className="text-3xl font-hand text-ink mb-2">{title}</h3>
                        <p className="text-ink/70 font-serif mb-6">{message}</p>
                        <button 
                            onClick={onClose}
                            className="bg-sage text-white font-hand text-xl px-8 py-2 rounded hover:bg-earth-300 transition-colors shadow-md"
                        >
                            Wonderful!
                        </button>
                    </div>
                </div>
            );
        };

        const Footer = ({ onSend }) => {
            const [isSending, setIsSending] = useState(false);

            const handleSubmit = () => {
                setIsSending(true);
                setTimeout(() => {
                    setIsSending(false);
                    onSend();
                }, 1500);
            };

            return (
                <footer className="bg-ink text-earth-100 py-16 mt-20 relative overflow-hidden">
                    <div className="absolute top-0 left-0 w-full h-2 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iMTAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTAgMTAgQyAxMCAwIDMwIDAgNDAgMTAiIGZpbGw9IiNmM2YxZWEiLz48L3N2Zz4=')]"></div>
                    
                    <div className="container mx-auto px-6 grid md:grid-cols-2 gap-12">
                        <div>
                            <h2 className="text-5xl font-hand mb-6 text-earth-300">Get in Touch</h2>
                            <p className="mb-8 font-serif text-lg opacity-80 max-w-md">
                                Have questions about our farming practices or your subscription? We're usually out in the fields, but we answer emails every evening.
                            </p>
                            <div className="flex gap-4 text-2xl opacity-60">
                                <a href="#" className="hover:text-sage hover:opacity-100 transition">Instagram</a>
                                <a href="#" className="hover:text-sage hover:opacity-100 transition">Facebook</a>
                            </div>
                        </div>
                        
                        <form className="space-y-4" onSubmit={(e) => { e.preventDefault(); handleSubmit(); }}>
                            <input 
                                type="email" 
                                placeholder="Your Email" 
                                className="w-full bg-white/10 border border-white/20 rounded p-3 text-earth-100 placeholder:text-earth-100/30 focus:outline-none focus:border-sage transition"
                            />
                            <textarea 
                                rows="4" 
                                placeholder="How can we help?"
                                className="w-full bg-white/10 border border-white/20 rounded p-3 text-earth-100 placeholder:text-earth-100/30 focus:outline-none focus:border-sage transition"
                            ></textarea>
                            <button 
                                type="submit"
                                disabled={isSending}
                                className={`bg-sage text-white font-hand text-xl px-8 py-2 rounded hover:bg-earth-300 transition-colors w-full md:w-auto flex items-center justify-center ${isSending ? 'opacity-80 cursor-wait' : ''}`}
                            >
                                {isSending ? (
                                    <span className="flex items-center gap-2">
                                        <svg className="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                            <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                                            <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                        </svg>
                                        Sending...
                                    </span>
                                ) : "Send Message"}
                            </button>
                        </form>
                    </div>
                    <div className="text-center mt-16 opacity-30 text-sm font-sans">
                        &copy; 2026 Artisan CSA. Hand-coded with ‚ù§Ô∏è.
                    </div>
                </footer>
            );
        };

        const AnimatedCounter = ({ value }) => {
            const [displayValue, setDisplayValue] = useState(value);
            
            useEffect(() => {
                let start = displayValue;
                const end = value;
                if (start === end) return;
                
                const duration = 500;
                const startTime = performance.now();
                
                const animate = (currentTime) => {
                    const elapsed = currentTime - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    
                    // EaseOutQuart
                    const ease = 1 - Math.pow(1 - progress, 4);
                    
                    const current = Math.floor(start + (end - start) * ease);
                    setDisplayValue(current);
                    
                    if (progress < 1) {
                        requestAnimationFrame(animate);
                    }
                };
                
                requestAnimationFrame(animate);
            }, [value]);
            
            return <span>{displayValue}</span>;
        };

        const ScrollToTop = () => {
            const [visible, setVisible] = useState(false);
            
            useEffect(() => {
                const toggleVisibility = () => {
                    if (window.pageYOffset > 300) {
                        setVisible(true);
                    } else {
                        setVisible(false);
                    }
                };
                
                window.addEventListener('scroll', toggleVisibility);
                return () => window.removeEventListener('scroll', toggleVisibility);
            }, []);
            
            const scrollToTop = () => {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            };
            
            return (
                <button 
                    onClick={scrollToTop}
                    className={`fixed bottom-8 right-8 bg-ink text-white w-12 h-12 rounded-full shadow-lg flex items-center justify-center text-2xl z-40 transition-all duration-500 transform hover:bg-rust ${visible ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10 pointer-events-none'}`}
                    aria-label="Scroll to top"
                >
                    ‚Üë
                </button>
            );
        };

        // --- Main App ---

        const App = () => {
            const [openFaq, setOpenFaq] = useState(0);
            const [mobileMenuOpen, setMobileMenuOpen] = useState(false);
            const [modalState, setModalState] = useState({ isOpen: false, title: '', message: '' });

            const openModal = (title, message) => {
                setModalState({ isOpen: true, title, message });
            };

            const closeModal = () => {
                setModalState({ ...modalState, isOpen: false });
            };

            const faqs = [
                { q: "What happens if I'm on vacation?", a: "You can pause your subscription or donate your box to a local food bank directly from your account dashboard." },
                { q: "Can I choose what goes in my box?", a: "The core box is seasonal and curated by the farmers, but you can swap up to 2 items per week and add unlimited extras." },
                { q: "Where do you deliver?", a: "We currently serve the greater metro area. Use the ZIP checker above to confirm if your home is within our radius." },
                { q: "Is everything organic?", a: "Yes! We are Certified Organic and use regenerative farming practices to ensure soil health for future generations." },
            ];

            const toggleMobileMenu = () => setMobileMenuOpen(!mobileMenuOpen);
            
            // Parallax offsets
            const basketY = useParallax(0.1);
            const carrotY = useParallax(0.25);
            const tomatoY = useParallax(0.15);
            const leafY = useParallax(0.3);

            return (
                <div className="min-h-screen">
                    <SuccessModal 
                        isOpen={modalState.isOpen} 
                        onClose={closeModal} 
                        title={modalState.title} 
                        message={modalState.message} 
                    />

                    {/* Navigation */}
                    <nav className="flex justify-between items-center p-6 md:px-12 max-w-7xl mx-auto relative z-50">
                        <div className="text-3xl font-hand font-bold text-ink tracking-widest border-b-2 border-rust pb-1 transform -rotate-2 inline-block z-50 relative">
                            Artisan CSA
                        </div>
                        
                        {/* Desktop Menu */}
                        <div className="hidden md:flex gap-8 font-serif font-medium text-ink/80">
                            <a href="#harvest" className="hover:text-rust transition">Harvest</a>
                            <a href="#plans" className="hover:text-rust transition">Plans</a>
                            <a href="#farm" className="hover:text-rust transition">The Farm</a>
                        </div>
                        <button className="hidden md:block bg-ink text-white font-hand px-6 py-2 rounded hover:bg-rust transition-colors shadow-md">
                            Member Login
                        </button>

                        {/* Mobile Hamburger */}
                        <button 
                            className="md:hidden z-50 text-ink focus:outline-none"
                            onClick={toggleMobileMenu}
                        >
                            <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                {mobileMenuOpen ? (
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                                ) : (
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6h16M4 12h16M4 18h16" />
                                )}
                            </svg>
                        </button>
                    </nav>

                    {/* Mobile Menu Overlay */}
                    <div className={`fixed inset-0 bg-paper z-40 transform transition-transform duration-300 ease-in-out ${mobileMenuOpen ? 'translate-x-0' : 'translate-x-full'} md:hidden flex flex-col justify-center items-center space-y-8`}>
                        {/* Background Texture for overlay */}
                        <div className="absolute inset-0 opacity-10 pointer-events-none" style={{backgroundImage: `url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='1'/%3E%3C/svg%3E")`}}></div>
                        
                        <a href="#harvest" onClick={toggleMobileMenu} className="text-4xl font-hand text-ink hover:text-rust transition">Harvest</a>
                        <a href="#plans" onClick={toggleMobileMenu} className="text-4xl font-hand text-ink hover:text-rust transition">Plans</a>
                        <a href="#farm" onClick={toggleMobileMenu} className="text-4xl font-hand text-ink hover:text-rust transition">The Farm</a>
                        <button className="bg-ink text-white font-hand text-2xl px-8 py-3 rounded hover:bg-rust transition-colors shadow-md mt-4">
                            Member Login
                        </button>
                    </div>

                    {/* Hero Section */}
                    <header className="container mx-auto px-6 py-12 md:py-20 grid md:grid-cols-2 gap-12 items-center relative overflow-hidden">
                        <DoodleSun className="absolute top-0 right-10 w-24 h-24 animate-spin-slow opacity-60 hidden md:block" />
                        
                        <div className="space-y-6 z-10">
                            <div className="inline-block bg-earth-200 text-ink/80 px-3 py-1 rounded-full text-sm font-bold tracking-wider mb-2">
                                üçÇ FALL SHARES NOW OPEN
                            </div>
                            <h1 className="text-6xl md:text-8xl font-hand text-ink leading-[0.9]">
                                Farm to Table, <br/>
                                <span className="text-rust">Hand to Heart.</span>
                            </h1>
                            <p className="text-xl font-serif text-ink/70 max-w-md leading-relaxed">
                                Experience the taste of truly local food. Weekly baskets of organic heirlooms, delivered from our soil to your doorstep.
                            </p>
                            
                            <ZipChecker />
                        </div>

                        <div className="relative flex justify-center items-center">
                            {/* Illustration Composition */}
                            <div className="relative w-80 h-80 md:w-[500px] md:h-[500px]">
                                <div className="absolute inset-0 bg-sage/10 rounded-full blur-3xl transform translate-y-10"></div>
                                <div style={{ transform: `translateY(${basketY}px)` }} className="transition-transform duration-75 will-change-transform">
                                    <IconBasket className="w-full h-full float-anim drop-shadow-2xl" />
                                </div>
                                
                                {/* Floating Veggies with Parallax */}
                                <div style={{ transform: `translateY(${carrotY}px) rotate(-12deg)` }} className="absolute -top-10 -left-10 w-32 h-32 transition-transform duration-75 will-change-transform">
                                    <IconCarrot className="w-full h-full float-anim" style={{animationDelay: '1s'}} />
                                </div>
                                <div style={{ transform: `translateY(${tomatoY}px) rotate(12deg)` }} className="absolute bottom-10 -right-5 w-24 h-24 transition-transform duration-75 will-change-transform">
                                    <IconTomato className="w-full h-full float-anim" style={{animationDelay: '2s'}} />
                                </div>
                                <div style={{ transform: `translateY(${leafY}px)` }} className="absolute top-1/2 -right-10 w-20 h-20 text-sage transition-transform duration-75 will-change-transform">
                                    <IconLeaf className="w-full h-full float-anim" style={{animationDelay: '1.5s'}} />
                                </div>
                            </div>
                        </div>
                    </header>

                    {/* How it Works / Seasonal Grid */}
                    <RevealSection id="harvest" className="py-20 bg-white/40 backdrop-blur-sm border-t border-dashed border-ink/20">
                        <div className="container mx-auto px-6">
                            <div className="text-center mb-16">
                                <h2 className="text-5xl font-hand text-ink mb-4">What's in Season?</h2>
                                <p className="font-serif text-lg text-ink/60 max-w-2xl mx-auto">
                                    Our crop rotation ensures you get the best flavors each month. Here's a peek at our typical harvest calendar.
                                </p>
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                <SeasonCard 
                                    season="Spring" 
                                    color="text-sage" 
                                    produce={['Asparagus', 'Radishes', 'Peas', 'Spinach', 'Strawberries']} 
                                    Icon={IconSprout}
                                />
                                <SeasonCard 
                                    season="Summer" 
                                    color="text-mustard" 
                                    produce={['Tomatoes', 'Peppers', 'Corn', 'Zucchini', 'Peaches']} 
                                    Icon={DoodleSun}
                                />
                                <SeasonCard 
                                    season="Autumn" 
                                    color="text-rust" 
                                    produce={['Pumpkins', 'Squash', 'Apples', 'Kale', 'Beets']} 
                                    Icon={IconLeaf}
                                />
                                <SeasonCard 
                                    season="Winter" 
                                    color="text-slate" 
                                    produce={['Potatoes', 'Onions', 'Carrots', 'Cabbage', 'Citrus']} 
                                    Icon={IconSnowflake}
                                />
                            </div>
                        </div>
                    </RevealSection>

                    {/* Pricing Section */}
                    <RevealSection id="plans" className="py-20 relative">
                        <div className="container mx-auto px-6">
                            <div className="text-center mb-12">
                                <h2 className="text-5xl font-hand text-ink">Build Your Box</h2>
                            </div>
                            <PricingConfigurator onSubscribe={() => openModal("Welcome to the Family!", "You're one step closer to fresh, local food. Check your inbox to complete your setup.")} />
                        </div>
                    </RevealSection>

                    {/* Map Section */}
                    <RevealSection id="farm">
                        <MapSection />
                    </RevealSection>

                    {/* Testimonials */}
                    <RevealSection className="py-20 bg-earth-100/30">
                        <Testimonials />
                    </RevealSection>

                    {/* FAQ */}
                    <RevealSection className="py-20 max-w-3xl mx-auto px-6">
                        <h2 className="text-4xl font-hand text-center mb-10">Common Questions</h2>
                        <div className="bg-white sketchy-border p-8 shadow-sm">
                            {faqs.map((faq, i) => (
                                <AccordionItem 
                                    key={i} 
                                    question={faq.q} 
                                    answer={faq.a} 
                                    isOpen={openFaq === i}
                                    onClick={() => setOpenFaq(openFaq === i ? -1 : i)}
                                />
                            ))}
                        </div>
                    </RevealSection>

                    <Footer onSend={() => openModal("Message Sent!", "Thanks for reaching out. We'll get back to you as soon as we're out of the fields.")} />
                    
                    <ScrollToTop />
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
