<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Skills Matrix</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            900: '#1e3a8a',
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9; 
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
        }

        .matrix-cell {
            transition: all 0.2s ease;
        }
        .matrix-cell:hover {
            transform: scale(1.05);
            z-index: 10;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 font-sans h-screen overflow-hidden">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- Mock Data ---
        const INITIAL_DEPARTMENTS = ['Engineering', 'Product', 'Design'];

        const INITIAL_EMPLOYEES = [
            { id: 1, name: "Alice Chen", role: "Senior FE Dev", dept: "Engineering", avatar: "AC" },
            { id: 2, name: "Bob Smith", role: "Backend Dev", dept: "Engineering", avatar: "BS" },
            { id: 3, name: "Charlie Davis", role: "Product Mgr", dept: "Product", avatar: "CD" },
            { id: 4, name: "Diana Prince", role: "UX Designer", dept: "Design", avatar: "DP" },
            { id: 5, name: "Evan Wright", role: "Full Stack", dept: "Engineering", avatar: "EW" },
            { id: 6, name: "Fiona Gallagher", role: "QA Engineer", dept: "Engineering", avatar: "FG" },
        ];

        const INITIAL_SKILLS = [
            { 
                category: "Frontend Development", 
                items: [
                    { id: 's1', name: 'React.js' },
                    { id: 's2', name: 'TypeScript' },
                    { id: 's3', name: 'CSS/Tailwind' },
                    { id: 's4', name: 'Next.js' }
                ]
            },
            { 
                category: "Backend Development", 
                items: [
                    { id: 's5', name: 'Node.js' },
                    { id: 's6', name: 'Python' },
                    { id: 's7', name: 'PostgreSQL' },
                    { id: 's8', name: 'Redis' }
                ]
            },
            { 
                category: "Design & Product", 
                items: [
                    { id: 's9', name: 'Figma' },
                    { id: 's10', name: 'User Research' },
                    { id: 's11', name: 'Prototyping' },
                    { id: 's12', name: 'Agile/Scrum' }
                ]
            },
            { 
                category: "DevOps & Cloud", 
                items: [
                    { id: 's13', name: 'AWS' },
                    { id: 's14', name: 'Docker/K8s' },
                    { id: 's15', name: 'CI/CD Pipelines' }
                ]
            }
        ];

        // 0: None, 1: Novice, 2: Intermediate, 3: Advanced, 4: Expert
        const INITIAL_RATINGS = {
            '1_s1': 4, '1_s2': 3, '1_s3': 4, '1_s4': 3, '1_s9': 2,
            '2_s5': 4, '2_s6': 3, '2_s7': 4, '2_s13': 2, '2_s14': 2,
            '3_s12': 4, '3_s10': 3, '3_s9': 1,
            '4_s9': 4, '4_s11': 4, '4_s10': 3, '4_s3': 2,
            '5_s1': 3, '5_s5': 3, '5_s2': 3, '5_s6': 2,
            '6_s15': 2, '6_s12': 3, '6_s2': 1
        };

        const PROFICIENCY_LEVELS = [
            { level: 0, label: "None", color: "bg-slate-50 border-slate-200 text-transparent", desc: "No knowledge" },
            { level: 1, label: "Novice", color: "bg-blue-50 border-blue-200 text-blue-400", desc: "Basic understanding" },
            { level: 2, label: "Intermediate", color: "bg-blue-200 border-blue-300 text-blue-600", desc: "Can work independently" },
            { level: 3, label: "Advanced", color: "bg-blue-400 border-blue-500 text-white", desc: "Strong knowledge, can mentor" },
            { level: 4, label: "Expert", color: "bg-blue-600 border-blue-700 text-white", desc: "Deep expertise, strategic impact" },
        ];

        // --- Icons ---
        const Icon = ({ name, size = 16, className }) => {
            React.useEffect(() => {
                lucide.createIcons();
            }, [name]);
            return <i data-lucide={name} className={className} style={{ width: size, height: size }}></i>;
        };

        // --- Components ---

        const ProficiencyLegend = () => (
            <div className="flex items-center gap-3 text-xs text-slate-600 bg-white px-4 py-2 rounded-lg border border-slate-200 shadow-sm">
                <span className="font-semibold mr-1">Proficiency:</span>
                {PROFICIENCY_LEVELS.slice(1).map((p) => (
                    <div key={p.level} className="flex items-center gap-1.5" title={p.desc}>
                        <div className={`w-3 h-3 rounded-sm ${p.color} border shadow-sm`}></div>
                        <span>{p.label}</span>
                    </div>
                ))}
            </div>
        );

        const EmployeeCard = ({ employee }) => (
            <div className="flex flex-col items-center justify-center py-2 px-1 min-w-[100px] max-w-[100px] h-full">
                <div className="w-8 h-8 rounded-full bg-slate-200 text-slate-600 flex items-center justify-center text-xs font-bold mb-1 shadow-sm border border-white">
                    {employee.avatar}
                </div>
                <div className="text-xs font-medium text-slate-800 text-center truncate w-full px-1">{employee.name}</div>
                <div className="text-[10px] text-slate-500 text-center truncate w-full px-1">{employee.role}</div>
            </div>
        );

        const MatrixCell = ({ level, onClick }) => {
            const config = PROFICIENCY_LEVELS[level] || PROFICIENCY_LEVELS[0];
            return (
                <div 
                    onClick={onClick}
                    className={`
                        matrix-cell w-full h-full border-r border-b border-slate-100 
                        cursor-pointer flex items-center justify-center font-bold text-xs
                        ${config.color}
                        hover:brightness-95
                    `}
                    title={`Click to cycle: ${config.label}`}
                >
                    {level > 0 ? level : ''}
                </div>
            );
        };

        const App = () => {
            const [employees, setEmployees] = useState(INITIAL_EMPLOYEES);
            const [ratings, setRatings] = useState(INITIAL_RATINGS);
            const [searchTerm, setSearchTerm] = useState("");
            const [deptFilter, setDeptFilter] = useState("All");

            // Filter Logic
            const filteredEmployees = useMemo(() => {
                return employees.filter(emp => {
                    const matchesSearch = emp.name.toLowerCase().includes(searchTerm.toLowerCase()) || 
                                          emp.role.toLowerCase().includes(searchTerm.toLowerCase());
                    const matchesDept = deptFilter === "All" || emp.dept === deptFilter;
                    return matchesSearch && matchesDept;
                });
            }, [employees, searchTerm, deptFilter]);

            // Handlers
            const handleCellClick = (empId, skillId) => {
                const key = `${empId}_${skillId}`;
                setRatings(prev => {
                    const current = prev[key] || 0;
                    const next = (current + 1) % 5;
                    // If cycling back to 0, delete the key to keep state clean, else set value
                    if (next === 0) {
                        const { [key]: _, ...rest } = prev;
                        return rest;
                    }
                    return { ...prev, [key]: next };
                });
            };

            // Calculate Stats
            const totalSkills = INITIAL_SKILLS.reduce((acc, cat) => acc + cat.items.length, 0);
            const avgProficiency = useMemo(() => {
                const values = Object.values(ratings);
                if (values.length === 0) return 0;
                return (values.reduce((a, b) => a + b, 0) / values.length).toFixed(1);
            }, [ratings]);

            const coverage = useMemo(() => {
                const tracked = Object.keys(ratings).length;
                const totalPossible = employees.length * totalSkills;
                return Math.round((tracked / totalPossible) * 100);
            }, [ratings, employees.length, totalSkills]);

            return (
                <div className="flex flex-col h-full max-w-full mx-auto bg-white shadow-xl overflow-hidden">
                    {/* Header Section */}
                    <header className="bg-white border-b border-slate-200 px-6 py-4 flex flex-col md:flex-row justify-between items-start md:items-center gap-4 z-20 relative">
                        <div>
                            <div className="flex items-center gap-2">
                                <div className="bg-brand-600 text-white p-1.5 rounded-lg shadow-sm">
                                    <Icon name="layout-grid" size={20} />
                                </div>
                                <h1 className="text-xl font-bold text-slate-800 tracking-tight">Employee Skills Matrix</h1>
                            </div>
                            <p className="text-sm text-slate-500 mt-1">Manage team competencies and identify gaps.</p>
                        </div>

                        <div className="flex gap-6 text-sm">
                            <div className="bg-slate-50 px-3 py-2 rounded border border-slate-100">
                                <span className="block text-slate-500 text-xs uppercase tracking-wider font-semibold">Team Size</span>
                                <span className="font-bold text-slate-800 text-lg">{employees.length}</span>
                            </div>
                            <div className="bg-slate-50 px-3 py-2 rounded border border-slate-100">
                                <span className="block text-slate-500 text-xs uppercase tracking-wider font-semibold">Avg Level</span>
                                <span className="font-bold text-slate-800 text-lg">{avgProficiency}</span>
                            </div>
                            <div className="bg-slate-50 px-3 py-2 rounded border border-slate-100">
                                <span className="block text-slate-500 text-xs uppercase tracking-wider font-semibold">Coverage</span>
                                <span className="font-bold text-slate-800 text-lg">{coverage}%</span>
                            </div>
                        </div>
                    </header>

                    {/* Controls Bar */}
                    <div className="px-6 py-3 bg-slate-50 border-b border-slate-200 flex flex-col md:flex-row gap-4 justify-between items-center z-10">
                        <div className="flex items-center gap-4 w-full md:w-auto">
                            <div className="relative group">
                                <Icon name="search" size={16} className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 group-hover:text-brand-500 transition-colors" />
                                <input 
                                    type="text" 
                                    placeholder="Search employees..." 
                                    className="pl-9 pr-4 py-2 rounded-lg border border-slate-300 text-sm focus:outline-none focus:ring-2 focus:ring-brand-500 focus:border-brand-500 w-full md:w-64 shadow-sm"
                                    value={searchTerm}
                                    onChange={(e) => setSearchTerm(e.target.value)}
                                />
                            </div>

                            <select 
                                className="px-3 py-2 rounded-lg border border-slate-300 text-sm focus:outline-none focus:ring-2 focus:ring-brand-500 bg-white shadow-sm cursor-pointer hover:border-brand-400 transition-colors"
                                value={deptFilter}
                                onChange={(e) => setDeptFilter(e.target.value)}
                            >
                                <option value="All">All Departments</option>
                                {INITIAL_DEPARTMENTS.map(d => <option key={d} value={d}>{d}</option>)}
                            </select>
                        </div>
                        
                        <ProficiencyLegend />
                    </div>

                    {/* Matrix Grid Container */}
                    <div className="flex-1 overflow-auto relative bg-white">
                        <div className="inline-block min-w-full align-middle">
                            <table className="min-w-full border-collapse">
                                {/* Table Header (Sticky) */}
                                <thead className="bg-white sticky top-0 z-30 shadow-sm">
                                    <tr>
                                        {/* Corner Cell */}
                                        <th className="sticky left-0 z-40 bg-white border-b border-r border-slate-200 min-w-[250px] p-4 text-left shadow-[4px_0_8px_-4px_rgba(0,0,0,0.05)]">
                                            <div className="text-xs font-semibold uppercase tracking-wider text-slate-400">Skills / Employees</div>
                                        </th>
                                        
                                        {/* Employee Columns */}
                                        {filteredEmployees.map(emp => (
                                            <th key={emp.id} className="p-0 border-b border-slate-200 min-w-[100px] hover:bg-slate-50 transition-colors">
                                                <EmployeeCard employee={emp} />
                                            </th>
                                        ))}
                                    </tr>
                                </thead>

                                {/* Table Body */}
                                <tbody className="bg-white divide-y divide-slate-100">
                                    {INITIAL_SKILLS.map((category) => (
                                        <React.Fragment key={category.category}>
                                            {/* Category Header Row */}
                                            <tr className="bg-slate-50/80">
                                                <td className="sticky left-0 z-20 bg-slate-50 border-r border-slate-200 px-4 py-2 font-semibold text-xs text-slate-600 uppercase tracking-wider shadow-[4px_0_8px_-4px_rgba(0,0,0,0.05)]" colSpan={1}>
                                                    {category.category}
                                                </td>
                                                {/* Empty cells for category row */}
                                                <td colSpan={filteredEmployees.length} className="bg-slate-50/50"></td>
                                            </tr>

                                            {/* Skill Rows */}
                                            {category.items.map(skill => (
                                                <tr key={skill.id} className="group hover:bg-slate-50/50">
                                                    {/* Skill Name (Sticky Left) */}
                                                    <td className="sticky left-0 z-20 bg-white group-hover:bg-slate-50 border-r border-slate-200 px-4 py-3 text-sm font-medium text-slate-700 shadow-[4px_0_8px_-4px_rgba(0,0,0,0.05)] transition-colors">
                                                        <div className="flex items-center justify-between">
                                                            {skill.name}
                                                            {/* Mini Sparkline placeholder (optional visual flourish) */}
                                                            <div className="hidden group-hover:block text-[10px] text-slate-400 font-normal">
                                                                Edit
                                                            </div>
                                                        </div>
                                                    </td>

                                                    {/* Rating Cells */}
                                                    {filteredEmployees.map(emp => {
                                                        const rating = ratings[`${emp.id}_${skill.id}`] || 0;
                                                        return (
                                                            <td key={`${emp.id}_${skill.id}`} className="p-0 w-[100px] h-[48px] border-b border-slate-100">
                                                                <MatrixCell 
                                                                    level={rating} 
                                                                    onClick={() => handleCellClick(emp.id, skill.id)} 
                                                                />
                                                            </td>
                                                        );
                                                    })}
                                                </tr>
                                            ))}
                                        </React.Fragment>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                        
                        {filteredEmployees.length === 0 && (
                            <div className="flex flex-col items-center justify-center h-64 text-slate-400">
                                <Icon name="users" size={48} className="mb-4 opacity-20" />
                                <p className="text-lg font-medium">No employees found</p>
                                <p className="text-sm">Try adjusting your filters.</p>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
