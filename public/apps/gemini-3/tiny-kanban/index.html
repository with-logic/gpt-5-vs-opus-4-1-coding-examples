<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tiny Kanban</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: transparent; 
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
        }
        
        .card-drag-over {
            border: 2px dashed #3b82f6;
            background-color: #eff6ff;
        }
        
        .column-drag-over {
            background-color: #f1f5f9;
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
    </style>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                        secondary: '#64748b',
                        success: '#22c55e',
                        warning: '#eab308',
                        danger: '#ef4444',
                        doing: '#f59e0b',
                        done: '#10b981',
                        todo: '#64748b'
                    }
                }
            }
        }
    </script>
</head>
<body class="text-gray-800 h-screen overflow-hidden flex flex-col">

    <div id="root" class="h-full flex flex-col"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;

        // --- Mock Data ---
        const INITIAL_DATA = [
            { id: 't1', title: 'Design System Update', priority: 'high', assignee: 'Alex', status: 'todo' },
            { id: 't2', title: 'Fix Login Bug', priority: 'critical', assignee: 'Sam', status: 'doing' },
            { id: 't3', title: 'Q3 Analytics Report', priority: 'medium', assignee: 'Jordan', status: 'done' },
            { id: 't4', title: 'Update Dependencies', priority: 'low', assignee: 'Casey', status: 'todo' },
            { id: 't5', title: 'User Interview Notes', priority: 'medium', assignee: 'Alex', status: 'doing' },
            { id: 't6', title: 'Accessibility Audit', priority: 'high', assignee: 'Sam', status: 'todo' },
        ];

        const COLUMNS = [
            { id: 'todo', title: 'To Do', limit: null, color: 'border-l-4 border-gray-400' },
            { id: 'doing', title: 'In Progress', limit: 3, color: 'border-l-4 border-blue-500' },
            { id: 'done', title: 'Done', limit: null, color: 'border-l-4 border-green-500' }
        ];

        const PRIORITIES = {
            critical: { label: 'Critical', color: 'bg-red-100 text-red-800 border-red-200' },
            high: { label: 'High', color: 'bg-orange-100 text-orange-800 border-orange-200' },
            medium: { label: 'Medium', color: 'bg-blue-100 text-blue-800 border-blue-200' },
            low: { label: 'Low', color: 'bg-gray-100 text-gray-800 border-gray-200' }
        };

        const AVATARS = {
            'Alex': 'https://api.dicebear.com/7.x/avataaars/svg?seed=Alex',
            'Sam': 'https://api.dicebear.com/7.x/avataaars/svg?seed=Sam',
            'Jordan': 'https://api.dicebear.com/7.x/avataaars/svg?seed=Jordan',
            'Casey': 'https://api.dicebear.com/7.x/avataaars/svg?seed=Casey',
            'Taylor': 'https://api.dicebear.com/7.x/avataaars/svg?seed=Taylor',
        };

        // --- Components ---

        const PriorityBadge = ({ priority }) => {
            const config = PRIORITIES[priority] || PRIORITIES.low;
            return (
                <span className={`text-xs font-semibold px-2 py-0.5 rounded border ${config.color}`}>
                    {config.label}
                </span>
            );
        };

        const AssigneeAvatar = ({ name }) => {
            const src = AVATARS[name] || `https://api.dicebear.com/7.x/initials/svg?seed=${name}`;
            return (
                <div className="flex items-center gap-1.5" title={`Assigned to ${name}`}>
                    <img src={src} alt={name} className="w-6 h-6 rounded-full bg-gray-200 border border-white shadow-sm" />
                    <span className="text-xs text-gray-500 font-medium hidden sm:inline">{name}</span>
                </div>
            );
        };

        const Card = ({ task, onDelete, onDragStart }) => {
            return (
                <div 
                    className="bg-white p-4 rounded-lg shadow-sm border border-gray-200 cursor-grab active:cursor-grabbing hover:shadow-md transition-all duration-200 group relative"
                    draggable="true"
                    onDragStart={(e) => onDragStart(e, task.id)}
                >
                    <div className="flex justify-between items-start mb-2">
                        <PriorityBadge priority={task.priority} />
                        <button 
                            onClick={() => onDelete(task.id)}
                            className="text-gray-300 hover:text-red-500 transition-colors opacity-0 group-hover:opacity-100"
                            title="Delete Task"
                        >
                            <i className="fas fa-trash-alt"></i>
                        </button>
                    </div>
                    
                    <h3 className="font-medium text-gray-800 mb-3 text-lg leading-snug">{task.title}</h3>
                    
                    <div className="flex justify-between items-center mt-2 border-t border-gray-50 pt-3">
                        <AssigneeAvatar name={task.assignee} />
                        <div className="text-xs text-gray-400 font-mono">#{task.id}</div>
                    </div>
                </div>
            );
        };

        const Column = ({ column, tasks, onDrop, onDragOver, onDeleteTask, onDragStart }) => {
            const isOverLimit = column.limit && tasks.length > column.limit;

            return (
                <div 
                    className={`flex-1 min-w-[320px] bg-gray-100/50 rounded-xl p-4 flex flex-col h-full border border-gray-200 transition-colors duration-200`}
                    onDragOver={(e) => onDragOver(e)}
                    onDrop={(e) => onDrop(e, column.id)}
                >
                    <div className={`flex justify-between items-center mb-4 pb-2 border-b-2 ${column.id === 'todo' ? 'border-gray-300' : column.id === 'doing' ? 'border-blue-400' : 'border-green-400'}`}>
                        <div className="flex items-center gap-2">
                            <h2 className="font-bold text-gray-700 uppercase tracking-wider text-sm">{column.title}</h2>
                            <span className="bg-gray-200 text-gray-600 px-2 py-0.5 rounded-full text-xs font-bold shadow-inner">
                                {tasks.length}
                            </span>
                        </div>
                        {column.limit && (
                            <div className={`text-xs font-semibold px-2 py-1 rounded ${isOverLimit ? 'bg-red-100 text-red-600 animate-pulse' : 'text-gray-400 bg-gray-200'}`}>
                                Max: {column.limit}
                            </div>
                        )}
                    </div>

                    <div className="flex-1 overflow-y-auto space-y-3 px-1 pb-4 custom-scrollbar">
                        {tasks.map(task => (
                            <Card 
                                key={task.id} 
                                task={task} 
                                onDelete={onDeleteTask}
                                onDragStart={onDragStart}
                            />
                        ))}
                        {tasks.length === 0 && (
                            <div className="h-24 border-2 border-dashed border-gray-200 rounded-lg flex items-center justify-center text-gray-400 text-sm italic">
                                Drop tasks here
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const NewTaskModal = ({ isOpen, onClose, onAdd }) => {
            if (!isOpen) return null;

            const [title, setTitle] = useState('');
            const [assignee, setAssignee] = useState('Alex');
            const [priority, setPriority] = useState('medium');

            const handleSubmit = (e) => {
                e.preventDefault();
                if (!title.trim()) return;
                onAdd({ title, assignee, priority });
                setTitle('');
                onClose();
            };

            return (
                <div className="fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50">
                    <div className="bg-white rounded-xl shadow-2xl w-full max-w-md p-6 transform transition-all scale-100">
                        <div className="flex justify-between items-center mb-6">
                            <h2 className="text-xl font-bold text-gray-800">Add New Task</h2>
                            <button onClick={onClose} className="text-gray-400 hover:text-gray-600">
                                <i className="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <form onSubmit={handleSubmit} className="space-y-4">
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">Title</label>
                                <input 
                                    autoFocus
                                    type="text" 
                                    className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"
                                    placeholder="What needs to be done?"
                                    value={title}
                                    onChange={(e) => setTitle(e.target.value)}
                                />
                            </div>
                            
                            <div className="grid grid-cols-2 gap-4">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-1">Assignee</label>
                                    <select 
                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none bg-white"
                                        value={assignee}
                                        onChange={(e) => setAssignee(e.target.value)}
                                    >
                                        {Object.keys(AVATARS).map(name => (
                                            <option key={name} value={name}>{name}</option>
                                        ))}
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-1">Priority</label>
                                    <select 
                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none bg-white"
                                        value={priority}
                                        onChange={(e) => setPriority(e.target.value)}
                                    >
                                        {Object.keys(PRIORITIES).map(p => (
                                            <option key={p} value={p}>{PRIORITIES[p].label}</option>
                                        ))}
                                    </select>
                                </div>
                            </div>

                            <div className="flex justify-end gap-3 mt-6">
                                <button 
                                    type="button" 
                                    onClick={onClose}
                                    className="px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg font-medium transition-colors"
                                >
                                    Cancel
                                </button>
                                <button 
                                    type="submit" 
                                    className="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium shadow-md shadow-blue-200 transition-all transform active:scale-95"
                                >
                                    Create Task
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [tasks, setTasks] = useState(INITIAL_DATA);
            const [searchQuery, setSearchQuery] = useState('');
            const [isModalOpen, setIsModalOpen] = useState(false);
            const [draggedTaskId, setDraggedTaskId] = useState(null);

            // -- DnD Logic --
            const handleDragStart = (e, taskId) => {
                setDraggedTaskId(taskId);
                e.dataTransfer.effectAllowed = "move";
                // Invisible drag image for cleaner look if desired, or default
            };

            const handleDragOver = (e) => {
                e.preventDefault(); // Necessary to allow dropping
            };

            const handleDrop = (e, targetColumnId) => {
                e.preventDefault();
                
                const targetColumn = COLUMNS.find(c => c.id === targetColumnId);
                const currentColumnTasks = tasks.filter(t => t.status === targetColumnId);
                
                // WIP Limit Check
                if (targetColumn.limit && currentColumnTasks.length >= targetColumn.limit && tasks.find(t=>t.id===draggedTaskId).status !== targetColumnId) {
                    alert(`WIP Limit reached for ${targetColumn.title}!`);
                    return;
                }

                if (draggedTaskId) {
                    setTasks(prev => prev.map(t => 
                        t.id === draggedTaskId ? { ...t, status: targetColumnId } : t
                    ));
                    setDraggedTaskId(null);
                }
            };

            // -- Task Logic --
            const handleAddTask = (newTask) => {
                const id = 't' + (Date.now().toString().slice(-5));
                setTasks(prev => [...prev, { ...newTask, id, status: 'todo' }]);
            };

            const handleDeleteTask = (taskId) => {
                if (confirm('Are you sure you want to delete this task?')) {
                    setTasks(prev => prev.filter(t => t.id !== taskId));
                }
            };

            // -- Filter Logic --
            const filteredTasks = tasks.filter(task => 
                task.title.toLowerCase().includes(searchQuery.toLowerCase()) ||
                task.assignee.toLowerCase().includes(searchQuery.toLowerCase())
            );

            return (
                <div className="flex flex-col h-screen bg-gradient-to-br from-slate-100 to-slate-200">
                    {/* Header */}
                    <header className="glass-panel px-6 py-4 flex items-center justify-between z-10 sticky top-0">
                        <div className="flex items-center gap-4">
                            <div className="bg-blue-600 text-white p-2 rounded-lg shadow-lg shadow-blue-300">
                                <i className="fas fa-layer-group text-xl"></i>
                            </div>
                            <div>
                                <h1 className="text-2xl font-bold text-gray-800 tracking-tight">Tiny Kanban</h1>
                                <p className="text-xs text-gray-500 font-medium">Daily Standup Board</p>
                            </div>
                        </div>

                        <div className="flex items-center gap-4">
                            <div className="relative group">
                                <i className="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 group-focus-within:text-blue-500 transition-colors"></i>
                                <input 
                                    type="text" 
                                    placeholder="Search tasks..." 
                                    className="pl-10 pr-4 py-2 rounded-full border border-gray-200 bg-gray-50 focus:bg-white focus:ring-2 focus:ring-blue-100 focus:border-blue-500 w-64 transition-all outline-none"
                                    value={searchQuery}
                                    onChange={(e) => setSearchQuery(e.target.value)}
                                />
                            </div>
                            
                            <button 
                                onClick={() => setIsModalOpen(true)}
                                className="bg-blue-600 hover:bg-blue-700 text-white px-5 py-2 rounded-full font-semibold shadow-lg shadow-blue-200 flex items-center gap-2 transition-all transform active:scale-95"
                            >
                                <i className="fas fa-plus"></i>
                                <span>New Task</span>
                            </button>
                        </div>
                    </header>

                    {/* Board Area */}
                    <main className="flex-1 overflow-x-auto overflow-y-hidden p-6">
                        <div className="h-full flex gap-6 min-w-max">
                            {COLUMNS.map(col => (
                                <Column 
                                    key={col.id} 
                                    column={col} 
                                    tasks={filteredTasks.filter(t => t.status === col.id)}
                                    onDrop={handleDrop}
                                    onDragOver={handleDragOver}
                                    onDragStart={handleDragStart}
                                    onDeleteTask={handleDeleteTask}
                                />
                            ))}
                        </div>
                    </main>

                    {/* Footer / Stats */}
                    <footer className="bg-white border-t border-gray-200 px-6 py-2 text-xs text-gray-500 flex justify-between items-center">
                        <div>
                            <span>Total Tasks: <span className="font-bold text-gray-700">{tasks.length}</span></span>
                            <span className="mx-2">â€¢</span>
                            <span>Completed: <span className="font-bold text-green-600">{tasks.filter(t => t.status === 'done').length}</span></span>
                        </div>
                        <div className="italic">
                             Drag and drop cards to move them.
                        </div>
                    </footer>

                    <NewTaskModal 
                        isOpen={isModalOpen} 
                        onClose={() => setIsModalOpen(false)} 
                        onAdd={handleAddTask}
                    />
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
