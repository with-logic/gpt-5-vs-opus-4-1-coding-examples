<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Theory Trainer</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tone.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a; /* Slate 900 */
            color: #e2e8f0; /* Slate 200 */
            overflow-x: hidden;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1e293b; 
        }
        ::-webkit-scrollbar-thumb {
            background: #475569; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b; 
        }

        /* Piano Key Animations */
        .white-key {
            transition: background-color 0.1s, transform 0.1s;
        }
        .white-key:active, .white-key.active {
            background-color: #e2e8f0;
            transform: translateY(2px);
            background: linear-gradient(to bottom, #fff 0%, #cbd5e1 100%);
        }
        .black-key {
            transition: background-color 0.1s, transform 0.1s;
        }
        .black-key:active, .black-key.active {
            transform: translateY(2px);
            background-color: #334155;
        }

        .highlight-scale {
            background-color: #8b5cf6 !important; /* Violet 500 */
            border-color: #7c3aed !important;
            box-shadow: 0 0 10px #8b5cf6;
        }
        
        .highlight-chord {
            background-color: #ec4899 !important; /* Pink 500 */
            border-color: #db2777 !important;
            box-shadow: 0 0 10px #ec4899;
        }

        /* Utility for engaging Tone.js */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 50;
            flex-direction: column;
        }

        .piano-container {
            perspective: 500px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        // --- Music Theory Constants & Logic ---
        const NOTES = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];
        
        const SCALES = {
            'Major': [0, 2, 4, 5, 7, 9, 11],
            'Natural Minor': [0, 2, 3, 5, 7, 8, 10],
            'Harmonic Minor': [0, 2, 3, 5, 7, 8, 11],
            'Dorian': [0, 2, 3, 5, 7, 9, 10],
            'Mixolydian': [0, 2, 4, 5, 7, 9, 10],
            'Blues': [0, 3, 5, 6, 7, 10]
        };

        const CHORDS = {
            'Major': [0, 4, 7],
            'Minor': [0, 3, 7],
            'Diminished': [0, 3, 6],
            'Augmented': [0, 4, 8],
            'Maj7': [0, 4, 7, 11],
            'Min7': [0, 3, 7, 10],
            'Dom7': [0, 4, 7, 10]
        };

        // Helper to generate full keyboard range
        // Start from C3 (MIDI 48) to B5 (MIDI 83)
        const generateKeyboard = (startOctave = 3, numOctaves = 2) => {
            const keys = [];
            for (let i = 0; i < numOctaves * 12; i++) {
                const noteIndex = i % 12;
                const octave = startOctave + Math.floor(i / 12);
                const noteName = NOTES[noteIndex];
                keys.push({
                    note: noteName,
                    octave: octave,
                    fullName: `${noteName}${octave}`,
                    isBlack: noteName.includes('#'),
                    midi: 48 + i // C3 is 48
                });
            }
            return keys;
        };

        const KEYBOARD_DATA = generateKeyboard(3, 2); // C3 to B4

        // --- Audio Engine ---
        const useAudio = () => {
            const synth = useRef(null);
            const [isReady, setIsReady] = useState(false);

            const initAudio = async () => {
                await Tone.start();
                synth.current = new Tone.PolySynth(Tone.Synth, {
                    oscillator: { type: "triangle" },
                    envelope: {
                        attack: 0.02,
                        decay: 0.1,
                        sustain: 0.3,
                        release: 1
                    }
                }).toDestination();
                // Add some reverb for richness
                const reverb = new Tone.Reverb({ decay: 2, wet: 0.3 }).toDestination();
                synth.current.connect(reverb);
                setIsReady(true);
            };

            const playNote = (note, duration = "8n") => {
                if (synth.current) {
                    synth.current.triggerAttackRelease(note, duration);
                }
            };
            
            const playChord = (notes, duration = "4n") => {
                if(synth.current) {
                    synth.current.triggerAttackRelease(notes, duration);
                }
            }

            return { isReady, initAudio, playNote, playChord };
        };

        // --- Components ---

        // 1. Piano Component
        const Piano = ({ activeNotes = [], onNotePlay, highlightColor = 'blue' }) => {
            
            const isNoteActive = (noteObj) => {
                return activeNotes.includes(noteObj.fullName);
            };

            const handlePlay = (noteObj) => {
                if (onNotePlay) onNotePlay(noteObj);
            };

            return (
                <div className="relative h-48 sm:h-64 select-none overflow-x-auto overflow-y-hidden piano-container bg-slate-800 rounded-b-xl shadow-2xl border-t-4 border-slate-700">
                    <div className="flex h-full px-4 pt-2 pb-4 min-w-max mx-auto justify-center">
                        {KEYBOARD_DATA.map((k) => {
                            if (k.isBlack) return null; // Render black keys separately to overlay
                            
                            // Find if the black key immediately following this white key exists
                            const nextKey = KEYBOARD_DATA.find(n => n.midi === k.midi + 1);
                            const hasBlackKey = nextKey && nextKey.isBlack;

                            const active = isNoteActive(k);

                            return (
                                <div key={k.fullName} className="relative group">
                                    {/* White Key */}
                                    <div 
                                        className={`
                                            white-key w-10 sm:w-14 h-full border border-slate-300 rounded-b-md cursor-pointer relative z-10
                                            ${active ? (highlightColor === 'scale' ? 'highlight-scale' : highlightColor === 'chord' ? 'highlight-chord' : '!bg-violet-400') : 'bg-white hover:bg-slate-100'}
                                        `}
                                        onMouseDown={() => handlePlay(k)}
                                        onTouchStart={(e) => { e.preventDefault(); handlePlay(k); }}
                                    >
                                        <div className="absolute bottom-2 left-1/2 -translate-x-1/2 text-xs font-bold text-slate-400 pointer-events-none">
                                            {k.note}
                                        </div>
                                    </div>

                                    {/* Black Key (Absolute positioned relative to container, usually) 
                                        But here we nest it to position relative to the white key gap
                                    */}
                                    {hasBlackKey && (
                                        <div 
                                            className={`
                                                black-key absolute w-8 sm:w-10 h-3/5 -right-4 sm:-right-5 top-0 z-20 rounded-b-md cursor-pointer border-x border-b border-slate-900 shadow-md
                                                ${isNoteActive(nextKey) ? (highlightColor === 'scale' ? 'highlight-scale' : highlightColor === 'chord' ? 'highlight-chord' : '!bg-violet-400') : 'bg-slate-900 group-hover:bg-slate-800'}
                                            `}
                                            onMouseDown={(e) => { e.stopPropagation(); handlePlay(nextKey); }}
                                            onTouchStart={(e) => { e.preventDefault(); e.stopPropagation(); handlePlay(nextKey); }}
                                        >
                                        </div>
                                    )}
                                </div>
                            );
                        })}
                    </div>
                </div>
            );
        };

        // 2. Theory Lab Component
        const TheoryLab = ({ playNote, playChord }) => {
            const [root, setRoot] = useState('C');
            const [mode, setMode] = useState('scale'); // 'scale' or 'chord'
            const [type, setType] = useState('Major');
            
            // Logic to calculate notes
            const getHighlightedNotes = () => {
                const rootIndex = NOTES.indexOf(root);
                const formula = mode === 'scale' ? SCALES[type] : CHORDS[type];
                
                if (!formula) return [];

                // Generate full names (e.g., C3, E3, G3)
                // We'll map them to the KEYBOARD_DATA to see which ones to light up.
                // We'll calculate modulo 12 to match note names regardless of octave, 
                // but for visualization, let's light up all matching notes or just one octave?
                // Let's light up one octave starting from C3 roughly.
                
                const notesToHighlight = [];
                // Base midi for calculation (using C3 as base roughly)
                const baseMidi = 48 + rootIndex; 

                formula.forEach(interval => {
                    const midi = baseMidi + interval;
                    const noteName = NOTES[midi % 12];
                    // Find this specific midi in our keyboard data if it exists, otherwise just match name
                    // Let's just match names across the board for simplicity in teaching
                    // Actually, specific intervals are better.
                });

                // Let's return just the note names (e.g. "C", "E", "G") to highlight all instances
                // OR better, specific calculated notes.
                const noteNames = formula.map(interval => NOTES[(rootIndex + interval) % 12]);
                
                // Map to full keyboard keys
                return KEYBOARD_DATA.filter(k => noteNames.includes(k.note)).map(k => k.fullName);
            };

            const highlighted = getHighlightedNotes();

            const handlePlayPreview = () => {
                 // Play the scale/chord audio starting at octave 3
                 const rootIndex = NOTES.indexOf(root);
                 const formula = mode === 'scale' ? SCALES[type] : CHORDS[type];
                 const notes = formula.map(interval => {
                     const midi = 48 + rootIndex + interval; // Start at C3
                     const noteName = NOTES[midi % 12];
                     const octave = Math.floor(midi / 12) - 1; // midi 48 is C3. 48/12 = 4. 
                     return `${noteName}${octave}`;
                 });
                 
                 if (mode === 'chord') {
                     playChord(notes);
                 } else {
                     // Play scale as sequence
                     const now = Tone.now();
                     notes.forEach((n, i) => {
                         playNote(n, "8n", now + i * 0.3);
                     });
                 }
            };

            return (
                <div className="p-6 max-w-4xl mx-auto space-y-6">
                    <div className="flex flex-col md:flex-row gap-6 justify-center items-center bg-slate-800 p-6 rounded-xl border border-slate-700 shadow-lg">
                        
                        {/* Controls */}
                        <div className="flex gap-4">
                            <div className="flex flex-col gap-1">
                                <label className="text-xs text-slate-400 uppercase font-bold tracking-wider">Root</label>
                                <select 
                                    value={root} 
                                    onChange={(e) => setRoot(e.target.value)}
                                    className="bg-slate-700 text-white p-2 rounded-lg border border-slate-600 focus:ring-2 focus:ring-violet-500 outline-none"
                                >
                                    {NOTES.map(n => <option key={n} value={n}>{n}</option>)}
                                </select>
                            </div>

                            <div className="flex flex-col gap-1">
                                <label className="text-xs text-slate-400 uppercase font-bold tracking-wider">Mode</label>
                                <div className="flex bg-slate-700 rounded-lg p-1 border border-slate-600">
                                    <button 
                                        className={`px-3 py-1 rounded-md text-sm transition ${mode === 'scale' ? 'bg-violet-600 text-white shadow-sm' : 'text-slate-300 hover:text-white'}`}
                                        onClick={() => { setMode('scale'); setType('Major'); }}
                                    >Scale</button>
                                    <button 
                                        className={`px-3 py-1 rounded-md text-sm transition ${mode === 'chord' ? 'bg-pink-600 text-white shadow-sm' : 'text-slate-300 hover:text-white'}`}
                                        onClick={() => { setMode('chord'); setType('Major'); }}
                                    >Chord</button>
                                </div>
                            </div>

                            <div className="flex flex-col gap-1">
                                <label className="text-xs text-slate-400 uppercase font-bold tracking-wider">Type</label>
                                <select 
                                    value={type} 
                                    onChange={(e) => setType(e.target.value)}
                                    className="bg-slate-700 text-white p-2 rounded-lg border border-slate-600 focus:ring-2 focus:ring-violet-500 outline-none min-w-[140px]"
                                >
                                    {Object.keys(mode === 'scale' ? SCALES : CHORDS).map(t => (
                                        <option key={t} value={t}>{t}</option>
                                    ))}
                                </select>
                            </div>
                        </div>

                        <button 
                            onClick={handlePlayPreview}
                            className="bg-slate-100 text-slate-900 p-3 rounded-full hover:bg-white hover:scale-105 transition shadow-lg active:scale-95"
                            title="Play Preview"
                        >
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                        </button>
                    </div>

                    <div className="bg-slate-900 p-4 rounded-xl border border-slate-800 shadow-inner">
                        <Piano activeNotes={highlighted} onNotePlay={(k) => playNote(k.fullName)} highlightColor={mode === 'scale' ? 'scale' : 'chord'} />
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="bg-slate-800 p-4 rounded-lg border border-slate-700">
                            <h3 className="text-violet-400 font-bold mb-2">Notes in {root} {type}</h3>
                            <div className="flex flex-wrap gap-2">
                                {(mode === 'scale' ? SCALES[type] : CHORDS[type]).map(interval => {
                                    const rootIndex = NOTES.indexOf(root);
                                    return NOTES[(rootIndex + interval) % 12];
                                }).map((n, i) => (
                                    <span key={i} className="px-3 py-1 bg-slate-700 rounded-full text-sm font-mono border border-slate-600">{n}</span>
                                ))}
                            </div>
                        </div>
                        <div className="bg-slate-800 p-4 rounded-lg border border-slate-700">
                            <h3 className="text-pink-400 font-bold mb-2">Interval Structure</h3>
                            <div className="text-sm text-slate-300">
                                {mode === 'scale' ? 'Sequence of intervals relative to root.' : 'Stacked intervals creating harmony.'}
                                <br/>
                                <span className="font-mono text-xs opacity-70">
                                    Formula: {(mode === 'scale' ? SCALES[type] : CHORDS[type]).join(' - ')} (semitones)
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // 3. Ear Training Game
        const EarTraining = ({ playNote, playChord }) => {
            const [gameState, setGameState] = useState('idle'); // idle, playing, success, failure
            const [currentQuestion, setCurrentQuestion] = useState(null);
            const [score, setScore] = useState(0);
            const [feedback, setFeedback] = useState("");

            const generateQuestion = () => {
                const types = ['note', 'chord'];
                const type = types[Math.floor(Math.random() * types.length)];
                
                // Random root C3 to B3
                const rootMidi = 48 + Math.floor(Math.random() * 12); 
                const rootName = NOTES[rootMidi % 12];
                const octave = Math.floor(rootMidi / 12) - 1;
                const rootFull = `${rootName}${octave}`;

                if (type === 'note') {
                    return {
                        type: 'note',
                        target: rootFull,
                        display: rootName,
                        notes: [rootFull]
                    };
                } else {
                    const chordTypes = Object.keys(CHORDS);
                    const chordType = chordTypes[Math.floor(Math.random() * chordTypes.length)];
                    const intervals = CHORDS[chordType];
                    const notes = intervals.map(i => {
                         const midi = rootMidi + i;
                         const n = NOTES[midi % 12];
                         const o = Math.floor(midi / 12) - 1;
                         return `${n}${o}`;
                    });
                    
                    return {
                        type: 'chord',
                        target: chordType, // They have to guess the chord quality (Major, Minor, etc)
                        root: rootName,
                        notes: notes
                    };
                }
            };

            const startGame = () => {
                const q = generateQuestion();
                setCurrentQuestion(q);
                setGameState('playing');
                setFeedback("");
                playQuestion(q);
            };

            const playQuestion = (q = currentQuestion) => {
                if (!q) return;
                const now = Tone.now();
                if (q.type === 'note') {
                    playNote(q.notes[0], "2n");
                } else {
                    playChord(q.notes, "2n");
                }
            };

            const handleGuess = (guess) => {
                if (gameState !== 'playing') return;

                let isCorrect = false;
                if (currentQuestion.type === 'note') {
                    // For note guess, we pass the note name (without octave)
                    if (guess === currentQuestion.display) isCorrect = true;
                } else {
                    if (guess === currentQuestion.target) isCorrect = true;
                }

                if (isCorrect) {
                    setScore(s => s + 10);
                    setFeedback("Correct! ðŸŽ‰");
                    setGameState('success');
                    playChord(['C5', 'E5', 'G5'], '8n'); // Victory sound
                    setTimeout(() => {
                        startGame();
                    }, 1500);
                } else {
                    setFeedback(`Wrong! It was ${currentQuestion.type === 'note' ? currentQuestion.display : currentQuestion.target}`);
                    setGameState('failure');
                    playNote('C2', '4n'); // Failure sound
                    setTimeout(() => {
                        startGame();
                    }, 2000);
                }
            };

            return (
                <div className="max-w-2xl mx-auto p-6 space-y-8 text-center">
                    <div className="bg-slate-800 p-8 rounded-2xl border border-slate-700 shadow-2xl">
                        <div className="flex justify-between items-center mb-8">
                            <h2 className="text-2xl font-bold text-white flex items-center gap-2">
                                <span className="text-emerald-400">ðŸ‘‚</span> Ear Trainer
                            </h2>
                            <div className="bg-slate-900 px-4 py-2 rounded-lg font-mono text-xl text-emerald-400 border border-slate-700">
                                Score: {score}
                            </div>
                        </div>

                        {gameState === 'idle' ? (
                            <div className="text-center py-10">
                                <p className="text-slate-400 mb-6">Test your hearing. Identify notes and chords.</p>
                                <button 
                                    onClick={startGame}
                                    className="bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-3 px-8 rounded-full transition transform hover:scale-105 shadow-lg shadow-emerald-500/20"
                                >
                                    Start Training
                                </button>
                            </div>
                        ) : (
                            <div className="space-y-8">
                                <div className="py-4">
                                    <button 
                                        onClick={() => playQuestion()}
                                        className="w-24 h-24 rounded-full bg-slate-700 hover:bg-slate-600 border-4 border-slate-500 flex items-center justify-center mx-auto transition active:scale-95 active:border-emerald-500 group"
                                    >
                                        <svg className="text-slate-300 group-hover:text-white" xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>
                                    </button>
                                    <p className="text-slate-400 mt-4 text-sm uppercase tracking-widest font-semibold">
                                        Listen & Identify the {currentQuestion.type}
                                    </p>
                                </div>

                                <div className="min-h-[60px]">
                                    {feedback && (
                                        <div className={`text-xl font-bold animate-bounce ${gameState === 'success' ? 'text-emerald-400' : 'text-red-400'}`}>
                                            {feedback}
                                        </div>
                                    )}
                                </div>

                                <div className="grid grid-cols-4 gap-3">
                                    {currentQuestion.type === 'note' ? (
                                        NOTES.map(n => (
                                            <button
                                                key={n}
                                                onClick={() => handleGuess(n)}
                                                disabled={gameState !== 'playing'}
                                                className="bg-slate-700 hover:bg-slate-600 disabled:opacity-50 text-white font-bold py-3 rounded-lg border-b-4 border-slate-900 active:border-b-0 active:translate-y-1 transition"
                                            >
                                                {n}
                                            </button>
                                        ))
                                    ) : (
                                        Object.keys(CHORDS).map(c => (
                                            <button
                                                key={c}
                                                onClick={() => handleGuess(c)}
                                                disabled={gameState !== 'playing'}
                                                className="bg-slate-700 hover:bg-slate-600 disabled:opacity-50 text-white font-bold py-3 rounded-lg border-b-4 border-slate-900 active:border-b-0 active:translate-y-1 transition text-sm"
                                            >
                                                {c}
                                            </button>
                                        ))
                                    )}
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // --- Main App ---
        const App = () => {
            const { isReady, initAudio, playNote, playChord } = useAudio();
            const [activeTab, setActiveTab] = useState('play'); // play, learn, ear

            if (!isReady) {
                return (
                    <div className="overlay">
                        <div className="text-center animate-fade-in space-y-6">
                            <h1 className="text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-violet-400 to-pink-600 mb-2">
                                Music Theory Trainer
                            </h1>
                            <p className="text-slate-400 text-lg">Interactive Piano â€¢ Scales & Chords â€¢ Ear Training</p>
                            
                            <button 
                                onClick={initAudio}
                                className="mt-8 px-8 py-4 bg-white text-slate-900 text-lg font-bold rounded-full hover:bg-slate-200 transition-all shadow-[0_0_20px_rgba(255,255,255,0.3)] hover:shadow-[0_0_30px_rgba(255,255,255,0.5)] transform hover:-translate-y-1"
                            >
                                Start Application
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-slate-950 flex flex-col items-center">
                    {/* Header */}
                    <header className="w-full bg-slate-900 border-b border-slate-800 p-4 shadow-lg sticky top-0 z-40">
                        <div className="max-w-6xl mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
                            <div className="flex items-center gap-3">
                                <div className="w-8 h-8 bg-gradient-to-br from-violet-500 to-pink-500 rounded-lg flex items-center justify-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5 text-white" viewBox="0 0 20 20" fill="currentColor">
                                        <path d="M18 3a1 1 0 00-1.196-.98l-10 2A1 1 0 006 5v9.114A4.369 4.369 0 005 14c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V7.82l8-1.6v5.894A4.37 4.37 0 0015 12c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V3z" />
                                    </svg>
                                </div>
                                <h1 className="text-xl font-bold tracking-tight text-white">Music Theory Trainer</h1>
                            </div>
                            
                            <nav className="flex bg-slate-800 rounded-lg p-1 border border-slate-700">
                                {[
                                    { id: 'play', label: 'Free Play', icon: 'ðŸŽ¹' },
                                    { id: 'learn', label: 'Theory Lab', icon: 'ðŸ§ª' },
                                    { id: 'ear', label: 'Ear Training', icon: 'ðŸ‘‚' }
                                ].map(tab => (
                                    <button
                                        key={tab.id}
                                        onClick={() => setActiveTab(tab.id)}
                                        className={`px-4 py-2 rounded-md text-sm font-medium transition flex items-center gap-2 ${activeTab === tab.id ? 'bg-slate-700 text-white shadow-sm' : 'text-slate-400 hover:text-white hover:bg-slate-700/50'}`}
                                    >
                                        <span>{tab.icon}</span> {tab.label}
                                    </button>
                                ))}
                            </nav>
                        </div>
                    </header>

                    {/* Main Content */}
                    <main className="w-full max-w-6xl mx-auto p-4 flex-1">
                        
                        <div className={`transition-opacity duration-300 ${activeTab === 'play' ? 'block' : 'hidden'}`}>
                            <div className="text-center py-10">
                                <h2 className="text-4xl font-bold text-white mb-4">Studio Piano</h2>
                                <p className="text-slate-400 mb-8 max-w-lg mx-auto">
                                    Play freely. Use your mouse or touch screen. Experiment with harmonies and melodies in a responsive environment.
                                </p>
                            </div>
                            <div className="bg-slate-900 p-6 rounded-2xl border border-slate-800 shadow-2xl">
                                <Piano onNotePlay={(k) => playNote(k.fullName)} />
                                <div className="mt-6 text-center text-slate-500 text-sm">
                                    Tap keys to play.
                                </div>
                            </div>
                        </div>

                        <div className={`transition-opacity duration-300 ${activeTab === 'learn' ? 'block' : 'hidden'}`}>
                            <div className="text-center py-6">
                                <h2 className="text-3xl font-bold text-white">Theory Laboratory</h2>
                                <p className="text-slate-400">Visualize scales and chords instantly.</p>
                            </div>
                            <TheoryLab playNote={playNote} playChord={playChord} />
                        </div>

                        <div className={`transition-opacity duration-300 ${activeTab === 'ear' ? 'block' : 'hidden'}`}>
                            <EarTraining playNote={playNote} playChord={playChord} />
                        </div>

                    </main>

                    <footer className="w-full py-6 text-center text-slate-600 text-sm border-t border-slate-900 mt-auto">
                        Built with React, Tone.js & Tailwind CSS
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
