<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>Farewell Message Board</title>
  <meta name="description" content="A warm, modern board to share farewell messages with heartfelt cards and a joyful vibe." />
  <style>
    /* --- Design Tokens --- */
    :root {
      --bg: #0f1220;
      --bg-2: #121528;
      --surface: #161a33;
      --surface-2: #1b2040;
      --text: #e9ecf6;
      --muted: #b5bdd7;
      --primary: #7c5cff; /* iris */
      --primary-700: #6a4bff;
      --primary-600: #7c5cff;
      --primary-500: #8a6bff;
      --accent: #ff7ac6; /* pink */
      --success: #2fd180;
      --warning: #ffb454;
      --danger: #ff6b6b;
      --ring: rgba(124, 92, 255, 0.55);
      --card-gradient: radial-gradient(1200px 600px at 10% -20%, rgba(124,92,255,.08), transparent 50%),
                        radial-gradient(1000px 500px at 120% 10%, rgba(255,122,198,.08), transparent 40%),
                        linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0));
      --shadow-1: 0 1px 1px rgba(0,0,0,.15), 0 8px 20px rgba(10, 12, 25, .35);
      --shadow-2: 0 2px 8px rgba(0,0,0,.25), 0 16px 40px rgba(10, 12, 25, .45);
      --radius: 16px;
      --radius-lg: 22px;
      --radius-sm: 10px;
      --gap: 20px;
      --focus: 0 0 0 3px var(--ring), 0 0 0 1px var(--primary-700);
    }

    /* --- Base Reset --- */
    *, *::before, *::after { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Inter, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text);
      background: radial-gradient(1200px 800px at -10% -10%, #2b2e5a 0%, transparent 60%),
                  radial-gradient(1200px 800px at 110% -10%, #3b235e 0%, transparent 60%),
                  linear-gradient(180deg, var(--bg), var(--bg-2));
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }
    a { color: inherit; text-decoration: none; }
    img, svg { display: block; max-width: 100%; }
    button { font: inherit; color: inherit; background: none; border: none; cursor: pointer; }

    /* --- Layout --- */
    .wrap { display: grid; min-height: 100svh; grid-template-rows: auto 1fr; }
    .container { width: min(1100px, 92%); margin-inline: auto; }

    /* --- App Bar --- */
    .appbar {
      position: sticky; top: 0; z-index: 20;
      backdrop-filter: saturate(1.1) blur(14px);
      background: linear-gradient(180deg, rgba(18,22,46,.85), rgba(18,22,46,.55));
      border-bottom: 1px solid rgba(255,255,255,.06);
    }
    .bar {
      display: flex; align-items: center; justify-content: space-between;
      gap: 16px; padding: 14px 0;
    }
    .brand { display: flex; align-items: center; gap: 12px; }
    .logo {
      width: 36px; height: 36px; border-radius: 10px; overflow: hidden; position: relative;
      background: conic-gradient(from 140deg, #7c5cff, #ff7ac6, #2fd180, #7c5cff);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.22), 0 6px 18px rgba(0,0,0,.35);
    }
    .logo::after { content: ""; inset: 1px; position: absolute; border-radius: 9px; background: radial-gradient(200% 120% at 100% 0%, rgba(255,255,255,.35), transparent 35%); }
    .title { font-weight: 700; letter-spacing: 0.2px; font-size: 18px; }
    .subtitle { color: var(--muted); font-size: 14px; }

    /* --- Buttons --- */
    .btn { --h: 42px; height: var(--h); padding-inline: 16px; border-radius: 999px; display: inline-flex; align-items: center; gap: 10px; white-space: nowrap; position: relative; isolation: isolate; }
    .btn:focus-visible { outline: none; box-shadow: var(--focus); }
    .btn:active { transform: translateY(1px); }
    .btn .icon { width: 18px; height: 18px; opacity: .95; }
    .btn-primary { color: #0b0d1d; background: linear-gradient(180deg, #a18bff, #7c5cff); box-shadow: 0 2px 0 #6a4bff, var(--shadow-1); }
    .btn-primary:hover { filter: brightness(1.05); }
    .btn-ghost { color: var(--text); background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,.12); box-shadow: var(--shadow-1); }
    .btn-ghost:hover { background: rgba(255,255,255,0.12); }
    .btn-danger { color: #fff; background: linear-gradient(180deg, #ff8b8b, #ff6b6b); box-shadow: 0 2px 0 #db5858, var(--shadow-1); }

    /* --- Hero / Intro --- */
    .intro { padding: 26px 0 18px; display: grid; gap: 10px; }
    .intro h1 { font-size: clamp(22px, 3.2vw, 30px); margin: 0; letter-spacing: .2px; }
    .hint { color: var(--muted); font-size: 14px; }
    .stats { color: var(--muted); font-size: 13px; }

    /* --- Grid / Cards --- */
    .grid { display: grid; gap: var(--gap); grid-template-columns: repeat(12, 1fr); }
    .card {
      grid-column: span 12;
      display: grid; grid-template-columns: 86px 1fr; gap: 16px; align-items: start;
      padding: 16px; border-radius: var(--radius);
      background: color-mix(in oklab, #151939 80%, #0f1220 20%);
      background-image: var(--card-gradient);
      border: 1px solid rgba(255,255,255,.08);
      box-shadow: var(--shadow-1);
      transition: transform .2s ease, box-shadow .2s ease, border-color .2s ease;
    }
    .card:hover { transform: translateY(-2px); box-shadow: var(--shadow-2); border-color: rgba(255,255,255,.14); }
    @media (width >= 600px) { .card { grid-column: span 6; } }
    @media (width >= 1024px) { .card { grid-column: span 4; } }

    .avatar {
      width: 70px; height: 70px; border-radius: 16px; display: grid; place-items: center; font-size: 34px; line-height: 1; user-select: none;
      background: radial-gradient(120% 120% at 0% 0%, rgba(255,255,255,.15), transparent 40%),
                  linear-gradient(135deg, rgba(124,92,255,.25), rgba(255,122,198,.25));
      border: 1px solid rgba(255,255,255,.16);
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.25), 0 10px 20px rgba(0,0,0,.25);
      color: #fff;
    }
    .meta { display: flex; align-items: baseline; gap: 8px; margin-bottom: 8px; }
    .name { font-weight: 700; }
    .role { color: var(--muted); font-size: 12px; }
    .text { color: var(--text); line-height: 1.5; font-size: 15px; }
    .text strong { color: #fff; }
    .footer { display: flex; align-items: center; gap: 10px; margin-top: 12px; color: var(--muted); font-size: 12px; }
    .chip { padding: 4px 8px; border-radius: 999px; border: 1px solid rgba(255,255,255,.12); background: rgba(255,255,255,.06); font-size: 12px; color: #e7e9f4; }

    /* --- Composer Modal --- */
    .overlay { position: fixed; inset: 0; display: none; place-items: center; background: rgba(10,12,25,.55); backdrop-filter: blur(10px); z-index: 40; }
    .overlay.show { display: grid; }
    .modal {
      width: min(680px, 92vw);
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: var(--shadow-2);
      border-radius: var(--radius-lg);
      padding: 20px;
    }
    .modal h2 { margin: 0 0 10px; font-size: 20px; }
    .modal .row { display: grid; gap: 10px; margin-top: 10px; }
    .field { display: grid; gap: 8px; }
    .label { font-size: 13px; color: var(--muted); }
    .input, .textarea {
      width: 100%; border-radius: 12px; border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: var(--text); padding: 12px 14px; box-shadow: inset 0 1px 0 rgba(255,255,255,.05);
    }
    .input:focus, .textarea:focus { outline: none; box-shadow: var(--focus); border-color: transparent; }
    .textarea { min-height: 120px; resize: vertical; }

    .icons { display: grid; grid-template-columns: repeat(10, 1fr); gap: 10px; }
    @media (width <= 560px) { .icons { grid-template-columns: repeat(5, 1fr); } }
    .icon-option {
      border-radius: 12px; height: 54px; display: grid; place-items: center; font-size: 26px;
      background: rgba(255,255,255,.06); border: 1px solid rgba(255,255,255,.12);
      transition: transform .15s ease, box-shadow .2s ease, border-color .2s ease;
    }
    .icon-option[aria-selected="true"] { outline: none; border-color: var(--primary-600); box-shadow: var(--focus); transform: translateY(-1px); }

    .modal-actions { display: flex; justify-content: space-between; align-items: center; margin-top: 14px; }

    /* --- Toast --- */
    .toast { position: fixed; left: 50%; transform: translateX(-50%); bottom: 18px; z-index: 50; display: none; }
    .toast.show { display: block; }
    .toast .msg { background: rgba(255,255,255,.08); border: 1px solid rgba(255,255,255,.14); padding: 10px 14px; border-radius: 12px; box-shadow: var(--shadow-1); }

    /* --- Canvas Confetti Layer --- */
    #fx { position: fixed; inset: 0; pointer-events: none; z-index: 45; }

    /* --- Utilities --- */
    .spacer { flex: 1; }
    .muted { color: var(--muted); }
    .hidden { display: none !important; }
  </style>
</head>
<body>
  <div class="wrap">
    <!-- App Bar -->
    <header class="appbar">
      <div class="container bar" role="navigation" aria-label="Top bar">
        <div class="brand">
          <div class="logo" aria-hidden="true"></div>
          <div>
            <div class="title">Farewell Message Board</div>
            <div class="subtitle">Share warm wishes and favorite memories</div>
          </div>
        </div>
        <div style="display:flex; gap:10px; align-items:center;">
          <button id="loginBtn" class="btn btn-ghost" aria-haspopup="true" aria-expanded="false">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-4 0-7 2-7 4.5V20a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-1.5C19 16 16 14 12 14Z"/></svg>
            <span id="loginLabel">Sign in</span>
          </button>
          <button id="writeBtn" class="btn btn-primary">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M19 4h-3a1 1 0 0 0 0 2h1.586L7.293 16.293a1 1 0 0 0 1.414 1.414L19 7.414V9a1 1 0 0 0 2 0V6a2 2 0 0 0-2-2Z"/></svg>
            Write
          </button>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="container" id="main">
      <section class="intro" aria-label="Introduction">
        <h1>Letâ€™s send them off with love ðŸ’œ</h1>
        <div class="hint">Write a note, share a memory, or wish them luck on the next adventure.</div>
        <div class="stats" id="stats">0 messages â€¢ your words matter</div>
      </section>

      <section class="grid" id="board" aria-live="polite" aria-label="Farewell messages">
        <!-- Cards render here -->
      </section>
    </main>
  </div>

  <!-- Composer Modal -->
  <div class="overlay" id="composer" role="dialog" aria-modal="true" aria-labelledby="composerTitle">
    <div class="modal" role="document">
      <h2 id="composerTitle">Write a Farewell Message</h2>
      <form id="composeForm" class="row">
        <div class="field">
          <label class="label" for="author">Your name (optional)</label>
          <input class="input" id="author" name="author" placeholder="e.g., Maya" autocomplete="name" />
        </div>
        <div class="field">
          <label class="label" for="message">Your message</label>
          <textarea class="textarea" id="message" name="message" placeholder="Share a memory, a wish, or a thank youâ€¦" maxlength="800" required></textarea>
        </div>
        <div class="field">
          <div class="label">Pick a picture</div>
          <div class="icons" id="iconPicker" role="listbox" aria-label="Choose an icon"></div>
        </div>
        <div class="modal-actions">
          <div class="muted">Kindness first. Keep it respectful.</div>
          <div style="display:flex; gap:10px;">
            <button type="button" class="btn btn-ghost" id="cancelBtn">Cancel</button>
            <button type="submit" class="btn btn-primary">Post</button>
          </div>
        </div>
      </form>
    </div>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast" role="status" aria-live="polite"><div class="msg" id="toastMsg">Saved</div></div>

  <!-- Confetti Canvas -->
  <canvas id="fx"></canvas>

  <script>
    ;(() => {
      const $ = (sel, el=document) => el.querySelector(sel);
      const $$ = (sel, el=document) => Array.from(el.querySelectorAll(sel));

      const store = {
        key: 'farewellMessages:v1',
        userKey: 'farewellUser',
        get() { try { return JSON.parse(localStorage.getItem(this.key)) || []; } catch { return []; } },
        set(list) { localStorage.setItem(this.key, JSON.stringify(list)); },
        getUser() { try { return JSON.parse(localStorage.getItem(this.userKey)) || null; } catch { return null; } },
        setUser(u) { localStorage.setItem(this.userKey, JSON.stringify(u)); }
      };

      const ICONS = [
        { id: 'rocket', char: 'ðŸš€', label: 'Rocket' },
        { id: 'party', char: 'ðŸŽ‰', label: 'Confetti' },
        { id: 'heart', char: 'ðŸ’œ', label: 'Heart' },
        { id: 'sunrise', char: 'ðŸŒ…', label: 'Sunrise' },
        { id: 'coffee', char: 'â˜•ï¸', label: 'Coffee' },
        { id: 'book', char: 'ðŸ“š', label: 'Book' },
        { id: 'compass', char: 'ðŸ§­', label: 'Compass' },
        { id: 'handshake', char: 'ðŸ¤', label: 'Handshake' },
        { id: 'globe', char: 'ðŸŒ', label: 'Globe' },
        { id: 'lightbulb', char: 'ðŸ’¡', label: 'Lightbulb' },
        { id: 'plane', char: 'âœˆï¸', label: 'Plane' },
      ];

      const PRESET = [
        {
          author: 'Maya', role: 'Design', icon: 'heart',
          text: 'Your kindness and calm leadership shaped our team. Thank you for championing people firstâ€”wishing you joy and growth in every next step!'
        },
        {
          author: 'Liam', role: 'Backend', icon: 'lightbulb',
          text: 'Thanks for every thoughtful review and late-night debugging buddy sessions. Keep inventing wonderful thingsâ€”you inspire builders everywhere.'
        },
        {
          author: 'Ava', role: 'Product', icon: 'rocket',
          text: 'You made standups fun and strategy sharper. Proud of all we shipped togetherâ€”canâ€™t wait to see you launch the next big thing.'
        },
        {
          author: 'Noah', role: 'Support', icon: 'coffee',
          text: 'Iâ€™ll miss our coffee chats and your steady presence. Hereâ€™s to new cafes and new storiesâ€”keep in touch!'
        },
        {
          author: 'Emma', role: 'Mobile', icon: 'book',
          text: 'Thank you for guiding my very first PR. Your patience changed my careerâ€”wishing you endless chapters of success.'
        },
        {
          author: 'Oliver', role: 'Data', icon: 'compass',
          text: 'To brave pivots and elegant insightsâ€”you always found true north. May your next maps be even more exciting.'
        },
        {
          author: 'Sophia', role: 'People Ops', icon: 'party',
          text: 'Your positivity is contagious. You built community wherever you wentâ€”weâ€™ll carry that spark forward. Celebrate big!' 
        },
        {
          author: 'Ethan', role: 'SRE', icon: 'plane',
          text: 'From on-calls to inside jokesâ€”you brought reliability and warmth. Wishing you smooth flights and blue skies ahead.'
        },
        {
          author: 'Mia', role: 'QA', icon: 'globe',
          text: 'May the road rise to meet you and adventures find you ready. Thanks for caring about quality in both code and people.'
        },
        {
          author: 'Lucas', role: 'Finance', icon: 'sunrise',
          text: 'To new horizons and brighter morningsâ€”youâ€™ve earned them. Weâ€™re cheering you on from the sidelines!'
        }
      ].map((m, i) => ({ ...m, id: crypto.randomUUID(), date: Date.now() - (10 - i) * 3600_000 }));

      function iconFor(id) { return ICONS.find(i => i.id === id) || ICONS[0]; }

      // Seed once
      let messages = store.get();
      if (!messages || !messages.length) {
        messages = PRESET;
        store.set(messages);
      }

      // Elements
      const board = $('#board');
      const stats = $('#stats');
      const composer = $('#composer');
      const form = $('#composeForm');
      const loginBtn = $('#loginBtn');
      const loginLabel = $('#loginLabel');
      const writeBtn = $('#writeBtn');
      const cancelBtn = $('#cancelBtn');
      const iconPicker = $('#iconPicker');
      const toast = $('#toast');
      const toastMsg = $('#toastMsg');

      // Icon picker render
      let selectedIcon = ICONS[0].id;
      function renderIconPicker() {
        iconPicker.innerHTML = ICONS.map((ic, idx) => `
          <button type="button" class="icon-option" role="option" aria-selected="${ic.id===selectedIcon}" aria-label="${ic.label}" data-id="${ic.id}">${ic.char}</button>
        `).join('');
      }
      renderIconPicker();
      iconPicker.addEventListener('click', (e) => {
        const btn = e.target.closest('.icon-option');
        if (!btn) return;
        selectedIcon = btn.dataset.id;
        $$('.icon-option', iconPicker).forEach(b => b.setAttribute('aria-selected', String(b===btn)));
      });

      // Renderer
      function fmtTime(ts) {
        const d = new Date(ts);
        return d.toLocaleString([], { month: 'short', day: 'numeric' });
      }
      function render() {
        const list = [...messages].sort((a,b)=>b.date-a.date);
        stats.textContent = `${list.length} message${list.length!==1?'s':''} â€¢ your words matter`;
        board.innerHTML = list.map(m => {
          const ic = iconFor(m.icon);
          return `
            <article class="card" data-id="${m.id}">
              <div class="avatar" aria-hidden="true"><span role="img" aria-label="${ic.label}">${ic.char}</span></div>
              <div>
                <div class="meta">
                  <div class="name">${escapeHTML(m.author || 'Anonymous')}</div>
                  ${m.role ? `<div class="role">${escapeHTML(m.role)}</div>` : ''}
                  <div class="spacer"></div>
                </div>
                <div class="text">${linkify(escapeHTML(m.text))}</div>
                <div class="footer">
                  <span class="chip">${ic.label}</span>
                  <span title="Posted">Â· ${fmtTime(m.date)}</span>
                </div>
              </div>
            </article>
          `;
        }).join('');
      }

      // Utilities: safe text & linkify
      function escapeHTML(s) { return s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[c])); }
      function linkify(text) {
        return text.replace(/(https?:\/\/[^\s]+)|(#[a-zA-Z0-9_]+)/g, (m) => {
          if (m.startsWith('#')) return `<span class="chip">${m}</span>`;
          return `<a href="${m}" target="_blank" rel="noopener">${m}</a>`;
        });
      }

      // Modal controls
      function openComposer() { composer.classList.add('show'); setTimeout(()=>$('#message').focus(), 0); }
      function closeComposer() { composer.classList.remove('show'); form.reset(); selectedIcon = ICONS[0].id; renderIconPicker(); }

      writeBtn.addEventListener('click', openComposer);
      cancelBtn.addEventListener('click', closeComposer);
      composer.addEventListener('click', (e) => { if (e.target === composer) closeComposer(); });
      window.addEventListener('keydown', (e)=>{ if (e.key==='Escape' && composer.classList.contains('show')) closeComposer(); });

      // Pseudo login
      let user = store.getUser();
      function updateLoginUI() { loginLabel.textContent = user ? `Signed in: ${user.name}` : 'Sign in'; }
      updateLoginUI();

      loginBtn.addEventListener('click', () => {
        if (!user) {
          // Pseudo sign-in with a light prompt
          const name = prompt('Add your name (optional):', 'Guest');
          user = { name: (name || 'Guest').trim().slice(0, 24) };
          store.setUser(user);
          updateLoginUI();
          showToast(`Welcome, ${user.name}!`);
        } else {
          // Toggle to sign out
          if (confirm(`Sign out ${user.name}?`)) {
            user = null; store.setUser(null); updateLoginUI(); showToast('Signed out');
          }
        }
      });

      // Submit
      form.addEventListener('submit', (e) => {
        e.preventDefault();
        const author = $('#author').value.trim() || (user ? user.name : 'Anonymous');
        const text = $('#message').value.trim();
        if (!text) return;
        const item = { id: crypto.randomUUID(), author, role: '', icon: selectedIcon, text, date: Date.now() };
        messages.push(item);
        store.set(messages);
        render();
        closeComposer();
        showToast('Message posted ðŸŽ‰');
        confetti();
      });

      // Toast
      let toastTimer; 
      function showToast(msg) {
        toastMsg.textContent = msg; toast.classList.add('show');
        clearTimeout(toastTimer); toastTimer = setTimeout(()=>toast.classList.remove('show'), 1800);
      }

      // Confetti (tiny, self-contained)
      const fx = document.getElementById('fx');
      const ctx = fx.getContext('2d');
      function sizeCanvas() { fx.width = innerWidth * devicePixelRatio; fx.height = innerHeight * devicePixelRatio; ctx.setTransform(1,0,0,1,0,0); ctx.scale(devicePixelRatio, devicePixelRatio); }
      sizeCanvas(); addEventListener('resize', sizeCanvas);
      function confetti() {
        const N = 90; const parts = Array.from({length:N}, () => ({
          x: Math.random()*innerWidth, y: -10, r: 4+Math.random()*4, s: 6+Math.random()*6,
          c: ['#7c5cff','#ff7ac6','#2fd180','#ffb454','#9ad5ff'][Math.floor(Math.random()*5)],
          t: Math.random()*Math.PI*2
        }));
        let start = performance.now();
        function frame(now) {
          const dt = Math.min(20, now - start); start = now;
          ctx.clearRect(0,0,innerWidth,innerHeight);
          parts.forEach(p => {
            p.t += 0.1; p.y += p.s * dt/60; p.x += Math.sin(p.t) * 1.2;
            ctx.fillStyle = p.c; ctx.save(); ctx.translate(p.x, p.y); ctx.rotate(p.t/2);
            ctx.fillRect(-p.r/2, -p.r/2, p.r, p.r);
            ctx.restore();
          });
          if (parts.some(p => p.y < innerHeight+10)) requestAnimationFrame(frame);
        }
        requestAnimationFrame(frame);
      }

      // Initial render
      render();
    })();
  </script>
</body>
</html>
