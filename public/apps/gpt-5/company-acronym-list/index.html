<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Company Acronym List</title>
  <meta name="description" content="Search, learn, and quiz yourself on internal company acronyms with categories, powerful search, and a clean, responsive UI." />
  <meta name="color-scheme" content="light dark">
  <style>
    /* --- Design Tokens --- */
    :root {
      --bg: #0b1020;
      --panel: #11162a;
      --card: #131a33;
      --elev: rgba(255,255,255,0.06);
      --text: #e6e8ee;
      --muted: #b2b9cc;
      --border: rgba(255,255,255,0.12);
      --accent: #6aa9ff;
      --accent-2: #8b5cf6;
      --ok: #22c55e;
      --warn: #f59e0b;
      --err: #ef4444;
      --shadow: 0 6px 24px rgba(0,0,0,0.35), 0 2px 8px rgba(0,0,0,0.2);
      --radius: 14px;
      --radius-sm: 10px;
      --ring: 0 0 0 2px rgba(106,169,255,0.35);
      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial,
               "Apple Color Emoji", "Segoe UI Emoji";
    }
    @media (prefers-color-scheme: light) {
      :root:not([data-theme="dark"]) {
        --bg: #f6f7fb;
        --panel: #ffffff;
        --card: #ffffff;
        --elev: rgba(17, 24, 39, 0.05);
        --text: #0b1020;
        --muted: #4b5563;
        --border: rgba(8, 12, 24, 0.12);
        --accent: #2563eb;
        --accent-2: #7c3aed;
        --shadow: 0 6px 24px rgba(17,24,39,0.08), 0 2px 8px rgba(17,24,39,0.06);
      }
    }

    /* --- Base --- */
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; padding: 0; background: linear-gradient(180deg, var(--bg), color-mix(in oklab, var(--bg) 86%, #000));
      color: var(--text); font-family: var(--font); -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
    }
    a { color: var(--accent); text-decoration: none; }
    .container { max-width: 1200px; margin: 0 auto; padding: 24px; }

    /* --- Header / Nav --- */
    header {
      position: sticky; top: 0; z-index: 50; backdrop-filter: saturate(120%) blur(10px);
      background: color-mix(in oklab, var(--bg) 80%, transparent); border-bottom: 1px solid var(--border);
    }
    .brand {
      display: flex; gap: 12px; align-items: center; font-weight: 800; letter-spacing: .2px;
    }
    .brand .logo {
      width: 38px; height: 38px; border-radius: 10px; display: grid; place-items: center;
      background: conic-gradient(from 210deg, var(--accent), var(--accent-2));
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.25), var(--shadow);
    }
    .brand .title { font-size: 18px; }
    .topbar {
      display: grid; grid-template-columns: 1fr auto; gap: 16px; align-items: center; padding: 14px 24px;
    }
    .nav-tabs { display: flex; gap: 8px; align-items: center; }
    .tab {
      appearance: none; border: 1px solid var(--border); background: var(--panel); color: var(--text);
      padding: 8px 14px; border-radius: 999px; cursor: pointer; transition: transform .12s ease, background .2s ease;
    }
    .tab[aria-selected="true"] { background: color-mix(in oklab, var(--accent) 16%, var(--panel)); border-color: transparent; }
    .tab:hover { transform: translateY(-1px); }

    /* --- Controls --- */
    .controls { display: grid; grid-template-columns: 1fr auto auto; gap: 12px; align-items: center; margin-top: 8px; }
    .search {
      display: grid; grid-template-columns: 28px 1fr 28px; align-items: center;
      background: var(--panel); border: 1px solid var(--border); border-radius: 999px; overflow: hidden;
      box-shadow: var(--shadow);
    }
    .search input {
      width: 100%; background: transparent; border: 0; outline: none; color: var(--text);
      padding: 12px 6px; font-size: 15px;
    }
    .search .icon { display: grid; place-items: center; opacity: .8; }
    .btn {
      appearance: none; border: 1px solid var(--border); background: var(--panel); color: var(--text);
      padding: 10px 14px; border-radius: 10px; cursor: pointer; font-weight: 600; letter-spacing: .2px;
      transition: transform .12s ease, background .2s ease, border-color .2s ease;
    }
    .btn.primary { background: linear-gradient(180deg, color-mix(in oklab, var(--accent) 70%, #fff), var(--accent)); border-color: transparent; color: white; }
    .btn.ghost { background: transparent; }
    .btn:hover { transform: translateY(-1px); }

    /* --- Chips --- */
    .chips { display: flex; gap: 8px; flex-wrap: wrap; margin: 14px 0 2px; }
    .chip {
      display: inline-flex; gap: 8px; align-items: center; padding: 6px 12px; border-radius: 999px; cursor: pointer;
      background: color-mix(in oklab, var(--panel) 80%, transparent); border: 1px solid var(--border); color: var(--text);
      transition: background .2s ease, transform .12s ease, border-color .2s ease; user-select: none;
    }
    .chip[data-active="true"] { background: color-mix(in oklab, var(--accent) 18%, var(--panel)); border-color: transparent; }
    .chip .count { color: var(--muted); font-size: 12px; }
    .chip:hover { transform: translateY(-1px); }

    /* --- Result Summary --- */
    .meta { display: flex; gap: 12px; align-items: center; color: var(--muted); font-size: 14px; margin: 6px 2px; flex-wrap: wrap; }

    /* --- Grid --- */
    .grid { display: grid; grid-template-columns: repeat(12, 1fr); gap: 14px; align-items: stretch; }
    .col-12 { grid-column: span 12; }
    .col-6 { grid-column: span 6; }
    .col-4 { grid-column: span 4; }
    @media (max-width: 980px) { .col-4 { grid-column: span 6; } }
    @media (max-width: 640px) { .col-4, .col-6 { grid-column: span 12; } .controls { grid-template-columns: 1fr auto; } }

    /* --- Cards --- */
    .card {
      background: radial-gradient(120% 120% at 0% 0%, color-mix(in oklab, var(--card) 88%, transparent) 0%, var(--card) 60%),
                  linear-gradient(180deg, transparent, var(--elev));
      border: 1px solid var(--border); border-radius: var(--radius); box-shadow: var(--shadow);
      padding: 16px 16px 12px; position: relative; overflow: hidden;
      transition: transform .15s ease, box-shadow .2s ease, border-color .2s ease;
    }
    .card:hover { transform: translateY(-2px); border-color: color-mix(in oklab, var(--accent) 40%, var(--border)); }
    .acronym { font-size: 22px; font-weight: 800; letter-spacing: .3px; display: flex; align-items: center; gap: 8px; }
    .expansion { font-size: 15px; color: var(--muted); margin-top: 4px; }
    .definition { font-size: 14px; color: var(--text); opacity: .95; margin-top: 10px; line-height: 1.45; }
    .tags { display: flex; flex-wrap: wrap; gap: 6px; margin-top: 12px; }
    .tag { font-size: 12px; padding: 4px 8px; border-radius: 999px; border: 1px solid var(--border); color: var(--text); opacity: .9; }
    .card .actions { position: absolute; right: 10px; top: 10px; display: flex; gap: 6px; }
    .icon-btn { border: 1px solid var(--border); background: color-mix(in oklab, var(--panel) 70%, transparent); border-radius: 8px; padding: 6px; cursor: pointer; }
    .icon-btn:hover { box-shadow: var(--ring); }
    mark { background: color-mix(in oklab, var(--accent) 35%, #fff); color: black; border-radius: 4px; padding: 0 2px; }

    /* --- Empty State --- */
    .empty { text-align: center; padding: 32px; border: 1px dashed var(--border); border-radius: var(--radius); color: var(--muted); }

    /* --- Quiz --- */
    .quiz-panel { background: var(--panel); border: 1px solid var(--border); border-radius: var(--radius); box-shadow: var(--shadow); padding: 16px; }
    .quiz-hdr { display: flex; gap: 12px; align-items: center; justify-content: space-between; flex-wrap: wrap; }
    .quiz-controls { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
    .seg { display: inline-flex; background: var(--card); border: 1px solid var(--border); border-radius: 12px; overflow: hidden; }
    .seg button { background: transparent; border: 0; color: var(--text); padding: 8px 12px; cursor: pointer; }
    .seg [aria-pressed="true"] { background: color-mix(in oklab, var(--accent) 18%, var(--panel)); }
    .pill { padding: 8px 10px; border-radius: 999px; background: var(--card); border: 1px solid var(--border); }
    .quiz-stage { margin-top: 14px; }
    .q-card { background: var(--card); border: 1px solid var(--border); border-radius: var(--radius); padding: 16px; box-shadow: var(--shadow); }
    .q-stem { font-size: 18px; font-weight: 700; }
    .choices { display: grid; gap: 10px; margin-top: 14px; }
    .choice {
      background: color-mix(in oklab, var(--panel) 90%, transparent); border: 1px solid var(--border); color: var(--text);
      padding: 12px; border-radius: 12px; cursor: pointer; text-align: left; transition: transform .1s ease, border-color .2s ease;
    }
    .choice:hover { transform: translateY(-1px); border-color: color-mix(in oklab, var(--accent) 40%, var(--border)); }
    .choice[data-correct="true"] { border-color: color-mix(in oklab, var(--ok) 60%, var(--border)); background: color-mix(in oklab, var(--ok) 20%, transparent); }
    .choice[data-wrong="true"] { border-color: color-mix(in oklab, var(--err) 60%, var(--border)); background: color-mix(in oklab, var(--err) 18%, transparent); }
    .progress { height: 8px; background: color-mix(in oklab, var(--panel) 70%, transparent); border-radius: 999px; overflow: hidden; }
    .progress > div { height: 100%; background: linear-gradient(90deg, var(--accent), var(--accent-2)); width: 0%; transition: width .35s ease; }
    .stat { display: inline-flex; align-items: center; gap: 6px; padding: 6px 10px; border-radius: 999px; border: 1px solid var(--border); background: var(--panel); }
    .score-ok { color: var(--ok); }
    .score-err { color: var(--err); }

    /* --- Footer --- */
    footer { color: var(--muted); font-size: 12px; padding: 18px 24px 32px; text-align: center; }

    /* --- Utilities --- */
    .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); border: 0; }
    .flex { display: flex; }
    .gap-8 { gap: 8px; }
    .gap-10 { gap: 10px; }
    .gap-12 { gap: 12px; }
    .center { align-items: center; }
    .justify-between { justify-content: space-between; }
    .muted { color: var(--muted); }
    .right { text-align: right; }
  </style>
</head>
<body>
  <header>
    <div class="topbar container">
      <div class="brand" aria-label="Company Acronym List">
        <div class="logo" aria-hidden="true">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 2l2.7 5.46L20.8 8l-4.1 4 1 5.8L12 15.9 6.3 17.8l1-5.8L3.2 8l6.1-.54L12 2z" fill="white" opacity=".9"/>
          </svg>
        </div>
        <div class="title">Company Acronym List</div>
      </div>
      <div class="nav-tabs">
        <button id="tab-browse" class="tab" role="tab" aria-selected="true">Browse</button>
        <button id="tab-quiz" class="tab" role="tab" aria-selected="false">Quiz</button>
        <button id="themeBtn" class="tab" title="Toggle theme" aria-label="Toggle theme">
          <svg id="themeIcon" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 3a1 1 0 0 1 1 1v1a1 1 0 1 1-2 0V4a1 1 0 0 1 1-1zm0 15a1 1 0 0 1 1 1v1a1 1 0 1 1-2 0v-1a1 1 0 0 1 1-1zM4 11a1 1 0 1 1 0 2H3a1 1 0 1 1 0-2h1zm17 0a1 1 0 1 1 0 2h-1a1 1 0 1 1 0-2h1zM6.2 5.2a1 1 0 0 1 1.4 0l.7.7a1 1 0 1 1-1.4 1.4l-.7-.7a1 1 0 0 1 0-1.4zm9.5 9.5a1 1 0 0 1 1.4 0l.7.7a1 1 0 1 1-1.4 1.4l-.7-.7a1 1 0 0 1 0-1.4zM5.2 17.8a1 1 0 0 1 1.4 0l.7.7a1 1 0 1 1-1.4 1.4l-.7-.7a1 1 0 0 1 0-1.4zm9.5-9.5a1 1 0 0 1 1.4 0l.7.7a1 1 0 1 1-1.4 1.4l-.7-.7a1 1 0 0 1 0-1.4z"/>
          </svg>
        </button>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Browse Mode -->
    <section id="browse" aria-labelledby="tab-browse">
      <div class="controls">
        <label class="search" for="searchInput">
          <div class="icon" aria-hidden="true">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="11" cy="11" r="7"></circle>
              <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </svg>
          </div>
          <input id="searchInput" type="search" placeholder="Search acronyms, meanings, definitions, or tags... (press / to focus)" autocomplete="off" />
          <button id="clearSearch" class="icon" aria-label="Clear search" title="Clear">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M18.3 5.7a1 1 0 0 0-1.4 0L12 10.6 7.1 5.7A1 1 0 0 0 5.7 7.1L10.6 12l-4.9 4.9a1 1 0 1 0 1.4 1.4L12 13.4l4.9 4.9a1 1 0 0 0 1.4-1.4L13.4 12l4.9-4.9a1 1 0 0 0 0-1.4z"/></svg>
          </button>
        </label>
        <button id="resetFilters" class="btn ghost" title="Reset filters">Reset</button>
        <div class="muted right" id="resultSummary" aria-live="polite">Loading…</div>
      </div>

      <div class="chips" id="categoryChips" aria-label="Filter by category"></div>

      <div id="results" class="grid" aria-live="polite"></div>

      <div id="emptyState" class="empty" hidden>
        No results. Try adjusting your search or filters.
      </div>
    </section>

    <!-- Quiz Mode -->
    <section id="quiz" aria-labelledby="tab-quiz" hidden>
      <div class="quiz-panel">
        <div class="quiz-hdr">
          <div class="flex gap-12 center">
            <div class="seg" role="group" aria-label="Quiz type">
              <button id="qTypeMc" aria-pressed="true">Multiple Choice</button>
              <button id="qTypeType">Type Answer</button>
            </div>
            <div class="pill">Questions: <input id="qCount" type="number" min="3" max="50" value="10" style="width:64px;margin-left:6px;background:transparent;border:0;color:var(--text);font-weight:600;"/></div>
            <div class="pill">Categories: <span id="qCategoriesLabel" class="muted" style="margin-left:6px;">All</span></div>
          </div>
          <div class="quiz-controls">
            <button id="chooseCats" class="btn">Choose Categories</button>
            <button id="startQuiz" class="btn primary">Start Quiz</button>
          </div>
        </div>

        <div class="quiz-stage" id="quizStage" hidden>
          <div class="progress" aria-label="Progress"><div id="qProgress"></div></div>
          <div class="flex gap-12 center" style="margin-top:10px;">
            <div class="stat"><span id="qIndex">0</span>/<span id="qTotal">0</span></div>
            <div class="stat score-ok">✔ <span id="qCorrect">0</span></div>
            <div class="stat score-err">✖ <span id="qWrong">0</span></div>
          </div>
          <div class="q-card" style="margin-top:12px;">
            <div class="q-stem" id="qStem">What does … stand for?</div>
            <div id="qHint" class="muted" style="margin-top:6px;"></div>
            <div id="mcBlock" class="choices" style="margin-top:12px;"></div>
            <div id="typeBlock" style="margin-top:12px;" hidden>
              <label class="sr-only" for="typeInput">Your answer</label>
              <input id="typeInput" type="text" placeholder="Type the expansion…" style="width:100%;padding:12px;border-radius:12px;border:1px solid var(--border);background:var(--panel);color:var(--text);" />
              <div class="flex gap-10 center" style="margin-top:10px;">
                <button id="checkType" class="btn primary">Check</button>
                <button id="revealType" class="btn">Reveal</button>
              </div>
              <div id="typeFeedback" style="margin-top:10px;"></div>
            </div>
          </div>
          <div class="flex gap-10 center" style="margin-top:12px;">
            <button id="nextQ" class="btn" disabled>Next</button>
            <button id="restartQuiz" class="btn ghost">Restart</button>
          </div>
        </div>

        <dialog id="catDialog" style="border:0;border-radius:14px;max-width:700px;width:96%;padding:0;">
          <div style="padding:16px;background:var(--panel);color:var(--text);border:1px solid var(--border);border-radius:14px;">
            <div class="flex justify-between center">
              <div style="font-weight:800;">Choose Categories</div>
              <button id="closeCatDialog" class="icon-btn" aria-label="Close">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M18.3 5.7a1 1 0 0 0-1.4 0L12 10.6 7.1 5.7A1 1 0 0 0 5.7 7.1L10.6 12l-4.9 4.9a1 1 0 1 0 1.4 1.4L12 13.4l4.9 4.9a1 1 0 0 0 1.4-1.4L13.4 12l4.9-4.9a1 1 0 0 0 0-1.4z"/></svg>
              </button>
            </div>
            <div id="catDialogBody" class="chips" style="margin-top:10px;max-height:360px;overflow:auto;"></div>
            <div class="flex gap-10 center" style="margin-top:12px;justify-content:flex-end;">
              <button id="catsClear" class="btn ghost">Clear</button>
              <button id="catsAll" class="btn ghost">All</button>
              <button id="catsApply" class="btn primary">Apply</button>
            </div>
          </div>
        </dialog>
      </div>
    </section>
  </main>

  <footer>
    Built with vanilla HTML/CSS/JS. Keyboard tips: press "/" to focus search; in quiz, use 1–4 for choices and Enter for check/next.
  </footer>

  <script>
  ;(() => {
    // --- Utility helpers ---
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));
    const clamp = (n,min,max) => Math.max(min, Math.min(n, max));
    const debounce = (fn, ms=150) => { let t; return (...args)=>{ clearTimeout(t); t=setTimeout(()=>fn(...args), ms); } };
    const copy = async (text) => { try { await navigator.clipboard.writeText(text); toast('Copied'); } catch(e){ toast('Copy failed'); } };
    const norm = (s) => (s||'').toString().toLowerCase().normalize('NFKD').replace(/[\u0300-\u036f]/g,'').replace(/[^a-z0-9]+/g,' ').trim();
    const includesNorm = (hay, needle) => norm(hay).includes(norm(needle));
    const unique = (arr) => Array.from(new Set(arr));
    const sample = (arr, n) => {
      const a = arr.slice();
      for (let i=a.length-1; i>0; i--) { const j = Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; }
      return a.slice(0, n);
    };
    const similarity = (a,b) => { // Sorensen-Dice on bigrams
      a = norm(a); b = norm(b); if (!a && !b) return 1; if (!a || !b) return 0;
      const bigr = s => { const v=[]; for(let i=0;i<s.length-1;i++) v.push(s.slice(i,i+2)); return v; };
      const A = bigr(a), B = bigr(b); const setA = new Map();
      for (let x of A) setA.set(x, (setA.get(x)||0)+1);
      let inter = 0; const setB = new Map();
      for (let x of B) setB.set(x, (setB.get(x)||0)+1);
      for (let [k, va] of setA) { const vb = setB.get(k)||0; inter += Math.min(va, vb); }
      return (2*inter) / (A.length + B.length || 1);
    };

    // --- Toast ---
    let toastTimer; const toast = (msg) => {
      let el = $('#toast');
      if (!el) {
        el = document.createElement('div'); el.id = 'toast';
        el.style.cssText = 'position:fixed;bottom:18px;left:50%;transform:translateX(-50%);background:var(--panel);color:var(--text);border:1px solid var(--border);padding:10px 14px;border-radius:12px;box-shadow:var(--shadow);z-index:1000;opacity:0;transition:opacity .2s ease';
        document.body.appendChild(el);
      }
      el.textContent = msg; el.style.opacity = '1';
      clearTimeout(toastTimer); toastTimer = setTimeout(()=>{ el.style.opacity='0'; }, 1400);
    };

    // --- Theme ---
    const themeBtn = $('#themeBtn');
    const themeIcon = $('#themeIcon');
    const setTheme = (t) => { if (t==='dark') document.documentElement.setAttribute('data-theme','dark'); else document.documentElement.removeAttribute('data-theme'); localStorage.setItem('cal:theme', t); };
    const currentTheme = localStorage.getItem('cal:theme') || 'auto';
    setTheme(currentTheme);
    themeBtn.addEventListener('click', () => {
      const t = document.documentElement.getAttribute('data-theme')==='dark' ? 'auto' : 'dark';
      setTheme(t);
    });

    // --- Data ---
    const ACRONYMS = [
      { term:'OKR', expansion:'Objectives and Key Results', definition:'A goal-setting framework that aligns teams around measurable outcomes on a fixed cadence.', categories:['Process','Planning','Leadership']},
      { term:'KPI', expansion:'Key Performance Indicator', definition:'A quantifiable measure used to evaluate success against objectives.', categories:['Metrics','Business']},
      { term:'SLA', expansion:'Service Level Agreement', definition:'A contract that defines the level of service expected between provider and customer.', categories:['Support','Customer','Legal']},
      { term:'SLO', expansion:'Service Level Objective', definition:'A target value for a service’s reliability or performance, derived from SLAs.', categories:['SRE','Metrics']},
      { term:'SLI', expansion:'Service Level Indicator', definition:'A precise measurement of some aspect of the level of service provided.', categories:['SRE','Metrics']},
      { term:'CI', expansion:'Continuous Integration', definition:'Practice of frequently merging code changes and validating with automated tests.', categories:['Engineering','DevOps','Process']},
      { term:'CD', expansion:'Continuous Delivery', definition:'Ability to deploy changes to production safely, quickly, and sustainably.', categories:['Engineering','DevOps','Process']},
      { term:'CICD', expansion:'Continuous Integration and Continuous Delivery', definition:'Combined practice of integrating and delivering software changes rapidly.', categories:['Engineering','DevOps']},
      { term:'API', expansion:'Application Programming Interface', definition:'A set of rules that enables software components to communicate.', categories:['Engineering','Platform']},
      { term:'SDK', expansion:'Software Development Kit', definition:'Tools, libraries, and docs that help developers build for a platform.', categories:['Engineering','Platform']},
      { term:'RCA', expansion:'Root Cause Analysis', definition:'A structured process to determine the underlying cause of an incident.', categories:['Process','SRE','Postmortem']},
      { term:'RFC', expansion:'Request for Comments', definition:'A proposal document used to seek alignment and feedback before changes.', categories:['Process','Engineering']},
      { term:'PRD', expansion:'Product Requirements Document', definition:'Defines what a product or feature should do and why.', categories:['Product','Process']},
      { term:'ADR', expansion:'Architecture Decision Record', definition:'A short document capturing an important architectural decision and its context.', categories:['Engineering','Architecture']},
      { term:'SPA', expansion:'Single Page Application', definition:'A web app that loads a single HTML page and dynamically updates content.', categories:['Engineering','Web']},
      { term:'PWA', expansion:'Progressive Web App', definition:'Web apps with app-like capabilities such as offline and installability.', categories:['Engineering','Web']},
      { term:'ETL', expansion:'Extract, Transform, Load', definition:'A data integration process that moves and reshapes data into a warehouse.', categories:['Data','Analytics']},
      { term:'ELT', expansion:'Extract, Load, Transform', definition:'Loads raw data first then transforms it inside the warehouse.', categories:['Data','Analytics']},
      { term:'DWH', expansion:'Data Warehouse', definition:'A central repository optimized for analytics and reporting.', categories:['Data','Analytics']},
      { term:'ORM', expansion:'Object Relational Mapping', definition:'Technique that maps objects to relational database tables.', categories:['Engineering','Data']},
      { term:'SSO', expansion:'Single Sign-On', definition:'Authentication method that lets users access multiple systems with one login.', categories:['Security','IT']},
      { term:'MFA', expansion:'Multi-Factor Authentication', definition:'Security method requiring two or more verification factors.', categories:['Security','IT']},
      { term:'IAM', expansion:'Identity and Access Management', definition:'Policies and tools to manage digital identities and permissions.', categories:['Security','IT']},
      { term:'JWT', expansion:'JSON Web Token', definition:'A compact, signed token format for securely transmitting information.', categories:['Security','Engineering']},
      { term:'CSRF', expansion:'Cross-Site Request Forgery', definition:'An attack that tricks a user into executing unwanted actions on a site.', categories:['Security','Web']},
      { term:'XSS', expansion:'Cross-Site Scripting', definition:'An injection attack that allows execution of malicious scripts in browsers.', categories:['Security','Web']},
      { term:'GDPR', expansion:'General Data Protection Regulation', definition:'EU regulation governing data protection and privacy.', categories:['Compliance','Legal']},
      { term:'SOC 2', expansion:'System and Organization Controls 2', definition:'A compliance standard for managing customer data based on five trust principles.', categories:['Compliance','Security']},
      { term:'HIPAA', expansion:'Health Insurance Portability and Accountability Act', definition:'US law for protecting sensitive patient health information.', categories:['Compliance','Legal']},
      { term:'PCI', expansion:'Payment Card Industry', definition:'Security standards for organizations handling cardholder data.', categories:['Compliance','Security']},
      { term:'NPS', expansion:'Net Promoter Score', definition:'Customer loyalty metric derived from likelihood to recommend.', categories:['Customer','Metrics']},
      { term:'ARR', expansion:'Annual Recurring Revenue', definition:'Annualized value of subscription revenue.', categories:['Finance','SaaS']},
      { term:'MRR', expansion:'Monthly Recurring Revenue', definition:'Monthly subscription revenue recognized within a period.', categories:['Finance','SaaS']},
      { term:'CAC', expansion:'Customer Acquisition Cost', definition:'Average cost to acquire a new customer.', categories:['Finance','Marketing']},
      { term:'LTV', expansion:'Lifetime Value', definition:'Projected net profit from a customer over the relationship.', categories:['Finance','Marketing']},
      { term:'GTM', expansion:'Go-To-Market', definition:'Plan for how a company brings a product to customers.', categories:['Marketing','Sales','Strategy']},
      { term:'ACV', expansion:'Annual Contract Value', definition:'Total value of a customer contract normalized to one year.', categories:['Sales','Finance']},
      { term:'TCV', expansion:'Total Contract Value', definition:'Total value of a contract across its full term.', categories:['Sales','Finance']},
      { term:'POV', expansion:'Proof of Value', definition:'A scoped exercise to demonstrate measurable business value.', categories:['Sales','Presales']},
      { term:'POC', expansion:'Proof of Concept', definition:'A minimal implementation to validate technical feasibility.', categories:['Engineering','Presales']},
      { term:'QA', expansion:'Quality Assurance', definition:'Systematic activities to ensure product quality.', categories:['Engineering','Testing']},
      { term:'PMF', expansion:'Product-Market Fit', definition:'Degree to which a product satisfies strong market demand.', categories:['Product','Strategy']},
      { term:'TTFB', expansion:'Time To First Byte', definition:'Time from request to first byte received; a performance metric.', categories:['Performance','Web']},
      { term:'RPS', expansion:'Requests Per Second', definition:'Number of requests a system handles each second.', categories:['Performance','SRE']},
      { term:'TPS', expansion:'Transactions Per Second', definition:'Number of transactions processed each second.', categories:['Performance','SRE']},
      { term:'CS', expansion:'Customer Success', definition:'Team that helps customers achieve desired outcomes with the product.', categories:['Team','Customer']},
      { term:'SE', expansion:'Sales Engineering', definition:'Role that bridges product and sales through technical expertise.', categories:['Team','Sales']},
      { term:'AE', expansion:'Account Executive', definition:'Sales role responsible for closing business.', categories:['Team','Sales']},
      { term:'SDR', expansion:'Sales Development Representative', definition:'Prospecting role focused on pipeline generation.', categories:['Team','Sales']},
      { term:'SME', expansion:'Subject Matter Expert', definition:'An individual with deep expertise in a specific domain.', categories:['Team','Knowledge']},
      { term:'TL', expansion:'Tech Lead', definition:'Engineer responsible for technical direction and team guidance.', categories:['Team','Engineering']},
      { term:'EM', expansion:'Engineering Manager', definition:'Leader responsible for people, delivery, and quality in engineering.', categories:['Team','Engineering']},
      { term:'PM', expansion:'Product Manager', definition:'Owner of product outcomes who aligns user value with business goals.', categories:['Team','Product']},
      { term:'TPM', expansion:'Technical Program Manager', definition:'Drives cross-functional initiatives and delivery at scale.', categories:['Team','Product']},
      { term:'UX', expansion:'User Experience', definition:'Discipline focused on usability and overall product experience.', categories:['Design','Product']},
      { term:'UI', expansion:'User Interface', definition:'The visual and interactive layer a user directly engages with.', categories:['Design','Product']},
      { term:'DRI', expansion:'Directly Responsible Individual', definition:'Person ultimately accountable for a task or decision.', categories:['Process','Leadership']},
      { term:'DR', expansion:'Disaster Recovery', definition:'Policies and procedures to restore systems after a disruption.', categories:['IT','Resilience']},
      { term:'RTO', expansion:'Recovery Time Objective', definition:'Maximum acceptable time a system can be down after an incident.', categories:['IT','Resilience']},
      { term:'RPO', expansion:'Recovery Point Objective', definition:'Maximum acceptable data loss measured in time.', categories:['IT','Resilience']},
      { term:'SAST', expansion:'Static Application Security Testing', definition:'Analyzing source code for vulnerabilities without executing programs.', categories:['Security','Testing']},
      { term:'DAST', expansion:'Dynamic Application Security Testing', definition:'Testing a running application for security issues.', categories:['Security','Testing']},
      { term:'RACI', expansion:'Responsible, Accountable, Consulted, Informed', definition:'A framework that clarifies roles and responsibilities.', categories:['Process','Leadership']},
      { term:'ROI', expansion:'Return on Investment', definition:'A profitability ratio comparing gain from investment to its cost.', categories:['Finance','Business']},
      { term:'ICP', expansion:'Ideal Customer Profile', definition:'Description of the type of company that gets the most value from the product.', categories:['Marketing','Sales']},
      { term:'ABM', expansion:'Account-Based Marketing', definition:'Coordinated marketing strategy focused on a curated list of accounts.', categories:['Marketing','Sales']},
      { term:'CTR', expansion:'Click-Through Rate', definition:'The ratio of clicks to impressions for an asset.', categories:['Marketing','Metrics']},
      { term:'CVR', expansion:'Conversion Rate', definition:'Percentage of users who complete a desired action.', categories:['Marketing','Metrics']},
      { term:'CPM', expansion:'Cost Per Mille', definition:'Advertising cost per one thousand impressions.', categories:['Marketing','Metrics']},
      { term:'CPC', expansion:'Cost Per Click', definition:'Advertising cost per individual click.', categories:['Marketing','Metrics']}
    ].map((e,i) => ({ ...e, id: i+1, added: Date.now() - (i*86400000) }));

    // --- State ---
    const state = {
      search: '',
      activeCats: new Set(),
      view: 'browse', // 'quiz'
      qType: 'mc',
      qSelectedCats: new Set(),
      quiz: null,
    };

    // --- Elements ---
    const tabBrowse = $('#tab-browse');
    const tabQuiz = $('#tab-quiz');
    const sectionBrowse = $('#browse');
    const sectionQuiz = $('#quiz');
    const resultsEl = $('#results');
    const emptyEl = $('#emptyState');
    const summaryEl = $('#resultSummary');
    const searchInput = $('#searchInput');
    const clearSearch = $('#clearSearch');
    const resetFilters = $('#resetFilters');
    const chipsEl = $('#categoryChips');

    // Quiz elements
    const startQuizBtn = $('#startQuiz');
    const qTypeMcBtn = $('#qTypeMc');
    const qTypeTypeBtn = $('#qTypeType');
    const qCountInput = $('#qCount');
    const qCategoriesLabel = $('#qCategoriesLabel');
    const chooseCatsBtn = $('#chooseCats');
    const catDialog = $('#catDialog');
    const catDialogBody = $('#catDialogBody');
    const catsApply = $('#catsApply');
    const catsAll = $('#catsAll');
    const catsClear = $('#catsClear');
    const closeCatDialog = $('#closeCatDialog');

    const quizStage = $('#quizStage');
    const qProgress = $('#qProgress');
    const qIndex = $('#qIndex');
    const qTotal = $('#qTotal');
    const qCorrect = $('#qCorrect');
    const qWrong = $('#qWrong');
    const qStem = $('#qStem');
    const qHint = $('#qHint');
    const mcBlock = $('#mcBlock');
    const typeBlock = $('#typeBlock');
    const typeInput = $('#typeInput');
    const checkType = $('#checkType');
    const revealType = $('#revealType');
    const typeFeedback = $('#typeFeedback');
    const nextQ = $('#nextQ');
    const restartQuiz = $('#restartQuiz');

    // --- Build categories ---
    const ALL_CATS = unique(ACRONYMS.flatMap(a => a.categories)).sort((a,b)=>a.localeCompare(b));

    function renderCategoryChips(rootEl, activeSet, opts={showCounts:true, clickable:true}) {
      rootEl.innerHTML = '';
      const counts = {};
      for (const c of ALL_CATS) counts[c] = 0;
      for (const a of ACRONYMS) for (const c of a.categories) counts[c]++;
      for (const c of ALL_CATS) {
        const chip = document.createElement('button');
        chip.className = 'chip'; chip.setAttribute('data-active', activeSet.has(c)); chip.setAttribute('aria-pressed', activeSet.has(c));
        chip.innerHTML = `<span>${c}</span>${opts.showCounts?`<span class="count">${counts[c]}</span>`:''}`;
        if (opts.clickable) {
          chip.addEventListener('click', () => {
            if (activeSet.has(c)) activeSet.delete(c); else activeSet.add(c);
            chip.setAttribute('data-active', activeSet.has(c)); chip.setAttribute('aria-pressed', activeSet.has(c));
            if (rootEl === chipsEl) renderResults();
            updateQuizCatsLabel();
          });
        }
        rootEl.appendChild(chip);
      }
    }

    // --- Search & results ---
    const doSearch = debounce(() => { state.search = searchInput.value.trim(); renderResults(); }, 120);

    function highlight(text, q) {
      if (!q) return escapeHtml(text);
      const words = unique(norm(q).split(' ').filter(Boolean)).sort((a,b)=>b.length-a.length).slice(0,6);
      if (!words.length) return escapeHtml(text);
      let out = escapeHtml(text);
      for (const w of words) {
        const re = new RegExp(`(${w.replace(/[-/\\^$*+?.()|[\]{}]/g, '\\$&')})`, 'ig');
        out = out.replace(re, '<mark>$1</mark>');
      }
      return out;
    }
    function escapeHtml(s){ return (s+'').replace(/[&<>"']/g, m=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[m])); }

    function matchesSearch(a, q) {
      if (!q) return true; const tokens = norm(q).split(' ').filter(Boolean);
      const hay = [a.term, a.expansion, a.definition, ...(a.categories||[])].map(norm).join(' ');
      return tokens.every(t => hay.includes(t));
    }
    function matchesCats(a, cats) {
      if (!cats.size) return true; return [...cats].every(c => a.categories.includes(c));
    }

    function renderResults() {
      const q = state.search; const cats = state.activeCats;
      let items = ACRONYMS.filter(a => matchesSearch(a, q) && matchesCats(a, cats));
      items.sort((a,b) => a.term.localeCompare(b.term));
      summaryEl.textContent = `${items.length} result${items.length!==1?'s':''}${q?` for "${q}"`:''}${cats.size?` • ${cats.size} filter${cats.size>1?'s':''}`:''}`;
      resultsEl.innerHTML = '';
      emptyEl.hidden = items.length !== 0;
      if (!items.length) return;

      const frag = document.createDocumentFragment();
      for (const a of items) {
        const col = document.createElement('div'); col.className = 'col-4';
        const card = document.createElement('article'); card.className = 'card'; card.tabIndex = 0;
        const title = `<div class="acronym">${highlight(a.term, q)}</div>`;
        const expansion = `<div class="expansion">${highlight(a.expansion, q)}</div>`;
        const definition = `<div class="definition">${highlight(a.definition, q)}</div>`;
        const tags = `<div class="tags">${(a.categories||[]).map(t=>`<button class="tag" title="Filter by ${escapeHtml(t)}" data-tag="${escapeHtml(t)}">${highlight(t, q)}</button>`).join('')}</div>`;
        const actions = `<div class="actions">
            <button class="icon-btn" title="Copy acronym" data-copy="${escapeHtml(a.term)}" aria-label="Copy acronym">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M16 1H6a2 2 0 0 0-2 2v12h2V3h10V1zm3 4H10a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h9a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2zm0 16H10V7h9v14z"/></svg>
            </button>
            <button class="icon-btn" title="Copy expansion" data-copy="${escapeHtml(a.expansion)}" aria-label="Copy expansion">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M19 21H8a2 2 0 0 1-2-2V6h2v13h11v2zM17 3H5a2 2 0 0 0-2 2v12h2V5h12V3zm3 4H9a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"/></svg>
            </button>
          </div>`;
        card.innerHTML = `${actions}${title}${expansion}${definition}${tags}`;
        card.addEventListener('click', (e) => {
          const t = e.target; if (t.closest('[data-copy]')) return; // handled elsewhere
          if (t.closest('.tag')) return; // handled elsewhere
        });
        col.appendChild(card); frag.appendChild(col);
      }
      resultsEl.appendChild(frag);

      // wire tag filters and copy
      $$('[data-copy]', resultsEl).forEach(btn => btn.addEventListener('click', (e)=>{
        e.stopPropagation(); copy(btn.getAttribute('data-copy'));
      }));
      $$('.tag', resultsEl).forEach(tagEl => tagEl.addEventListener('click', (e)=>{
        e.stopPropagation(); const tag = tagEl.getAttribute('data-tag');
        if (state.activeCats.has(tag)) state.activeCats.delete(tag); else state.activeCats.add(tag);
        // Reflect selection in top chips as well
        $$('button.chip', chipsEl).forEach(ch => { const c = ch.textContent.trim().replace(/\s\d+$/, ''); ch.setAttribute('data-active', state.activeCats.has(c)); ch.setAttribute('aria-pressed', state.activeCats.has(c)); });
        renderResults();
      }));
    }

    // --- Quiz logic ---
    function updateQuizCatsLabel() {
      const arr = [...state.qSelectedCats];
      qCategoriesLabel.textContent = arr.length ? arr.join(', ') : 'All';
    }

    function openCatDialog() {
      // Build selectable chips based on ALL_CATS
      catDialogBody.innerHTML = '';
      const active = new Set(state.qSelectedCats);
      renderCategoryChips(catDialogBody, active, {showCounts:true, clickable:true});
      // override handler to just toggle active set
      $$('.chip', catDialogBody).forEach(ch => ch.addEventListener('click', () => {
        const name = ch.querySelector('span').textContent; // first span is name
        if (active.has(name)) active.delete(name); else active.add(name);
      }));
      catsApply.onclick = () => { state.qSelectedCats = active; updateQuizCatsLabel(); catDialog.close(); };
      catsAll.onclick = () => { state.qSelectedCats = new Set(); updateQuizCatsLabel(); catDialog.close(); };
      catsClear.onclick = () => { active.clear(); };
      catDialog.showModal();
    }

    function startQuiz() {
      const pool = ACRONYMS.filter(a => !state.qSelectedCats.size || [...state.qSelectedCats].every(c => a.categories.includes(c)));
      const total = clamp(parseInt(qCountInput.value, 10) || 10, 3, 50);
      if (pool.length < Math.min(4, total)) { toast('Not enough items in chosen categories'); return; }

      const questions = sample(pool, Math.min(total, pool.length)).map(stem => ({ stem }));
      state.quiz = {
        pool, questions, index: 0, correct: 0, wrong: 0, done: false,
        type: state.qType,
      };
      quizStage.hidden = false; nextQ.disabled = true; typeFeedback.innerHTML = '';
      qTotal.textContent = questions.length; qCorrect.textContent = 0; qWrong.textContent = 0; qIndex.textContent = 0; qHint.textContent = '';
      showQuestion();
    }

    function buildChoices(correct, pool) {
      const others = sample(pool.filter(a => a.term !== correct.term), 8);
      const picks = sample([correct, ...sample(others, 3)], 4);
      return picks;
    }

    function showQuestion() {
      const quiz = state.quiz; if (!quiz) return;
      const i = quiz.index; const q = quiz.questions[i]; const stem = q.stem;
      qIndex.textContent = i+1; qStem.textContent = `What does ${stem.term} stand for?`;
      qHint.textContent = `Hint: ${stem.definition}`;
      qProgress.style.width = `${((i)/quiz.questions.length)*100}%`;
      nextQ.disabled = true; typeFeedback.innerHTML = '';

      if (quiz.type === 'mc') {
        typeBlock.hidden = true; mcBlock.innerHTML = ''; mcBlock.style.display = 'grid';
        const choices = buildChoices(stem, quiz.pool);
        choices.forEach((choice) => {
          const btn = document.createElement('button');
          btn.className = 'choice'; btn.innerHTML = `<strong>${escapeHtml(choice.expansion)}</strong>`;
          btn.addEventListener('click', () => {
            const correct = choice === stem; // clicked
            $$('.choice', mcBlock).forEach(c => c.disabled = true);
            btn.setAttribute('data-' + (correct? 'correct':'wrong'), 'true');
            if (!correct) {
              // highlight the correct one
              $$('.choice', mcBlock).forEach(b => { if (b.textContent.trim() === stem.expansion) b.setAttribute('data-correct','true'); });
            }
            if (correct) { state.quiz.correct++; qCorrect.textContent = state.quiz.correct; } else { state.quiz.wrong++; qWrong.textContent = state.quiz.wrong; }
            nextQ.disabled = false; nextQ.focus();
          });
          mcBlock.appendChild(btn);
        });
      } else {
        mcBlock.style.display = 'none'; typeBlock.hidden = false; typeInput.value = ''; typeInput.focus();
      }
    }

    function nextQuestion() {
      const quiz = state.quiz; if (!quiz) return;
      if (quiz.index < quiz.questions.length - 1) {
        quiz.index++; showQuestion();
      } else {
        finishQuiz();
      }
    }

    function finishQuiz() {
      const quiz = state.quiz; if (!quiz) return;
      quiz.done = true; qProgress.style.width = '100%';
      const total = quiz.questions.length; const pct = Math.round((quiz.correct/total)*100);
      mcBlock.innerHTML = ''; typeBlock.hidden = true; qStem.textContent = `Done! Score: ${quiz.correct}/${total} (${pct}%)`;
      qHint.textContent = quiz.wrong ? `Review missed: ${quiz.wrong} question${quiz.wrong>1?'s':''}.` : 'Perfect run — great job!';
      nextQ.disabled = true;
      // store summary
      try {
        const key = `cal:quiz:${quiz.type}:${[...state.qSelectedCats].sort().join(',')||'all'}`;
        const hist = JSON.parse(localStorage.getItem(key)||'[]');
        hist.unshift({ at: Date.now(), score: pct, total, correct: quiz.correct, wrong: quiz.wrong });
        localStorage.setItem(key, JSON.stringify(hist.slice(0,20)));
      } catch {}
    }

    function checkTyped() {
      const quiz = state.quiz; if (!quiz) return;
      const user = typeInput.value.trim(); if (!user) { toast('Type an answer'); return; }
      const expected = quiz.questions[quiz.index].stem.expansion;
      const sim = similarity(user, expected);
      let verdict = ''; let color = '';
      if (sim >= 0.88) { verdict = 'Correct'; color = 'var(--ok)'; quiz.correct++; qCorrect.textContent = quiz.correct; }
      else if (sim >= 0.72) { verdict = 'Close enough'; color = 'var(--warn)'; quiz.correct++; qCorrect.textContent = quiz.correct; }
      else { verdict = 'Not quite'; color = 'var(--err)'; quiz.wrong++; qWrong.textContent = quiz.wrong; }
      typeFeedback.innerHTML = `<div style="padding:10px;border-radius:12px;border:1px solid var(--border);background:var(--panel);"><div style="color:${color};font-weight:800;margin-bottom:6px;">${verdict}</div><div class="muted">Expected: <strong>${escapeHtml(expected)}</strong></div></div>`;
      nextQ.disabled = false; nextQ.focus();
    }

    // --- Events ---
    tabBrowse.addEventListener('click', ()=>{ state.view='browse'; sectionBrowse.hidden=false; sectionQuiz.hidden=true; tabBrowse.setAttribute('aria-selected','true'); tabQuiz.setAttribute('aria-selected','false'); });
    tabQuiz.addEventListener('click', ()=>{ state.view='quiz'; sectionBrowse.hidden=true; sectionQuiz.hidden=false; tabBrowse.setAttribute('aria-selected','false'); tabQuiz.setAttribute('aria-selected','true'); });

    searchInput.addEventListener('input', doSearch);
    clearSearch.addEventListener('click', ()=>{ searchInput.value=''; doSearch(); searchInput.focus(); });
    resetFilters.addEventListener('click', ()=>{ searchInput.value=''; state.activeCats.clear(); $$('button.chip', chipsEl).forEach(ch=>{ ch.setAttribute('data-active','false'); ch.setAttribute('aria-pressed','false'); }); renderResults(); searchInput.focus(); });

    // keyboard shortcuts
    window.addEventListener('keydown', (e) => {
      if (e.key === '/' && document.activeElement.tagName !== 'INPUT') { e.preventDefault(); searchInput.focus(); }
      if (state.view === 'quiz' && !quizStage.hidden) {
        if (state.quiz?.type === 'mc') {
          if (['1','2','3','4'].includes(e.key)) {
            const i = parseInt(e.key)-1; const btn = $$('.choice', mcBlock)[i]; if (btn && !btn.disabled) btn.click();
          }
        } else if (state.quiz?.type === 'type') {
          if (e.key === 'Enter' && !nextQ.disabled) { nextQuestion(); }
          else if (e.key === 'Enter') { checkTyped(); }
        }
        if (e.key.toLowerCase() === 'n' && !nextQ.disabled) nextQuestion();
      }
    });

    chipsEl.addEventListener('wheel', (e)=>{ if (Math.abs(e.deltaX) < Math.abs(e.deltaY)) return; e.preventDefault(); chipsEl.scrollLeft += e.deltaX; }, { passive:false });

    // Quiz controls
    qTypeMcBtn.addEventListener('click', ()=>{ state.qType='mc'; qTypeMcBtn.setAttribute('aria-pressed','true'); qTypeTypeBtn.setAttribute('aria-pressed','false'); });
    qTypeTypeBtn.addEventListener('click', ()=>{ state.qType='type'; qTypeMcBtn.setAttribute('aria-pressed','false'); qTypeTypeBtn.setAttribute('aria-pressed','true'); });
    chooseCatsBtn.addEventListener('click', openCatDialog);
    closeCatDialog.addEventListener('click', ()=>catDialog.close());
    startQuizBtn.addEventListener('click', startQuiz);
    nextQ.addEventListener('click', nextQuestion);
    restartQuiz.addEventListener('click', startQuiz);
    checkType.addEventListener('click', checkTyped);
    revealType.addEventListener('click', () => {
      const ans = state.quiz?.questions[state.quiz.index].stem.expansion; typeFeedback.innerHTML = `<div class="muted">Answer: <strong>${escapeHtml(ans||'')}</strong></div>`; typeInput.focus();
    });

    // --- Init ---
    renderCategoryChips(chipsEl, state.activeCats, {showCounts:true, clickable:true});
    renderResults(); updateQuizCatsLabel();

  })();
  </script>
</body>
</html>
