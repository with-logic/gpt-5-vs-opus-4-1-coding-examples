<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Custom QR Code Generator</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #f4f1ea;
      --panel: #fffdf8;
      --ink: #1f1c16;
      --muted: #6a6358;
      --accent: #1f6f78;
      --accent-soft: #d9ecef;
      --ring: rgba(31, 111, 120, 0.28);
      --shadow: 0 14px 40px rgba(48, 34, 7, 0.08);
      --radius: 18px;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: "Space Grotesk", system-ui, -apple-system, Segoe UI, sans-serif;
      color: var(--ink);
      background:
        radial-gradient(circle at 10% 20%, #f8e9c8 0%, transparent 38%),
        radial-gradient(circle at 90% 12%, #d8ecf0 0%, transparent 32%),
        radial-gradient(circle at 80% 90%, #fde3cd 0%, transparent 36%),
        var(--bg);
      display: grid;
      place-items: center;
      padding: 24px;
    }

    .app {
      width: min(980px, 100%);
      background: var(--panel);
      border: 1px solid rgba(48, 34, 7, 0.08);
      border-radius: calc(var(--radius) + 6px);
      box-shadow: var(--shadow);
      overflow: hidden;
      display: grid;
      grid-template-columns: minmax(300px, 1fr) minmax(340px, 1.25fr);
      animation: rise 700ms ease;
    }

    @keyframes rise {
      from { opacity: 0; transform: translateY(8px) scale(0.99); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }

    .controls {
      padding: 28px;
      border-right: 1px solid rgba(48, 34, 7, 0.08);
      display: grid;
      gap: 18px;
      align-content: start;
      background: linear-gradient(180deg, #fffdf8 0%, #fff8ee 100%);
    }

    h1 {
      margin: 0;
      font-size: 1.45rem;
      letter-spacing: 0.01em;
    }

    .subtitle {
      margin: 0;
      color: var(--muted);
      font-size: 0.95rem;
      line-height: 1.4;
    }

    .field {
      display: grid;
      gap: 8px;
    }

    label {
      font-size: 0.88rem;
      font-weight: 600;
      letter-spacing: 0.01em;
    }

    textarea,
    input[type="text"] {
      width: 100%;
      border: 1px solid rgba(48, 34, 7, 0.18);
      border-radius: 12px;
      padding: 12px 13px;
      font: inherit;
      color: var(--ink);
      background: #fff;
      outline: none;
      transition: border-color 140ms ease, box-shadow 140ms ease;
    }

    textarea {
      min-height: 110px;
      resize: vertical;
    }

    textarea:focus,
    input[type="text"]:focus,
    input[type="color"]:focus-visible,
    button:focus-visible {
      border-color: var(--accent);
      box-shadow: 0 0 0 4px var(--ring);
    }

    .color-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .color-field {
      display: grid;
      gap: 8px;
    }

    input[type="color"] {
      -webkit-appearance: none;
      appearance: none;
      width: 100%;
      height: 46px;
      border: 1px solid rgba(48, 34, 7, 0.18);
      border-radius: 12px;
      padding: 4px;
      background: #fff;
      cursor: pointer;
    }

    input[type="color"]::-webkit-color-swatch-wrapper { padding: 0; }
    input[type="color"]::-webkit-color-swatch,
    input[type="color"]::-moz-color-swatch {
      border: 0;
      border-radius: 8px;
    }

    .actions {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 2px;
    }

    button {
      border: 0;
      border-radius: 12px;
      padding: 12px 14px;
      font: inherit;
      font-weight: 700;
      cursor: pointer;
      transition: transform 120ms ease, filter 120ms ease;
    }

    button:active { transform: translateY(1px); }

    #generateBtn {
      background: var(--accent);
      color: #fff;
    }

    #generateBtn:hover { filter: brightness(1.05); }

    #downloadBtn {
      background: var(--accent-soft);
      color: #12434a;
    }

    #downloadBtn:hover { filter: brightness(0.98); }

    .status {
      min-height: 18px;
      margin: 0;
      color: var(--muted);
      font-size: 0.86rem;
    }

    .preview {
      padding: 28px;
      display: grid;
      place-items: center;
      background:
        linear-gradient(0deg, rgba(31, 111, 120, 0.05), rgba(31, 111, 120, 0.05)),
        repeating-linear-gradient(45deg, rgba(255, 255, 255, 0.6) 0 10px, rgba(255, 255, 255, 0.9) 10px 20px);
    }

    .qr-frame {
      width: min(100%, 560px);
      aspect-ratio: 1;
      border-radius: 22px;
      background: #fff;
      border: 1px solid rgba(0, 0, 0, 0.08);
      display: grid;
      place-items: center;
      padding: 16px;
      box-shadow:
        0 24px 34px rgba(0, 0, 0, 0.08),
        inset 0 0 0 1px rgba(255, 255, 255, 0.8);
      position: relative;
      overflow: hidden;
    }

    .qr-frame::after {
      content: "";
      position: absolute;
      inset: 8px;
      border-radius: 16px;
      border: 1px dashed rgba(0, 0, 0, 0.08);
      pointer-events: none;
    }

    #qrCanvas {
      width: 100%;
      height: 100%;
      image-rendering: pixelated;
      border-radius: 12px;
      animation: pop 260ms ease;
    }

    @keyframes pop {
      from { transform: scale(0.985); opacity: 0.7; }
      to { transform: scale(1); opacity: 1; }
    }

    @media (max-width: 860px) {
      .app {
        grid-template-columns: 1fr;
      }

      .controls {
        border-right: 0;
        border-bottom: 1px solid rgba(48, 34, 7, 0.08);
      }

      .qr-frame {
        width: min(100%, 500px);
      }
    }
  </style>
</head>
<body>
  <main class="app" aria-label="Custom QR Code Generator">
    <section class="controls">
      <div>
        <h1>Custom QR Code Generator</h1>
        <p class="subtitle">Generate a QR code from any text or URL, customize colors, and download a high-resolution PNG.</p>
      </div>

      <div class="field">
        <label for="contentInput">Text or URL</label>
        <textarea id="contentInput" placeholder="https://example.com">https://example.com</textarea>
      </div>

      <div class="color-row">
        <div class="color-field">
          <label for="fgColor">Foreground</label>
          <input id="fgColor" type="color" value="#1f1c16" />
        </div>
        <div class="color-field">
          <label for="bgColor">Background</label>
          <input id="bgColor" type="color" value="#ffffff" />
        </div>
      </div>

      <div class="actions">
        <button id="generateBtn" type="button">Generate</button>
        <button id="downloadBtn" type="button">Download PNG</button>
      </div>

      <p id="status" class="status" aria-live="polite"></p>
    </section>

    <section class="preview">
      <div class="qr-frame">
        <canvas id="qrCanvas" width="1200" height="1200" aria-label="QR code preview"></canvas>
      </div>
    </section>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>
  <script>
    (function () {
      const contentInput = document.getElementById('contentInput');
      const fgColorInput = document.getElementById('fgColor');
      const bgColorInput = document.getElementById('bgColor');
      const generateBtn = document.getElementById('generateBtn');
      const downloadBtn = document.getElementById('downloadBtn');
      const status = document.getElementById('status');
      const canvas = document.getElementById('qrCanvas');
      const ctx = canvas.getContext('2d');

      function setStatus(message, isError) {
        status.textContent = message;
        status.style.color = isError ? '#a12b2b' : '';
      }

      function generateQRCode() {
        const text = contentInput.value.trim();
        const fg = fgColorInput.value;
        const bg = bgColorInput.value;

        if (!text) {
          setStatus('Enter text or a URL to generate your QR code.', true);
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          return;
        }

        try {
          const qr = qrcode(0, 'M');
          qr.addData(text);
          qr.make();

          const count = qr.getModuleCount();
          const marginModules = 4;
          const totalModules = count + marginModules * 2;
          const moduleSize = canvas.width / totalModules;

          ctx.fillStyle = bg;
          ctx.fillRect(0, 0, canvas.width, canvas.height);

          ctx.fillStyle = fg;
          for (let row = 0; row < count; row++) {
            for (let col = 0; col < count; col++) {
              if (!qr.isDark(row, col)) continue;
              const x = Math.round((col + marginModules) * moduleSize);
              const y = Math.round((row + marginModules) * moduleSize);
              const w = Math.ceil(moduleSize);
              const h = Math.ceil(moduleSize);
              ctx.fillRect(x, y, w, h);
            }
          }

          setStatus('QR code generated. Ready to download.');
        } catch (err) {
          setStatus('Unable to generate QR code. Try shorter text.', true);
        }
      }

      function downloadPNG() {
        const text = contentInput.value.trim();
        if (!text) {
          setStatus('Generate a QR code before downloading.', true);
          return;
        }

        const url = canvas.toDataURL('image/png');
        const a = document.createElement('a');
        a.href = url;
        a.download = 'custom-qr-code.png';
        a.click();
        setStatus('PNG downloaded.');
      }

      generateBtn.addEventListener('click', generateQRCode);
      downloadBtn.addEventListener('click', downloadPNG);

      [contentInput, fgColorInput, bgColorInput].forEach((el) => {
        el.addEventListener('input', () => {
          if (!contentInput.value.trim()) {
            setStatus('');
            return;
          }
          generateQRCode();
        });
      });

      generateQRCode();
    })();
  </script>
</body>
</html>
