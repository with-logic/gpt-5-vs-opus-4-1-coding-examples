<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Equation Solver Tool</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@400;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/mathjs@12.4.2/lib/browser/math.js"></script>
  <style>
    :root {
      --bg: #f8f7f4;
      --paper: #fcfbf8;
      --ink: #1f2a34;
      --muted: #5f6b74;
      --line: #d9d6cf;
      --accent: #23384d;
      --accent-soft: #e9eef3;
      --ok: #214f2e;
      --warn: #9e3c2f;
      --shadow: 0 6px 20px rgba(24, 39, 51, 0.08);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: "Libre Baskerville", Georgia, serif;
      color: var(--ink);
      background:
        radial-gradient(circle at 15% 8%, rgba(35, 56, 77, 0.08), transparent 35%),
        radial-gradient(circle at 88% 100%, rgba(77, 62, 35, 0.07), transparent 32%),
        var(--bg);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 22px;
    }

    .card {
      width: min(900px, 100%);
      background: linear-gradient(180deg, #fff 0%, var(--paper) 100%);
      border: 1px solid var(--line);
      border-radius: 14px;
      box-shadow: var(--shadow);
      overflow: hidden;
    }

    .header {
      padding: 26px 26px 14px;
      border-bottom: 1px solid var(--line);
      background: linear-gradient(180deg, rgba(35, 56, 77, 0.06), transparent 80%);
    }

    .title {
      margin: 0;
      font-size: clamp(1.35rem, 2.8vw, 1.75rem);
      letter-spacing: 0.015em;
    }

    .subtitle {
      margin: 8px 0 0;
      color: var(--muted);
      font-size: 0.95rem;
      line-height: 1.45;
    }

    .main {
      padding: 22px 26px 26px;
      display: grid;
      gap: 16px;
    }

    .input-row {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 12px;
    }

    .equation-input {
      width: 100%;
      border: 1px solid #bfc4c8;
      background: #fff;
      color: var(--ink);
      border-radius: 10px;
      padding: 12px 14px;
      font: 500 0.98rem/1.2 "IBM Plex Mono", ui-monospace, Menlo, monospace;
      outline: none;
      transition: border-color 0.18s ease, box-shadow 0.18s ease;
    }

    .equation-input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(35, 56, 77, 0.15);
    }

    .solve-btn,
    .export-btn,
    .copy-btn {
      border: 1px solid var(--accent);
      background: var(--accent);
      color: #fff;
      font: 600 0.9rem/1 "IBM Plex Mono", ui-monospace, monospace;
      letter-spacing: 0.02em;
      border-radius: 10px;
      padding: 0 16px;
      min-height: 44px;
      cursor: pointer;
      transition: transform 0.12s ease, filter 0.12s ease, background 0.12s ease;
    }

    .solve-btn:hover,
    .export-btn:hover,
    .copy-btn:hover {
      filter: brightness(1.08);
    }

    .solve-btn:active,
    .export-btn:active,
    .copy-btn:active {
      transform: translateY(1px);
    }

    .hint {
      margin-top: -6px;
      color: var(--muted);
      font-size: 0.83rem;
      line-height: 1.4;
    }

    .panel {
      border: 1px solid var(--line);
      border-radius: 12px;
      background: #fff;
      padding: 16px;
      display: grid;
      gap: 12px;
    }

    .result {
      margin: 0;
      border-left: 4px solid var(--accent);
      background: var(--accent-soft);
      border-radius: 8px;
      padding: 10px 12px;
      font-size: 0.95rem;
      line-height: 1.5;
    }

    .result strong {
      font-family: "IBM Plex Mono", ui-monospace, monospace;
    }

    .steps-title {
      margin: 0;
      font-size: 1rem;
    }

    .steps {
      margin: 0;
      padding-left: 1.2rem;
      display: grid;
      gap: 8px;
      line-height: 1.55;
      color: #2a3742;
    }

    .steps li {
      padding-left: 0.2rem;
    }

    .code {
      font-family: "IBM Plex Mono", ui-monospace, monospace;
      background: #f2f4f6;
      border: 1px solid #dde1e5;
      border-radius: 6px;
      padding: 0.1em 0.35em;
      font-size: 0.92em;
    }

    .status {
      margin: 0;
      min-height: 1.2em;
      font-size: 0.84rem;
      color: var(--muted);
    }

    .status.error {
      color: var(--warn);
    }

    .status.success {
      color: var(--ok);
    }

    .export-row {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .copy-btn {
      border-color: #6c7b88;
      background: #6c7b88;
    }

    .export-btn:disabled,
    .copy-btn:disabled {
      opacity: 0.45;
      cursor: not-allowed;
      filter: none;
      transform: none;
    }

    .footer {
      margin-top: 4px;
      padding-top: 12px;
      border-top: 1px dashed var(--line);
      color: var(--muted);
      font-size: 0.8rem;
      line-height: 1.45;
    }

    @media (max-width: 660px) {
      .header,
      .main {
        padding-left: 18px;
        padding-right: 18px;
      }

      .input-row {
        grid-template-columns: 1fr;
      }

      .solve-btn {
        width: 100%;
      }

      .export-row {
        display: grid;
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <main class="card" aria-labelledby="app-title">
    <header class="header">
      <h1 class="title" id="app-title">Equation Solver Tool</h1>
      <p class="subtitle">Solve equations and review each algebraic step. Designed for clean, academic work with exportable results.</p>
    </header>

    <section class="main">
      <div class="input-row">
        <input id="equationInput" class="equation-input" type="text" spellcheck="false" placeholder="Examples: 2x + 5 = 17, x^2 - 5x + 6 = 0, (3+4)*2" aria-label="Equation input" />
        <button id="solveBtn" class="solve-btn" type="button">Solve</button>
      </div>
      <p class="hint">Supported: expressions, linear equations in <span class="code">x</span>, and quadratic equations in <span class="code">x</span>. You may write <span class="code">2x</span> (auto-converted to <span class="code">2*x</span>).</p>

      <article class="panel" aria-live="polite">
        <p class="result" id="resultBox"><strong>Result:</strong> Enter an equation to begin.</p>
        <h2 class="steps-title">Step-by-step breakdown</h2>
        <ol class="steps" id="stepsList">
          <li>Type an equation and click <span class="code">Solve</span>.</li>
        </ol>
        <p class="status" id="status"></p>

        <div class="export-row">
          <button id="exportBtn" class="export-btn" type="button" disabled>Export as .txt</button>
          <button id="copyBtn" class="copy-btn" type="button" disabled>Copy summary</button>
        </div>

        <div class="footer">
          <div>Notation: all computations are symbolic where possible; numeric values are rounded for readability when needed.</div>
        </div>
      </article>
    </section>
  </main>

  <script>
    (function () {
      const inputEl = document.getElementById('equationInput');
      const solveBtn = document.getElementById('solveBtn');
      const resultBox = document.getElementById('resultBox');
      const stepsList = document.getElementById('stepsList');
      const statusEl = document.getElementById('status');
      const exportBtn = document.getElementById('exportBtn');
      const copyBtn = document.getElementById('copyBtn');

      let latestReport = null;

      function setStatus(message, type) {
        statusEl.textContent = message || '';
        statusEl.className = 'status' + (type ? ' ' + type : '');
      }

      function formatNumber(value, digits = 8) {
        if (!Number.isFinite(value)) return String(value);
        const tiny = Math.abs(value) < 1e-12 ? 0 : value;
        const rounded = Number(tiny.toFixed(digits));
        return String(rounded);
      }

      function normalizeInput(raw) {
        let s = String(raw || '').trim();
        s = s.replace(/[–—]/g, '-');
        s = s.replace(/\s+/g, '');
        s = s.replace(/(\d)([a-zA-Z(])/g, '$1*$2');
        s = s.replace(/\)([\dA-Za-z])/g, ')*$1');
        s = s.replace(/([a-zA-Z])(\d)/g, '$1*$2');
        return s;
      }

      function evaluateSafe(expr, scope) {
        const v = math.evaluate(expr, scope);
        if (typeof v !== 'number' || !Number.isFinite(v)) {
          throw new Error('Expression does not evaluate to a real finite number.');
        }
        return v;
      }

      function extractQuadraticCoefficients(expr) {
        const checks = [0, 1, 2, 3, 4].map((x) => evaluateSafe(expr, { x }));
        const c = checks[0];
        const a = (checks[2] - 2 * checks[1] + checks[0]) / 2;
        const b = checks[1] - a - c;

        const approx = (x) => a * x * x + b * x + c;
        const tolerance = 1e-8;
        for (let i = 3; i < checks.length; i += 1) {
          if (Math.abs(approx(i) - checks[i]) > tolerance) {
            return null;
          }
        }
        return { a, b, c };
      }

      function ensureOnlyX(expr) {
        const node = math.parse(expr);
        let invalid = null;
        node.traverse(function (n) {
          if (n.type === 'SymbolNode' && n.name !== 'x' && n.name !== 'e' && n.name !== 'pi') {
            invalid = n.name;
          }
        });
        return invalid;
      }

      function solveExpression(expr) {
        const steps = [];
        steps.push('Recognize input as an arithmetic expression (no equals sign).');
        const simplified = math.simplify(expr).toString();
        steps.push('Simplify the expression: ' + simplified + '.');
        const value = evaluateSafe(simplified, {});
        steps.push('Evaluate numerically to obtain ' + formatNumber(value) + '.');

        return {
          kind: 'Expression',
          resultText: formatNumber(value),
          steps,
          exportText: [
            'Equation Solver Tool',
            'Type: Expression',
            'Input: ' + expr,
            'Simplified: ' + simplified,
            'Result: ' + formatNumber(value)
          ].join('\n')
        };
      }

      function solveEquation(rawEq) {
        const steps = [];
        const parts = rawEq.split('=');
        if (parts.length !== 2 || !parts[0] || !parts[1]) {
          throw new Error('Please enter one valid equation with a single equals sign, e.g. 2x+5=17.');
        }

        const left = parts[0];
        const right = parts[1];
        steps.push('Start with the equation: ' + left + ' = ' + right + '.');

        const merged = '(' + left + ')-(' + right + ')';
        const invalidSymbol = ensureOnlyX(merged);
        if (invalidSymbol) {
          throw new Error('Unsupported variable "' + invalidSymbol + '". Use only x.');
        }

        const simplified = math.simplify(merged).toString();
        steps.push('Move all terms to the left side: ' + simplified + ' = 0.');

        const coeffs = extractQuadraticCoefficients(simplified);
        if (!coeffs) {
          throw new Error('This solver currently supports linear/quadratic equations in x.');
        }

        const a = Math.abs(coeffs.a) < 1e-10 ? 0 : coeffs.a;
        const b = Math.abs(coeffs.b) < 1e-10 ? 0 : coeffs.b;
        const c = Math.abs(coeffs.c) < 1e-10 ? 0 : coeffs.c;

        steps.push('Identify coefficients in ax^2 + bx + c = 0: a=' + formatNumber(a) + ', b=' + formatNumber(b) + ', c=' + formatNumber(c) + '.');

        if (a === 0) {
          if (b === 0) {
            if (c === 0) {
              steps.push('The equation reduces to 0 = 0, so every real x is a solution.');
              return {
                kind: 'Identity',
                resultText: 'All real numbers satisfy the equation.',
                steps,
                exportText: [
                  'Equation Solver Tool',
                  'Type: Identity equation',
                  'Input: ' + rawEq,
                  'Reduced form: ' + simplified + ' = 0',
                  'Result: Infinite solutions (all real numbers)'
                ].join('\n')
              };
            }
            steps.push('The equation reduces to ' + formatNumber(c) + ' = 0, which is impossible.');
            return {
              kind: 'Contradiction',
              resultText: 'No solution.',
              steps,
              exportText: [
                'Equation Solver Tool',
                'Type: Contradiction equation',
                'Input: ' + rawEq,
                'Reduced form: ' + simplified + ' = 0',
                'Result: No solution'
              ].join('\n')
            };
          }

          steps.push('Since a=0 and b!=0, this is linear: bx + c = 0.');
          const x = -c / b;
          steps.push('Isolate x: x = -c/b = -(' + formatNumber(c) + ')/' + formatNumber(b) + ' = ' + formatNumber(x) + '.');

          return {
            kind: 'Linear equation',
            resultText: 'x = ' + formatNumber(x),
            steps,
            exportText: [
              'Equation Solver Tool',
              'Type: Linear equation',
              'Input: ' + rawEq,
              'Reduced form: ' + simplified + ' = 0',
              'Coefficients: a=' + formatNumber(a) + ', b=' + formatNumber(b) + ', c=' + formatNumber(c),
              'Result: x = ' + formatNumber(x)
            ].join('\n')
          };
        }

        const d = b * b - 4 * a * c;
        steps.push('Compute the discriminant: Delta = b^2 - 4ac = ' + formatNumber(d) + '.');

        if (Math.abs(d) < 1e-10) {
          const x = -b / (2 * a);
          steps.push('Delta = 0, so there is one repeated real root.');
          steps.push('x = -b/(2a) = ' + formatNumber(x) + '.');
          return {
            kind: 'Quadratic equation',
            resultText: 'x1 = x2 = ' + formatNumber(x),
            steps,
            exportText: [
              'Equation Solver Tool',
              'Type: Quadratic equation',
              'Input: ' + rawEq,
              'Reduced form: ' + simplified + ' = 0',
              'Coefficients: a=' + formatNumber(a) + ', b=' + formatNumber(b) + ', c=' + formatNumber(c),
              'Discriminant: ' + formatNumber(d),
              'Result: x1 = x2 = ' + formatNumber(x)
            ].join('\n')
          };
        }

        if (d > 0) {
          const sqrtD = Math.sqrt(d);
          const x1 = (-b + sqrtD) / (2 * a);
          const x2 = (-b - sqrtD) / (2 * a);
          steps.push('Delta > 0, so there are two distinct real roots.');
          steps.push('x1 = (-b + sqrt(Delta))/(2a) = ' + formatNumber(x1) + '.');
          steps.push('x2 = (-b - sqrt(Delta))/(2a) = ' + formatNumber(x2) + '.');
          return {
            kind: 'Quadratic equation',
            resultText: 'x1 = ' + formatNumber(x1) + ', x2 = ' + formatNumber(x2),
            steps,
            exportText: [
              'Equation Solver Tool',
              'Type: Quadratic equation',
              'Input: ' + rawEq,
              'Reduced form: ' + simplified + ' = 0',
              'Coefficients: a=' + formatNumber(a) + ', b=' + formatNumber(b) + ', c=' + formatNumber(c),
              'Discriminant: ' + formatNumber(d),
              'Result: x1 = ' + formatNumber(x1) + ', x2 = ' + formatNumber(x2)
            ].join('\n')
          };
        }

        const sqrtAbsD = Math.sqrt(Math.abs(d));
        const realPart = -b / (2 * a);
        const imagPart = sqrtAbsD / (2 * a);
        steps.push('Delta < 0, so roots are complex conjugates.');
        steps.push('x1 = ' + formatNumber(realPart) + ' + ' + formatNumber(Math.abs(imagPart)) + 'i.');
        steps.push('x2 = ' + formatNumber(realPart) + ' - ' + formatNumber(Math.abs(imagPart)) + 'i.');

        return {
          kind: 'Quadratic equation',
          resultText: 'x1 = ' + formatNumber(realPart) + ' + ' + formatNumber(Math.abs(imagPart)) + 'i, x2 = ' + formatNumber(realPart) + ' - ' + formatNumber(Math.abs(imagPart)) + 'i',
          steps,
          exportText: [
            'Equation Solver Tool',
            'Type: Quadratic equation',
            'Input: ' + rawEq,
            'Reduced form: ' + simplified + ' = 0',
            'Coefficients: a=' + formatNumber(a) + ', b=' + formatNumber(b) + ', c=' + formatNumber(c),
            'Discriminant: ' + formatNumber(d),
            'Result: x1 = ' + formatNumber(realPart) + ' + ' + formatNumber(Math.abs(imagPart)) + 'i, x2 = ' + formatNumber(realPart) + ' - ' + formatNumber(Math.abs(imagPart)) + 'i'
          ].join('\n')
        };
      }

      function renderReport(report) {
        resultBox.innerHTML = '<strong>Result:</strong> [' + report.kind + '] ' + report.resultText;
        stepsList.innerHTML = '';
        report.steps.forEach(function (stepText) {
          const li = document.createElement('li');
          li.textContent = stepText;
          stepsList.appendChild(li);
        });
        latestReport = report;
        exportBtn.disabled = false;
        copyBtn.disabled = false;
      }

      function resetView(message) {
        resultBox.innerHTML = '<strong>Result:</strong> ' + message;
        stepsList.innerHTML = '<li>Check your input format and try again.</li>';
        exportBtn.disabled = true;
        copyBtn.disabled = true;
        latestReport = null;
      }

      function solve() {
        setStatus('', '');
        const raw = inputEl.value;
        const normalized = normalizeInput(raw);

        if (!normalized) {
          resetView('Please enter an expression or equation.');
          setStatus('Input is empty.', 'error');
          return;
        }

        try {
          const report = normalized.includes('=') ? solveEquation(normalized) : solveExpression(normalized);
          renderReport(report);
          setStatus('Solved successfully.', 'success');
        } catch (err) {
          resetView(err && err.message ? err.message : 'Unable to solve this input.');
          setStatus('Could not solve. Review the equation syntax.', 'error');
        }
      }

      function exportText() {
        if (!latestReport) return;
        const now = new Date();
        const timestamp = now.toISOString().replace('T', ' ').replace('Z', ' UTC');
        const content = latestReport.exportText + '\nGenerated: ' + timestamp + '\n';
        const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'equation-solution.txt';
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
        setStatus('Exported equation-solution.txt', 'success');
      }

      async function copySummary() {
        if (!latestReport) return;
        const now = new Date();
        const timestamp = now.toISOString().replace('T', ' ').replace('Z', ' UTC');
        const content = latestReport.exportText + '\nGenerated: ' + timestamp;
        try {
          await navigator.clipboard.writeText(content);
          setStatus('Summary copied to clipboard.', 'success');
        } catch (_) {
          setStatus('Clipboard access failed in this browser context.', 'error');
        }
      }

      solveBtn.addEventListener('click', solve);
      inputEl.addEventListener('keydown', function (event) {
        if (event.key === 'Enter') solve();
      });
      exportBtn.addEventListener('click', exportText);
      copyBtn.addEventListener('click', copySummary);

      inputEl.value = 'x^2 - 5x + 6 = 0';
      solve();
    })();
  </script>
</body>
</html>
