<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Employee Skills Matrix</title>
  <style>
    :root {
      --bg: #f5f7fb;
      --card: #ffffff;
      --ink: #1f2a44;
      --muted: #5f6b85;
      --line: #d9deea;
      --primary: #0a66c2;
      --primary-soft: #e7f2ff;
      --accent: #0f9d8a;
      --risk: #d93025;
      --warn: #f39c12;
      --neutral: #808ca3;
      --radius: 14px;
      --shadow: 0 10px 30px rgba(31, 42, 68, 0.08);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: "Avenir Next", "Segoe UI", "Helvetica Neue", sans-serif;
      background:
        radial-gradient(circle at 10% -10%, #dfeeff 0%, transparent 40%),
        radial-gradient(circle at 100% 0%, #e9fff9 0%, transparent 35%),
        var(--bg);
      color: var(--ink);
      min-height: 100vh;
    }

    .container {
      width: min(1320px, 94vw);
      margin: 28px auto 40px;
      display: grid;
      gap: 20px;
    }

    .hero {
      background: linear-gradient(130deg, #0f2d5c 0%, #0a66c2 52%, #0f9d8a 100%);
      border-radius: var(--radius);
      padding: 22px 24px;
      color: #fff;
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
    }

    .hero::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(to right, rgba(255,255,255,.08), transparent 35%);
      pointer-events: none;
    }

    .hero h1 {
      margin: 0;
      font-size: clamp(1.4rem, 2.4vw, 2rem);
      letter-spacing: 0.3px;
    }

    .hero p {
      margin: 6px 0 0;
      color: rgba(255, 255, 255, 0.9);
      max-width: 80ch;
      font-size: 0.98rem;
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(4, minmax(170px, 1fr));
      gap: 12px;
      margin-top: 16px;
    }

    .stat {
      background: rgba(255,255,255,0.14);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 12px;
      padding: 10px 12px;
      backdrop-filter: blur(2px);
    }

    .stat .label {
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.8px;
      opacity: 0.9;
    }

    .stat .value {
      font-size: 1.35rem;
      font-weight: 700;
      margin-top: 3px;
    }

    .panel {
      background: var(--card);
      border-radius: var(--radius);
      border: 1px solid var(--line);
      box-shadow: var(--shadow);
      padding: 16px;
    }

    .controls {
      display: grid;
      grid-template-columns: 1.4fr 1fr 1fr auto;
      gap: 10px;
      align-items: end;
    }

    .field {
      display: grid;
      gap: 6px;
    }

    .field label {
      font-size: 0.78rem;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.6px;
      font-weight: 600;
    }

    input[type="search"], select, button {
      font: inherit;
      border-radius: 10px;
      border: 1px solid var(--line);
      padding: 9px 11px;
      background: #fff;
      color: var(--ink);
    }

    input[type="search"]:focus, select:focus {
      outline: 2px solid #b5d8ff;
      border-color: #83bfff;
    }

    button {
      cursor: pointer;
      font-weight: 600;
      transition: transform .08s ease, box-shadow .15s ease, background .15s ease;
    }

    button:active { transform: translateY(1px); }

    .btn-primary {
      background: var(--primary);
      border-color: var(--primary);
      color: #fff;
    }

    .btn-primary:hover { background: #0956a0; }

    .btn-muted {
      background: #f4f7fc;
      color: #2b3b5f;
    }

    .matrix-wrap {
      overflow: auto;
      border: 1px solid var(--line);
      border-radius: 12px;
    }

    table {
      border-collapse: separate;
      border-spacing: 0;
      width: 100%;
      min-width: 860px;
      background: #fff;
    }

    thead th {
      position: sticky;
      top: 0;
      z-index: 2;
      background: #edf4fe;
      color: #163969;
      font-size: 0.86rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      border-bottom: 1px solid #c6d8ef;
      padding: 11px 10px;
      text-align: left;
      white-space: nowrap;
    }

    tbody td, tbody th {
      border-bottom: 1px solid #ebeff8;
      padding: 8px 10px;
      vertical-align: middle;
      background: #fff;
    }

    tbody tr:nth-child(odd) td,
    tbody tr:nth-child(odd) th {
      background: #fcfdff;
    }

    tbody th {
      position: sticky;
      left: 0;
      z-index: 1;
      background: #f7fbff;
      font-size: 0.92rem;
      font-weight: 700;
      color: #234;
      min-width: 190px;
      border-right: 1px solid #e6edf8;
    }

    .skill-meta {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .skill-group {
      font-size: .75rem;
      color: var(--muted);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: .5px;
    }

    .level {
      width: 100%;
      min-width: 120px;
      padding: 7px 8px;
      font-size: .9rem;
      border-radius: 8px;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 72px;
      padding: 3px 9px;
      font-size: 0.75rem;
      font-weight: 700;
      border-radius: 999px;
      border: 1px solid transparent;
      letter-spacing: .2px;
    }

    .lvl-0 { background: #f0f3fa; color: #5a6987; border-color: #dde4f0; }
    .lvl-1 { background: #fff5e9; color: #8f5400; border-color: #ffd7a0; }
    .lvl-2 { background: #eef8ff; color: #12518f; border-color: #b8dbff; }
    .lvl-3 { background: #e9f9f6; color: #086756; border-color: #ade8dc; }
    .lvl-4 { background: #e6f6eb; color: #1d6a2c; border-color: #bde3c8; }

    .insights {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }

    .box {
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 12px;
      background: #fff;
    }

    .box h3 {
      margin: 0 0 8px;
      font-size: 0.96rem;
      color: #1f3860;
    }

    .list {
      margin: 0;
      padding: 0;
      list-style: none;
      display: grid;
      gap: 8px;
    }

    .list li {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      align-items: center;
      font-size: 0.9rem;
      border: 1px solid #edf1f8;
      background: #fafcff;
      border-radius: 10px;
      padding: 8px 9px;
    }

    .bar {
      height: 8px;
      border-radius: 999px;
      background: #e9edf6;
      overflow: hidden;
      margin-top: 6px;
    }

    .bar > span {
      display: block;
      height: 100%;
      background: linear-gradient(90deg, #0a66c2, #0f9d8a);
    }

    .legend {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      margin-top: 10px;
    }

    .legend small { color: var(--muted); }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    @media (max-width: 1040px) {
      .stats { grid-template-columns: repeat(2, minmax(170px, 1fr)); }
      .controls { grid-template-columns: 1fr 1fr; }
      .insights { grid-template-columns: 1fr; }
    }

    @media (max-width: 720px) {
      .container { margin-top: 16px; }
      .hero { padding: 16px; }
      .stats { grid-template-columns: 1fr; }
      .controls { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <main class="container" aria-label="Employee Skills Matrix Application">
    <section class="hero">
      <h1>Employee Skills Matrix</h1>
      <p>HR capability dashboard for identifying skill coverage, bench strength, and development priorities across your team.</p>
      <div class="stats" id="stats" aria-live="polite"></div>
    </section>

    <section class="panel" aria-label="Matrix controls">
      <div class="controls">
        <div class="field">
          <label for="search">Search skills or employees</label>
          <input id="search" type="search" placeholder="e.g. Workforce planning, Ava Patel" autocomplete="off" />
        </div>
        <div class="field">
          <label for="deptFilter">Department</label>
          <select id="deptFilter"></select>
        </div>
        <div class="field">
          <label for="focusFilter">Focus view</label>
          <select id="focusFilter">
            <option value="all">All Skills</option>
            <option value="gaps">Critical Gaps (avg < 2.0)</option>
            <option value="strong">Strong Coverage (avg >= 3.0)</option>
          </select>
        </div>
        <button id="resetBtn" class="btn-muted" type="button">Reset Filters</button>
      </div>

      <div class="legend" aria-label="Proficiency legend">
        <small>Proficiency Scale:</small>
        <span class="chip lvl-0">0 None</span>
        <span class="chip lvl-1">1 Basic</span>
        <span class="chip lvl-2">2 Working</span>
        <span class="chip lvl-3">3 Advanced</span>
        <span class="chip lvl-4">4 Expert</span>
      </div>
    </section>

    <section class="panel" aria-label="Skills matrix table">
      <div class="matrix-wrap">
        <table>
          <thead>
            <tr id="tableHeadRow"></tr>
          </thead>
          <tbody id="matrixBody"></tbody>
        </table>
      </div>
    </section>

    <section class="insights">
      <article class="box">
        <h3>Coverage by Skill</h3>
        <ul class="list" id="skillCoverageList"></ul>
      </article>
      <article class="box">
        <h3>Development Priorities</h3>
        <ul class="list" id="priorityList"></ul>
      </article>
    </section>
  </main>

  <script>
    const levelLabels = ["None", "Basic", "Working", "Advanced", "Expert"];

    const employees = [
      { id: "e1", name: "Ava Patel", role: "HR Business Partner", dept: "People Ops" },
      { id: "e2", name: "Marcus Liu", role: "Talent Acquisition Lead", dept: "Talent" },
      { id: "e3", name: "Sofia Reed", role: "L&D Specialist", dept: "Learning" },
      { id: "e4", name: "Jonah Morales", role: "Compensation Analyst", dept: "Comp & Benefits" },
      { id: "e5", name: "Elena Park", role: "HR Analyst", dept: "People Ops" },
      { id: "e6", name: "Nora Benson", role: "Employee Relations Manager", dept: "People Ops" }
    ];

    const skills = [
      { id: "s1", name: "Workforce Planning", group: "Strategy" },
      { id: "s2", name: "Succession Design", group: "Strategy" },
      { id: "s3", name: "Recruiting Analytics", group: "Talent" },
      { id: "s4", name: "Interview Calibration", group: "Talent" },
      { id: "s5", name: "Learning Program Design", group: "Learning" },
      { id: "s6", name: "Compensation Benchmarking", group: "Comp & Benefits" },
      { id: "s7", name: "Benefits Compliance", group: "Comp & Benefits" },
      { id: "s8", name: "Conflict Resolution", group: "Employee Relations" },
      { id: "s9", name: "HRIS Reporting", group: "Operations" },
      { id: "s10", name: "Policy Development", group: "Governance" }
    ];

    const ratings = {
      s1: { e1: 3, e2: 2, e3: 2, e4: 1, e5: 2, e6: 2 },
      s2: { e1: 2, e2: 1, e3: 2, e4: 1, e5: 1, e6: 2 },
      s3: { e1: 1, e2: 4, e3: 2, e4: 1, e5: 3, e6: 1 },
      s4: { e1: 2, e2: 4, e3: 1, e4: 1, e5: 2, e6: 2 },
      s5: { e1: 2, e2: 1, e3: 4, e4: 1, e5: 2, e6: 2 },
      s6: { e1: 1, e2: 1, e3: 0, e4: 4, e5: 2, e6: 1 },
      s7: { e1: 2, e2: 1, e3: 1, e4: 3, e5: 2, e6: 2 },
      s8: { e1: 3, e2: 2, e3: 2, e4: 1, e5: 2, e6: 4 },
      s9: { e1: 2, e2: 3, e3: 2, e4: 2, e5: 4, e6: 2 },
      s10:{ e1: 3, e2: 2, e3: 2, e4: 2, e5: 3, e6: 3 }
    };

    const state = {
      search: "",
      dept: "all",
      focus: "all"
    };

    const els = {
      stats: document.getElementById("stats"),
      tableHeadRow: document.getElementById("tableHeadRow"),
      matrixBody: document.getElementById("matrixBody"),
      search: document.getElementById("search"),
      deptFilter: document.getElementById("deptFilter"),
      focusFilter: document.getElementById("focusFilter"),
      resetBtn: document.getElementById("resetBtn"),
      skillCoverageList: document.getElementById("skillCoverageList"),
      priorityList: document.getElementById("priorityList")
    };

    function init() {
      buildDepartmentFilter();
      wireEvents();
      render();
    }

    function buildDepartmentFilter() {
      const depts = [...new Set(employees.map(e => e.dept))].sort();
      els.deptFilter.innerHTML = `<option value="all">All Departments</option>${depts.map(d => `<option value="${d}">${d}</option>`).join("")}`;
    }

    function wireEvents() {
      els.search.addEventListener("input", (e) => {
        state.search = e.target.value.trim().toLowerCase();
        render();
      });
      els.deptFilter.addEventListener("change", (e) => {
        state.dept = e.target.value;
        render();
      });
      els.focusFilter.addEventListener("change", (e) => {
        state.focus = e.target.value;
        render();
      });
      els.resetBtn.addEventListener("click", () => {
        state.search = "";
        state.dept = "all";
        state.focus = "all";
        els.search.value = "";
        els.deptFilter.value = "all";
        els.focusFilter.value = "all";
        render();
      });
    }

    function getFilteredEmployees() {
      return employees.filter(e => state.dept === "all" || e.dept === state.dept);
    }

    function skillAverage(skillId, employeeSet) {
      if (!employeeSet.length) return 0;
      const sum = employeeSet.reduce((acc, emp) => acc + (ratings[skillId][emp.id] ?? 0), 0);
      return sum / employeeSet.length;
    }

    function expertCount(skillId, employeeSet) {
      return employeeSet.filter(emp => (ratings[skillId][emp.id] ?? 0) >= 3).length;
    }

    function getVisibleSkills(employeeSet) {
      return skills.filter(skill => {
        const avg = skillAverage(skill.id, employeeSet);
        const matchesFocus =
          state.focus === "all" ||
          (state.focus === "gaps" && avg < 2) ||
          (state.focus === "strong" && avg >= 3);

        const blob = [
          skill.name,
          skill.group,
          ...employeeSet.map(e => e.name),
          ...employeeSet.map(e => e.role)
        ].join(" ").toLowerCase();

        const matchesSearch = !state.search || blob.includes(state.search);
        return matchesFocus && matchesSearch;
      });
    }

    function render() {
      const visibleEmployees = getFilteredEmployees();
      const visibleSkills = getVisibleSkills(visibleEmployees);

      renderStats(visibleEmployees, visibleSkills);
      renderTable(visibleEmployees, visibleSkills);
      renderInsights(visibleEmployees, visibleSkills);
    }

    function renderStats(visibleEmployees, visibleSkills) {
      const ratedCells = visibleSkills.length * visibleEmployees.length;
      const scoreSum = visibleSkills.reduce((acc, skill) => {
        return acc + visibleEmployees.reduce((a, e) => a + (ratings[skill.id][e.id] ?? 0), 0);
      }, 0);

      const average = ratedCells ? (scoreSum / ratedCells) : 0;
      const highCoverage = visibleSkills.filter(skill => expertCount(skill.id, visibleEmployees) >= 2).length;
      const criticalGaps = visibleSkills.filter(skill => skillAverage(skill.id, visibleEmployees) < 2).length;

      const tiles = [
        { label: "Employees in View", value: visibleEmployees.length },
        { label: "Skills in Matrix", value: visibleSkills.length },
        { label: "Average Proficiency", value: average.toFixed(2) },
        { label: "Critical Skill Gaps", value: criticalGaps }
      ];

      els.stats.innerHTML = tiles.map(tile => `
        <div class="stat">
          <div class="label">${tile.label}</div>
          <div class="value">${tile.value}</div>
        </div>
      `).join("");
    }

    function renderTable(visibleEmployees, visibleSkills) {
      els.tableHeadRow.innerHTML = `
        <th scope="col">Skill</th>
        ${visibleEmployees.map(emp => `<th scope="col">${emp.name}<br><span style="font-size:.74rem;font-weight:600;opacity:.8">${emp.role}</span></th>`).join("")}
        <th scope="col">Coverage</th>
      `;

      if (!visibleEmployees.length) {
        els.matrixBody.innerHTML = `<tr><th colspan="2">No employees match this department filter.</th></tr>`;
        return;
      }

      if (!visibleSkills.length) {
        els.matrixBody.innerHTML = `<tr><th colspan="${visibleEmployees.length + 2}">No skills match current filters.</th></tr>`;
        return;
      }

      const rows = visibleSkills.map(skill => {
        const avg = skillAverage(skill.id, visibleEmployees);
        const pct = Math.round((avg / 4) * 100);

        const cells = visibleEmployees.map(emp => {
          const val = ratings[skill.id][emp.id] ?? 0;
          const options = levelLabels.map((label, idx) => `<option value="${idx}" ${idx === val ? "selected" : ""}>${idx} ${label}</option>`).join("");
          return `<td>
            <label class="sr-only" for="${skill.id}_${emp.id}">${skill.name} - ${emp.name}</label>
            <select id="${skill.id}_${emp.id}" class="level lvl-${val}" data-skill="${skill.id}" data-employee="${emp.id}" aria-label="${skill.name} proficiency for ${emp.name}">
              ${options}
            </select>
          </td>`;
        }).join("");

        return `
          <tr>
            <th scope="row">
              <div class="skill-meta">
                <span>${skill.name}</span>
                <span class="skill-group">${skill.group}</span>
              </div>
            </th>
            ${cells}
            <td>
              <span class="chip ${avg < 2 ? "lvl-1" : avg < 3 ? "lvl-2" : "lvl-3"}">${avg.toFixed(2)}</span>
              <div class="bar" aria-hidden="true"><span style="width:${pct}%"></span></div>
            </td>
          </tr>
        `;
      }).join("");

      els.matrixBody.innerHTML = rows;

      els.matrixBody.querySelectorAll("select.level").forEach(select => {
        select.addEventListener("change", (e) => {
          const skillId = e.target.dataset.skill;
          const employeeId = e.target.dataset.employee;
          const next = Number(e.target.value);
          ratings[skillId][employeeId] = next;
          e.target.className = `level lvl-${next}`;
          render();
        });
      });
    }

    function renderInsights(visibleEmployees, visibleSkills) {
      const orderedSkills = visibleSkills
        .map(skill => ({
          ...skill,
          avg: skillAverage(skill.id, visibleEmployees),
          experts: expertCount(skill.id, visibleEmployees)
        }))
        .sort((a, b) => a.avg - b.avg);

      const coverageItems = orderedSkills.map(skill => {
        const pct = Math.round((skill.avg / 4) * 100);
        return `<li>
          <div>
            <strong>${skill.name}</strong><br>
            <small style="color:var(--muted)">${skill.experts} advanced/expert contributors</small>
          </div>
          <div style="min-width:130px;text-align:right">
            <span class="chip ${skill.avg < 2 ? "lvl-1" : skill.avg < 3 ? "lvl-2" : "lvl-3"}">${skill.avg.toFixed(2)}</span>
            <div class="bar"><span style="width:${pct}%"></span></div>
          </div>
        </li>`;
      }).join("");

      els.skillCoverageList.innerHTML = coverageItems || `<li>No coverage data in this view.</li>`;

      const priorities = orderedSkills
        .filter(skill => skill.avg < 2.4)
        .slice(0, 4)
        .map(skill => {
          const atRisk = visibleEmployees.filter(emp => (ratings[skill.id][emp.id] ?? 0) <= 1).length;
          return `<li>
            <div>
              <strong>${skill.name}</strong><br>
              <small style="color:var(--muted)">${skill.group}</small>
            </div>
            <div style="text-align:right">
              <span class="chip lvl-1">${atRisk} at-risk</span>
            </div>
          </li>`;
        }).join("");

      els.priorityList.innerHTML = priorities || `<li><span>Coverage is strong across visible skills.</span><span class="chip lvl-3">No urgent gaps</span></li>`;
    }

    init();
  </script>
</body>
</html>
