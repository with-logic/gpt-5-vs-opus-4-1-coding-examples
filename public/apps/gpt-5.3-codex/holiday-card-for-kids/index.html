<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Holiday Card for Kids</title>
  <style>
    :root {
      --bg-top: #0f2044;
      --bg-mid: #193a7a;
      --bg-bot: #2b6db8;
      --card: #fff4dd;
      --accent: #ff5f7e;
      --accent-2: #32c5a9;
      --gold: #ffd66e;
      --shadow: 0 16px 40px rgba(6, 18, 40, 0.35);
      --radius: 26px;
    }

    * { box-sizing: border-box; }

    html, body {
      margin: 0;
      height: 100%;
      font-family: "Comic Sans MS", "Trebuchet MS", "Marker Felt", cursive, sans-serif;
      overflow: hidden;
      color: #1c2543;
      background: linear-gradient(180deg, var(--bg-top), var(--bg-mid) 55%, var(--bg-bot));
    }

    .aurora {
      position: fixed;
      inset: 0;
      pointer-events: none;
      background:
        radial-gradient(circle at 12% 12%, rgba(152, 255, 219, 0.24), transparent 28%),
        radial-gradient(circle at 86% 22%, rgba(255, 182, 238, 0.16), transparent 33%),
        radial-gradient(circle at 50% 75%, rgba(162, 229, 255, 0.18), transparent 38%);
      filter: blur(12px);
      animation: floatGlow 9s ease-in-out infinite alternate;
    }

    @keyframes floatGlow {
      from { transform: translateY(-10px) scale(1.01); }
      to { transform: translateY(12px) scale(1.04); }
    }

    #snow {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 2;
    }

    .app {
      position: relative;
      z-index: 3;
      height: 100%;
      display: grid;
      grid-template-rows: auto 1fr auto;
      gap: 10px;
      padding: 12px;
    }

    .topbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      color: #f5fbff;
      text-shadow: 0 2px 8px rgba(0,0,0,0.35);
      padding: 2px 8px;
      user-select: none;
    }

    .title {
      font-size: clamp(1.2rem, 2.5vw, 2rem);
      letter-spacing: 0.02em;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .controls {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    button {
      border: 0;
      border-radius: 999px;
      padding: 10px 14px;
      font-weight: 700;
      font-family: inherit;
      cursor: pointer;
      box-shadow: 0 6px 18px rgba(9, 20, 54, 0.28);
      transition: transform .12s ease, filter .18s ease;
      color: #1e214f;
      background: linear-gradient(145deg, #fff9d8, #ffd66e);
    }

    button:hover { filter: brightness(1.05); }
    button:active { transform: translateY(2px) scale(0.99); }

    .layout {
      min-height: 0;
      display: grid;
      grid-template-columns: 1fr minmax(220px, 27vw);
      gap: 12px;
      align-items: stretch;
    }

    .card-wrap {
      min-height: 0;
      position: relative;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      background:
        linear-gradient(180deg, rgba(255,255,255,0.95), rgba(255,255,255,0.82)),
        repeating-linear-gradient(45deg, rgba(255, 148, 170, .07) 0 12px, rgba(255, 215, 130, .07) 12px 24px);
      overflow: hidden;
      border: 3px solid rgba(255,255,255,0.42);
    }

    .lights {
      position: absolute;
      inset: 0;
      pointer-events: none;
      border-radius: var(--radius);
    }

    .lights::before {
      content: "";
      position: absolute;
      inset: 6px;
      border-radius: calc(var(--radius) - 6px);
      border: 7px dotted transparent;
      border-image: conic-gradient(from 0deg,
          #ff6f95 0% 15%, #72f5d2 15% 30%, #f8cf56 30% 45%, #85a9ff 45% 60%, #ffa56b 60% 75%, #b6ff71 75% 90%, #ff6f95 90% 100%) 1;
      opacity: .9;
      animation: spinLights 16s linear infinite;
    }

    @keyframes spinLights { to { transform: rotate(360deg); } }

    .card {
      position: absolute;
      inset: 0;
      padding: clamp(14px, 2.5vw, 28px);
      overflow: hidden;
      touch-action: none;
      user-select: none;
    }

    .greeting {
      position: absolute;
      top: clamp(16px, 3vh, 32px);
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
      width: 90%;
      pointer-events: none;
    }

    .greeting h1 {
      margin: 0;
      font-size: clamp(1.4rem, 4.2vw, 3.2rem);
      color: #d63866;
      text-shadow: 0 3px 0 #ffe1eb, 0 8px 20px rgba(213, 56, 102, 0.28);
    }

    .greeting p {
      margin: 8px 0 0;
      font-size: clamp(.9rem, 2vw, 1.4rem);
      color: #21497c;
      font-weight: 700;
    }

    .msg {
      position: absolute;
      bottom: clamp(16px, 2.2vh, 24px);
      width: 100%;
      text-align: center;
      color: #26558a;
      font-size: clamp(0.9rem, 1.6vw, 1.2rem);
      font-weight: 700;
      text-shadow: 0 1px 1px rgba(255,255,255,0.8);
      pointer-events: none;
    }

    .palette {
      min-height: 0;
      border-radius: 22px;
      padding: 12px;
      background: linear-gradient(180deg, rgba(255,255,255,.95), rgba(255,243,223,.92));
      box-shadow: var(--shadow);
      border: 2px solid rgba(255,255,255,0.5);
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .palette h2 {
      margin: 0;
      color: #244d86;
      font-size: 1.05rem;
      text-align: center;
    }

    .hint {
      margin: 0;
      font-size: .88rem;
      color: #4f5c7c;
      text-align: center;
      font-weight: 700;
    }

    .stickers {
      min-height: 0;
      overflow: auto;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(58px, 1fr));
      gap: 10px;
      padding: 6px;
      align-content: start;
    }

    .sticker {
      position: absolute;
      width: 68px;
      height: 68px;
      display: grid;
      place-items: center;
      font-size: 38px;
      background: radial-gradient(circle at 35% 25%, #ffffff, #ffeecb 68%);
      border: 2px solid rgba(255, 214, 110, 0.8);
      border-radius: 18px;
      box-shadow: 0 8px 16px rgba(26, 38, 67, 0.2);
      cursor: grab;
      transform-origin: center;
      transition: transform .12s ease;
      touch-action: none;
    }

    .sticker.in-palette {
      position: relative;
      width: 58px;
      height: 58px;
      font-size: 32px;
      border-radius: 15px;
      cursor: pointer;
      margin: 0 auto;
    }

    .sticker:active { cursor: grabbing; }
    .sticker:hover { transform: scale(1.08) rotate(-3deg); }
    .sticker.dragging { transform: scale(1.13) rotate(6deg); z-index: 999; }

    .sparkle {
      position: absolute;
      width: 14px;
      height: 14px;
      border-radius: 50%;
      pointer-events: none;
      background: radial-gradient(circle, #fffef9 0, #ffe27e 52%, rgba(255,226,126,0) 72%);
      filter: drop-shadow(0 0 8px #ffecad);
      animation: pop .8s ease-out forwards;
      z-index: 998;
    }

    @keyframes pop {
      from { opacity: .95; transform: scale(.6) translateY(0); }
      to { opacity: 0; transform: scale(2.2) translateY(-18px); }
    }

    .footer {
      color: #eef8ff;
      text-align: center;
      text-shadow: 0 2px 8px rgba(0, 0, 0, .34);
      font-weight: 700;
      font-size: .95rem;
      letter-spacing: .01em;
      user-select: none;
    }

    .shake { animation: shake .42s ease; }
    @keyframes shake {
      0% { transform: translateX(0); }
      25% { transform: translateX(-6px) rotate(-1deg); }
      50% { transform: translateX(6px) rotate(1deg); }
      75% { transform: translateX(-4px) rotate(-.4deg); }
      100% { transform: translateX(0); }
    }

    @media (max-width: 920px) {
      .layout {
        grid-template-columns: 1fr;
        grid-template-rows: 1fr minmax(210px, 35vh);
      }
      .palette h2 { font-size: 1rem; }
      .stickers { grid-template-columns: repeat(auto-fill, minmax(52px, 1fr)); }
      .sticker.in-palette { width: 52px; height: 52px; font-size: 29px; }
    }
  </style>
</head>
<body>
  <div class="aurora"></div>
  <canvas id="snow"></canvas>

  <div class="app">
    <header class="topbar">
      <div class="title">üéÑ Holiday Card Fun üéÅ</div>
      <div class="controls">
        <button id="jingleBtn" type="button">Play Jingle</button>
        <button id="shakeBtn" type="button">Snow Burst</button>
        <button id="muteBtn" type="button">Sound: On</button>
      </div>
    </header>

    <main class="layout">
      <section class="card-wrap" aria-label="Holiday card scene">
        <div class="lights"></div>
        <div class="card" id="card">
          <div class="greeting">
            <h1>Happy Holidays!</h1>
            <p>Drag cute goodies onto the card and make magic!</p>
          </div>
          <div class="msg">Tap anywhere for sparkles ‚ú®</div>

          <div class="sticker" data-emoji="üéÖ" style="left: 6%; top: 58%;">üéÖ</div>
          <div class="sticker" data-emoji="üéÑ" style="left: 76%; top: 56%;">üéÑ</div>
          <div class="sticker" data-emoji="üß∏" style="left: 30%; top: 66%;">üß∏</div>
          <div class="sticker" data-emoji="‚≠ê" style="left: 62%; top: 26%;">‚≠ê</div>
          <div class="sticker" data-emoji="üç™" style="left: 18%; top: 32%;">üç™</div>
        </div>
      </section>

      <aside class="palette" aria-label="Sticker palette">
        <h2>Sticker Basket</h2>
        <p class="hint">Drag from here to decorate your card!</p>
        <div class="stickers" id="palette">
          <div class="sticker in-palette" data-emoji="üéÅ">üéÅ</div>
          <div class="sticker in-palette" data-emoji="ü¶å">ü¶å</div>
          <div class="sticker in-palette" data-emoji="‚õÑ">‚õÑ</div>
          <div class="sticker in-palette" data-emoji="‚ùÑÔ∏è">‚ùÑÔ∏è</div>
          <div class="sticker in-palette" data-emoji="üß¶">üß¶</div>
          <div class="sticker in-palette" data-emoji="üßÅ">üßÅ</div>
          <div class="sticker in-palette" data-emoji="üç≠">üç≠</div>
          <div class="sticker in-palette" data-emoji="ü¶Ñ">ü¶Ñ</div>
          <div class="sticker in-palette" data-emoji="üêß">üêß</div>
          <div class="sticker in-palette" data-emoji="üåü">üåü</div>
          <div class="sticker in-palette" data-emoji="üíù">üíù</div>
          <div class="sticker in-palette" data-emoji="üç¨">üç¨</div>
          <div class="sticker in-palette" data-emoji="üõ∑">üõ∑</div>
          <div class="sticker in-palette" data-emoji="ü•õ">ü•õ</div>
          <div class="sticker in-palette" data-emoji="üêª">üêª</div>
          <div class="sticker in-palette" data-emoji="üéÄ">üéÄ</div>
          <div class="sticker in-palette" data-emoji="üßô‚Äç‚ôÄÔ∏è">üßô‚Äç‚ôÄÔ∏è</div>
          <div class="sticker in-palette" data-emoji="üåà">üåà</div>
          <div class="sticker in-palette" data-emoji="ü™Ñ">ü™Ñ</div>
          <div class="sticker in-palette" data-emoji="üç´">üç´</div>
        </div>
      </aside>
    </main>

    <div class="footer">Tip: move stickers around and press "Play Jingle" for a mini holiday tune!</div>
  </div>

  <script>
    (() => {
      const card = document.getElementById('card');
      const palette = document.getElementById('palette');
      const jingleBtn = document.getElementById('jingleBtn');
      const shakeBtn = document.getElementById('shakeBtn');
      const muteBtn = document.getElementById('muteBtn');

      let zCounter = 20;
      let muted = false;

      const audio = {
        ctx: null,
        ensure() {
          if (this.ctx) return this.ctx;
          const Ctx = window.AudioContext || window.webkitAudioContext;
          if (!Ctx) return null;
          this.ctx = new Ctx();
          return this.ctx;
        },
        beep(freq = 440, type = 'sine', duration = 0.12, vol = 0.12) {
          if (muted) return;
          const ctx = this.ensure();
          if (!ctx) return;
          const t = ctx.currentTime;
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();
          osc.type = type;
          osc.frequency.setValueAtTime(freq, t);
          gain.gain.setValueAtTime(0.0001, t);
          gain.gain.exponentialRampToValueAtTime(vol, t + 0.02);
          gain.gain.exponentialRampToValueAtTime(0.0001, t + duration);
          osc.connect(gain);
          gain.connect(ctx.destination);
          osc.start(t);
          osc.stop(t + duration + 0.02);
        },
        chime() {
          const base = [523.25, 659.25, 783.99, 1046.5][Math.floor(Math.random() * 4)];
          this.beep(base, 'triangle', 0.15, 0.09);
          setTimeout(() => this.beep(base * 1.25, 'sine', 0.13, 0.08), 80);
        },
        tap() {
          this.beep(740 + Math.random() * 90, 'square', 0.06, 0.05);
        },
        jingle() {
          if (muted) return;
          const ctx = this.ensure();
          if (!ctx) return;
          const notes = [659, 659, 659, 659, 659, 659, 659, 783, 523, 587, 659, 0, 698, 698, 698, 698, 698, 659, 659, 659, 659, 587, 587, 659, 587, 783];
          let t = ctx.currentTime;
          notes.forEach((n, i) => {
            const dur = i % 3 === 2 ? 0.23 : 0.14;
            if (n > 0) {
              const osc = ctx.createOscillator();
              const gain = ctx.createGain();
              osc.type = i % 4 === 0 ? 'triangle' : 'sine';
              osc.frequency.setValueAtTime(n, t);
              gain.gain.setValueAtTime(0.0001, t);
              gain.gain.exponentialRampToValueAtTime(0.08, t + 0.02);
              gain.gain.exponentialRampToValueAtTime(0.0001, t + dur);
              osc.connect(gain);
              gain.connect(ctx.destination);
              osc.start(t);
              osc.stop(t + dur + 0.02);
            }
            t += dur + 0.03;
          });
        }
      };

      function createSparkles(x, y, count = 8) {
        const rect = card.getBoundingClientRect();
        for (let i = 0; i < count; i++) {
          const s = document.createElement('div');
          s.className = 'sparkle';
          const rx = x - rect.left + (Math.random() * 26 - 13);
          const ry = y - rect.top + (Math.random() * 26 - 13);
          s.style.left = `${rx}px`;
          s.style.top = `${ry}px`;
          s.style.animationDelay = `${i * 0.02}s`;
          card.appendChild(s);
          setTimeout(() => s.remove(), 900);
        }
      }

      function positionInCard(sticker, clientX, clientY) {
        const rect = card.getBoundingClientRect();
        const x = Math.min(Math.max(clientX - rect.left - sticker.offsetWidth / 2, 0), rect.width - sticker.offsetWidth);
        const y = Math.min(Math.max(clientY - rect.top - sticker.offsetHeight / 2, 0), rect.height - sticker.offsetHeight);
        sticker.style.left = `${x}px`;
        sticker.style.top = `${y}px`;
      }

      function makeDraggable(node, fromPalette = false) {
        let dragEl = null;
        let activeId = null;

        const onDown = (e) => {
          if (e.button !== undefined && e.button !== 0) return;
          e.preventDefault();
          activeId = e.pointerId;
          node.setPointerCapture(activeId);

          if (fromPalette) {
            dragEl = document.createElement('div');
            dragEl.className = 'sticker';
            dragEl.dataset.emoji = node.dataset.emoji;
            dragEl.textContent = node.dataset.emoji;
            card.appendChild(dragEl);
            const cRect = card.getBoundingClientRect();
            dragEl.style.left = `${cRect.width / 2 - 34}px`;
            dragEl.style.top = `${cRect.height / 2 - 34}px`;
          } else {
            dragEl = node;
          }

          dragEl.classList.add('dragging');
          dragEl.style.zIndex = ++zCounter;
          positionInCard(dragEl, e.clientX, e.clientY);
          audio.tap();
        };

        const onMove = (e) => {
          if (!dragEl || e.pointerId !== activeId) return;
          positionInCard(dragEl, e.clientX, e.clientY);
        };

        const onUp = (e) => {
          if (!dragEl || e.pointerId !== activeId) return;
          dragEl.classList.remove('dragging');
          createSparkles(e.clientX, e.clientY, 10);
          audio.chime();

          if (fromPalette) {
            makeDraggable(dragEl, false);
          }

          dragEl = null;
          activeId = null;
        };

        node.addEventListener('pointerdown', onDown);
        node.addEventListener('pointermove', onMove);
        node.addEventListener('pointerup', onUp);
        node.addEventListener('pointercancel', onUp);
      }

      [...card.querySelectorAll('.sticker')].forEach((s) => {
        s.style.zIndex = ++zCounter;
        makeDraggable(s, false);
      });
      [...palette.querySelectorAll('.sticker.in-palette')].forEach((s) => makeDraggable(s, true));

      card.addEventListener('pointerdown', (e) => {
        if (e.target.classList.contains('sticker')) return;
        createSparkles(e.clientX, e.clientY, 14);
        audio.tap();
      });

      jingleBtn.addEventListener('click', () => {
        audio.jingle();
        createSparkles(window.innerWidth * 0.5, window.innerHeight * 0.2, 20);
      });

      shakeBtn.addEventListener('click', () => {
        card.classList.remove('shake');
        void card.offsetWidth;
        card.classList.add('shake');
        snowBurst(55);
        audio.beep(320, 'triangle', 0.12, 0.07);
        setTimeout(() => audio.beep(210, 'sine', 0.12, 0.06), 100);
      });

      muteBtn.addEventListener('click', () => {
        muted = !muted;
        muteBtn.textContent = muted ? 'Sound: Off' : 'Sound: On';
        if (!muted) audio.tap();
      });

      const snowCanvas = document.getElementById('snow');
      const ctx = snowCanvas.getContext('2d');
      let flakes = [];
      let w = 0;
      let h = 0;

      function resize() {
        w = snowCanvas.width = window.innerWidth;
        h = snowCanvas.height = window.innerHeight;
        flakes = Array.from({ length: Math.min(220, Math.floor(w / 7)) }, () => newFlake(true));
      }

      function newFlake(initial = false) {
        return {
          x: Math.random() * w,
          y: initial ? Math.random() * h : -20,
          r: 1 + Math.random() * 3.8,
          vx: -0.4 + Math.random() * 0.8,
          vy: 0.7 + Math.random() * 1.8,
          a: 0.35 + Math.random() * 0.5
        };
      }

      function snowBurst(count = 40) {
        for (let i = 0; i < count; i++) {
          flakes.push({
            x: Math.random() * w,
            y: -10 - Math.random() * 80,
            r: 1 + Math.random() * 3,
            vx: -1 + Math.random() * 2,
            vy: 1.8 + Math.random() * 2.4,
            a: 0.5 + Math.random() * 0.45
          });
        }
      }

      function animateSnow() {
        ctx.clearRect(0, 0, w, h);
        for (let i = 0; i < flakes.length; i++) {
          const f = flakes[i];
          f.x += f.vx + Math.sin((f.y + i) * 0.01) * 0.2;
          f.y += f.vy;

          if (f.y > h + 12 || f.x < -16 || f.x > w + 16) {
            flakes[i] = newFlake(false);
            continue;
          }

          ctx.beginPath();
          ctx.fillStyle = `rgba(255, 255, 255, ${f.a})`;
          ctx.arc(f.x, f.y, f.r, 0, Math.PI * 2);
          ctx.fill();
        }
        requestAnimationFrame(animateSnow);
      }

      window.addEventListener('resize', resize);
      resize();
      animateSnow();

      // kick off a gentle sparkle & tiny welcome sound
      setTimeout(() => {
        const cRect = card.getBoundingClientRect();
        createSparkles(cRect.left + cRect.width * 0.5, cRect.top + 90, 16);
      }, 450);

      document.addEventListener('visibilitychange', () => {
        if (document.hidden) return;
        snowBurst(25);
      });
    })();
  </script>
</body>
</html>
