<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Math Practice Drills</title>
  <style>
    :root {
      --bg: #f4f7fb;
      --card: #ffffff;
      --text: #122033;
      --muted: #5f6c7b;
      --accent: #116dff;
      --accent-soft: #dce9ff;
      --ok: #0d9f57;
      --bad: #d93036;
      --border: #d8e2ee;
      --shadow: 0 10px 30px rgba(18, 32, 51, 0.08);
      --radius: 18px;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      display: grid;
      place-items: center;
      background:
        radial-gradient(1200px 600px at 10% -10%, #e8f0ff 0%, transparent 55%),
        radial-gradient(1000px 500px at 90% 110%, #eafbf3 0%, transparent 50%),
        var(--bg);
      color: var(--text);
      font-family: "Avenir Next", "Segoe UI", "Helvetica Neue", Helvetica, Arial, sans-serif;
      padding: 20px;
    }

    .app {
      width: min(880px, 100%);
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: clamp(18px, 3vw, 34px);
    }

    h1 {
      margin: 0 0 12px;
      font-size: clamp(2rem, 4.2vw, 2.9rem);
      line-height: 1.1;
      letter-spacing: -0.03em;
    }

    .subtitle {
      font-size: clamp(1rem, 1.9vw, 1.15rem);
      color: var(--muted);
      margin: 0 0 22px;
    }

    .controls {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 12px;
      margin-bottom: 16px;
    }

    .control {
      background: #f8fbff;
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 12px;
    }

    .control label {
      display: block;
      font-weight: 700;
      font-size: 0.98rem;
      margin-bottom: 8px;
    }

    select, button, input {
      font: inherit;
    }

    select, .btn {
      width: 100%;
      border-radius: 12px;
      border: 1px solid var(--border);
      min-height: 48px;
      font-size: 1.05rem;
      padding: 0 12px;
      background: #fff;
      color: var(--text);
    }

    .btn {
      cursor: pointer;
      font-weight: 700;
      border: none;
      background: linear-gradient(180deg, #2a7cff, #116dff);
      color: #fff;
      transition: transform 0.05s ease;
    }

    .btn:active { transform: translateY(1px); }
    .btn.secondary {
      background: #edf3ff;
      color: #19437a;
      border: 1px solid #c9daff;
    }

    .main {
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: clamp(14px, 2.4vw, 24px);
      background: #fff;
    }

    .hud {
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 10px;
      margin-bottom: 20px;
    }

    .stat {
      background: #f8fbff;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 12px;
      text-align: center;
    }

    .stat .label {
      color: var(--muted);
      font-size: 0.9rem;
      margin-bottom: 4px;
    }

    .stat .value {
      font-size: clamp(1.25rem, 2.7vw, 1.7rem);
      font-weight: 800;
      letter-spacing: -0.02em;
    }

    .timer .value { color: var(--accent); }

    .problem {
      text-align: center;
      margin: 10px 0 14px;
      font-size: clamp(2rem, 7vw, 4rem);
      font-weight: 800;
      letter-spacing: -0.03em;
      min-height: 1.2em;
    }

    .answer-row {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 10px;
      align-items: center;
      margin: 0 auto;
      width: min(460px, 100%);
    }

    .answer-input {
      min-height: 56px;
      border: 2px solid var(--border);
      border-radius: 14px;
      padding: 0 14px;
      font-size: clamp(1.2rem, 2.8vw, 1.6rem);
      text-align: center;
      font-weight: 700;
    }

    .answer-input:focus {
      outline: none;
      border-color: #8bb4ff;
      box-shadow: 0 0 0 4px var(--accent-soft);
    }

    .submit {
      min-width: 112px;
      min-height: 56px;
      border-radius: 14px;
      border: none;
      background: #0f7bff;
      color: #fff;
      font-weight: 800;
      font-size: 1.02rem;
      cursor: pointer;
    }

    .feedback {
      min-height: 1.3em;
      text-align: center;
      margin-top: 12px;
      font-size: clamp(1rem, 2vw, 1.2rem);
      font-weight: 700;
    }

    .feedback.ok { color: var(--ok); }
    .feedback.bad { color: var(--bad); }

    .scoreboard {
      margin-top: 18px;
      border-top: 1px dashed var(--border);
      padding-top: 16px;
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
    }

    .score-item {
      background: #f8fbff;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 10px;
      text-align: center;
    }

    .score-item .k {
      color: var(--muted);
      font-size: 0.9rem;
      margin-bottom: 4px;
    }

    .score-item .v {
      font-size: clamp(1.1rem, 2.4vw, 1.4rem);
      font-weight: 800;
    }

    .disabled { opacity: 0.55; pointer-events: none; }

    @media (max-width: 740px) {
      .controls { grid-template-columns: 1fr; }
      .hud { grid-template-columns: 1fr 1fr; }
      .scoreboard { grid-template-columns: 1fr; }
      .answer-row { grid-template-columns: 1fr; }
      .submit { width: 100%; }
    }
  </style>
</head>
<body>
  <main class="app" aria-label="Math Practice Drills App">
    <h1>Math Practice Drills</h1>
    <p class="subtitle">Improve your speed and accuracy with timed arithmetic practice.</p>

    <section class="controls" aria-label="Quiz settings">
      <div class="control">
        <label for="difficulty">Difficulty</label>
        <select id="difficulty">
          <option value="easy">Easy</option>
          <option value="medium" selected>Medium</option>
          <option value="hard">Hard</option>
        </select>
      </div>
      <div class="control">
        <label for="duration">Quiz Duration</label>
        <select id="duration">
          <option value="30">30 seconds</option>
          <option value="60" selected>60 seconds</option>
          <option value="120">120 seconds</option>
        </select>
      </div>
      <div class="control">
        <label>&nbsp;</label>
        <button id="startBtn" class="btn" type="button">Start Quiz</button>
      </div>
    </section>

    <section class="main" aria-live="polite">
      <div class="hud">
        <div class="stat timer">
          <div class="label">Time Left</div>
          <div id="timeLeft" class="value">60s</div>
        </div>
        <div class="stat">
          <div class="label">Correct</div>
          <div id="correctCount" class="value">0</div>
        </div>
        <div class="stat">
          <div class="label">Incorrect</div>
          <div id="wrongCount" class="value">0</div>
        </div>
        <div class="stat">
          <div class="label">Accuracy</div>
          <div id="accuracy" class="value">0%</div>
        </div>
      </div>

      <div id="problem" class="problem">Press Start</div>

      <form id="answerForm" class="answer-row" autocomplete="off">
        <input id="answer" class="answer-input" inputmode="numeric" aria-label="Your answer" placeholder="Type answer" disabled />
        <button class="submit" type="submit" id="submitBtn" disabled>Submit</button>
      </form>

      <div id="feedback" class="feedback"></div>

      <div class="scoreboard" aria-label="Score tracker">
        <div class="score-item">
          <div class="k">Current Streak</div>
          <div id="streak" class="v">0</div>
        </div>
        <div class="score-item">
          <div class="k">Best This Session</div>
          <div id="bestSession" class="v">0</div>
        </div>
        <div class="score-item">
          <div class="k">All-Time Best</div>
          <div id="allTimeBest" class="v">0</div>
        </div>
      </div>
    </section>
  </main>

  <script>
    (function () {
      const BEST_KEY = "math-drills-all-time-best";

      const el = {
        difficulty: document.getElementById("difficulty"),
        duration: document.getElementById("duration"),
        startBtn: document.getElementById("startBtn"),
        timeLeft: document.getElementById("timeLeft"),
        correctCount: document.getElementById("correctCount"),
        wrongCount: document.getElementById("wrongCount"),
        accuracy: document.getElementById("accuracy"),
        problem: document.getElementById("problem"),
        answerForm: document.getElementById("answerForm"),
        answer: document.getElementById("answer"),
        submitBtn: document.getElementById("submitBtn"),
        feedback: document.getElementById("feedback"),
        streak: document.getElementById("streak"),
        bestSession: document.getElementById("bestSession"),
        allTimeBest: document.getElementById("allTimeBest")
      };

      const state = {
        running: false,
        timeLeft: Number(el.duration.value),
        timerId: null,
        current: null,
        correct: 0,
        wrong: 0,
        streak: 0,
        bestSession: 0,
        allTimeBest: Number(localStorage.getItem(BEST_KEY) || 0)
      };

      el.allTimeBest.textContent = String(state.allTimeBest);
      el.timeLeft.textContent = `${state.timeLeft}s`;

      function randInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }

      function pick(arr) {
        return arr[randInt(0, arr.length - 1)];
      }

      function makeProblem() {
        const diff = el.difficulty.value;

        if (diff === "easy") {
          const op = pick(["+", "-"]);
          let a = randInt(0, 20);
          let b = randInt(0, 20);
          if (op === "-" && b > a) [a, b] = [b, a];
          return { text: `${a} ${op} ${b}`, answer: op === "+" ? a + b : a - b };
        }

        if (diff === "medium") {
          const op = pick(["+", "-", "×"]);
          if (op === "×") {
            const a = randInt(2, 12);
            const b = randInt(2, 12);
            return { text: `${a} × ${b}`, answer: a * b };
          }
          let a = randInt(10, 60);
          let b = randInt(1, 50);
          if (op === "-" && b > a) [a, b] = [b, a];
          return { text: `${a} ${op} ${b}`, answer: op === "+" ? a + b : a - b };
        }

        const op = pick(["+", "-", "×", "÷"]);
        if (op === "×") {
          const a = randInt(6, 25);
          const b = randInt(4, 18);
          return { text: `${a} × ${b}`, answer: a * b };
        }
        if (op === "÷") {
          const divisor = randInt(2, 14);
          const quotient = randInt(2, 20);
          const dividend = divisor * quotient;
          return { text: `${dividend} ÷ ${divisor}`, answer: quotient };
        }
        let a = randInt(35, 180);
        let b = randInt(15, 140);
        if (op === "-" && b > a) [a, b] = [b, a];
        return { text: `${a} ${op} ${b}`, answer: op === "+" ? a + b : a - b };
      }

      function setControlsDisabled(disabled) {
        el.difficulty.disabled = disabled;
        el.duration.disabled = disabled;
      }

      function updateStats() {
        const attempts = state.correct + state.wrong;
        const accuracy = attempts ? Math.round((state.correct / attempts) * 100) : 0;

        el.correctCount.textContent = String(state.correct);
        el.wrongCount.textContent = String(state.wrong);
        el.accuracy.textContent = `${accuracy}%`;
        el.streak.textContent = String(state.streak);
        el.bestSession.textContent = String(state.bestSession);
        el.allTimeBest.textContent = String(state.allTimeBest);
      }

      function nextProblem() {
        state.current = makeProblem();
        el.problem.textContent = state.current.text;
        el.answer.value = "";
        el.answer.focus();
      }

      function setFeedback(message, kind) {
        el.feedback.textContent = message;
        el.feedback.className = `feedback ${kind || ""}`;
      }

      function startQuiz() {
        if (state.running) return;

        state.running = true;
        state.timeLeft = Number(el.duration.value);
        state.correct = 0;
        state.wrong = 0;
        state.streak = 0;
        state.bestSession = 0;

        el.timeLeft.textContent = `${state.timeLeft}s`;
        setFeedback("", "");
        updateStats();
        nextProblem();

        el.answer.disabled = false;
        el.submitBtn.disabled = false;
        el.startBtn.textContent = "Running...";
        el.startBtn.classList.add("secondary");
        setControlsDisabled(true);

        state.timerId = setInterval(() => {
          state.timeLeft -= 1;
          el.timeLeft.textContent = `${state.timeLeft}s`;

          if (state.timeLeft <= 0) {
            finishQuiz();
          }
        }, 1000);
      }

      function finishQuiz() {
        if (!state.running) return;

        state.running = false;
        clearInterval(state.timerId);
        state.timerId = null;
        state.timeLeft = 0;
        el.timeLeft.textContent = "0s";

        if (state.correct > state.allTimeBest) {
          state.allTimeBest = state.correct;
          localStorage.setItem(BEST_KEY, String(state.allTimeBest));
        }

        el.answer.disabled = true;
        el.submitBtn.disabled = true;
        setControlsDisabled(false);
        el.startBtn.textContent = "Start Again";
        el.startBtn.classList.remove("secondary");
        el.problem.textContent = "Time's up!";

        const attempts = state.correct + state.wrong;
        const accuracy = attempts ? Math.round((state.correct / attempts) * 100) : 0;
        setFeedback(`Final score: ${state.correct} correct (${accuracy}% accuracy)`, "ok");
        updateStats();
      }

      function submitAnswer(event) {
        event.preventDefault();
        if (!state.running || !state.current) return;

        const raw = el.answer.value.trim();
        if (raw === "") return;

        const user = Number(raw);
        if (!Number.isFinite(user)) {
          setFeedback("Enter a valid number.", "bad");
          return;
        }

        if (user === state.current.answer) {
          state.correct += 1;
          state.streak += 1;
          state.bestSession = Math.max(state.bestSession, state.correct);
          setFeedback("Correct", "ok");
        } else {
          state.wrong += 1;
          state.streak = 0;
          setFeedback(`Not quite. ${state.current.text} = ${state.current.answer}`, "bad");
        }

        updateStats();
        nextProblem();
      }

      el.startBtn.addEventListener("click", startQuiz);
      el.answerForm.addEventListener("submit", submitAnswer);
      el.duration.addEventListener("change", () => {
        if (!state.running) {
          state.timeLeft = Number(el.duration.value);
          el.timeLeft.textContent = `${state.timeLeft}s`;
        }
      });

      // Let users quickly type negative values if needed in future operator expansions.
      el.answer.addEventListener("keydown", (e) => {
        if (e.key === "-") return;
        if (e.ctrlKey || e.metaKey || e.altKey) return;
      });
    })();
  </script>
</body>
</html>
