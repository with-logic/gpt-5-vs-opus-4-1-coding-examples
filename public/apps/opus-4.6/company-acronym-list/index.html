<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Company Acronym List</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#f8fafc;--surface:#ffffff;--surface-hover:#f1f5f9;
  --border:#e2e8f0;--border-light:#f1f5f9;
  --text:#0f172a;--text-secondary:#475569;--text-muted:#94a3b8;
  --primary:#4f46e5;--primary-light:#eef2ff;--primary-dark:#4338ca;
  --accent:#06b6d4;--accent-light:#ecfeff;
  --success:#10b981;--success-light:#ecfdf5;
  --warning:#f59e0b;--warning-light:#fffbeb;
  --danger:#ef4444;--danger-light:#fef2f2;
  --shadow-sm:0 1px 2px rgba(0,0,0,0.05);
  --shadow:0 1px 3px rgba(0,0,0,0.1),0 1px 2px rgba(0,0,0,0.06);
  --shadow-md:0 4px 6px -1px rgba(0,0,0,0.1),0 2px 4px -1px rgba(0,0,0,0.06);
  --shadow-lg:0 10px 15px -3px rgba(0,0,0,0.1),0 4px 6px -2px rgba(0,0,0,0.05);
  --shadow-xl:0 20px 25px -5px rgba(0,0,0,0.1),0 10px 10px -5px rgba(0,0,0,0.04);
  --radius:8px;--radius-lg:12px;--radius-xl:16px;
  --transition:150ms cubic-bezier(0.4,0,0.2,1);
}

[data-theme="dark"]{
  --bg:#0f172a;--surface:#1e293b;--surface-hover:#334155;
  --border:#334155;--border-light:#1e293b;
  --text:#f1f5f9;--text-secondary:#94a3b8;--text-muted:#64748b;
  --primary:#818cf8;--primary-light:#1e1b4b;--primary-dark:#a5b4fc;
  --accent:#22d3ee;--accent-light:#083344;
  --success:#34d399;--success-light:#064e3b;
  --warning:#fbbf24;--warning-light:#451a03;
  --danger:#f87171;--danger-light:#450a0a;
  --shadow-sm:0 1px 2px rgba(0,0,0,0.3);
  --shadow:0 1px 3px rgba(0,0,0,0.4),0 1px 2px rgba(0,0,0,0.3);
  --shadow-md:0 4px 6px -1px rgba(0,0,0,0.4),0 2px 4px -1px rgba(0,0,0,0.3);
  --shadow-lg:0 10px 15px -3px rgba(0,0,0,0.4),0 4px 6px -2px rgba(0,0,0,0.3);
  --shadow-xl:0 20px 25px -5px rgba(0,0,0,0.5),0 10px 10px -5px rgba(0,0,0,0.3);
}

body{font-family:'Inter',system-ui,-apple-system,sans-serif;background:var(--bg);color:var(--text);line-height:1.6;min-height:100vh;transition:background var(--transition),color var(--transition)}

/* Scrollbar */
::-webkit-scrollbar{width:6px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--text-muted);border-radius:3px}
::-webkit-scrollbar-thumb:hover{background:var(--text-secondary)}

/* Header */
.header{background:var(--surface);border-bottom:1px solid var(--border);position:sticky;top:0;z-index:100;backdrop-filter:blur(12px);background:rgba(255,255,255,0.85)}
[data-theme="dark"] .header{background:rgba(30,41,59,0.85)}
.header-inner{max-width:1200px;margin:0 auto;padding:16px 24px;display:flex;align-items:center;justify-content:space-between;gap:16px}
.logo{display:flex;align-items:center;gap:12px;text-decoration:none;color:var(--text)}
.logo-icon{width:40px;height:40px;background:linear-gradient(135deg,var(--primary),var(--accent));border-radius:var(--radius-lg);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;font-size:16px;letter-spacing:-0.5px;flex-shrink:0}
.logo-text h1{font-size:18px;font-weight:700;letter-spacing:-0.3px;line-height:1.2}
.logo-text p{font-size:11px;color:var(--text-muted);font-weight:500;text-transform:uppercase;letter-spacing:0.5px}
.header-actions{display:flex;align-items:center;gap:8px}

/* Buttons */
.btn{display:inline-flex;align-items:center;gap:8px;padding:8px 16px;border-radius:var(--radius);font-size:14px;font-weight:500;cursor:pointer;border:1px solid transparent;transition:all var(--transition);font-family:inherit;line-height:1.4;white-space:nowrap}
.btn:hover{transform:translateY(-1px)}
.btn:active{transform:translateY(0)}
.btn-primary{background:var(--primary);color:#fff;box-shadow:var(--shadow-sm)}
.btn-primary:hover{background:var(--primary-dark);box-shadow:var(--shadow)}
.btn-secondary{background:var(--surface);color:var(--text);border-color:var(--border);box-shadow:var(--shadow-sm)}
.btn-secondary:hover{background:var(--surface-hover);box-shadow:var(--shadow)}
.btn-ghost{background:transparent;color:var(--text-secondary)}
.btn-ghost:hover{background:var(--surface-hover);color:var(--text)}
.btn-icon{padding:8px;width:36px;height:36px;display:inline-flex;align-items:center;justify-content:center}
.btn-sm{padding:6px 12px;font-size:13px}
.btn-lg{padding:12px 24px;font-size:16px}
.btn-success{background:var(--success);color:#fff}
.btn-success:hover{opacity:0.9}
.btn-danger{background:var(--danger);color:#fff}
.btn-danger:hover{opacity:0.9}

/* Layout */
.container{max-width:1200px;margin:0 auto;padding:24px}
.main-layout{display:grid;grid-template-columns:260px 1fr;gap:24px}
@media(max-width:900px){.main-layout{grid-template-columns:1fr}.sidebar{display:none}.sidebar.open{display:block;position:fixed;top:73px;left:0;right:0;bottom:0;z-index:99;background:var(--bg);padding:24px;overflow-y:auto}}

/* Sidebar */
.sidebar{position:sticky;top:97px;align-self:start;max-height:calc(100vh - 120px);overflow-y:auto}
.sidebar-section{margin-bottom:24px}
.sidebar-title{font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:0.8px;color:var(--text-muted);padding:0 12px;margin-bottom:8px}
.nav-item{display:flex;align-items:center;gap:10px;padding:8px 12px;border-radius:var(--radius);cursor:pointer;color:var(--text-secondary);font-size:14px;font-weight:500;transition:all var(--transition);user-select:none}
.nav-item:hover{background:var(--surface-hover);color:var(--text)}
.nav-item.active{background:var(--primary-light);color:var(--primary)}
.nav-item svg{width:18px;height:18px;flex-shrink:0}
.nav-badge{margin-left:auto;background:var(--surface-hover);padding:2px 8px;border-radius:10px;font-size:11px;font-weight:600;color:var(--text-muted)}
.nav-item.active .nav-badge{background:rgba(79,70,229,0.15);color:var(--primary)}

/* Category Colors */
.cat-teams{--cat:#8b5cf6;--cat-bg:#f5f3ff}
.cat-projects{--cat:#3b82f6;--cat-bg:#eff6ff}
.cat-processes{--cat:#10b981;--cat-bg:#ecfdf5}
.cat-tech{--cat:#f59e0b;--cat-bg:#fffbeb}
.cat-hr{--cat:#ec4899;--cat-bg:#fdf2f8}
.cat-finance{--cat:#06b6d4;--cat-bg:#ecfeff}
.cat-general{--cat:#64748b;--cat-bg:#f8fafc}
[data-theme="dark"] .cat-teams{--cat-bg:#2e1065}
[data-theme="dark"] .cat-projects{--cat-bg:#172554}
[data-theme="dark"] .cat-processes{--cat-bg:#064e3b}
[data-theme="dark"] .cat-tech{--cat-bg:#451a03}
[data-theme="dark"] .cat-hr{--cat-bg:#500724}
[data-theme="dark"] .cat-finance{--cat-bg:#083344}
[data-theme="dark"] .cat-general{--cat-bg:#1e293b}

.tag{display:inline-flex;align-items:center;gap:4px;padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600;background:var(--cat-bg);color:var(--cat);letter-spacing:0.2px;text-transform:uppercase}
.tag .dot{width:6px;height:6px;border-radius:50%;background:var(--cat)}

/* Search */
.search-section{margin-bottom:24px}
.search-wrapper{position:relative}
.search-input{width:100%;padding:12px 16px 12px 44px;border:2px solid var(--border);border-radius:var(--radius-lg);font-size:15px;background:var(--surface);color:var(--text);transition:all var(--transition);font-family:inherit;box-shadow:var(--shadow-sm)}
.search-input:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px rgba(79,70,229,0.15)}
.search-input::placeholder{color:var(--text-muted)}
.search-icon{position:absolute;left:14px;top:50%;transform:translateY(-50%);color:var(--text-muted);pointer-events:none}
.search-clear{position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;color:var(--text-muted);cursor:pointer;padding:4px;border-radius:4px;display:none;line-height:0}
.search-clear.show{display:block}
.search-clear:hover{color:var(--text);background:var(--surface-hover)}
.search-stats{display:flex;align-items:center;justify-content:space-between;margin-top:12px;font-size:13px;color:var(--text-muted)}
.search-kbd{display:none;align-items:center;gap:4px}
@media(min-width:768px){.search-kbd{display:flex}}
kbd{background:var(--surface-hover);border:1px solid var(--border);padding:2px 6px;border-radius:4px;font-size:11px;font-family:inherit;color:var(--text-muted)}

/* Content */
.content-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;gap:12px;flex-wrap:wrap}
.view-toggle{display:flex;background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);overflow:hidden}
.view-btn{padding:6px 12px;border:none;background:none;cursor:pointer;color:var(--text-muted);font-size:13px;font-weight:500;transition:all var(--transition);font-family:inherit;display:flex;align-items:center;gap:6px}
.view-btn:hover{color:var(--text)}
.view-btn.active{background:var(--primary);color:#fff}
.view-btn svg{width:16px;height:16px}
.sort-select{padding:6px 28px 6px 12px;border:1px solid var(--border);border-radius:var(--radius);font-size:13px;background:var(--surface);color:var(--text);cursor:pointer;font-family:inherit;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 8px center}

/* Cards */
.acronym-grid{display:grid;gap:12px}
.acronym-grid.grid-view{grid-template-columns:repeat(auto-fill,minmax(340px,1fr))}
@media(max-width:500px){.acronym-grid.grid-view{grid-template-columns:1fr}}
.acronym-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-lg);padding:20px;transition:all var(--transition);cursor:default;position:relative;overflow:hidden}
.acronym-card:hover{border-color:var(--primary);box-shadow:var(--shadow-md);transform:translateY(-2px)}
.acronym-card .card-top{display:flex;align-items:flex-start;justify-content:space-between;gap:12px;margin-bottom:10px}
.acronym-card .acronym{font-size:20px;font-weight:800;color:var(--primary);letter-spacing:-0.3px;line-height:1.2}
.acronym-card .full-name{font-size:15px;font-weight:600;color:var(--text);margin-bottom:6px}
.acronym-card .definition{font-size:13px;color:var(--text-secondary);line-height:1.6;margin-bottom:12px}
.acronym-card .card-footer{display:flex;align-items:center;justify-content:space-between;gap:8px;flex-wrap:wrap}
.acronym-card .card-actions{display:flex;gap:4px}
.acronym-card .action-btn{background:none;border:none;padding:4px;cursor:pointer;color:var(--text-muted);border-radius:4px;transition:all var(--transition);line-height:0}
.acronym-card .action-btn:hover{color:var(--primary);background:var(--primary-light)}
.acronym-card .action-btn.bookmarked{color:var(--warning)}
.acronym-card .highlight{background:rgba(79,70,229,0.15);color:var(--primary);border-radius:2px;padding:0 2px}
.acronym-card .card-accent{position:absolute;top:0;left:0;right:0;height:3px;background:var(--cat)}

/* List View */
.list-view .acronym-card{display:grid;grid-template-columns:120px 1fr;gap:16px;padding:16px 20px;align-items:center}
.list-view .acronym-card .card-accent{display:none}
.list-view .card-main{display:flex;align-items:center;gap:16px;flex-wrap:wrap}
.list-view .acronym-card .acronym{font-size:16px;margin:0}
.list-view .acronym-card .full-name{font-size:14px;margin:0}
.list-view .acronym-card .definition{display:none}
.list-view .card-top{margin:0}
.list-view .card-footer{margin:0}

/* Empty State */
.empty-state{text-align:center;padding:60px 20px;color:var(--text-muted)}
.empty-state svg{width:64px;height:64px;margin-bottom:16px;opacity:0.4}
.empty-state h3{font-size:18px;font-weight:600;margin-bottom:8px;color:var(--text-secondary)}
.empty-state p{font-size:14px;max-width:400px;margin:0 auto}

/* Modal */
.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.5);backdrop-filter:blur(4px);z-index:200;display:flex;align-items:center;justify-content:center;padding:20px;opacity:0;pointer-events:none;transition:opacity 200ms}
.modal-overlay.open{opacity:1;pointer-events:auto}
.modal{background:var(--surface);border-radius:var(--radius-xl);box-shadow:var(--shadow-xl);max-width:600px;width:100%;max-height:90vh;overflow-y:auto;transform:scale(0.95) translateY(10px);transition:transform 200ms}
.modal-overlay.open .modal{transform:scale(1) translateY(0)}
.modal-header{padding:24px 24px 0;display:flex;align-items:center;justify-content:space-between}
.modal-header h2{font-size:20px;font-weight:700}
.modal-body{padding:24px}
.modal-footer{padding:0 24px 24px;display:flex;justify-content:flex-end;gap:8px}

/* Quiz Mode */
.quiz-container{max-width:650px;margin:0 auto}
.quiz-header{text-align:center;margin-bottom:32px}
.quiz-header h2{font-size:24px;font-weight:700;margin-bottom:8px}
.quiz-header p{color:var(--text-secondary);font-size:14px}
.quiz-progress{display:flex;align-items:center;gap:12px;margin-bottom:32px}
.quiz-progress-bar{flex:1;height:8px;background:var(--border);border-radius:4px;overflow:hidden}
.quiz-progress-fill{height:100%;background:linear-gradient(90deg,var(--primary),var(--accent));border-radius:4px;transition:width 400ms cubic-bezier(0.4,0,0.2,1)}
.quiz-progress-text{font-size:13px;font-weight:600;color:var(--text-muted);white-space:nowrap}
.quiz-card{background:var(--surface);border:2px solid var(--border);border-radius:var(--radius-xl);padding:32px;text-align:center;margin-bottom:24px;box-shadow:var(--shadow-lg)}
.quiz-question-label{font-size:12px;text-transform:uppercase;letter-spacing:1px;color:var(--text-muted);font-weight:600;margin-bottom:16px}
.quiz-acronym{font-size:48px;font-weight:800;color:var(--primary);letter-spacing:-1px;margin-bottom:8px}
.quiz-hint{font-size:13px;color:var(--text-muted);margin-bottom:24px}
.quiz-options{display:grid;gap:10px;text-align:left}
.quiz-option{padding:14px 18px;border:2px solid var(--border);border-radius:var(--radius-lg);cursor:pointer;transition:all var(--transition);font-size:14px;font-weight:500;background:var(--surface);color:var(--text);display:flex;align-items:center;gap:12px}
.quiz-option:hover:not(.disabled){border-color:var(--primary);background:var(--primary-light)}
.quiz-option .option-letter{width:28px;height:28px;border-radius:50%;background:var(--surface-hover);display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;color:var(--text-muted);flex-shrink:0}
.quiz-option:hover:not(.disabled) .option-letter{background:var(--primary);color:#fff}
.quiz-option.correct{border-color:var(--success);background:var(--success-light)}
.quiz-option.correct .option-letter{background:var(--success);color:#fff}
.quiz-option.wrong{border-color:var(--danger);background:var(--danger-light)}
.quiz-option.wrong .option-letter{background:var(--danger);color:#fff}
.quiz-option.disabled{cursor:default;opacity:0.7}
.quiz-option.disabled.reveal{opacity:1;border-color:var(--success);background:var(--success-light)}
.quiz-option.disabled.reveal .option-letter{background:var(--success);color:#fff}
.quiz-explanation{margin-top:16px;padding:14px 18px;background:var(--surface-hover);border-radius:var(--radius);font-size:13px;color:var(--text-secondary);line-height:1.6;text-align:left}

/* Quiz Results */
.quiz-results{text-align:center;padding:24px}
.quiz-score-circle{width:140px;height:140px;border-radius:50%;margin:0 auto 24px;display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative}
.quiz-score-circle svg{position:absolute;top:0;left:0;transform:rotate(-90deg)}
.quiz-score-circle .score-value{font-size:36px;font-weight:800;color:var(--primary)}
.quiz-score-circle .score-label{font-size:12px;color:var(--text-muted);font-weight:500}
.quiz-results h3{font-size:22px;font-weight:700;margin-bottom:8px}
.quiz-results p{color:var(--text-secondary);margin-bottom:24px;font-size:14px}
.quiz-stats{display:flex;justify-content:center;gap:24px;margin-bottom:32px}
.quiz-stat{text-align:center}
.quiz-stat .stat-value{font-size:24px;font-weight:700}
.quiz-stat .stat-label{font-size:12px;color:var(--text-muted)}
.stat-correct .stat-value{color:var(--success)}
.stat-wrong .stat-value{color:var(--danger)}

/* Quiz Settings */
.quiz-settings{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-xl);padding:32px;max-width:500px;margin:0 auto}
.quiz-settings h3{font-size:18px;font-weight:700;margin-bottom:20px}
.setting-group{margin-bottom:20px}
.setting-label{font-size:13px;font-weight:600;color:var(--text-secondary);margin-bottom:8px;display:block}
.setting-options{display:flex;gap:8px;flex-wrap:wrap}
.setting-chip{padding:8px 16px;border:2px solid var(--border);border-radius:var(--radius);cursor:pointer;font-size:13px;font-weight:500;transition:all var(--transition);background:var(--surface)}
.setting-chip:hover{border-color:var(--primary)}
.setting-chip.active{border-color:var(--primary);background:var(--primary-light);color:var(--primary)}

/* Add Form */
.form-group{margin-bottom:16px}
.form-label{display:block;font-size:13px;font-weight:600;color:var(--text-secondary);margin-bottom:6px}
.form-input{width:100%;padding:10px 14px;border:2px solid var(--border);border-radius:var(--radius);font-size:14px;background:var(--surface);color:var(--text);font-family:inherit;transition:border-color var(--transition)}
.form-input:focus{outline:none;border-color:var(--primary)}
textarea.form-input{resize:vertical;min-height:80px}
.form-select{width:100%;padding:10px 14px;border:2px solid var(--border);border-radius:var(--radius);font-size:14px;background:var(--surface);color:var(--text);font-family:inherit;cursor:pointer}

/* Mobile Menu */
.mobile-toggle{display:none;padding:8px;background:none;border:1px solid var(--border);border-radius:var(--radius);cursor:pointer;color:var(--text)}
@media(max-width:900px){.mobile-toggle{display:flex;align-items:center;justify-content:center}}

/* Tooltip */
.tooltip{position:relative}
.tooltip::after{content:attr(data-tip);position:absolute;bottom:calc(100% + 6px);left:50%;transform:translateX(-50%);padding:4px 10px;background:var(--text);color:var(--bg);font-size:11px;border-radius:4px;white-space:nowrap;opacity:0;pointer-events:none;transition:opacity var(--transition)}
.tooltip:hover::after{opacity:1}

/* Animations */
@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
@keyframes slideIn{from{opacity:0;transform:translateX(-10px)}to{opacity:1;transform:translateX(0)}}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.5}}
.fade-in{animation:fadeIn 300ms ease-out forwards}
.stagger{opacity:0;animation:fadeIn 300ms ease-out forwards}

/* Toast */
.toast-container{position:fixed;bottom:24px;right:24px;z-index:300;display:flex;flex-direction:column;gap:8px}
.toast{padding:12px 20px;border-radius:var(--radius);background:var(--text);color:var(--bg);font-size:14px;font-weight:500;box-shadow:var(--shadow-lg);animation:fadeIn 200ms ease-out;display:flex;align-items:center;gap:10px;max-width:360px}
.toast.success{background:var(--success)}
.toast.error{background:var(--danger)}

/* Responsive */
@media(max-width:640px){
  .header-inner{padding:12px 16px}
  .container{padding:16px}
  .logo-text p{display:none}
  .quiz-acronym{font-size:36px}
  .quiz-card{padding:24px}
  .btn span.hide-mobile{display:none}
}
</style>
</head>
<body>
<!-- Header -->
<header class="header">
<div class="header-inner">
  <a class="logo" href="#" onclick="navigateTo('browse');return false">
    <div class="logo-icon">AL</div>
    <div class="logo-text">
      <h1>AcroList</h1>
      <p>Company Acronym Guide</p>
    </div>
  </a>
  <div class="header-actions">
    <button class="btn btn-ghost btn-icon tooltip" data-tip="Toggle theme" onclick="toggleTheme()" aria-label="Toggle dark mode">
      <svg id="themeIcon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
    </button>
    <button class="btn btn-primary btn-sm" onclick="openAddModal()">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
      <span class="hide-mobile">Add Acronym</span>
    </button>
    <button class="mobile-toggle" onclick="toggleSidebar()" aria-label="Toggle menu">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
    </button>
  </div>
</div>
</header>

<!-- Main -->
<div class="container">
<div class="main-layout">
  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-section">
      <div class="sidebar-title">Navigation</div>
      <div class="nav-item active" data-page="browse" onclick="navigateTo('browse')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
        Browse All
        <span class="nav-badge" id="totalCount">0</span>
      </div>
      <div class="nav-item" data-page="bookmarks" onclick="navigateTo('bookmarks')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z"/></svg>
        Bookmarks
        <span class="nav-badge" id="bookmarkCount">0</span>
      </div>
      <div class="nav-item" data-page="quiz" onclick="navigateTo('quiz')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
        Quiz Mode
      </div>
    </div>
    <div class="sidebar-section">
      <div class="sidebar-title">Categories</div>
      <div id="categoryNav"></div>
    </div>
    <div class="sidebar-section">
      <div class="sidebar-title">Quick Stats</div>
      <div style="padding:0 12px;font-size:13px;color:var(--text-secondary)">
        <div style="display:flex;justify-content:space-between;margin-bottom:6px"><span>Total acronyms</span><strong id="statTotal">0</strong></div>
        <div style="display:flex;justify-content:space-between;margin-bottom:6px"><span>Categories</span><strong id="statCats">0</strong></div>
        <div style="display:flex;justify-content:space-between"><span>Bookmarked</span><strong id="statBookmarks">0</strong></div>
      </div>
    </div>
  </aside>

  <!-- Content -->
  <main id="content">
    <!-- Browse Page -->
    <div id="browsePage">
      <div class="search-section">
        <div class="search-wrapper">
          <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
          <input type="text" class="search-input" id="searchInput" placeholder="Search acronyms, names, or definitions..." oninput="handleSearch()" autocomplete="off">
          <button class="search-clear" id="searchClear" onclick="clearSearch()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
          </button>
        </div>
        <div class="search-stats">
          <span id="searchResults"></span>
          <div class="search-kbd"><kbd>/</kbd> <span>to search</span></div>
        </div>
      </div>
      <div class="content-header">
        <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap" id="activeFilters"></div>
        <div style="display:flex;align-items:center;gap:8px">
          <select class="sort-select" id="sortSelect" onchange="handleSort()">
            <option value="alpha-asc">A → Z</option>
            <option value="alpha-desc">Z → A</option>
            <option value="newest">Newest First</option>
            <option value="category">By Category</option>
          </select>
          <div class="view-toggle">
            <button class="view-btn active" data-view="grid" onclick="setView('grid')">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>
              Grid
            </button>
            <button class="view-btn" data-view="list" onclick="setView('list')">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg>
              List
            </button>
          </div>
        </div>
      </div>
      <div class="acronym-grid grid-view" id="acronymGrid"></div>
    </div>

    <!-- Quiz Page -->
    <div id="quizPage" style="display:none"></div>
  </main>
</div>
</div>

<!-- Add/Edit Modal -->
<div class="modal-overlay" id="addModal" onclick="closeModal(event)">
<div class="modal" onclick="event.stopPropagation()">
  <div class="modal-header">
    <h2 id="modalTitle">Add Acronym</h2>
    <button class="btn btn-ghost btn-icon" onclick="closeAddModal()">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
    </button>
  </div>
  <div class="modal-body">
    <div class="form-group">
      <label class="form-label">Acronym *</label>
      <input type="text" class="form-input" id="formAcronym" placeholder="e.g., API" maxlength="20" style="text-transform:uppercase">
    </div>
    <div class="form-group">
      <label class="form-label">Full Name *</label>
      <input type="text" class="form-input" id="formName" placeholder="e.g., Application Programming Interface">
    </div>
    <div class="form-group">
      <label class="form-label">Definition *</label>
      <textarea class="form-input" id="formDefinition" placeholder="Brief description of what this acronym means in context..."></textarea>
    </div>
    <div class="form-group">
      <label class="form-label">Category</label>
      <select class="form-select" id="formCategory">
        <option value="general">General</option>
        <option value="teams">Teams</option>
        <option value="projects">Projects</option>
        <option value="processes">Processes</option>
        <option value="tech">Technology</option>
        <option value="hr">Human Resources</option>
        <option value="finance">Finance</option>
      </select>
    </div>
  </div>
  <div class="modal-footer">
    <button class="btn btn-secondary" onclick="closeAddModal()">Cancel</button>
    <button class="btn btn-primary" id="formSubmit" onclick="saveAcronym()">Add Acronym</button>
  </div>
</div>
</div>

<!-- Toast Container -->
<div class="toast-container" id="toastContainer"></div>

<script>
// ─── Data ───
const DEFAULT_ACRONYMS = [
  {id:1,acronym:"API",name:"Application Programming Interface",definition:"A set of protocols and tools that allow different software applications to communicate with each other. Used extensively in our microservices architecture.",category:"tech",bookmarked:false,added:Date.now()-100000},
  {id:2,acronym:"OKR",name:"Objectives and Key Results",definition:"A goal-setting framework used company-wide to define measurable goals and track outcomes. Reviewed quarterly by all teams.",category:"processes",bookmarked:false,added:Date.now()-90000},
  {id:3,acronym:"PTO",name:"Paid Time Off",definition:"Company-provided paid leave for vacation, personal time, or sick days. Accrued monthly based on tenure and position level.",category:"hr",bookmarked:false,added:Date.now()-80000},
  {id:4,acronym:"EBITDA",name:"Earnings Before Interest, Taxes, Depreciation and Amortization",definition:"A measure of a company's overall financial performance used as an alternative to net income. Key metric in our quarterly reports.",category:"finance",bookmarked:false,added:Date.now()-70000},
  {id:5,acronym:"MVP",name:"Minimum Viable Product",definition:"The most basic version of a product that can be released to early adopters. Core strategy for our product development lifecycle.",category:"projects",bookmarked:false,added:Date.now()-60000},
  {id:6,acronym:"SRE",name:"Site Reliability Engineering",definition:"An engineering discipline that applies software engineering practices to infrastructure and operations. Our SRE team manages platform stability.",category:"teams",bookmarked:false,added:Date.now()-50000},
  {id:7,acronym:"CI/CD",name:"Continuous Integration / Continuous Deployment",definition:"Automated practices for frequently merging code changes and deploying to production. Powered by our internal DevOps pipeline.",category:"tech",bookmarked:false,added:Date.now()-40000},
  {id:8,acronym:"RACI",name:"Responsible, Accountable, Consulted, Informed",definition:"A matrix used to clarify roles and responsibilities in projects and processes. Required for all cross-functional initiatives.",category:"processes",bookmarked:false,added:Date.now()-30000},
  {id:9,acronym:"P&L",name:"Profit and Loss",definition:"A financial statement summarizing revenues, costs, and expenses. Each business unit maintains their own P&L for quarterly reviews.",category:"finance",bookmarked:false,added:Date.now()-20000},
  {id:10,acronym:"QBR",name:"Quarterly Business Review",definition:"A structured meeting held every quarter to review progress, metrics, and strategic alignment across departments.",category:"processes",bookmarked:false,added:Date.now()-10000},
  {id:11,acronym:"SDK",name:"Software Development Kit",definition:"A collection of software tools, libraries, and documentation used by developers to build applications on our platform.",category:"tech",bookmarked:false,added:Date.now()-9000},
  {id:12,acronym:"HRIS",name:"Human Resource Information System",definition:"The centralized platform used for managing employee data, payroll, benefits, and compliance tracking.",category:"hr",bookmarked:false,added:Date.now()-8500},
  {id:13,acronym:"KPI",name:"Key Performance Indicator",definition:"Measurable values that demonstrate how effectively teams are achieving key business objectives. Tracked in our dashboards.",category:"processes",bookmarked:false,added:Date.now()-8000},
  {id:14,acronym:"UX",name:"User Experience",definition:"The overall experience a person has when interacting with our products. Our UX team leads research and design efforts.",category:"teams",bookmarked:false,added:Date.now()-7500},
  {id:15,acronym:"SLA",name:"Service Level Agreement",definition:"A formal commitment between service provider and client defining expected service standards, uptime, and response times.",category:"processes",bookmarked:false,added:Date.now()-7000},
  {id:16,acronym:"ROI",name:"Return on Investment",definition:"A performance measure used to evaluate the efficiency of an investment or compare the efficiency of several investments.",category:"finance",bookmarked:false,added:Date.now()-6500},
  {id:17,acronym:"DNS",name:"Domain Name System",definition:"The naming system for computers and services connected to the internet or private networks. Managed by our infrastructure team.",category:"tech",bookmarked:false,added:Date.now()-6000},
  {id:18,acronym:"PMO",name:"Project Management Office",definition:"The centralized team responsible for maintaining standards of project management across the organization.",category:"teams",bookmarked:false,added:Date.now()-5500},
  {id:19,acronym:"ERP",name:"Enterprise Resource Planning",definition:"Integrated management software used to manage day-to-day business activities such as accounting, procurement, and supply chain.",category:"tech",bookmarked:false,added:Date.now()-5000},
  {id:20,acronym:"L&D",name:"Learning and Development",definition:"The department focused on employee training, professional growth, and skill development programs throughout the organization.",category:"hr",bookmarked:false,added:Date.now()-4500},
  {id:21,acronym:"GTM",name:"Go-To-Market",definition:"The plan and strategy for launching a product or service, including target audience, marketing channels, and pricing strategy.",category:"projects",bookmarked:false,added:Date.now()-4000},
  {id:22,acronym:"CSAT",name:"Customer Satisfaction Score",definition:"A metric used to measure how satisfied customers are with our products and services. Surveyed after every support interaction.",category:"processes",bookmarked:false,added:Date.now()-3500},
  {id:23,acronym:"SOC",name:"Security Operations Center",definition:"The centralized team responsible for monitoring, detecting, and responding to cybersecurity threats and incidents 24/7.",category:"teams",bookmarked:false,added:Date.now()-3000},
  {id:24,acronym:"ARR",name:"Annual Recurring Revenue",definition:"The annualized revenue from subscription-based customers. A primary metric for tracking business growth and forecasting.",category:"finance",bookmarked:false,added:Date.now()-2500},
  {id:25,acronym:"POC",name:"Proof of Concept",definition:"A preliminary project or prototype used to demonstrate feasibility before committing full resources to development.",category:"projects",bookmarked:false,added:Date.now()-2000},
  {id:26,acronym:"SSO",name:"Single Sign-On",definition:"An authentication scheme that allows users to log in to multiple applications with one set of credentials. Required for all internal tools.",category:"tech",bookmarked:false,added:Date.now()-1500},
  {id:27,acronym:"BRD",name:"Business Requirements Document",definition:"A formal document outlining the business needs and requirements for a project. Must be approved before development begins.",category:"processes",bookmarked:false,added:Date.now()-1000},
  {id:28,acronym:"DEI",name:"Diversity, Equity, and Inclusion",definition:"Company-wide initiatives and programs aimed at fostering a diverse, equitable, and inclusive workplace culture.",category:"hr",bookmarked:false,added:Date.now()-500},
  {id:29,acronym:"NPS",name:"Net Promoter Score",definition:"A metric that measures customer loyalty and likelihood to recommend our products. Tracked monthly across all customer segments.",category:"processes",bookmarked:false,added:Date.now()-400},
  {id:30,acronym:"IPO",name:"Initial Public Offering",definition:"The process of offering shares of a private corporation to the public for the first time. Part of our long-term strategic roadmap.",category:"finance",bookmarked:false,added:Date.now()-300},
];

const CATEGORIES = {
  teams:{label:"Teams",icon:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>'},
  projects:{label:"Projects",icon:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/></svg>'},
  processes:{label:"Processes",icon:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 3 21 3 21 8"/><line x1="4" y1="20" x2="21" y2="3"/><polyline points="21 16 21 21 16 21"/><line x1="15" y1="15" x2="21" y2="21"/><line x1="4" y1="4" x2="9" y2="9"/></svg>'},
  tech:{label:"Technology",icon:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>'},
  hr:{label:"Human Resources",icon:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>'},
  finance:{label:"Finance",icon:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>'},
  general:{label:"General",icon:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>'},
};

// ─── State ───
let state = {
  acronyms: [],
  page: 'browse',
  view: 'grid',
  search: '',
  categoryFilter: null,
  sort: 'alpha-asc',
  bookmarks: new Set(),
  editingId: null,
  quiz: { active: false, questions: [], current: 0, score: 0, answered: false, count: 10, categories: [] }
};

// ─── Init ───
function init() {
  loadState();
  renderCategoryNav();
  renderAcronyms();
  updateStats();
  setupKeyboard();
}

function loadState() {
  try {
    const saved = localStorage.getItem('acronymList');
    if (saved) {
      const data = JSON.parse(saved);
      state.acronyms = data.acronyms || DEFAULT_ACRONYMS;
      state.bookmarks = new Set(data.bookmarks || []);
      state.view = data.view || 'grid';
    } else {
      state.acronyms = [...DEFAULT_ACRONYMS];
    }
  } catch(e) {
    state.acronyms = [...DEFAULT_ACRONYMS];
  }
  state.acronyms.forEach(a => { a.bookmarked = state.bookmarks.has(a.id); });
}

function saveState() {
  try {
    localStorage.setItem('acronymList', JSON.stringify({
      acronyms: state.acronyms,
      bookmarks: [...state.bookmarks],
      view: state.view
    }));
  } catch(e) {}
}

function setupKeyboard() {
  document.addEventListener('keydown', e => {
    if (e.key === '/' && !e.ctrlKey && !e.metaKey && document.activeElement.tagName !== 'INPUT' && document.activeElement.tagName !== 'TEXTAREA') {
      e.preventDefault();
      document.getElementById('searchInput')?.focus();
    }
    if (e.key === 'Escape') {
      closeAddModal();
      clearSearch();
    }
  });
}

// ─── Navigation ───
function navigateTo(page) {
  state.page = page;
  document.querySelectorAll('.nav-item[data-page]').forEach(el => {
    el.classList.toggle('active', el.dataset.page === page);
  });

  const sidebar = document.getElementById('sidebar');
  sidebar.classList.remove('open');

  document.getElementById('browsePage').style.display = (page === 'browse' || page === 'bookmarks') ? 'block' : 'none';
  document.getElementById('quizPage').style.display = page === 'quiz' ? 'block' : 'none';

  if (page === 'browse') {
    state.categoryFilter = null;
    renderAcronyms();
  } else if (page === 'bookmarks') {
    renderAcronyms();
  } else if (page === 'quiz') {
    renderQuizSetup();
  }
  updateActiveFilters();
}

function filterByCategory(cat) {
  state.page = 'browse';
  state.categoryFilter = cat;
  document.querySelectorAll('.nav-item[data-page]').forEach(el => {
    el.classList.toggle('active', false);
  });
  document.querySelectorAll('.nav-item[data-cat]').forEach(el => {
    el.classList.toggle('active', el.dataset.cat === cat);
  });
  document.getElementById('browsePage').style.display = 'block';
  document.getElementById('quizPage').style.display = 'none';

  const sidebar = document.getElementById('sidebar');
  sidebar.classList.remove('open');

  renderAcronyms();
  updateActiveFilters();
}

function toggleSidebar() {
  document.getElementById('sidebar').classList.toggle('open');
}

// ─── Render ───
function renderCategoryNav() {
  const nav = document.getElementById('categoryNav');
  const counts = {};
  state.acronyms.forEach(a => { counts[a.category] = (counts[a.category]||0) + 1; });

  nav.innerHTML = Object.entries(CATEGORIES).map(([key, val]) => `
    <div class="nav-item cat-${key}" data-cat="${key}" onclick="filterByCategory('${key}')">
      ${val.icon}
      ${val.label}
      <span class="nav-badge">${counts[key]||0}</span>
    </div>
  `).join('');
}

function getFilteredAcronyms() {
  let items = [...state.acronyms];

  if (state.page === 'bookmarks') {
    items = items.filter(a => state.bookmarks.has(a.id));
  }

  if (state.categoryFilter) {
    items = items.filter(a => a.category === state.categoryFilter);
  }

  if (state.search.trim()) {
    const q = state.search.toLowerCase().trim();
    items = items.filter(a =>
      a.acronym.toLowerCase().includes(q) ||
      a.name.toLowerCase().includes(q) ||
      a.definition.toLowerCase().includes(q)
    );
  }

  // Sort
  switch(state.sort) {
    case 'alpha-asc': items.sort((a,b) => a.acronym.localeCompare(b.acronym)); break;
    case 'alpha-desc': items.sort((a,b) => b.acronym.localeCompare(a.acronym)); break;
    case 'newest': items.sort((a,b) => b.added - a.added); break;
    case 'category': items.sort((a,b) => a.category.localeCompare(b.category) || a.acronym.localeCompare(b.acronym)); break;
  }

  return items;
}

function highlightText(text, query) {
  if (!query.trim()) return text;
  const escaped = query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
  return text.replace(new RegExp(`(${escaped})`, 'gi'), '<span class="highlight">$1</span>');
}

function renderAcronyms() {
  const grid = document.getElementById('acronymGrid');
  const items = getFilteredAcronyms();
  const query = state.search;

  grid.className = `acronym-grid ${state.view === 'list' ? 'list-view' : 'grid-view'}`;

  document.getElementById('searchResults').textContent = state.search ?
    `${items.length} result${items.length !== 1 ? 's' : ''} found` :
    (state.page === 'bookmarks' ? `${items.length} bookmarked` : `${items.length} acronyms`);

  if (items.length === 0) {
    grid.innerHTML = `
      <div class="empty-state" style="grid-column:1/-1">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>
        </svg>
        <h3>${state.page === 'bookmarks' ? 'No bookmarks yet' : 'No acronyms found'}</h3>
        <p>${state.page === 'bookmarks' ? 'Bookmark acronyms to save them here for quick reference.' : 'Try a different search term or add a new acronym.'}</p>
      </div>`;
    return;
  }

  grid.innerHTML = items.map((item, i) => `
    <div class="acronym-card cat-${item.category} stagger" style="animation-delay:${Math.min(i * 30, 300)}ms">
      <div class="card-accent"></div>
      <div class="card-top">
        <div>
          <div class="acronym">${highlightText(item.acronym, query)}</div>
          <div class="full-name">${highlightText(item.name, query)}</div>
        </div>
        <div class="card-actions">
          <button class="action-btn ${state.bookmarks.has(item.id) ? 'bookmarked' : ''}" onclick="toggleBookmark(${item.id})" title="Bookmark">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="${state.bookmarks.has(item.id) ? 'currentColor' : 'none'}" stroke="currentColor" stroke-width="2"><path d="m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z"/></svg>
          </button>
          <button class="action-btn" onclick="editAcronym(${item.id})" title="Edit">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
          </button>
          <button class="action-btn" onclick="deleteAcronym(${item.id})" title="Delete">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>
          </button>
        </div>
      </div>
      <div class="definition">${highlightText(item.definition, query)}</div>
      <div class="card-footer">
        <span class="tag cat-${item.category}"><span class="dot"></span>${CATEGORIES[item.category]?.label || item.category}</span>
      </div>
    </div>
  `).join('');
}

function updateActiveFilters() {
  const el = document.getElementById('activeFilters');
  let html = '';

  if (state.page === 'bookmarks') {
    html += `<span style="font-size:15px;font-weight:600">Bookmarked Acronyms</span>`;
  } else if (state.categoryFilter) {
    const cat = CATEGORIES[state.categoryFilter];
    html += `<span style="font-size:15px;font-weight:600">${cat?.label || state.categoryFilter}</span>`;
    html += `<button class="btn btn-ghost btn-sm" onclick="navigateTo('browse')" style="font-size:12px">Clear filter &times;</button>`;
  }

  el.innerHTML = html;
}

function updateStats() {
  document.getElementById('totalCount').textContent = state.acronyms.length;
  document.getElementById('bookmarkCount').textContent = state.bookmarks.size;
  document.getElementById('statTotal').textContent = state.acronyms.length;
  document.getElementById('statCats').textContent = new Set(state.acronyms.map(a=>a.category)).size;
  document.getElementById('statBookmarks').textContent = state.bookmarks.size;
  renderCategoryNav();
}

// ─── Actions ───
function handleSearch() {
  state.search = document.getElementById('searchInput').value;
  document.getElementById('searchClear').classList.toggle('show', state.search.length > 0);
  renderAcronyms();
}

function clearSearch() {
  state.search = '';
  document.getElementById('searchInput').value = '';
  document.getElementById('searchClear').classList.remove('show');
  renderAcronyms();
  document.getElementById('searchInput').focus();
}

function handleSort() {
  state.sort = document.getElementById('sortSelect').value;
  renderAcronyms();
}

function setView(view) {
  state.view = view;
  document.querySelectorAll('.view-btn').forEach(b => b.classList.toggle('active', b.dataset.view === view));
  renderAcronyms();
  saveState();
}

function toggleBookmark(id) {
  if (state.bookmarks.has(id)) {
    state.bookmarks.delete(id);
    showToast('Removed from bookmarks');
  } else {
    state.bookmarks.add(id);
    showToast('Added to bookmarks', 'success');
  }
  state.acronyms.forEach(a => { a.bookmarked = state.bookmarks.has(a.id); });
  renderAcronyms();
  updateStats();
  saveState();
}

function deleteAcronym(id) {
  if (!confirm('Delete this acronym?')) return;
  state.acronyms = state.acronyms.filter(a => a.id !== id);
  state.bookmarks.delete(id);
  renderAcronyms();
  updateStats();
  saveState();
  showToast('Acronym deleted');
}

// ─── Modal ───
function openAddModal() {
  state.editingId = null;
  document.getElementById('modalTitle').textContent = 'Add Acronym';
  document.getElementById('formSubmit').textContent = 'Add Acronym';
  document.getElementById('formAcronym').value = '';
  document.getElementById('formName').value = '';
  document.getElementById('formDefinition').value = '';
  document.getElementById('formCategory').value = 'general';
  document.getElementById('addModal').classList.add('open');
  setTimeout(() => document.getElementById('formAcronym').focus(), 100);
}

function editAcronym(id) {
  const item = state.acronyms.find(a => a.id === id);
  if (!item) return;
  state.editingId = id;
  document.getElementById('modalTitle').textContent = 'Edit Acronym';
  document.getElementById('formSubmit').textContent = 'Save Changes';
  document.getElementById('formAcronym').value = item.acronym;
  document.getElementById('formName').value = item.name;
  document.getElementById('formDefinition').value = item.definition;
  document.getElementById('formCategory').value = item.category;
  document.getElementById('addModal').classList.add('open');
  setTimeout(() => document.getElementById('formAcronym').focus(), 100);
}

function closeAddModal() {
  document.getElementById('addModal').classList.remove('open');
}

function closeModal(e) {
  if (e.target === e.currentTarget) closeAddModal();
}

function saveAcronym() {
  const acronym = document.getElementById('formAcronym').value.trim().toUpperCase();
  const name = document.getElementById('formName').value.trim();
  const definition = document.getElementById('formDefinition').value.trim();
  const category = document.getElementById('formCategory').value;

  if (!acronym || !name || !definition) {
    showToast('Please fill in all required fields', 'error');
    return;
  }

  if (state.editingId) {
    const item = state.acronyms.find(a => a.id === state.editingId);
    if (item) {
      item.acronym = acronym;
      item.name = name;
      item.definition = definition;
      item.category = category;
      showToast('Acronym updated', 'success');
    }
  } else {
    const newId = Math.max(0, ...state.acronyms.map(a=>a.id)) + 1;
    state.acronyms.push({ id: newId, acronym, name, definition, category, bookmarked: false, added: Date.now() });
    showToast('Acronym added', 'success');
  }

  closeAddModal();
  renderAcronyms();
  updateStats();
  saveState();
}

// ─── Quiz ───
function renderQuizSetup() {
  const quizPage = document.getElementById('quizPage');
  const catCounts = {};
  state.acronyms.forEach(a => { catCounts[a.category] = (catCounts[a.category]||0) + 1; });

  quizPage.innerHTML = `
    <div class="quiz-container">
      <div class="quiz-header">
        <h2>Quiz Mode</h2>
        <p>Test your knowledge of company acronyms</p>
      </div>
      <div class="quiz-settings">
        <h3>Configure Your Quiz</h3>
        <div class="setting-group">
          <label class="setting-label">Number of Questions</label>
          <div class="setting-options">
            ${[5,10,15,20].map(n => `
              <div class="setting-chip ${state.quiz.count===n?'active':''}" onclick="setQuizCount(${n})">${n}</div>
            `).join('')}
          </div>
        </div>
        <div class="setting-group">
          <label class="setting-label">Categories (leave empty for all)</label>
          <div class="setting-options">
            ${Object.entries(CATEGORIES).filter(([k]) => catCounts[k]).map(([key, val]) => `
              <div class="setting-chip ${state.quiz.categories.includes(key)?'active':''}" onclick="toggleQuizCategory('${key}')">${val.label} (${catCounts[key]})</div>
            `).join('')}
          </div>
        </div>
        <div style="margin-top:24px">
          <button class="btn btn-primary btn-lg" onclick="startQuiz()" style="width:100%">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>
            Start Quiz
          </button>
        </div>
      </div>
    </div>`;
}

function setQuizCount(n) {
  state.quiz.count = n;
  renderQuizSetup();
}

function toggleQuizCategory(cat) {
  const idx = state.quiz.categories.indexOf(cat);
  if (idx === -1) state.quiz.categories.push(cat);
  else state.quiz.categories.splice(idx, 1);
  renderQuizSetup();
}

function startQuiz() {
  let pool = [...state.acronyms];
  if (state.quiz.categories.length > 0) {
    pool = pool.filter(a => state.quiz.categories.includes(a.category));
  }

  if (pool.length < 4) {
    showToast('Need at least 4 acronyms to start a quiz', 'error');
    return;
  }

  const count = Math.min(state.quiz.count, pool.length);

  // Shuffle and pick questions
  const shuffled = pool.sort(() => Math.random() - 0.5);
  const selected = shuffled.slice(0, count);

  state.quiz.questions = selected.map(item => {
    // Generate wrong answers
    const others = pool.filter(a => a.id !== item.id);
    const wrongOnes = others.sort(() => Math.random() - 0.5).slice(0, 3);
    const options = [...wrongOnes.map(w => ({ text: w.name, correct: false })), { text: item.name, correct: true }];
    // Shuffle options
    options.sort(() => Math.random() - 0.5);

    return { item, options };
  });

  state.quiz.current = 0;
  state.quiz.score = 0;
  state.quiz.active = true;
  state.quiz.answered = false;

  renderQuizQuestion();
}

function renderQuizQuestion() {
  const quizPage = document.getElementById('quizPage');
  const q = state.quiz.questions[state.quiz.current];
  const total = state.quiz.questions.length;
  const current = state.quiz.current;
  const progress = ((current) / total) * 100;

  quizPage.innerHTML = `
    <div class="quiz-container">
      <div class="quiz-progress">
        <div class="quiz-progress-bar">
          <div class="quiz-progress-fill" style="width:${progress}%"></div>
        </div>
        <div class="quiz-progress-text">${current + 1} / ${total}</div>
      </div>
      <div class="quiz-card fade-in">
        <div class="quiz-question-label">What does this acronym stand for?</div>
        <div class="quiz-acronym">${q.item.acronym}</div>
        <div class="quiz-hint">
          <span class="tag cat-${q.item.category}"><span class="dot"></span>${CATEGORIES[q.item.category]?.label}</span>
        </div>
        <div class="quiz-options">
          ${q.options.map((opt, i) => `
            <div class="quiz-option" data-correct="${opt.correct}" onclick="answerQuiz(this, ${opt.correct}, ${i})">
              <span class="option-letter">${String.fromCharCode(65 + i)}</span>
              <span>${opt.text}</span>
            </div>
          `).join('')}
        </div>
        <div id="quizExplanation"></div>
      </div>
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div style="font-size:13px;color:var(--text-muted)">
          Score: <strong style="color:var(--success)">${state.quiz.score}</strong> / ${total}
        </div>
        <div style="display:flex;gap:8px">
          <button class="btn btn-secondary btn-sm" onclick="renderQuizSetup()">Quit</button>
          <button class="btn btn-primary btn-sm" id="nextQuizBtn" style="display:none" onclick="nextQuizQuestion()">
            ${current + 1 < total ? 'Next Question' : 'See Results'}
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
          </button>
        </div>
      </div>
    </div>`;
}

function answerQuiz(el, correct, index) {
  if (state.quiz.answered) return;
  state.quiz.answered = true;

  if (correct) state.quiz.score++;

  // Mark all options
  document.querySelectorAll('.quiz-option').forEach(opt => {
    opt.classList.add('disabled');
    if (opt.dataset.correct === 'true') {
      if (opt === el) {
        opt.classList.add('correct');
      } else {
        opt.classList.add('reveal');
      }
    }
  });

  if (!correct) {
    el.classList.add('wrong');
  }

  // Show explanation
  const q = state.quiz.questions[state.quiz.current];
  document.getElementById('quizExplanation').innerHTML = `
    <div class="quiz-explanation">
      <strong>${q.item.acronym}</strong> stands for <strong>${q.item.name}</strong>. ${q.item.definition}
    </div>`;

  document.getElementById('nextQuizBtn').style.display = 'inline-flex';
}

function nextQuizQuestion() {
  state.quiz.current++;
  state.quiz.answered = false;

  if (state.quiz.current >= state.quiz.questions.length) {
    renderQuizResults();
  } else {
    renderQuizQuestion();
  }
}

function renderQuizResults() {
  const quizPage = document.getElementById('quizPage');
  const total = state.quiz.questions.length;
  const score = state.quiz.score;
  const pct = Math.round((score / total) * 100);
  const circumference = 2 * Math.PI * 58;
  const offset = circumference - (pct / 100) * circumference;

  let message = '';
  if (pct === 100) message = 'Perfect score! You know your acronyms inside and out!';
  else if (pct >= 80) message = 'Excellent work! You have a strong grasp of company terminology.';
  else if (pct >= 60) message = 'Good effort! A little more practice and you\'ll be an expert.';
  else if (pct >= 40) message = 'Not bad! Keep studying to improve your knowledge.';
  else message = 'Looks like there\'s room to learn. Try browsing the acronym list!';

  quizPage.innerHTML = `
    <div class="quiz-container">
      <div class="quiz-card fade-in">
        <div class="quiz-results">
          <div class="quiz-score-circle">
            <svg width="140" height="140">
              <circle cx="70" cy="70" r="58" fill="none" stroke="var(--border)" stroke-width="8"/>
              <circle cx="70" cy="70" r="58" fill="none" stroke="var(--primary)" stroke-width="8" stroke-dasharray="${circumference}" stroke-dashoffset="${offset}" stroke-linecap="round" style="transition:stroke-dashoffset 1s ease-out"/>
            </svg>
            <span class="score-value">${pct}%</span>
            <span class="score-label">Score</span>
          </div>
          <h3>Quiz Complete!</h3>
          <p>${message}</p>
          <div class="quiz-stats">
            <div class="quiz-stat stat-correct">
              <div class="stat-value">${score}</div>
              <div class="stat-label">Correct</div>
            </div>
            <div class="quiz-stat stat-wrong">
              <div class="stat-value">${total - score}</div>
              <div class="stat-label">Incorrect</div>
            </div>
            <div class="quiz-stat">
              <div class="stat-value">${total}</div>
              <div class="stat-label">Total</div>
            </div>
          </div>
          <div style="display:flex;gap:12px;justify-content:center;flex-wrap:wrap">
            <button class="btn btn-primary" onclick="startQuiz()">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"/><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/></svg>
              Try Again
            </button>
            <button class="btn btn-secondary" onclick="renderQuizSetup()">Change Settings</button>
            <button class="btn btn-ghost" onclick="navigateTo('browse')">Browse Acronyms</button>
          </div>
        </div>
      </div>
    </div>`;
}

// ─── Theme ───
function toggleTheme() {
  const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
  document.documentElement.setAttribute('data-theme', isDark ? 'light' : 'dark');
  localStorage.setItem('theme', isDark ? 'light' : 'dark');
  updateThemeIcon();
}

function updateThemeIcon() {
  const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
  document.getElementById('themeIcon').innerHTML = isDark
    ? '<circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>'
    : '<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>';
}

// Load theme preference
(function(){
  const saved = localStorage.getItem('theme');
  if (saved === 'dark' || (!saved && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
    document.documentElement.setAttribute('data-theme', 'dark');
  }
  updateThemeIcon();
})();

// ─── Toast ───
function showToast(message, type = '') {
  const container = document.getElementById('toastContainer');
  const toast = document.createElement('div');
  toast.className = `toast ${type}`;
  toast.innerHTML = type === 'success'
    ? `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>${message}`
    : type === 'error'
    ? `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>${message}`
    : message;
  container.appendChild(toast);
  setTimeout(() => { toast.style.opacity = '0'; toast.style.transform = 'translateY(10px)'; setTimeout(() => toast.remove(), 200); }, 2500);
}

// ─── Start ───
init();
</script>
</body>
</html>
