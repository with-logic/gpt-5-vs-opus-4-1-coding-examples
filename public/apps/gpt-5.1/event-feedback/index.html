<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Event Feedback Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      :root {
        --bg: #f3f4f7;
        --bg-soft: #e5e7f0;
        --surface: #ffffff;
        --surface-soft: #f9fafb;
        --accent: #2563eb;
        --accent-soft: rgba(37, 99, 235, 0.08);
        --accent-strong: #1d4ed8;
        --text: #111827;
        --text-soft: #4b5563;
        --text-softer: #6b7280;
        --border-subtle: #e5e7eb;
        --shadow-soft: 0 14px 30px rgba(15, 23, 42, 0.12);
        --shadow-subtle: 0 1px 3px rgba(15, 23, 42, 0.08);
        --table-header-bg: #f9fafb;
        --row-alt-bg: #f9fafb;
        --row-hover-bg: #eef2ff;
        --rating-high-bg: #ecfdf3;
        --rating-high-text: #166534;
        --rating-mid-bg: #fef9c3;
        --rating-mid-text: #92400e;
        --rating-low-bg: #fef2f2;
        --rating-low-text: #b91c1c;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        min-height: 100vh;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        background: radial-gradient(
            circle at top left,
            rgba(37, 99, 235, 0.12),
            transparent 55%
          ),
          radial-gradient(
            circle at bottom right,
            rgba(15, 118, 110, 0.12),
            transparent 55%
          ),
          var(--bg);
        color: var(--text);
      }

      .app-shell {
        min-height: 100vh;
        padding: 24px 32px 32px;
        display: flex;
        flex-direction: column;
        gap: 16px;
        max-width: 1200px;
        margin: 0 auto;
      }

      .app-header {
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
        gap: 16px;
      }

      .app-title {
        margin: 0;
        font-size: 1.8rem;
        letter-spacing: -0.02em;
      }

      .app-subtitle {
        margin: 4px 0 0;
        font-size: 0.9rem;
        color: var(--text-softer);
      }

      .badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 4px 10px;
        border-radius: 999px;
        background: rgba(15, 23, 42, 0.04);
        color: var(--text-soft);
        font-size: 0.75rem;
        font-weight: 500;
        box-shadow: var(--shadow-subtle);
        white-space: nowrap;
      }

      .badge-dot {
        width: 7px;
        height: 7px;
        border-radius: 999px;
        background: #22c55e;
        box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.18);
      }

      .summary-card {
        position: relative;
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
        gap: 20px;
        padding: 16px 18px 16px 18px;
        border-radius: 14px;
        background: linear-gradient(
            135deg,
            rgba(37, 99, 235, 0.05),
            rgba(8, 47, 73, 0.02)
          ),
          var(--surface);
        border: 1px solid rgba(37, 99, 235, 0.14);
        box-shadow: var(--shadow-soft);
        overflow: hidden;
      }

      .summary-card::before {
        content: "";
        position: absolute;
        right: -40px;
        top: -40px;
        width: 140px;
        height: 140px;
        border-radius: 999px;
        background: radial-gradient(
          circle,
          rgba(37, 99, 235, 0.22),
          transparent 60%
        );
        opacity: 0.3;
        pointer-events: none;
      }

      .summary-main {
        position: relative;
        z-index: 1;
        max-width: 680px;
      }

      .summary-label {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 3px 9px;
        border-radius: 999px;
        background: rgba(15, 23, 42, 0.04);
        color: var(--text-soft);
        font-size: 0.7rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
      }

      .summary-label-dot {
        width: 6px;
        height: 6px;
        border-radius: 999px;
        background: var(--accent);
      }

      .summary-title {
        margin: 6px 0 4px;
        font-size: 1.1rem;
      }

      .summary-body {
        margin: 4px 0 10px;
        font-size: 0.85rem;
        color: var(--text-soft);
        max-width: 640px;
      }

      .summary-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        margin-top: 4px;
      }

      .summary-tag {
        padding: 4px 9px;
        border-radius: 999px;
        border: 1px dashed rgba(148, 163, 184, 0.8);
        font-size: 0.7rem;
        color: var(--text-softer);
        background: rgba(255, 255, 255, 0.5);
      }

      .summary-metrics {
        position: relative;
        z-index: 1;
        display: flex;
        align-items: stretch;
        gap: 10px;
      }

      .summary-metric {
        min-width: 88px;
        padding: 8px 10px;
        border-radius: 10px;
        background: rgba(15, 23, 42, 0.5);
        background-blend-mode: multiply;
        backdrop-filter: blur(12px);
        color: #e5e7eb;
        border: 1px solid rgba(148, 163, 184, 0.7);
        box-shadow: 0 10px 25px rgba(15, 23, 42, 0.45);
      }

      .summary-metric-label {
        font-size: 0.7rem;
        color: #cbd5f5;
      }

      .summary-metric-value {
        margin-top: 4px;
        font-size: 1rem;
        font-weight: 600;
      }

      .summary-metric-footnote {
        margin-top: 3px;
        font-size: 0.65rem;
        color: #e5e7eb;
        opacity: 0.85;
      }

      .summary-close {
        position: absolute;
        top: 10px;
        right: 10px;
        width: 26px;
        height: 26px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border-radius: 999px;
        border: none;
        background: rgba(15, 23, 42, 0.05);
        color: var(--text-soft);
        cursor: pointer;
        font-size: 0.9rem;
        transition: background 0.12s ease, transform 0.12s ease,
          color 0.12s ease;
      }

      .summary-close:hover {
        background: rgba(15, 23, 42, 0.12);
        color: var(--text);
        transform: scale(1.03);
      }

      .summary-card.summary-hidden {
        margin: 0;
        padding-top: 0;
        padding-bottom: 0;
        border-width: 0;
        box-shadow: none;
        max-height: 0;
        opacity: 0;
        overflow: hidden;
        transition: all 0.2s ease;
      }

      .summary-card:not(.summary-hidden) {
        transition: all 0.25s ease;
      }

      .card {
        background: linear-gradient(
            145deg,
            rgba(255, 255, 255, 0.9),
            rgba(248, 250, 252, 0.9)
          ),
          var(--surface);
        border-radius: 16px;
        padding: 16px 18px 18px;
        box-shadow: var(--shadow-soft);
        border: 1px solid rgba(148, 163, 184, 0.55);
        display: flex;
        flex-direction: column;
        gap: 10px;
        min-height: 0;
      }

      .controls-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        flex-wrap: wrap;
      }

      .search-input-wrapper {
        position: relative;
        flex: 1 1 260px;
      }

      .search-icon {
        position: absolute;
        left: 11px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 0.85rem;
        pointer-events: none;
        color: var(--text-softer);
      }

      .search-input {
        width: 100%;
        padding: 9px 12px 9px 30px;
        border-radius: 999px;
        border: 1px solid var(--border-subtle);
        background: var(--surface-soft);
        font-size: 0.85rem;
        color: var(--text);
        outline: none;
        transition: border-color 0.12s ease, box-shadow 0.12s ease,
          background 0.12s ease;
      }

      .search-input::placeholder {
        color: var(--text-softer);
      }

      .search-input:focus {
        border-color: var(--accent);
        background: #ffffff;
        box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.7),
          0 0 0 6px rgba(37, 99, 235, 0.12);
      }

      .table-meta {
        font-size: 0.8rem;
        color: var(--text-softer);
        white-space: nowrap;
      }

      .pill {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 4px 9px;
        border-radius: 999px;
        background: var(--accent-soft);
        color: var(--accent-strong);
        font-size: 0.75rem;
        font-weight: 500;
      }

      .pill-dot {
        width: 6px;
        height: 6px;
        border-radius: 999px;
        background: var(--accent-strong);
      }

      .table-container {
        border-radius: 12px;
        border: 1px solid rgba(148, 163, 184, 0.6);
        overflow: hidden;
        background: var(--surface);
      }

      .table-wrapper {
        max-height: 62vh;
        overflow: auto;
      }

      table {
        border-collapse: collapse;
        width: 100%;
        min-width: 780px;
        font-size: 0.82rem;
      }

      thead tr {
        background: linear-gradient(
          90deg,
          rgba(248, 250, 252, 0.95),
          rgba(241, 245, 249, 0.98)
        );
        position: sticky;
        top: 0;
        z-index: 1;
      }

      th,
      td {
        padding: 9px 10px;
        text-align: left;
        border-bottom: 1px solid rgba(226, 232, 240, 0.9);
        vertical-align: top;
      }

      th {
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.07em;
        color: var(--text-soft);
        position: relative;
        backdrop-filter: blur(14px);
      }

      th:first-child,
      td:first-child {
        padding-left: 14px;
      }

      th:last-child,
      td:last-child {
        padding-right: 14px;
      }

      tbody tr:nth-child(even) {
        background: var(--row-alt-bg);
      }

      tbody tr:hover {
        background: var(--row-hover-bg);
      }

      .sortable {
        cursor: pointer;
        user-select: none;
      }

      .th-content {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        white-space: nowrap;
      }

      .sort-icon {
        font-size: 0.7rem;
        color: var(--text-softer);
        opacity: 0;
        transition: opacity 0.15s ease, transform 0.15s ease;
      }

      th.sortable:hover .sort-icon {
        opacity: 0.8;
      }

      th.sortable.sorted-asc .sort-icon,
      th.sortable.sorted-desc .sort-icon {
        opacity: 1;
        color: var(--accent-strong);
      }

      th.sortable.sorted-asc .sort-icon {
        transform: translateY(-1px);
      }

      th.sortable.sorted-desc .sort-icon {
        transform: translateY(1px);
      }

      .date-cell {
        white-space: nowrap;
        font-variant-numeric: tabular-nums;
      }

      .event-cell {
        font-weight: 500;
        color: var(--text);
      }

      .participant-cell {
        color: var(--text-soft);
      }

      .rating-pill {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 3px 9px;
        border-radius: 999px;
        font-size: 0.75rem;
        font-weight: 600;
      }

      .rating-pill-high {
        background: var(--rating-high-bg);
        color: var(--rating-high-text);
        border: 1px solid rgba(22, 101, 52, 0.24);
      }

      .rating-pill-mid {
        background: var(--rating-mid-bg);
        color: var(--rating-mid-text);
        border: 1px solid rgba(146, 64, 14, 0.24);
      }

      .rating-pill-low {
        background: var(--rating-low-bg);
        color: var(--rating-low-text);
        border: 1px solid rgba(185, 28, 28, 0.24);
      }

      .rating-scale {
        font-size: 0.7rem;
        opacity: 0.8;
      }

      .feedback-cell {
        max-width: 380px;
        color: var(--text-soft);
        line-height: 1.4;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }

      .feedback-cell span {
        display: inline;
      }

      .empty-state {
        padding: 24px;
        text-align: center;
        font-size: 0.9rem;
        color: var(--text-softer);
      }

      @media (max-width: 900px) {
        .app-shell {
          padding: 18px 14px 22px;
        }

        .app-header {
          flex-direction: column;
          align-items: flex-start;
          gap: 8px;
        }

        .summary-card {
          flex-direction: column;
          gap: 14px;
        }

        .summary-metrics {
          width: 100%;
        }

        .summary-metric {
          flex: 1 1 0;
        }

        .card {
          padding: 12px 12px 14px;
        }

        .table-wrapper {
          max-height: none;
        }
      }

      @media (max-width: 640px) {
        .controls-row {
          align-items: stretch;
        }

        .table-meta {
          width: 100%;
          text-align: right;
        }

        table {
          min-width: 640px;
        }
      }
    </style>
  </head>
  <body>
    <div class="app-shell">
      <header class="app-header">
        <div>
          <h1 class="app-title">Event Feedback Dashboard</h1>
          <p class="app-subtitle">
            Review participant sentiment and experience across your recent
            events‚Äîall in one clean view.
          </p>
        </div>
        <div>
          <span class="badge">
            <span class="badge-dot"></span>
            Live feedback snapshot
          </span>
        </div>
      </header>

      <section id="ai-summary" class="summary-card" aria-label="AI summary">
        <button
          class="summary-close"
          type="button"
          aria-label="Hide AI summary"
        >
          √ó
        </button>
        <div class="summary-main">
          <div class="summary-label">
            <span class="summary-label-dot"></span>
            AI summary
          </div>
          <h2 class="summary-title">Overall sentiment is strong and steady</h2>
          <p class="summary-body">
            Participants consistently highlight knowledgeable speakers, clear
            storytelling, and well-paced agendas. Feedback suggests that
            interactive elements and time for practical application have the
            biggest impact on satisfaction. The main opportunities are deeper
            breakout discussions and more concrete next steps after each
            session.
          </p>
          <div class="summary-tags">
            <span class="summary-tag">High engagement</span>
            <span class="summary-tag">Content clarity</span>
            <span class="summary-tag">Actionable insights</span>
            <span class="summary-tag">Networking &amp; interaction</span>
          </div>
        </div>
        <div class="summary-metrics" aria-hidden="true">
          <div class="summary-metric">
            <div class="summary-metric-label">Average rating</div>
            <div id="avg-rating" class="summary-metric-value">4.6</div>
            <div class="summary-metric-footnote">out of 5</div>
          </div>
          <div class="summary-metric">
            <div class="summary-metric-label">Promoters</div>
            <div id="promoters-count" class="summary-metric-value">‚Äî</div>
            <div class="summary-metric-footnote">rated 4.5 or higher</div>
          </div>
          <div class="summary-metric">
            <div class="summary-metric-label">Distinct events</div>
            <div id="events-count" class="summary-metric-value">‚Äî</div>
            <div class="summary-metric-footnote">in this view</div>
          </div>
        </div>
      </section>

      <main class="card">
        <div class="controls-row">
          <div class="search-input-wrapper">
            <span class="search-icon">üîç</span>
            <input
              id="search-input"
              class="search-input"
              type="search"
              placeholder="Search by event, participant, rating, or keywords in feedback‚Ä¶"
              aria-label="Search feedback entries"
            />
          </div>
          <div class="table-meta">
            <span class="pill">
              <span class="pill-dot"></span>
              <span>
                Showing
                <span id="visible-count">0</span> of
                <span id="total-count">0</span>
                responses
              </span>
            </span>
          </div>
        </div>

        <div class="table-container" aria-live="polite">
          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th
                    class="sortable"
                    data-key="date"
                    scope="col"
                    aria-label="Sort by date"
                  >
                    <span class="th-content">
                      Date
                      <span class="sort-icon" aria-hidden="true">‚áÖ</span>
                    </span>
                  </th>
                  <th
                    class="sortable"
                    data-key="eventName"
                    scope="col"
                    aria-label="Sort by event name"
                  >
                    <span class="th-content">
                      Event
                      <span class="sort-icon" aria-hidden="true">‚áÖ</span>
                    </span>
                  </th>
                  <th
                    class="sortable"
                    data-key="participantName"
                    scope="col"
                    aria-label="Sort by participant"
                  >
                    <span class="th-content">
                      Participant
                      <span class="sort-icon" aria-hidden="true">‚áÖ</span>
                    </span>
                  </th>
                  <th
                    class="sortable"
                    data-key="rating"
                    scope="col"
                    aria-label="Sort by rating"
                  >
                    <span class="th-content">
                      Rating
                      <span class="sort-icon" aria-hidden="true">‚áÖ</span>
                    </span>
                  </th>
                  <th
                    class="sortable"
                    data-key="feedback"
                    scope="col"
                    aria-label="Sort by feedback"
                  >
                    <span class="th-content">
                      Feedback
                      <span class="sort-icon" aria-hidden="true">‚áÖ</span>
                    </span>
                  </th>
                </tr>
              </thead>
              <tbody id="table-body"></tbody>
            </table>
          </div>
          <div id="empty-state" class="empty-state" style="display: none">
            No feedback entries match your search. Try a different keyword or
            clear the search box.
          </div>
        </div>
      </main>
    </div>

    <script>
      (function () {
        const firstNames = [
          "Alex",
          "Jordan",
          "Taylor",
          "Morgan",
          "Casey",
          "Riley",
          "Blake",
          "Avery",
          "Reese",
          "Quinn",
          "Harper",
          "Drew",
          "Logan",
          "Hayden",
          "Emerson",
        ];

        const lastNames = [
          "Nguyen",
          "Patel",
          "Garcia",
          "Kim",
          "Martinez",
          "Brown",
          "Johnson",
          "Schneider",
          "Williams",
          "Khan",
          "Lopez",
          "Rodriguez",
          "Fischer",
          "Dupont",
          "Silva",
        ];

        const companies = [
          "Northwind Retail",
          "Acme Financial",
          "BluePeak Analytics",
          "Summit Health",
          "Aurora Mobility",
          "Vertex Cloud",
          "Brightline Media",
          "Evergreen Foods",
          "Lighthouse Consulting",
          "Orbit Logistics",
        ];

        const events = [
          "Customer Success Summit",
          "Leadership Offsite 2024",
          "Product Strategy Deep Dive",
          "Quarterly Business Review",
          "Enterprise Onboarding Workshop",
          "Data Storytelling Masterclass",
          "Customer Journey Mapping Lab",
          "Revenue Operations Roundtable",
          "Hybrid Collaboration Bootcamp",
          "Digital Transformation Forum",
        ];

        const topics = [
          "stakeholder communication",
          "remote collaboration",
          "product roadmap planning",
          "change management",
          "customer journey mapping",
          "data storytelling",
          "customer retention",
          "cross-functional alignment",
          "prioritization frameworks",
          "meeting facilitation",
        ];

        const improvements = [
          "more live demos",
          "additional hands-on exercises",
          "extra time for peer discussion",
          "clearer pre-read material",
          "more concrete next steps",
          "real-world implementation examples",
          "shorter lecture-style segments",
          "follow-up office hours",
        ];

        const feedbackTemplates = [
          "The session offered a great balance between theory and practice. I especially appreciated the concrete examples around {topic}. I left with several ideas I can apply immediately with my team.",
          "I enjoyed the content and found the speakers very credible. The pacing felt thoughtful and there was enough room for questions. A bit more focus on {improvement} would make it outstanding.",
          "Strong facilitation and clear structure from start to finish. The frameworks on {topic} gave me language to use with senior stakeholders. I would love to see {improvement} in future editions.",
          "This event was time well spent. The group exercises helped reinforce the concepts around {topic}, and the discussion with peers surfaced useful best practices. I wish we had {improvement}.",
          "The visuals and storytelling made the material on {topic} easy to follow. I appreciated how practical the recommendations were. Adding {improvement} could make the experience even richer.",
          "Very polished experience with minimal technical friction. The content on {topic} connected directly to current initiatives in our organization. I would have enjoyed {improvement} toward the end.",
          "Thoughtful, well-structured, and relevant. The real value came from hearing how other companies approach {topic}. If we could incorporate {improvement}, it would help drive even more adoption.",
          "I came in with limited context on {topic} and left feeling confident about the basics. The facilitator created space for reflection and discussion. My only ask is {improvement} next time.",
        ];

        function pickRandom(array) {
          return array[Math.floor(Math.random() * array.length)];
        }

        function randomRating() {
          const rating = 3 + Math.random() * 2; // 3.0‚Äì5.0
          return Number(rating.toFixed(1));
        }

        function ratingClass(rating) {
          if (rating >= 4.5) return "rating-pill-high";
          if (rating >= 3.7) return "rating-pill-mid";
          return "rating-pill-low";
        }

        function buildFeedback() {
          const template = pickRandom(feedbackTemplates);
          const topic = pickRandom(topics);
          const improvement = pickRandom(improvements);
          return template
            .replace("{topic}", topic)
            .replace("{improvement}", improvement);
        }

        function randomDateWithinLastDays(days) {
          const now = new Date();
          const offsetDays = Math.floor(Math.random() * days);
          const d = new Date(
            now.getTime() - offsetDays * 24 * 60 * 60 * 1000
          );
          // Randomize within the day
          d.setHours(Math.floor(Math.random() * 8) + 8); // 8am‚Äì4pm
          d.setMinutes(Math.floor(Math.random() * 60));
          d.setSeconds(0, 0);
          return d;
        }

        function formatDate(date) {
          const months = [
            "Jan",
            "Feb",
            "Mar",
            "Apr",
            "May",
            "Jun",
            "Jul",
            "Aug",
            "Sep",
            "Oct",
            "Nov",
            "Dec",
          ];
          const month = months[date.getMonth()];
          const day = String(date.getDate()).padStart(2, "0");
          const year = date.getFullYear();
          return month + " " + day + ", " + year;
        }

        const data = [];
        const ENTRY_COUNT = 30;

        for (let i = 0; i < ENTRY_COUNT; i++) {
          const dateObj = randomDateWithinLastDays(90);
          const eventName = pickRandom(events);
          const rating = randomRating();
          const first = pickRandom(firstNames);
          const last = pickRandom(lastNames);
          const company = pickRandom(companies);
          const participantName = first + " " + last + " ¬∑ " + company;
          const feedback = buildFeedback();

          data.push({
            id: i + 1,
            dateObj: dateObj,
            dateLabel: formatDate(dateObj),
            eventName: eventName,
            participantName: participantName,
            rating: rating,
            feedback: feedback,
          });
        }

        const state = {
          sortKey: "date",
          sortDirection: "desc",
          search: "",
        };

        const tbody = document.getElementById("table-body");
        const searchInput = document.getElementById("search-input");
        const visibleCountEl = document.getElementById("visible-count");
        const totalCountEl = document.getElementById("total-count");
        const emptyStateEl = document.getElementById("empty-state");

        const avgRatingEl = document.getElementById("avg-rating");
        const promotersCountEl = document.getElementById("promoters-count");
        const eventsCountEl = document.getElementById("events-count");

        function updateSummaryMetrics() {
          if (!data.length) return;
          const total = data.reduce(function (sum, row) {
            return sum + row.rating;
          }, 0);
          const avg = total / data.length;
          const promoters = data.filter(function (row) {
            return row.rating >= 4.5;
          }).length;
          const distinctEvents = new Set(
            data.map(function (row) {
              return row.eventName;
            })
          ).size;

          if (avgRatingEl) avgRatingEl.textContent = avg.toFixed(1);
          if (promotersCountEl) promotersCountEl.textContent = String(promoters);
          if (eventsCountEl) eventsCountEl.textContent = String(distinctEvents);
        }

        function matchesSearch(row, term) {
          if (!term) return true;
          const value =
            row.dateLabel +
            " " +
            row.eventName +
            " " +
            row.participantName +
            " " +
            row.rating +
            " " +
            row.feedback;
          return value.toLowerCase().indexOf(term.toLowerCase()) !== -1;
        }

        function compareRows(a, b) {
          var dir = state.sortDirection === "asc" ? 1 : -1;
          var key = state.sortKey;
          var av;
          var bv;

          if (key === "date") {
            av = a.dateObj;
            bv = b.dateObj;
          } else if (key === "rating") {
            av = a.rating;
            bv = b.rating;
          } else {
            av = a[key] || "";
            bv = b[key] || "";
            av = String(av).toLowerCase();
            bv = String(bv).toLowerCase();
          }

          if (av < bv) return -1 * dir;
          if (av > bv) return 1 * dir;
          return 0;
        }

        function renderTableRows(rows) {
          if (!tbody) return;
          tbody.innerHTML = "";

          if (!rows.length) {
            if (emptyStateEl) emptyStateEl.style.display = "block";
            return;
          }

          if (emptyStateEl) emptyStateEl.style.display = "none";

          var fragment = document.createDocumentFragment();

          rows.forEach(function (row) {
            var tr = document.createElement("tr");

            var tdDate = document.createElement("td");
            tdDate.className = "date-cell";
            tdDate.textContent = row.dateLabel;
            tr.appendChild(tdDate);

            var tdEvent = document.createElement("td");
            tdEvent.className = "event-cell";
            tdEvent.textContent = row.eventName;
            tr.appendChild(tdEvent);

            var tdParticipant = document.createElement("td");
            tdParticipant.className = "participant-cell";
            tdParticipant.textContent = row.participantName;
            tr.appendChild(tdParticipant);

            var tdRating = document.createElement("td");
            var ratingSpan = document.createElement("span");
            var ratingClassName =
              "rating-pill " + ratingClass(row.rating || 0);
            ratingSpan.className = ratingClassName;
            ratingSpan.innerHTML =
              '<span>' +
              row.rating.toFixed(1) +
              "</span>" +
              '<span class="rating-scale">/ 5</span>';
            tdRating.appendChild(ratingSpan);
            tr.appendChild(tdRating);

            var tdFeedback = document.createElement("td");
            tdFeedback.className = "feedback-cell";
            var feedbackSpan = document.createElement("span");
            feedbackSpan.textContent = row.feedback;
            tdFeedback.appendChild(feedbackSpan);
            tdFeedback.title = row.feedback;
            tr.appendChild(tdFeedback);

            fragment.appendChild(tr);
          });

          tbody.appendChild(fragment);
        }

        function updateCounts(visibleCount) {
          if (visibleCountEl)
            visibleCountEl.textContent = String(visibleCount);
          if (totalCountEl) totalCountEl.textContent = String(data.length);
        }

        function updateSortIndicators() {
          var headers = document.querySelectorAll("th.sortable");
          headers.forEach(function (th) {
            var icon = th.querySelector(".sort-icon");
            var key = th.getAttribute("data-key");
            th.classList.remove("sorted-asc", "sorted-desc");

            if (!icon) return;

            if (key === state.sortKey) {
              var dir = state.sortDirection;
              th.classList.add(dir === "asc" ? "sorted-asc" : "sorted-desc");
              icon.textContent = dir === "asc" ? "‚ñ≤" : "‚ñº";
            } else {
              icon.textContent = "‚áÖ";
            }
          });
        }

        function render() {
          var filtered = data.filter(function (row) {
            return matchesSearch(row, state.search);
          });
          var sorted = filtered.slice().sort(compareRows);
          renderTableRows(sorted);
          updateCounts(filtered.length);
        }

        function wireUpSorting() {
          var headers = document.querySelectorAll("th.sortable");
          headers.forEach(function (th) {
            th.addEventListener("click", function () {
              var key = th.getAttribute("data-key");
              if (!key) return;

              if (state.sortKey === key) {
                state.sortDirection =
                  state.sortDirection === "asc" ? "desc" : "asc";
              } else {
                state.sortKey = key;
                state.sortDirection = key === "date" ? "desc" : "asc";
              }

              updateSortIndicators();
              render();
            });
          });
        }

        function wireUpSearch() {
          if (!searchInput) return;
          searchInput.addEventListener("input", function (event) {
            state.search = (event.target.value || "").trim();
            render();
          });
        }

        function wireUpSummaryClose() {
          var summarySection = document.getElementById("ai-summary");
          var closeButton = summarySection
            ? summarySection.querySelector(".summary-close")
            : null;
          if (!summarySection || !closeButton) return;
          closeButton.addEventListener("click", function () {
            summarySection.classList.add("summary-hidden");
          });
        }

        // Initial setup
        updateSummaryMetrics();
        wireUpSorting();
        wireUpSearch();
        wireUpSummaryClose();
        updateSortIndicators();
        render();
      })();
    </script>
  </body>
</html>

