<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Tea Dunkability Simulator</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
      :root {
        color-scheme: dark;
        --bg: radial-gradient(circle at top, #0a0f19, #05060a);
        --glass: rgba(255, 255, 255, 0.08);
        --accent: #f59f0b;
      }
      body {
        margin: 0;
        font-family: "Space Grotesk", system-ui;
        background: var(--bg);
        color: #f8fafc;
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 2rem;
      }
      .app {
        width: min(960px, 100%);
        display: grid;
        gap: 1.5rem;
      }
      .card {
        background: var(--glass);
        border-radius: 24px;
        padding: 1.5rem;
        backdrop-filter: blur(16px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
      }
      label {
        display: flex;
        justify-content: space-between;
        margin-bottom: 0.6rem;
      }
      input[type="range"],
      select {
        width: 100%;
      }
      .teacup {
        width: 220px;
        height: 140px;
        border: 6px solid #f8fafc;
        border-radius: 0 0 120px 120px;
        margin: 0 auto;
        position: relative;
        overflow: hidden;
      }
      .steam span {
        position: absolute;
        top: -40px;
        width: 6px;
        height: 60px;
        border-radius: 999px;
        background: linear-gradient(transparent, rgba(255, 255, 255, 0.5));
        animation: float 3s ease-in-out infinite;
      }
      @keyframes float {
        from {
          transform: translateY(30px) scaleX(0.7);
          opacity: 0;
        }
        50% {
          opacity: 1;
        }
        to {
          transform: translateY(-30px) scaleX(0.4);
          opacity: 0;
        }
      }
      .crumbs span {
        position: absolute;
        width: 8px;
        height: 8px;
        background: #d97706;
        border-radius: 50%;
        animation: fall 1s linear forwards;
      }
      @keyframes fall {
        to {
          transform: translateY(50px) scale(0.3);
          opacity: 0;
        }
      }
      .graph {
        height: 120px;
        display: flex;
        gap: 0.5rem;
        align-items: flex-end;
      }
      .graph div {
        flex: 1;
        background: linear-gradient(180deg, #fde68a, #b45309);
        border-radius: 12px 12px 0 0;
      }
      .shortcuts {
        font-size: 0.85rem;
        opacity: 0.7;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const biscuits = [
        { name: "Digestive", factor: 0.5 },
        { name: "Rich tea", factor: 0.6 },
        { name: "Shortbread", factor: 0.4 },
        { name: "Ginger nut", factor: 0.3 },
      ];

      function App() {
        const [temp, setTemp] = React.useState(85);
        const [time, setTime] = React.useState(4);
        const [integrity, setIntegrity] = React.useState(70);
        const [biscuit, setBiscuit] = React.useState(biscuits[0]);
        const [crumbs, setCrumbs] = React.useState([]);

        const risk = Math.min(1, (temp / 100 + time / 10 + (100 - integrity) / 100 + biscuit.factor) / 3);

        React.useEffect(() => {
          const handler = (event) => {
            if (event.key === "t") setTemp((t) => Math.min(100, t + 2));
            if (event.key === "d") setTime((t) => Math.min(10, t + 0.5));
          };
          window.addEventListener("keydown", handler);
          return () => window.removeEventListener("keydown", handler);
        }, []);

        React.useEffect(() => {
          if (risk > 0.7) {
            const crumb = { id: crypto.randomUUID(), x: Math.random() * 200 + 10 };
            setCrumbs((c) => [...c.slice(-8), crumb]);
            setTimeout(() => setCrumbs((c) => c.filter((item) => item.id !== crumb.id)), 1200);
          }
        }, [risk]);

        const graphBars = [temp / 100, time / 10, integrity / 100, 1 - biscuit.factor];

        return (
          <div className="app">
            <div className="card">
              <h1>Tea Dunkability Simulator</h1>
              <p className="shortcuts">Shortcuts: T heat ↑ · D dunk time ↑</p>
            </div>
            <div className="card" style={{ display: "grid", gap: "1rem" }}>
              <label>
                <span>Tea temperature ({temp}°C)</span>
                <input type="range" min="60" max="100" value={temp} onChange={(e) => setTemp(Number(e.target.value))} />
              </label>
              <label>
                <span>Dunk time ({time.toFixed(1)} s)</span>
                <input type="range" min="1" max="10" step="0.5" value={time} onChange={(e) => setTime(Number(e.target.value))} />
              </label>
              <label>
                <span>Structural integrity ({integrity}%)</span>
                <input type="range" min="30" max="100" value={integrity} onChange={(e) => setIntegrity(Number(e.target.value))} />
              </label>
              <label>
                <span>Biscuit</span>
                <select value={biscuit.name} onChange={(e) => setBiscuit(biscuits.find((b) => b.name === e.target.value))}>
                  {biscuits.map((b) => (
                    <option key={b.name}>{b.name}</option>
                  ))}
                </select>
              </label>
            </div>
            <div className="card" style={{ display: "flex", justifyContent: "space-between", alignItems: "center" }}>
              <div className="teacup">
                <div style={{ position: "absolute", inset: "40% 0 0", background: `linear-gradient(180deg, #fcd34d, #b45309)` }}></div>
                <div className="steam">
                  {[0, 1, 2].map((n) => (
                    <span key={n} style={{ left: 60 + n * 40, animationDelay: `${n * 0.6}s` }}></span>
                  ))}
                </div>
                <div className="crumbs">
                  {crumbs.map((crumb) => (
                    <span key={crumb.id} style={{ left: crumb.x }}></span>
                  ))}
                </div>
              </div>
              <div>
                <p>Risk level</p>
                <h2>{Math.round(risk * 100)}%</h2>
                <p>{risk > 0.7 ? "Abort dunk!" : "Safe to dunk."}</p>
              </div>
            </div>
            <div className="card">
              <h3>Crumble-o-meter</h3>
              <div className="graph">
                {graphBars.map((value, idx) => (
                  <div key={idx} style={{ height: `${value * 100}%` }}></div>
                ))}
              </div>
            </div>
          </div>
        );
      }

      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
