<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Tiny Kanban</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #0f172a;
      --bg-elevated: #020617;
      --bg-column: #020617;
      --border-subtle: rgba(148, 163, 184, 0.3);
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.12);
      --accent-strong: rgba(56, 189, 248, 0.3);
      --text-primary: #e5e7eb;
      --text-muted: #9ca3af;
      --danger: #f97373;
      --danger-soft: rgba(248, 113, 113, 0.1);
      --danger-strong: rgba(248, 113, 113, 0.3);
      --card-bg: #020617;
      --card-border: rgba(148, 163, 184, 0.35);
      --shadow-soft: 0 18px 50px rgba(15, 23, 42, 0.9);
      --radius-lg: 18px;
      --radius-md: 12px;
      --radius-pill: 999px;
      --transition-fast: 150ms ease-out;
    }

    * {
      box-sizing: border-box;
    }

    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      background: radial-gradient(circle at top left, #1f2937 0, #020617 40%)
          fixed,
        radial-gradient(circle at bottom right, #0f172a 0, #020617 55%) fixed;
      color: var(--text-primary);
      font-size: 16px;
      line-height: 1.5;
      display: flex;
      justify-content: center;
      align-items: stretch;
    }

    .app-shell {
      width: 100%;
      max-width: 1320px;
      margin: 20px auto;
      padding: 18px 18px 24px;
      background: linear-gradient(
        135deg,
        rgba(15, 23, 42, 0.96),
        rgba(2, 6, 23, 0.98)
      );
      border-radius: 26px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      box-shadow: var(--shadow-soft);
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    @media (max-width: 900px) {
      .app-shell {
        margin: 0;
        border-radius: 0;
        border-left: none;
        border-right: none;
      }
    }

    .topbar {
      display: flex;
      gap: 18px;
      align-items: center;
      justify-content: space-between;
    }

    .topbar-left {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .title-row {
      display: flex;
      align-items: baseline;
      gap: 12px;
    }

    .app-title {
      font-size: 1.6rem;
      font-weight: 650;
      letter-spacing: 0.03em;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .title-pill {
      font-size: 0.8rem;
      padding: 3px 10px;
      border-radius: var(--radius-pill);
      border: 1px solid rgba(148, 163, 184, 0.5);
      color: var(--text-muted);
    }

    .subtitle {
      font-size: 0.95rem;
      color: var(--text-muted);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .subtitle span {
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .subtitle-arrow {
      opacity: 0.7;
    }

    .topbar-right {
      display: flex;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .search-group {
      position: relative;
      min-width: 220px;
      max-width: 320px;
      flex: 1 1 220px;
    }

    .search-input {
      width: 100%;
      padding: 9px 32px 9px 34px;
      border-radius: var(--radius-pill);
      border: 1px solid var(--border-subtle);
      background: radial-gradient(
        circle at top left,
        rgba(56, 189, 248, 0.06),
        rgba(15, 23, 42, 0.96)
      );
      color: var(--text-primary);
      font-size: 0.9rem;
      outline: none;
      transition: border-color var(--transition-fast),
        box-shadow var(--transition-fast), background-color var(--transition-fast);
    }

    .search-input::placeholder {
      color: rgba(148, 163, 184, 0.8);
    }

    .search-input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.4);
      background: radial-gradient(
        circle at top left,
        rgba(56, 189, 248, 0.12),
        rgba(15, 23, 42, 0.98)
      );
    }

    .search-icon {
      position: absolute;
      left: 11px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 0.9rem;
      color: rgba(148, 163, 184, 0.9);
      pointer-events: none;
    }

    .search-hint {
      position: absolute;
      right: 8px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 0.65rem;
      padding: 2px 6px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      color: rgba(148, 163, 184, 0.9);
    }

    .button {
      border-radius: var(--radius-pill);
      border: 1px solid rgba(148, 163, 184, 0.4);
      background: radial-gradient(
        circle at top left,
        rgba(56, 189, 248, 0.09),
        rgba(15, 23, 42, 0.98)
      );
      color: var(--text-primary);
      font-size: 0.85rem;
      padding: 8px 14px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      transition: background var(--transition-fast),
        border-color var(--transition-fast), transform 80ms ease-out,
        box-shadow var(--transition-fast);
      white-space: nowrap;
    }

    .button span {
      font-size: 1.1rem;
    }

    .button:hover {
      background: radial-gradient(
        circle at top left,
        rgba(56, 189, 248, 0.12),
        rgba(15, 23, 42, 0.98)
      );
      border-color: rgba(56, 189, 248, 0.7);
      transform: translateY(-0.5px);
      box-shadow: 0 7px 18px rgba(15, 23, 42, 0.8);
    }

    .button:active {
      transform: translateY(0.5px) scale(0.99);
      box-shadow: none;
    }

    .button-ghost {
      background: transparent;
      border-style: dashed;
      border-color: rgba(148, 163, 184, 0.6);
    }

    .legend {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      color: var(--text-muted);
      font-size: 0.8rem;
      padding: 8px 12px 6px;
      border-radius: 999px;
      border: 1px dashed rgba(148, 163, 184, 0.5);
      background: radial-gradient(
        circle at left,
        rgba(56, 189, 248, 0.08),
        rgba(15, 23, 42, 0.96)
      );
    }

    @media (max-width: 720px) {
      .legend {
        flex-wrap: wrap;
        border-radius: var(--radius-md);
      }
    }

    .legend-left,
    .legend-right {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .legend-label {
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-size: 0.7rem;
      color: rgba(148, 163, 184, 0.95);
    }

    .legend-item {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.4);
    }

    .legend-dot {
      width: 10px;
      height: 10px;
      border-radius: 999px;
    }

    .priority-high {
      background: #f97373;
      box-shadow: 0 0 0 1px rgba(248, 113, 113, 0.7);
    }

    .priority-medium {
      background: #facc15;
      box-shadow: 0 0 0 1px rgba(234, 179, 8, 0.7);
    }

    .priority-low {
      background: #4ade80;
      box-shadow: 0 0 0 1px rgba(74, 222, 128, 0.7);
    }

    .legend-pill {
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      background: rgba(15, 23, 42, 0.9);
    }

    .board {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 18px;
      padding-top: 4px;
    }

    @media (max-width: 960px) {
      .board {
        grid-template-columns: repeat(3, minmax(0, 1fr));
        overflow-x: auto;
        padding-bottom: 8px;
      }
    }

    @media (max-width: 720px) {
      .board {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .column {
      display: flex;
      flex-direction: column;
      gap: 10px;
      background: radial-gradient(
        circle at top left,
        rgba(15, 23, 42, 0.95),
        rgba(15, 23, 42, 0.98)
      );
      border-radius: var(--radius-lg);
      border: 1px solid rgba(148, 163, 184, 0.5);
      box-shadow: 0 14px 30px rgba(15, 23, 42, 0.9);
      min-height: 260px;
      position: relative;
      overflow: hidden;
    }

    .column-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 12px 6px 12px;
      border-bottom: 1px solid rgba(31, 41, 55, 0.95);
      background: radial-gradient(
        circle at top left,
        rgba(56, 189, 248, 0.14),
        rgba(31, 41, 55, 0.85)
      );
      position: relative;
      z-index: 1;
    }

    .column-header-main {
      display: flex;
      align-items: baseline;
      gap: 8px;
    }

    .column-title {
      font-size: 0.95rem;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      font-weight: 650;
      color: #e5e7eb;
    }

    .column-subtitle {
      font-size: 0.72rem;
      color: rgba(148, 163, 184, 0.95);
      text-transform: uppercase;
      letter-spacing: 0.14em;
    }

    .column-meta {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.74rem;
      color: var(--text-muted);
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.9);
      font-size: 0.7rem;
    }

    .chip-strong {
      background: var(--accent-soft);
      border-color: rgba(56, 189, 248, 0.9);
      color: rgba(191, 219, 254, 0.95);
    }

    .wip-input-wrapper {
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .wip-input-wrapper span {
      font-size: 0.72rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      opacity: 0.9;
    }

    .wip-input {
      width: 34px;
      padding: 1px 4px 1px 4px;
      border-radius: 6px;
      border: 1px solid rgba(148, 163, 184, 0.9);
      background: rgba(15, 23, 42, 0.95);
      color: var(--text-primary);
      font-size: 0.72rem;
      text-align: center;
      outline: none;
      transition: border-color var(--transition-fast),
        background-color var(--transition-fast), box-shadow var(--transition-fast);
    }

    .wip-input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.4);
      background: rgba(15, 23, 42, 0.98);
    }

    .column-count {
      font-size: 0.72rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: rgba(191, 219, 254, 0.95);
      padding: 2px 6px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      background: rgba(15, 23, 42, 0.95);
    }

    .column-body {
      padding: 10px 10px 10px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      min-height: 180px;
      position: relative;
      transition: background-color 120ms ease-out, box-shadow 120ms ease-out,
        border-color 120ms ease-out;
    }

    .column-footer {
      padding: 6px 10px 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      font-size: 0.72rem;
      color: var(--text-muted);
    }

    .column-footer button {
      font-size: 0.8rem;
    }

    .column-drop-target {
      border-radius: 14px;
      border: 1px dashed rgba(148, 163, 184, 0.7);
      background: radial-gradient(
        circle at top,
        rgba(56, 189, 248, 0.12),
        rgba(15, 23, 42, 1)
      );
      box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.5);
    }

    .column-over-limit .column-header {
      background: radial-gradient(
        circle at top left,
        rgba(248, 113, 113, 0.18),
        rgba(31, 41, 55, 0.9)
      );
      border-bottom-color: rgba(248, 113, 113, 0.6);
    }

    .column-over-limit .column-body {
      background: radial-gradient(
        circle at top,
        rgba(248, 113, 113, 0.1),
        rgba(15, 23, 42, 1)
      );
      box-shadow: inset 0 0 0 1px rgba(248, 113, 113, 0.4);
    }

    .column-over-limit .column-count {
      border-color: rgba(248, 113, 113, 0.9);
      background: rgba(127, 29, 29, 0.9);
      color: #fee2e2;
    }

    .column-over-limit .wip-input {
      border-color: rgba(248, 113, 113, 0.9);
      background: rgba(127, 29, 29, 0.9);
      color: #fee2e2;
    }

    .card {
      background: radial-gradient(
        circle at top left,
        rgba(15, 23, 42, 0.95),
        rgba(15, 23, 42, 1)
      );
      border-radius: 14px;
      border: 1px solid var(--card-border);
      padding: 8px 9px 8px 10px;
      box-shadow: 0 10px 26px rgba(15, 23, 42, 0.9);
      cursor: grab;
      display: flex;
      flex-direction: column;
      gap: 6px;
      position: relative;
      transition: transform 80ms ease-out, box-shadow 120ms ease-out,
        border-color 120ms ease-out, background-color 120ms ease-out,
        opacity 100ms ease-out;
    }

    .card[data-priority="high"] {
      border-left: 4px solid #f97373;
      box-shadow: 0 0 0 1px rgba(248, 113, 113, 0.4),
        0 18px 32px rgba(15, 23, 42, 0.9);
    }

    .card[data-priority="medium"] {
      border-left: 4px solid #facc15;
      box-shadow: 0 0 0 1px rgba(250, 204, 21, 0.4),
        0 18px 32px rgba(15, 23, 42, 0.9);
    }

    .card[data-priority="low"] {
      border-left: 4px solid #4ade80;
      box-shadow: 0 0 0 1px rgba(74, 222, 128, 0.4),
        0 18px 32px rgba(15, 23, 42, 0.9);
    }

    .card-header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 6px;
    }

    .card-title {
      font-size: 0.9rem;
      font-weight: 550;
      color: #e5e7eb;
    }

    .card-title span {
      font-size: 0.8rem;
      opacity: 0.75;
    }

    .card-meta {
      display: flex;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
      font-size: 0.72rem;
      color: var(--text-muted);
    }

    .card-priority-tag {
      padding: 2px 6px;
      border-radius: 999px;
      font-size: 0.7rem;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(148, 163, 184, 0.6);
    }

    .card-priority-tag[data-priority="high"] {
      background: rgba(127, 29, 29, 0.9);
      border-color: rgba(248, 113, 113, 0.9);
      color: #fecaca;
    }

    .card-priority-tag[data-priority="medium"] {
      background: rgba(120, 53, 15, 0.9);
      border-color: rgba(250, 204, 21, 0.9);
      color: #fef9c3;
    }

    .card-priority-tag[data-priority="low"] {
      background: rgba(20, 83, 45, 0.9);
      border-color: rgba(74, 222, 128, 0.9);
      color: #bbf7d0;
    }

    .card-assignee {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 2px 7px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.95);
      color: rgba(209, 213, 219, 0.95);
    }

    .avatar {
      width: 18px;
      height: 18px;
      border-radius: 999px;
      background: radial-gradient(
        circle at top left,
        #38bdf8,
        #6366f1 60%,
        #ec4899
      );
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 0.6rem;
      font-weight: 650;
      color: #e5e7eb;
      box-shadow: 0 0 0 1px rgba(15, 23, 42, 0.9);
    }

    .card-description {
      font-size: 0.8rem;
      color: rgba(209, 213, 219, 0.9);
    }

    .card-actions {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 6px;
      font-size: 0.7rem;
      color: var(--text-muted);
    }

    .card-badge {
      padding: 2px 6px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(148, 163, 184, 0.6);
    }

    .card button {
      border: none;
      background: transparent;
      color: rgba(148, 163, 184, 0.9);
      cursor: pointer;
      padding: 2px 4px;
      border-radius: 6px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      transition: background-color 80ms ease-out, color 80ms ease-out;
    }

    .card button:hover {
      background: rgba(15, 23, 42, 0.9);
      color: #fca5a5;
    }

    .card.dragging {
      opacity: 0.55;
      transform: scale(0.99);
      box-shadow: 0 18px 42px rgba(15, 23, 42, 0.95);
    }

    .card-hidden {
      opacity: 0.12;
      transform: scale(0.99);
    }

    .card--filtered-out {
      display: none;
    }

    .empty-hint {
      font-size: 0.78rem;
      color: rgba(148, 163, 184, 0.9);
      border-radius: 12px;
      border: 1px dashed rgba(75, 85, 99, 0.85);
      padding: 9px 10px;
      background: rgba(15, 23, 42, 0.9);
      text-align: center;
    }

    .empty-hint span {
      opacity: 0.9;
    }

    .badge-keyboard {
      padding: 0 6px;
      border-radius: 5px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.9);
      font-size: 0.7rem;
      margin-left: 4px;
    }

    .footer-note {
      font-size: 0.75rem;
      color: rgba(148, 163, 184, 0.95);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      padding-top: 4px;
      border-top: 1px solid rgba(30, 64, 175, 0.5);
      margin-top: 6px;
    }

    .footer-note span {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .pill {
      padding: 1px 7px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.9);
      font-size: 0.7rem;
      color: rgba(191, 219, 254, 0.95);
    }

    .hotkey-pill {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
        "Liberation Mono", "Courier New", monospace;
    }

    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.82);
      backdrop-filter: blur(16px) saturate(150%);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 40;
      opacity: 0;
      pointer-events: none;
      transition: opacity 140ms ease-out;
    }

    .modal-backdrop[data-open="true"] {
      opacity: 1;
      pointer-events: auto;
    }

    .modal {
      width: 100%;
      max-width: 430px;
      background: radial-gradient(
        circle at top left,
        rgba(56, 189, 248, 0.16),
        rgba(15, 23, 42, 0.98)
      );
      border-radius: 22px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      box-shadow: 0 26px 60px rgba(15, 23, 42, 0.98);
      padding: 16px 18px 14px;
      transform: translateY(8px) scale(0.98);
      opacity: 0;
      transition: opacity 140ms ease-out, transform 140ms ease-out;
    }

    .modal-backdrop[data-open="true"] .modal {
      opacity: 1;
      transform: translateY(0) scale(1);
    }

    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 8px;
    }

    .modal-title {
      font-size: 1.05rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .modal-subtitle {
      font-size: 0.78rem;
      color: rgba(191, 219, 254, 0.9);
    }

    .modal-close-btn {
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.9);
      color: rgba(209, 213, 219, 0.95);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      width: 26px;
      height: 26px;
      font-size: 1rem;
      transition: background-color 120ms ease-out, color 120ms ease-out,
        border-color 120ms ease-out, transform 80ms ease-out;
    }

    .modal-close-btn:hover {
      background: rgba(127, 29, 29, 0.9);
      border-color: rgba(248, 113, 113, 0.9);
      color: #fee2e2;
      transform: translateY(-0.5px);
    }

    .modal-body {
      display: flex;
      flex-direction: column;
      gap: 10px;
      padding-top: 4px;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 0.82rem;
    }

    .field label {
      color: rgba(209, 213, 219, 0.95);
      display: flex;
      align-items: center;
      gap: 6px;
      justify-content: space-between;
    }

    .field-label-main {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .field-hint {
      font-size: 0.7rem;
      color: rgba(148, 163, 184, 0.95);
    }

    .field-required {
      color: #f97373;
    }

    .input,
    .textarea,
    .select {
      width: 100%;
      border-radius: 10px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.96);
      color: var(--text-primary);
      font-size: 0.82rem;
      padding: 6px 8px;
      outline: none;
      resize: vertical;
      min-height: 0;
      transition: border-color var(--transition-fast),
        box-shadow var(--transition-fast), background-color var(--transition-fast);
    }

    .input::placeholder,
    .textarea::placeholder {
      color: rgba(148, 163, 184, 0.9);
    }

    .textarea {
      min-height: 60px;
      max-height: 120px;
    }

    .select {
      padding-right: 24px;
    }

    .input:focus,
    .textarea:focus,
    .select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.4);
      background: rgba(15, 23, 42, 0.98);
    }

    .select-row {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .select-row .select {
      flex: 1;
    }

    .modal-footer {
      margin-top: 8px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      font-size: 0.75rem;
      color: rgba(148, 163, 184, 0.95);
    }

    .modal-footer-actions {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .button-primary {
      border-radius: var(--radius-pill);
      border: none;
      padding: 8px 16px;
      font-size: 0.85rem;
      font-weight: 550;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      color: #0b1120;
      background: linear-gradient(
        135deg,
        #38bdf8,
        #22c55e 50%,
        #facc15
      );
      box-shadow: 0 12px 30px rgba(8, 47, 73, 0.9);
      transition: transform 80ms ease-out, box-shadow 120ms ease-out,
        filter 80ms ease-out;
    }

    .button-primary:hover {
      filter: brightness(1.06);
      transform: translateY(-0.5px);
      box-shadow: 0 16px 36px rgba(8, 47, 73, 1);
    }

    .button-primary:active {
      transform: translateY(0.5px) scale(0.99);
      box-shadow: none;
    }

    .button-secondary {
      border-radius: var(--radius-pill);
      border: 1px solid rgba(148, 163, 184, 0.6);
      padding: 7px 12px;
      font-size: 0.82rem;
      cursor: pointer;
      background: rgba(15, 23, 42, 0.98);
      color: rgba(209, 213, 219, 0.96);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: background-color 120ms ease-out, border-color 120ms ease-out,
        transform 80ms ease-out;
    }

    .button-secondary:hover {
      background: rgba(30, 64, 175, 0.9);
      border-color: rgba(191, 219, 254, 0.9);
      transform: translateY(-0.5px);
    }

    .toast-container {
      position: fixed;
      bottom: 16px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 50;
      display: flex;
      flex-direction: column;
      gap: 6px;
      pointer-events: none;
    }

    .toast {
      min-width: 260px;
      max-width: 380px;
      border-radius: 999px;
      padding: 6px 12px;
      font-size: 0.78rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: radial-gradient(
        circle at top left,
        rgba(56, 189, 248, 0.16),
        rgba(15, 23, 42, 0.98)
      );
      box-shadow: 0 16px 40px rgba(15, 23, 42, 0.98);
      opacity: 0;
      transform: translateY(6px);
      transition: opacity 160ms ease-out, transform 160ms ease-out;
      pointer-events: auto;
    }

    .toast-visible {
      opacity: 1;
      transform: translateY(0);
    }

    .toast-danger {
      border-color: rgba(248, 113, 113, 0.9);
      background: radial-gradient(
        circle at top left,
        rgba(248, 113, 113, 0.2),
        rgba(15, 23, 42, 0.98)
      );
      color: #fee2e2;
    }

    .toast span {
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .toast-strong {
      font-weight: 550;
    }

    @media (max-width: 720px) {
      .topbar {
        flex-direction: column;
        align-items: stretch;
      }

      .topbar-right {
        width: 100%;
        justify-content: space-between;
      }

      .topbar-left {
        align-items: flex-start;
      }

      .legend {
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <header class="topbar">
      <div class="topbar-left">
        <div class="title-row">
          <div class="app-title">
            Tiny Kanban
            <span class="title-pill">Standup-ready</span>
          </div>
        </div>
        <div class="subtitle">
          <span>
            <span class="subtitle-arrow">●</span>
            Todo
          </span>
          <span class="subtitle-arrow">➜</span>
          <span>Doing</span>
          <span class="subtitle-arrow">➜</span>
          <span>Done</span>
        </div>
      </div>
      <div class="topbar-right">
        <div class="search-group">
          <span class="search-icon">⌕</span>
          <input
            id="search-input"
            class="search-input"
            type="search"
            placeholder="Filter by title, description, or assignee"
            autocomplete="off"
          />
          <span class="search-hint">/ to focus</span>
        </div>
        <button id="reset-board-btn" class="button button-ghost" type="button">
          <span>↺</span>
          Reset board
        </button>
      </div>
    </header>

    <section class="legend">
      <div class="legend-left">
        <span class="legend-label">Priorities</span>
        <span class="legend-item">
          <span class="legend-dot priority-high"></span>
          High
        </span>
        <span class="legend-item">
          <span class="legend-dot priority-medium"></span>
          Medium
        </span>
        <span class="legend-item">
          <span class="legend-dot priority-low"></span>
          Low
        </span>
      </div>
      <div class="legend-right">
        <span class="legend-pill">
          Drag cards to move. WIP blocks overfilling Doing.
        </span>
      </div>
    </section>

    <main class="board" aria-label="Tiny Kanban Board">
      <section class="column" data-column="todo">
        <header class="column-header">
          <div class="column-header-main">
            <div class="column-title">Todo</div>
            <div class="column-subtitle">Next up</div>
          </div>
          <div class="column-meta">
            <div class="chip chip-strong">
              <span>Items</span>
              <span class="column-count" data-column-count="todo">0 / 5</span>
            </div>
            <div class="chip">
              <div class="wip-input-wrapper">
                <span>WIP</span>
                <input
                  class="wip-input"
                  type="number"
                  min="1"
                  step="1"
                  value="5"
                  aria-label="Todo WIP limit"
                  data-wip-input="todo"
                />
              </div>
            </div>
          </div>
        </header>
        <div class="column-body" data-column-body="todo"></div>
        <footer class="column-footer">
          <button
            class="button button-ghost"
            type="button"
            data-add-card="todo"
          >
            <span>＋</span>
            Add card
          </button>
          <span>Drag here from Doing/Done</span>
        </footer>
      </section>

      <section class="column" data-column="doing">
        <header class="column-header">
          <div class="column-header-main">
            <div class="column-title">Doing</div>
            <div class="column-subtitle">WIP-focused</div>
          </div>
          <div class="column-meta">
            <div class="chip chip-strong">
              <span>Items</span>
              <span class="column-count" data-column-count="doing">0 / 3</span>
            </div>
            <div class="chip">
              <div class="wip-input-wrapper">
                <span>WIP</span>
                <input
                  class="wip-input"
                  type="number"
                  min="1"
                  step="1"
                  value="3"
                  aria-label="Doing WIP limit"
                  data-wip-input="doing"
                />
              </div>
            </div>
          </div>
        </header>
        <div class="column-body" data-column-body="doing"></div>
        <footer class="column-footer">
          <button
            class="button button-ghost"
            type="button"
            data-add-card="doing"
          >
            <span>＋</span>
            Add card
          </button>
          <span>Keeps the team flowing</span>
        </footer>
      </section>

      <section class="column" data-column="done">
        <header class="column-header">
          <div class="column-header-main">
            <div class="column-title">Done</div>
            <div class="column-subtitle">Showcase</div>
          </div>
          <div class="column-meta">
            <div class="chip chip-strong">
              <span>Items</span>
              <span class="column-count" data-column-count="done">0 / 7</span>
            </div>
            <div class="chip">
              <div class="wip-input-wrapper">
                <span>WIP</span>
                <input
                  class="wip-input"
                  type="number"
                  min="1"
                  step="1"
                  value="7"
                  aria-label="Done WIP cap"
                  data-wip-input="done"
                />
              </div>
            </div>
          </div>
        </header>
        <div class="column-body" data-column-body="done"></div>
        <footer class="column-footer">
          <button
            class="button button-ghost"
            type="button"
            data-add-card="done"
          >
            <span>＋</span>
            Add card
          </button>
          <span>Celebrate and review</span>
        </footer>
      </section>
    </main>

    <div class="footer-note">
      <span>
        Standup tips:
        <span class="pill">Highlight blockers with High priority</span>
      </span>
      <span>
        Shortcuts:
        <span class="pill hotkey-pill">/</span>
        focus search
        <span class="pill hotkey-pill">N</span>
        new card
      </span>
    </div>
  </div>

  <div class="modal-backdrop" id="card-modal-backdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
      <div class="modal-header">
        <div>
          <div class="modal-title" id="modal-title">
            <span id="modal-title-text">New card</span>
          </div>
          <div class="modal-subtitle">
            Keep cards small and focused for quick standups.
          </div>
        </div>
        <button
          type="button"
          class="modal-close-btn"
          id="modal-close-btn"
          aria-label="Close"
        >
          ×
        </button>
      </div>
      <form id="card-form">
        <div class="modal-body">
          <div class="field">
            <label for="card-title">
              <span class="field-label-main">
                Title
                <span class="field-required">*</span>
              </span>
              <span class="field-hint">What will move the task?</span>
            </label>
            <input
              required
              id="card-title"
              name="title"
              class="input"
              type="text"
              maxlength="120"
              placeholder="Example: Ship login flow"
            />
          </div>
          <div class="field">
            <label for="card-description">
              <span class="field-label-main">Details</span>
              <span class="field-hint">Optional — ideal outcome or notes</span>
            </label>
            <textarea
              id="card-description"
              name="description"
              class="textarea"
              maxlength="400"
              placeholder="Example: pair with Alex, verify metrics, no regressions."
            ></textarea>
          </div>
          <div class="field">
            <label>
              <span class="field-label-main">Priority &amp; Column</span>
              <span class="field-hint">Use High for blockers</span>
            </label>
            <div class="select-row">
              <select
                id="card-priority"
                name="priority"
                class="select"
                aria-label="Priority"
              >
                <option value="high">High</option>
                <option value="medium" selected>Medium</option>
                <option value="low">Low</option>
              </select>
              <select
                id="card-column"
                name="column"
                class="select"
                aria-label="Column"
              >
                <option value="todo">Todo</option>
                <option value="doing">Doing</option>
                <option value="done">Done</option>
              </select>
            </div>
          </div>
          <div class="field">
            <label for="card-assignee">
              <span class="field-label-main">Assignee</span>
              <span class="field-hint">Who is driving this?</span>
            </label>
            <input
              id="card-assignee"
              name="assignee"
              class="input"
              type="text"
              maxlength="60"
              placeholder="Example: Alex W."
              autocomplete="off"
            />
          </div>
        </div>
        <div class="modal-footer">
          <div>Drag cards between columns any time.</div>
          <div class="modal-footer-actions">
            <button
              type="button"
              class="button-secondary"
              id="modal-cancel-btn"
            >
              Cancel
            </button>
            <button type="submit" class="button-primary">
              <span id="modal-submit-icon">＋</span>
              <span id="modal-submit-label">Add card</span>
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>

  <div class="toast-container" id="toast-container"></div>

  <script>
    (function () {
      var STORAGE_KEY = "tiny-kanban-v1";
      var searchInput = document.getElementById("search-input");
      var resetBoardBtn = document.getElementById("reset-board-btn");
      var columnBodies = {
        todo: document.querySelector('[data-column-body="todo"]'),
        doing: document.querySelector('[data-column-body="doing"]'),
        done: document.querySelector('[data-column-body="done"]'),
      };
      var columnCounts = {
        todo: document.querySelector('[data-column-count="todo"]'),
        doing: document.querySelector('[data-column-count="doing"]'),
        done: document.querySelector('[data-column-count="done"]'),
      };
      var wipInputs = {
        todo: document.querySelector('[data-wip-input="todo"]'),
        doing: document.querySelector('[data-wip-input="doing"]'),
        done: document.querySelector('[data-wip-input="done"]'),
      };
      var modalBackdrop = document.getElementById("card-modal-backdrop");
      var modalCloseBtn = document.getElementById("modal-close-btn");
      var modalCancelBtn = document.getElementById("modal-cancel-btn");
      var modalTitleText = document.getElementById("modal-title-text");
      var modalSubmitLabel = document.getElementById("modal-submit-label");
      var modalSubmitIcon = document.getElementById("modal-submit-icon");
      var cardForm = document.getElementById("card-form");
      var fieldTitle = document.getElementById("card-title");
      var fieldDescription = document.getElementById("card-description");
      var fieldPriority = document.getElementById("card-priority");
      var fieldColumn = document.getElementById("card-column");
      var fieldAssignee = document.getElementById("card-assignee");
      var toastContainer = document.getElementById("toast-container");
      var addCardButtons = document.querySelectorAll("[data-add-card]");

      var state = createInitialState();
      var currentFilter = "";
      var draggedCardId = null;
      var editingCardId = null;
      var modalOpen = false;

      function createInitialState() {
        var stored = null;
        try {
          stored = window.localStorage.getItem(STORAGE_KEY);
        } catch (e) {}
        if (stored) {
          try {
            var parsed = JSON.parse(stored);
            if (
              parsed &&
              Array.isArray(parsed.cards) &&
              parsed.wipLimits &&
              typeof parsed.nextId === "number"
            ) {
              return parsed;
            }
          } catch (e) {}
        }
        return {
          cards: [
            {
              id: 1,
              title: "Clarify today\u2019s priorities",
              description: "Agree on 1\u20132 most important outcomes for today.",
              priority: "high",
              assignee: "Team",
              column: "todo",
            },
            {
              id: 2,
              title: "Unblock critical work",
              description:
                "Review blockers and decide owners or next steps during standup.",
              priority: "medium",
              assignee: "Facilitator",
              column: "doing",
            },
            {
              id: 3,
              title: "Celebrate a small win",
              description: "Start with 1 quick win to keep energy high.",
              priority: "low",
              assignee: "",
              column: "done",
            },
          ],
          wipLimits: {
            todo: 5,
            doing: 3,
            done: 7,
          },
          nextId: 4,
        };
      }

      function persistState() {
        try {
          window.localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
        } catch (e) {}
      }

      function initialsFor(name) {
        if (!name) return "?";
        var trimmed = name.trim();
        if (!trimmed) return "?";
        var parts = trimmed.split(/\s+/);
        var first = parts[0] ? parts[0].charAt(0) : "";
        var last =
          parts.length > 1 && parts[parts.length - 1]
            ? parts[parts.length - 1].charAt(0)
            : "";
        var result = (first + last).toUpperCase();
        if (!result) return "?";
        return result;
      }

      function matchesFilter(card) {
        if (!currentFilter) return true;
        var q = currentFilter.toLowerCase();
        if (card.title && card.title.toLowerCase().indexOf(q) !== -1) return true;
        if (
          card.description &&
          card.description.toLowerCase().indexOf(q) !== -1
        ) {
          return true;
        }
        if (card.assignee && card.assignee.toLowerCase().indexOf(q) !== -1) {
          return true;
        }
        return false;
      }

      function cardPriorityLabel(priority) {
        if (priority === "high") return "High";
        if (priority === "medium") return "Medium";
        return "Low";
      }

      function cardColumnLabel(column) {
        if (column === "todo") return "Todo";
        if (column === "doing") return "Doing";
        return "Done";
      }

      function showToast(message, options) {
        if (!toastContainer) return;
        var opts = options || {};
        var el = document.createElement("div");
        el.className = "toast";
        if (opts.type === "danger") {
          el.className += " toast-danger";
        }
        var span = document.createElement("span");
        var strong = document.createElement("span");
        strong.className = "toast-strong";
        strong.textContent =
          opts.type === "danger" ? "Heads up" : "Saved";
        var text = document.createElement("span");
        text.textContent = message;
        span.appendChild(strong);
        span.appendChild(text);
        el.appendChild(span);
        toastContainer.appendChild(el);
        requestAnimationFrame(function () {
          el.classList.add("toast-visible");
        });
        var duration = opts.duration || 2600;
        setTimeout(function () {
          el.classList.remove("toast-visible");
          setTimeout(function () {
            if (el.parentNode) {
              el.parentNode.removeChild(el);
            }
          }, 220);
        }, duration);
      }

      function openModal(column, cardId) {
        modalOpen = true;
        modalBackdrop.setAttribute("data-open", "true");
        modalBackdrop.setAttribute("aria-hidden", "false");
        if (typeof cardId === "number") {
          editingCardId = cardId;
          var card = state.cards.find(function (c) {
            return c.id === cardId;
          });
          if (card) {
            modalTitleText.textContent = "Edit card";
            modalSubmitLabel.textContent = "Save";
            modalSubmitIcon.textContent = "✓";
            fieldTitle.value = card.title || "";
            fieldDescription.value = card.description || "";
            fieldPriority.value = card.priority || "medium";
            fieldColumn.value = card.column || column || "todo";
            fieldAssignee.value = card.assignee || "";
          }
        } else {
          editingCardId = null;
          modalTitleText.textContent = "New card";
          modalSubmitLabel.textContent = "Add card";
          modalSubmitIcon.textContent = "＋";
          fieldTitle.value = "";
          fieldDescription.value = "";
          fieldPriority.value = "medium";
          fieldColumn.value = column || "todo";
          fieldAssignee.value = "";
        }
        setTimeout(function () {
          fieldTitle.focus();
          fieldTitle.select();
        }, 20);
      }

      function closeModal() {
        if (!modalOpen) return;
        modalOpen = false;
        modalBackdrop.setAttribute("data-open", "false");
        modalBackdrop.setAttribute("aria-hidden", "true");
        editingCardId = null;
      }

      function ensureWipNumber(column) {
        var input = wipInputs[column];
        var limit = state.wipLimits[column];
        if (!input) return;
        var parsed = parseInt(input.value, 10);
        if (!parsed || parsed < 1) {
          parsed = limit || 1;
          input.value = String(parsed);
        }
        if (!state.wipLimits[column] || state.wipLimits[column] !== parsed) {
          state.wipLimits[column] = parsed;
          persistState();
        }
      }

      function canMoveToColumn(cardId, targetColumn) {
        var card = state.cards.find(function (c) {
          return c.id === cardId;
        });
        if (!card) return false;
        var originColumn = card.column;
        if (originColumn === targetColumn) {
          return true;
        }
        var limit = state.wipLimits[targetColumn];
        if (!limit || limit < 1) {
          limit = 1;
        }
        var countInTarget = state.cards.filter(function (c) {
          return c.column === targetColumn;
        }).length;
        if (countInTarget >= limit) {
          showToast(
            "WIP limit reached in " + cardColumnLabel(targetColumn) + ".",
            { type: "danger", duration: 3200 }
          );
          return false;
        }
        return true;
      }

      function deleteCard(cardId) {
        var idx = state.cards.findIndex(function (c) {
          return c.id === cardId;
        });
        if (idx === -1) return;
        state.cards.splice(idx, 1);
        persistState();
        render();
      }

      function upsertCardFromForm() {
        var title = (fieldTitle.value || "").trim();
        if (!title) {
          fieldTitle.focus();
          return;
        }
        var description = (fieldDescription.value || "").trim();
        var priority = fieldPriority.value || "medium";
        var column = fieldColumn.value || "todo";
        var assignee = (fieldAssignee.value || "").trim();

        if (editingCardId == null) {
          if (!canMoveToColumn(-1, column)) return;
          var newCard = {
            id: state.nextId++,
            title: title,
            description: description,
            priority: priority,
            assignee: assignee,
            column: column,
          };
          state.cards.push(newCard);
        } else {
          var card = state.cards.find(function (c) {
            return c.id === editingCardId;
          });
          if (!card) {
            editingCardId = null;
          } else {
            if (!canMoveToColumn(card.id, column)) return;
            card.title = title;
            card.description = description;
            card.priority = priority;
            card.assignee = assignee;
            card.column = column;
          }
        }
        persistState();
        render();
        closeModal();
      }

      function clearColumnBody(column) {
        var container = columnBodies[column];
        if (!container) return;
        while (container.firstChild) {
          container.removeChild(container.firstChild);
        }
      }

      function renderColumn(column) {
        var container = columnBodies[column];
        if (!container) return;
        clearColumnBody(column);
        var cards = state.cards.filter(function (c) {
          return c.column === column;
        });
        var limit = state.wipLimits[column];
        if (!limit || limit < 1) {
          limit = 1;
          state.wipLimits[column] = limit;
        }
        if (!cards.length) {
          var hint = document.createElement("div");
          hint.className = "empty-hint";
          var label = column === "todo"
            ? "Add the next few slices of work."
            : column === "doing"
            ? "Keep focus small to finish fast."
            : "Drag work here as it completes.";
          hint.innerHTML =
            '<span>' +
            label +
            "</span><span class=\"badge-keyboard\">Drag &amp; drop ready</span>";
          container.appendChild(hint);
        } else {
          cards.forEach(function (card) {
            var visible = matchesFilter(card);
            var cardEl = document.createElement("article");
            cardEl.className = "card";
            if (!visible) {
              cardEl.classList.add("card--filtered-out");
            }
            cardEl.setAttribute("draggable", "true");
            cardEl.setAttribute("data-id", String(card.id));
            cardEl.setAttribute("data-priority", card.priority);

            var header = document.createElement("div");
            header.className = "card-header";

            var titleEl = document.createElement("div");
            titleEl.className = "card-title";
            titleEl.textContent = card.title || "(Untitled)";
            header.appendChild(titleEl);

            var deleteBtn = document.createElement("button");
            deleteBtn.type = "button";
            deleteBtn.setAttribute("title", "Delete card");
            deleteBtn.textContent = "✕";
            deleteBtn.addEventListener("click", function (e) {
              e.stopPropagation();
              var confirmDelete = window.confirm(
                "Delete this card? This cannot be undone."
              );
              if (confirmDelete) {
                deleteCard(card.id);
              }
            });
            header.appendChild(deleteBtn);
            cardEl.appendChild(header);

            if (card.description) {
              var desc = document.createElement("div");
              desc.className = "card-description";
              desc.textContent = card.description;
              cardEl.appendChild(desc);
            }

            var meta = document.createElement("div");
            meta.className = "card-meta";

            var prio = document.createElement("span");
            prio.className = "card-priority-tag";
            prio.setAttribute("data-priority", card.priority);
            var dot = document.createElement("span");
            dot.className = "legend-dot priority-" + card.priority;
            prio.appendChild(dot);
            var label = document.createElement("span");
            label.textContent = cardPriorityLabel(card.priority);
            prio.appendChild(label);
            meta.appendChild(prio);

            if (card.assignee) {
              var assigneeEl = document.createElement("span");
              assigneeEl.className = "card-assignee";
              var avatar = document.createElement("span");
              avatar.className = "avatar";
              avatar.textContent = initialsFor(card.assignee);
              assigneeEl.appendChild(avatar);
              var name = document.createElement("span");
              name.textContent = card.assignee;
              assigneeEl.appendChild(name);
              meta.appendChild(assigneeEl);
            }

            var badge = document.createElement("span");
            badge.className = "card-badge";
            badge.textContent = cardColumnLabel(column);
            meta.appendChild(badge);

            cardEl.appendChild(meta);

            var actions = document.createElement("div");
            actions.className = "card-actions";
            var hint = document.createElement("span");
            hint.textContent = "Drag to move \u2022 Double-click to edit";
            actions.appendChild(hint);
            cardEl.appendChild(actions);

            cardEl.addEventListener("dragstart", function () {
              draggedCardId = card.id;
              cardEl.classList.add("dragging");
            });
            cardEl.addEventListener("dragend", function () {
              draggedCardId = null;
              cardEl.classList.remove("dragging");
              Object.keys(columnBodies).forEach(function (col) {
                columnBodies[col].classList.remove("column-drop-target");
              });
            });
            cardEl.addEventListener("dblclick", function () {
              openModal(column, card.id);
            });

            container.appendChild(cardEl);
          });
        }

        var countEl = columnCounts[column];
        if (countEl) {
          var count = cards.length;
          countEl.textContent = count + " / " + String(state.wipLimits[column]);
        }
        var columnSection = document.querySelector(
          '.column[data-column="' + column + '"]'
        );
        if (columnSection) {
          if (cards.length > state.wipLimits[column]) {
            columnSection.classList.add("column-over-limit");
          } else {
            columnSection.classList.remove("column-over-limit");
          }
        }
      }

      function render() {
        ["todo", "doing", "done"].forEach(function (column) {
          var input = wipInputs[column];
          if (input) {
            var limit = state.wipLimits[column];
            if (!limit || limit < 1) {
              limit = 1;
              state.wipLimits[column] = limit;
            }
            if (String(limit) !== input.value) {
              input.value = String(limit);
            }
          }
          renderColumn(column);
        });
      }

      function setupDragAndDrop() {
        Object.keys(columnBodies).forEach(function (column) {
          var body = columnBodies[column];
          if (!body) return;

          body.addEventListener("dragover", function (e) {
            if (draggedCardId == null) return;
            if (e.preventDefault) e.preventDefault();
            if (body.classList.contains("column-drop-target")) return;
            body.classList.add("column-drop-target");
          });

          body.addEventListener("dragleave", function (e) {
            if (!body.contains(e.relatedTarget)) {
              body.classList.remove("column-drop-target");
            }
          });

          body.addEventListener("drop", function (e) {
            if (e.preventDefault) e.preventDefault();
            body.classList.remove("column-drop-target");
            if (draggedCardId == null) return;
            var cardId = draggedCardId;
            var card = state.cards.find(function (c) {
              return c.id === cardId;
            });
            if (!card) return;
            if (!canMoveToColumn(cardId, column)) return;
            card.column = column;
            persistState();
            render();
          });
        });
      }

      function setupEventListeners() {
        searchInput.addEventListener("input", function () {
          currentFilter = (searchInput.value || "").trim();
          render();
        });

        document.addEventListener("keydown", function (e) {
          if (e.key === "/" && !modalOpen) {
            var active = document.activeElement;
            var tag = active && active.tagName ? active.tagName.toLowerCase() : "";
            if (tag !== "input" && tag !== "textarea" && tag !== "select") {
              e.preventDefault();
              searchInput.focus();
              searchInput.select();
            }
          } else if ((e.key === "n" || e.key === "N") && !modalOpen) {
            var activeTag =
              document.activeElement &&
              document.activeElement.tagName &&
              document.activeElement.tagName.toLowerCase();
            if (activeTag !== "input" && activeTag !== "textarea") {
              e.preventDefault();
              openModal("todo", null);
            }
          } else if (e.key === "Escape" && modalOpen) {
            e.preventDefault();
            closeModal();
          }
        });

        resetBoardBtn.addEventListener("click", function () {
          var confirmed = window.confirm(
            "Reset the board to the starter template? This removes all current cards."
          );
          if (!confirmed) return;
          state = createInitialState();
          persistState();
          currentFilter = "";
          searchInput.value = "";
          render();
          showToast("Board reset to starter template.", {
            type: "info",
          });
        });

        addCardButtons.forEach(function (btn) {
          btn.addEventListener("click", function () {
            var column = btn.getAttribute("data-add-card") || "todo";
            openModal(column, null);
          });
        });

        modalCloseBtn.addEventListener("click", function () {
          closeModal();
        });
        modalCancelBtn.addEventListener("click", function () {
          closeModal();
        });

        modalBackdrop.addEventListener("click", function (e) {
          if (e.target === modalBackdrop) {
            closeModal();
          }
        });

        cardForm.addEventListener("submit", function (e) {
          e.preventDefault();
          upsertCardFromForm();
        });

        Object.keys(wipInputs).forEach(function (column) {
          var input = wipInputs[column];
          if (!input) return;
          input.addEventListener("change", function () {
            ensureWipNumber(column);
            render();
          });
          input.addEventListener("blur", function () {
            ensureWipNumber(column);
            render();
          });
        });
      }

      render();
      setupDragAndDrop();
      setupEventListeners();
    })();
  </script>
</body>
</html>

