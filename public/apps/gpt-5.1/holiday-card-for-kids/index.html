<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Holiday Magic Card</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600;700&family=Fredoka:wght@500;700&display=swap" rel="stylesheet">
  <style>
    :root {
      color-scheme: light;
      --bg-gradient: radial-gradient(circle at top left, #ffe9f7 0, #ffe4c4 22%, #c7f4ff 48%, #d6e4ff 76%, #fef6ff 100%);
      --card-bg: rgba(255, 255, 255, 0.96);
      --card-border: rgba(255, 255, 255, 0.9);
      --primary: #ff4f79;
      --primary-dark: #e43761;
      --accent-green: #27c498;
      --accent-gold: #ffcf4a;
      --text-main: #2b2450;
      --snow-layer-opacity: 0.9;
      --sticker-shadow: 0 6px 14px rgba(15, 0, 50, 0.35);
    }

    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: stretch;
      justify-content: center;
      font-family: "Baloo 2", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background-image:
        radial-gradient(circle at 10% 0%, rgba(255, 255, 255, 0.9) 0, transparent 50%),
        radial-gradient(circle at 90% 0%, rgba(255, 255, 255, 0.75) 0, transparent 55%),
        var(--bg-gradient);
      color: var(--text-main);
      overflow: hidden;
    }

    body::before {
      content: "";
      position: fixed;
      inset: 0;
      pointer-events: none;
      background-image:
        radial-gradient(circle at 10% 20%, rgba(255, 255, 255, 0.35) 0, transparent 55%),
        radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.35) 0, transparent 60%);
      mix-blend-mode: screen;
      opacity: 0.7;
      z-index: 0;
    }

    .app-shell {
      position: relative;
      z-index: 1;
      width: 100%;
      max-width: 1200px;
      margin: 18px auto;
      padding: 16px;
    }

    .app-frame {
      display: grid;
      grid-template-columns: minmax(0, 3fr) minmax(260px, 1.35fr);
      gap: 16px;
      max-height: calc(100vh - 40px);
      backdrop-filter: blur(18px) saturate(130%);
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(248, 246, 255, 0.98));
      border-radius: 26px;
      border: 1px solid rgba(255, 255, 255, 0.9);
      box-shadow:
        0 28px 80px rgba(22, 0, 66, 0.28),
        0 0 0 1px rgba(255, 255, 255, 0.6);
      overflow: hidden;
    }

    @media (max-width: 880px) {
      .app-frame {
        grid-template-columns: minmax(0, 1fr);
        max-height: none;
      }
    }

    .app-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 22px 10px;
      border-bottom: 1px dashed rgba(190, 176, 255, 0.7);
      background: radial-gradient(circle at top left, rgba(255, 255, 255, 0.9) 0, transparent 70%);
    }

    .title-block {
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .title-emoji {
      font-size: 2.4rem;
      filter: drop-shadow(0 6px 10px rgba(0, 0, 0, 0.25));
      animation: float-wiggle 3s ease-in-out infinite;
      transform-origin: 50% 90%;
    }

    .title-text-main {
      font-family: "Fredoka", system-ui, sans-serif;
      font-size: 1.8rem;
      letter-spacing: 0.03em;
      display: flex;
      align-items: baseline;
      gap: 8px;
    }

    .title-text-main span {
      background: linear-gradient(135deg, #ff4f79, #ff8a4f);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      text-shadow: 0 2px 6px rgba(121, 26, 83, 0.3);
    }

    .title-pill {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 10px 3px;
      border-radius: 999px;
      background: linear-gradient(135deg, #27c498, #45e1b4);
      color: #053f36;
      font-size: 0.75rem;
      font-weight: 700;
      box-shadow: 0 3px 9px rgba(11, 122, 95, 0.45);
    }

    .title-pill span {
      font-size: 0.9rem;
    }

    .app-subtitle {
      font-size: 0.9rem;
      max-width: 290px;
      color: rgba(38, 23, 80, 0.8);
    }

    .controls-bar {
      display: flex;
      flex-wrap: wrap;
      justify-content: flex-end;
      align-items: center;
      gap: 10px;
      font-size: 0.88rem;
    }

    .control-group {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(244, 241, 255, 0.9);
      border: 1px solid rgba(211, 196, 255, 0.8);
      box-shadow: 0 3px 7px rgba(112, 100, 169, 0.25);
    }

    .control-label {
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .control-label span {
      font-size: 0.95rem;
    }

    .snow-slider {
      accent-color: var(--primary);
      width: 120px;
    }

    .toggle-button {
      border-radius: 999px;
      border: none;
      padding: 5px 12px;
      background: radial-gradient(circle at top, #ffcf4a, #ff8a4f);
      color: #5b2700;
      font-size: 0.78rem;
      font-weight: 700;
      letter-spacing: 0.02em;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      cursor: pointer;
      box-shadow: 0 3px 10px rgba(164, 116, 0, 0.5);
      transform: translateY(0);
      transition: transform 0.1s ease, box-shadow 0.1s ease, filter 0.15s ease;
    }

    .toggle-button-icon {
      font-size: 1rem;
    }

    .toggle-button[aria-pressed="true"] {
      filter: brightness(1.1) saturate(1.2);
      box-shadow: 0 1px 4px rgba(111, 79, 0, 0.6);
      transform: translateY(1px);
    }

    .toggle-button:active {
      transform: translateY(2px) scale(0.98);
      box-shadow: 0 0 2px rgba(0, 0, 0, 0.2);
    }

    .main-layout {
      display: grid;
      grid-template-columns: minmax(0, 3fr) minmax(260px, 1.35fr);
      gap: 0;
      min-height: 0;
    }

    @media (max-width: 880px) {
      .main-layout {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .card-panel {
      position: relative;
      padding: 14px 18px 22px 22px;
      border-right: 1px dashed rgba(212, 201, 255, 0.8);
      background: radial-gradient(circle at 0 -20%, rgba(255, 255, 255, 0.9) 0, transparent 60%);
      min-width: 0;
    }

    @media (max-width: 880px) {
      .card-panel {
        border-right: none;
        border-bottom: 1px dashed rgba(212, 201, 255, 0.8);
      }
    }

    .card-wrapper {
      position: relative;
      height: 100%;
      min-height: 320px;
      border-radius: 24px;
      background:
        linear-gradient(135deg, rgba(255, 255, 255, 0.96), rgba(249, 249, 255, 0.98)),
        linear-gradient(135deg, rgba(255, 255, 255, 0.85), rgba(249, 250, 255, 0.96));
      border: 2px solid var(--card-border);
      box-shadow:
        0 22px 40px rgba(41, 0, 81, 0.22),
        0 0 0 8px rgba(255, 255, 255, 0.9);
      padding: 18px 18px 20px;
      overflow: hidden;
    }

    .card-wrapper::before {
      content: "";
      position: absolute;
      inset: 10px;
      border-radius: 20px;
      padding: 2px;
      background:
        conic-gradient(
          from 120deg,
          #ff4f79,
          #ffcf4a,
          #27c498,
          #4fd5ff,
          #b77dff,
          #ff4f79
        );
      -webkit-mask:
        linear-gradient(#000 0 0) content-box,
        linear-gradient(#000 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      opacity: 0.95;
      animation: twinkle-border 10s linear infinite;
      pointer-events: none;
    }

    .card-inner {
      position: relative;
      z-index: 1;
      height: 100%;
      display: grid;
      grid-template-rows: auto 1fr auto;
      gap: 8px;
    }

    .card-greeting {
      text-align: center;
      padding: 6px 10px 8px;
    }

    .card-greeting-title {
      font-family: "Fredoka", system-ui, sans-serif;
      font-size: 1.7rem;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      color: #ff4f79;
      text-shadow:
        0 3px 0 rgba(255, 255, 255, 0.9),
        0 5px 12px rgba(187, 64, 121, 0.65);
    }

    .card-greeting-sub {
      font-size: 0.95rem;
      max-width: 420px;
      margin: 4px auto 0;
      color: rgba(50, 32, 86, 0.9);
    }

    .card-greeting-sub strong {
      color: #e43761;
    }

    .card-scene {
      position: relative;
      border-radius: 20px;
      background: linear-gradient(to top, #fefefe 0, #fef6ff 52%, #edf5ff 100%);
      box-shadow:
        inset 0 0 0 1px rgba(255, 255, 255, 0.9),
        0 12px 24px rgba(60, 37, 139, 0.16);
      overflow: hidden;
      margin: 2px 2px 4px;
    }

    .card-sky {
      position: absolute;
      inset: 0 0 45%;
      background: radial-gradient(circle at top, #ffffff 0, #e5f0ff 35%, #bed9ff 70%, #9dbef7 100%);
    }

    .card-horizon {
      position: absolute;
      inset: 55% 0 0;
      background: linear-gradient(to top, #ffffff 0, #f7fbff 55%, transparent 100%);
      filter: drop-shadow(0 -6px 16px rgba(80, 90, 150, 0.3));
    }

    .card-ground {
      position: absolute;
      inset: 64% -10% -8%;
      background:
        radial-gradient(circle at 0 80%, #ffffff 0, #f7fcff 52%, transparent 65%),
        radial-gradient(circle at 100% 85%, #ffffff 0, #f7fcff 55%, transparent 68%);
      transform: translate3d(0, 0, 0);
    }

    .card-scene-lights {
      position: absolute;
      inset: 12px 10px auto 10px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: space-around;
      pointer-events: none;
    }

    .light-bulb {
      width: 14px;
      height: 20px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 0, #fff 0, transparent 70%);
      box-shadow:
        0 4px 10px rgba(0, 0, 0, 0.25),
        0 0 14px rgba(255, 255, 255, 0.85);
      opacity: 0.86;
      transform-origin: 50% -18px;
      animation: light-swing 3.6s ease-in-out infinite alternate;
    }

    .light-bulb:nth-child(4n) {
      background-color: #ff4f79;
      animation-delay: -0.4s;
    }

    .light-bulb:nth-child(4n + 1) {
      background-color: #ffcf4a;
      animation-delay: -1.1s;
    }

    .light-bulb:nth-child(4n + 2) {
      background-color: #27c498;
      animation-delay: -0.7s;
    }

    .light-bulb:nth-child(4n + 3) {
      background-color: #4fd5ff;
      animation-delay: -1.4s;
    }

    .card-scene-characters {
      position: absolute;
      inset: 40% 0 5%;
      display: flex;
      align-items: flex-end;
      justify-content: space-around;
      pointer-events: none;
      font-size: 2.6rem;
      filter: drop-shadow(0 6px 10px rgba(46, 22, 76, 0.4));
    }

    .card-scene-characters span {
      animation: float-bob 3.4s ease-in-out infinite;
    }

    .card-scene-characters span:nth-child(2) {
      animation-delay: -1.3s;
    }

    .card-scene-characters span:nth-child(3) {
      animation-delay: -0.6s;
    }

    .card-footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      padding: 4px 4px 0;
      font-size: 0.86rem;
    }

    .card-tip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: rgba(244, 239, 255, 0.9);
      border-radius: 999px;
      padding: 4px 10px;
      border: 1px dashed rgba(167, 147, 255, 0.9);
      color: rgba(52, 38, 100, 0.95);
    }

    .card-tip span {
      font-size: 1rem;
    }

    .magic-button {
      border-radius: 999px;
      border: none;
      padding: 6px 13px;
      font-size: 0.82rem;
      font-weight: 700;
      cursor: pointer;
      background: linear-gradient(135deg, #8f5eff, #ff4fb2);
      color: #fff;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 4px 13px rgba(99, 57, 209, 0.7);
      transform: translateY(0);
      transition: transform 0.1s ease, box-shadow 0.1s ease, filter 0.15s ease;
    }

    .magic-button span {
      font-size: 1rem;
    }

    .magic-button:active {
      transform: translateY(2px) scale(0.98);
      box-shadow: 0 2px 6px rgba(50, 23, 122, 0.8);
      filter: brightness(1.05);
    }

    .magic-button.pressed {
      animation: sparkle-pulse 1.2s ease-in-out;
    }

    .sticker-area {
      position: relative;
      z-index: 1;
      width: 100%;
      height: 100%;
      padding: 52px 20px 32px;
      pointer-events: auto;
    }

    .sticker-layer {
      position: relative;
      width: 100%;
      height: 100%;
      border-radius: 18px;
      overflow: hidden;
    }

    .sticker {
      position: absolute;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 2.1rem;
      touch-action: none;
      cursor: grab;
      user-select: none;
      -webkit-user-drag: none;
      transform-origin: 50% 60%;
      text-shadow:
        0 0 4px rgba(255, 255, 255, 0.9),
        0 6px 12px rgba(47, 21, 92, 0.7);
      filter: drop-shadow(0 8px 10px rgba(0, 0, 0, 0.32));
      transition: transform 0.15s ease-in-out;
    }

    .sticker:active {
      cursor: grabbing;
      transform: scale(1.12) rotate(-2deg);
      z-index: 5;
    }

    .sticker.bounce-in {
      animation: sticker-pop 0.35s ease-out;
    }

    .sticker.wiggle {
      animation: sticker-wiggle 0.4s ease-in-out;
    }

    .sticker.glow {
      animation: sticker-glow 1.2s ease-in-out;
    }

    .sticker-badge {
      position: absolute;
      right: 12px;
      top: 14px;
      background: rgba(255, 255, 255, 0.94);
      border-radius: 999px;
      padding: 3px 10px;
      font-size: 0.78rem;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      color: #ff4f79;
      box-shadow: 0 3px 8px rgba(200, 150, 255, 0.7);
      z-index: 3;
    }

    .sticker-badge span {
      font-size: 0.95rem;
    }

    .sidebar {
      padding: 14px 16px 18px 16px;
      background: radial-gradient(circle at top right, rgba(255, 255, 255, 0.95) 0, transparent 60%);
      display: flex;
      flex-direction: column;
      gap: 10px;
      min-width: 0;
    }

    .sidebar-section {
      border-radius: 18px;
      padding: 10px 12px 12px;
      background: rgba(252, 248, 255, 0.98);
      box-shadow:
        0 10px 20px rgba(105, 77, 158, 0.18),
        0 0 0 1px rgba(238, 223, 255, 0.9);
      position: relative;
      overflow: hidden;
    }

    .sidebar-section::before {
      content: "";
      position: absolute;
      inset: 0;
      background-image:
        radial-gradient(circle at 20% 0%, rgba(255, 255, 255, 0.85) 0, transparent 46%),
        radial-gradient(circle at 90% 100%, rgba(255, 238, 254, 1) 0, transparent 55%);
      pointer-events: none;
      opacity: 0.9;
    }

    .sidebar-section-inner {
      position: relative;
      z-index: 1;
    }

    .sidebar-heading {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 6px;
    }

    .sidebar-heading-title {
      font-size: 1rem;
      font-weight: 700;
      letter-spacing: 0.02em;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .sidebar-heading-pill {
      font-size: 0.75rem;
      padding: 0 8px;
      border-radius: 999px;
      background: rgba(255, 207, 74, 0.18);
      border: 1px solid rgba(255, 207, 74, 0.8);
      color: #906106;
    }

    .palette-grid {
      display: grid;
      grid-template-columns: repeat(5, minmax(0, 1fr));
      gap: 6px;
    }

    @media (max-width: 360px) {
      .palette-grid {
        grid-template-columns: repeat(4, minmax(0, 1fr));
      }
    }

    .palette-item {
      position: relative;
      border-radius: 14px;
      padding: 6px 4px 4px;
      border: 1px solid rgba(222, 206, 255, 0.9);
      background: rgba(255, 255, 255, 0.98);
      box-shadow: 0 3px 7px rgba(137, 114, 188, 0.35);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-size: 1.35rem;
      cursor: pointer;
      transition: transform 0.12s ease-out, box-shadow 0.12s ease-out, border-color 0.12s ease-out, background 0.12s ease-out;
      user-select: none;
    }

    .palette-item span {
      display: block;
    }

    .palette-label {
      margin-top: 2px;
      font-size: 0.68rem;
      font-weight: 600;
      color: rgba(62, 41, 115, 0.9);
    }

    .palette-item:hover {
      transform: translateY(-2px) scale(1.03);
      box-shadow: 0 6px 14px rgba(96, 63, 167, 0.5);
      border-color: rgba(172, 149, 252, 0.96);
      background: linear-gradient(135deg, #ffffff, #f6edff);
    }

    .palette-item:active {
      transform: translateY(1px) scale(0.98);
      box-shadow: 0 3px 8px rgba(96, 63, 167, 0.6);
    }

    .palette-item.is-new::after {
      content: "‚ú®";
      position: absolute;
      right: 4px;
      top: 2px;
      font-size: 0.8rem;
    }

    .sidebar-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 6px;
    }

    .sidebar-button {
      border-radius: 999px;
      border: none;
      padding: 5px 11px;
      font-size: 0.78rem;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: linear-gradient(135deg, #27c498, #35e3b5);
      color: #053f36;
      box-shadow: 0 3px 10px rgba(13, 111, 90, 0.6);
      transition: transform 0.12s ease, box-shadow 0.12s ease, filter 0.12s ease;
    }

    .sidebar-button.secondary {
      background: linear-gradient(135deg, #f4f0ff, #fdfbff);
      color: #3a2d7f;
      border: 1px solid rgba(183, 166, 255, 0.9);
      box-shadow: 0 2px 8px rgba(105, 86, 176, 0.4);
    }

    .sidebar-button.danger {
      background: linear-gradient(135deg, #ff8a4f, #ff4f79);
      color: #4b061a;
      box-shadow: 0 3px 10px rgba(167, 69, 87, 0.7);
    }

    .sidebar-button:active {
      transform: translateY(1px) scale(0.98);
      box-shadow: 0 2px 6px rgba(41, 0, 81, 0.6);
      filter: brightness(1.02);
    }

    .sidebar-caption {
      margin-top: 5px;
      font-size: 0.78rem;
      color: rgba(60, 44, 120, 0.9);
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .sidebar-caption span {
      font-size: 0.9rem;
    }

    .sound-indicator {
      display: inline-flex;
      align-items: center;
      gap: 3px;
      font-size: 0.72rem;
      padding: 2px 7px;
      border-radius: 999px;
      border: 1px solid rgba(164, 144, 255, 0.9);
      background: rgba(244, 240, 255, 0.98);
      color: #4a378e;
    }

    .sound-indicator-icon {
      width: 12px;
      height: 8px;
      border-radius: 999px;
      position: relative;
      background: linear-gradient(135deg, #b07cff, #ff4f79);
      overflow: hidden;
    }

    .sound-indicator-icon::before,
    .sound-indicator-icon::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 0 50%, #fff 0, transparent 55%);
      opacity: 0.7;
      animation: tiny-wave 1.4s ease-in-out infinite;
    }

    .sound-indicator-icon::after {
      animation-delay: -0.7s;
    }

    #snow-layer {
      position: fixed;
      inset: -40px -20px 0;
      pointer-events: none;
      z-index: 0;
      opacity: var(--snow-layer-opacity);
      mix-blend-mode: screen;
    }

    .snowflake {
      position: absolute;
      top: -10vh;
      color: rgba(255, 255, 255, 0.96);
      font-size: 0.9rem;
      text-shadow:
        0 0 5px rgba(255, 255, 255, 0.9),
        0 0 12px rgba(192, 215, 255, 0.9);
      animation-name: snowfall;
      animation-timing-function: linear;
      animation-iteration-count: infinite;
      will-change: transform, opacity;
    }

    .snowflake::after {
      content: "‚ùÑ";
    }

    @media (prefers-reduced-motion: reduce) {
      * {
        scroll-behavior: auto !important;
        animation-duration: 0.001ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.001ms !important;
      }
      #snow-layer {
        display: none;
      }
    }

    @keyframes snowfall {
      0% {
        transform: translate3d(0, -12vh, 0) rotateZ(0deg);
        opacity: 0;
      }
      10% {
        opacity: 0.95;
      }
      50% {
        transform: translate3d(10px, 50vh, 0) rotateZ(90deg);
      }
      100% {
        transform: translate3d(-12px, 112vh, 0) rotateZ(180deg);
        opacity: 0.9;
      }
    }

    @keyframes float-wiggle {
      0% {
        transform: translateY(0) rotate(0);
      }
      30% {
        transform: translateY(-4px) rotate(-7deg);
      }
      60% {
        transform: translateY(2px) rotate(6deg);
      }
      100% {
        transform: translateY(0) rotate(0);
      }
    }

    @keyframes twinkle-border {
      0% {
        opacity: 0.75;
        transform: translate3d(0, 0, 0);
      }
      50% {
        opacity: 1;
      }
      100% {
        opacity: 0.85;
        transform: translate3d(-6px, 3px, 0);
      }
    }

    @keyframes float-bob {
      0% {
        transform: translate3d(0, 0, 0);
      }
      50% {
        transform: translate3d(0, -6px, 0);
      }
      100% {
        transform: translate3d(0, 0, 0);
      }
    }

    @keyframes light-swing {
      0% {
        transform: rotate(-7deg) translateY(0);
      }
      50% {
        transform: rotate(5deg) translateY(1px);
      }
      100% {
        transform: rotate(-4deg) translateY(0);
      }
    }

    @keyframes sticker-pop {
      0% {
        transform: scale(0.2) translateY(40px);
        opacity: 0;
      }
      60% {
        transform: scale(1.12) translateY(-4px);
        opacity: 1;
      }
      100% {
        transform: scale(1) translateY(0);
        opacity: 1;
      }
    }

    @keyframes sticker-wiggle {
      0% {
        transform: scale(1) rotate(0deg);
      }
      25% {
        transform: scale(1.04) rotate(-5deg);
      }
      50% {
        transform: scale(1.04) rotate(4deg);
      }
      75% {
        transform: scale(1.02) rotate(-3deg);
      }
      100% {
        transform: scale(1) rotate(0deg);
      }
    }

    @keyframes sticker-glow {
      0% {
        filter: drop-shadow(0 0 0 rgba(255, 255, 255, 0.8));
      }
      50% {
        filter: drop-shadow(0 0 18px rgba(255, 255, 255, 1));
      }
      100% {
        filter: drop-shadow(0 0 0 rgba(255, 255, 255, 0.9));
      }
    }

    @keyframes sparkle-pulse {
      0% {
        transform: translateY(0) scale(1);
        box-shadow: 0 4px 13px rgba(99, 57, 209, 0.7);
      }
      40% {
        transform: translateY(-1px) scale(1.06);
        box-shadow: 0 10px 20px rgba(142, 80, 255, 0.8);
      }
      100% {
        transform: translateY(0) scale(1);
        box-shadow: 0 4px 13px rgba(99, 57, 209, 0.7);
      }
    }

    @keyframes tiny-wave {
      0% {
        transform: translateX(-10%);
      }
      50% {
        transform: translateX(14%);
      }
      100% {
        transform: translateX(-10%);
      }
    }
  </style>
</head>
<body>
  <div id="snow-layer" aria-hidden="true"></div>

  <main class="app-shell" aria-label="Holiday magic card playground">
    <section class="app-frame" role="group" aria-label="Holiday card and sticker playground">
      <header class="app-header">
        <div class="title-block">
          <div class="title-emoji" aria-hidden="true">üéÑ</div>
          <div>
            <div class="title-text-main">
              <span>Holiday Magic Card</span>
              <div class="title-pill">
                <span>‚≠ê</span>
                <span>Kid-Friendly Fun</span>
              </div>
            </div>
            <p class="app-subtitle">
              Drag, drop, and decorate your very own snowy holiday scene. Tap the sparkly buttons for extra magic!
            </p>
          </div>
        </div>

        <div class="controls-bar">
          <div class="control-group" aria-label="Snow amount">
            <div class="control-label">
              <span>‚ùÑÔ∏è Snow</span>
            </div>
            <input
              id="snow-slider"
              class="snow-slider"
              type="range"
              min="0"
              max="100"
              value="85"
              aria-label="Snow amount"
            />
          </div>

          <button
            id="sound-toggle"
            class="toggle-button"
            type="button"
            aria-pressed="true"
            aria-label="Toggle fun sounds"
          >
            <span class="toggle-button-icon" aria-hidden="true">üîä</span>
            Sounds
          </button>
        </div>
      </header>

      <div class="main-layout">
        <section class="card-panel" aria-label="Holiday card scene">
          <div class="card-wrapper">
            <div class="card-inner">
              <div class="card-greeting">
                <div class="card-greeting-title">
                  Happy Holiday Wishes!
                </div>
                <p class="card-greeting-sub">
                  Dear friend, may your days be <strong>sparkly</strong>,
                  your cocoa <strong>extra cozy</strong>, and your heart
                  full of giggles and snowflakes.
                </p>
              </div>

              <div class="card-scene" aria-hidden="true">
                <div class="card-sky"></div>
                <div class="card-horizon"></div>
                <div class="card-ground"></div>
                <div class="card-scene-lights">
                  <div class="light-bulb"></div>
                  <div class="light-bulb"></div>
                  <div class="light-bulb"></div>
                  <div class="light-bulb"></div>
                  <div class="light-bulb"></div>
                  <div class="light-bulb"></div>
                  <div class="light-bulb"></div>
                  <div class="light-bulb"></div>
                  <div class="light-bulb"></div>
                  <div class="light-bulb"></div>
                </div>
                <div class="card-scene-characters">
                  <span aria-hidden="true">‚õÑÔ∏è</span>
                  <span aria-hidden="true">ü¶å</span>
                  <span aria-hidden="true">üêß</span>
                </div>
              </div>

              <div class="sticker-area">
                <div class="sticker-layer" id="sticker-layer" aria-label="Sticker playground" role="application"></div>
                <div class="sticker-badge" aria-hidden="true">
                  <span>‚ú®</span>
                  Drag your stickers here!
                </div>
              </div>

              <footer class="card-footer">
                <div class="card-tip">
                  <span aria-hidden="true">üëÜ</span>
                  <span>Tip: Tap a sticker to give it a silly wiggle.</span>
                </div>
                <button
                  id="magic-snow-button"
                  class="magic-button"
                  type="button"
                  aria-label="Magical snowburst"
                >
                  <span aria-hidden="true">‚ú®</span>
                  Magic Snowburst
                </button>
              </footer>
            </div>
          </div>
        </section>

        <aside class="sidebar" aria-label="Sticker tray and actions">
          <section class="sidebar-section" aria-label="Sticker tray">
            <div class="sidebar-section-inner">
              <div class="sidebar-heading">
                <div class="sidebar-heading-title">
                  <span aria-hidden="true">üéÅ</span>
                  Sticker Tray
                </div>
                <div class="sidebar-heading-pill">
                  Ready to decorate!
                </div>
              </div>
              <div class="palette-grid" id="palette-grid">
                <button class="palette-item" type="button" data-emoji="üéÑ" data-label="Tree">
                  <span aria-hidden="true">üéÑ</span>
                  <div class="palette-label">Tree</div>
                </button>
                <button class="palette-item is-new" type="button" data-emoji="‚õÑ" data-label="Snowpal">
                  <span aria-hidden="true">‚õÑ</span>
                  <div class="palette-label">Snowpal</div>
                </button>
                <button class="palette-item" type="button" data-emoji="üéÅ" data-label="Gift">
                  <span aria-hidden="true">üéÅ</span>
                  <div class="palette-label">Gift</div>
                </button>
                <button class="palette-item" type="button" data-emoji="üß∏" data-label="Teddy">
                  <span aria-hidden="true">üß∏</span>
                  <div class="palette-label">Teddy</div>
                </button>
                <button class="palette-item" type="button" data-emoji="üç≠" data-label="Candy">
                  <span aria-hidden="true">üç≠</span>
                  <div class="palette-label">Candy</div>
                </button>
                <button class="palette-item" type="button" data-emoji="‚≠ê" data-label="Star">
                  <span aria-hidden="true">‚≠ê</span>
                  <div class="palette-label">Star</div>
                </button>
                <button class="palette-item" type="button" data-emoji="‚ùÑÔ∏è" data-label="Flake">
                  <span aria-hidden="true">‚ùÑÔ∏è</span>
                  <div class="palette-label">Flake</div>
                </button>
                <button class="palette-item" type="button" data-emoji="ü¶å" data-label="Reindeer">
                  <span aria-hidden="true">ü¶å</span>
                  <div class="palette-label">Reindeer</div>
                </button>
                <button class="palette-item" type="button" data-emoji="üêß" data-label="Penguin">
                  <span aria-hidden="true">üêß</span>
                  <div class="palette-label">Penguin</div>
                </button>
                <button class="palette-item" type="button" data-emoji="üßë‚ÄçüéÑ" data-label="Helper">
                  <span aria-hidden="true">üßë‚ÄçüéÑ</span>
                  <div class="palette-label">Helper</div>
                </button>
                <button class="palette-item" type="button" data-emoji="üç™" data-label="Cookie">
                  <span aria-hidden="true">üç™</span>
                  <div class="palette-label">Cookie</div>
                </button>
                <button class="palette-item" type="button" data-emoji="üïØÔ∏è" data-label="Candle">
                  <span aria-hidden="true">üïØÔ∏è</span>
                  <div class="palette-label">Candle</div>
                </button>
                <button class="palette-item" type="button" data-emoji="üß¶" data-label="Sock">
                  <span aria-hidden="true">üß¶</span>
                  <div class="palette-label">Stocking</div>
                </button>
                <button class="palette-item" type="button" data-emoji="üéÄ" data-label="Bow">
                  <span aria-hidden="true">üéÄ</span>
                  <div class="palette-label">Bow</div>
                </button>
                <button class="palette-item" type="button" data-emoji="üåü" data-label="Glow">
                  <span aria-hidden="true">üåü</span>
                  <div class="palette-label">Glow</div>
                </button>
              </div>
              <div class="sidebar-caption">
                <span aria-hidden="true">‚ú®</span>
                Tap any sticker to drop a new one into the snowy card.
              </div>
            </div>
          </section>

          <section class="sidebar-section" aria-label="Actions and sound">
            <div class="sidebar-section-inner">
              <div class="sidebar-heading">
                <div class="sidebar-heading-title">
                  <span aria-hidden="true">‚ùÑÔ∏è</span>
                  Extra Magic
                </div>
                <div class="sound-indicator" aria-hidden="true">
                  <div class="sound-indicator-icon"></div>
                  <span>Chimes on tap</span>
                </div>
              </div>

              <div class="sidebar-actions">
                <button
                  id="party-button"
                  class="sidebar-button secondary"
                  type="button"
                  aria-label="Sprinkle a burst of random stickers"
                >
                  <span aria-hidden="true">üéâ</span>
                  Surprise Party
                </button>
                <button
                  id="twinkle-button"
                  class="sidebar-button"
                  type="button"
                  aria-label="Make stickers glow and twinkle"
                >
                  <span aria-hidden="true">üåà</span>
                  Twinkly Glow
                </button>
                <button
                  id="clear-button"
                  class="sidebar-button danger"
                  type="button"
                  aria-label="Clear all added stickers"
                >
                  <span aria-hidden="true">üßπ</span>
                  Gently Tidy
                </button>
              </div>

              <div class="sidebar-caption">
                <span aria-hidden="true">üí°</span>
                Sounds work best after your first tap or drag.
              </div>
            </div>
          </section>
        </aside>
      </div>
    </section>
  </main>

  <script>
    (function () {
      var snowLayer = document.getElementById("snow-layer");
      var snowSlider = document.getElementById("snow-slider");
      var stickerLayer = document.getElementById("sticker-layer");
      var soundToggle = document.getElementById("sound-toggle");
      var magicSnowButton = document.getElementById("magic-snow-button");
      var partyButton = document.getElementById("party-button");
      var twinkleButton = document.getElementById("twinkle-button");
      var clearButton = document.getElementById("clear-button");
      var paletteGrid = document.getElementById("palette-grid");

      var soundEnabled = true;
      var audioCtx;

      function getAudioContext() {
        if (!audioCtx) {
          var Ctor = window.AudioContext || window.webkitAudioContext;
          if (!Ctor) {
            return null;
          }
          audioCtx = new Ctor();
        }
        if (audioCtx.state === "suspended") {
          audioCtx.resume();
        }
        return audioCtx;
      }

      function playToneSequence(config) {
        if (!soundEnabled) return;
        var ctx = getAudioContext();
        if (!ctx) return;

        var now = ctx.currentTime;
        for (var i = 0; i < config.length; i++) {
          var note = config[i];
          var osc = ctx.createOscillator();
          var gain = ctx.createGain();
          osc.type = note.type || "sine";
          osc.frequency.value = note.freq;
          var startTime = now + (note.offset || 0);
          var duration = note.dur || 0.25;
          gain.gain.setValueAtTime(note.volume || 0.18, startTime);
          gain.gain.exponentialRampToValueAtTime(0.01, startTime + duration);
          osc.connect(gain);
          gain.connect(ctx.destination);
          osc.start(startTime);
          osc.stop(startTime + duration + 0.02);
        }
      }

      function playPlaceSound() {
        playToneSequence([
          { freq: 880, dur: 0.16, volume: 0.2, type: "triangle", offset: 0 },
          { freq: 1320, dur: 0.14, volume: 0.16, type: "triangle", offset: 0.08 }
        ]);
      }

      function playDropSound() {
        playToneSequence([
          { freq: 520, dur: 0.2, volume: 0.18, type: "sine", offset: 0 },
          { freq: 260, dur: 0.22, volume: 0.16, type: "sine", offset: 0.05 }
        ]);
      }

      function playMagicSound() {
        playToneSequence([
          { freq: 740, dur: 0.22, volume: 0.18, type: "triangle", offset: 0 },
          { freq: 880, dur: 0.24, volume: 0.16, type: "triangle", offset: 0.1 },
          { freq: 1175, dur: 0.3, volume: 0.14, type: "sine", offset: 0.22 },
          { freq: 1567, dur: 0.32, volume: 0.12, type: "sine", offset: 0.34 }
        ]);
      }

      function playTwinkleSound() {
        playToneSequence([
          { freq: 1046, dur: 0.14, volume: 0.14, type: "triangle", offset: 0 },
          { freq: 1318, dur: 0.16, volume: 0.14, type: "triangle", offset: 0.08 }
        ]);
      }

      function toggleSound() {
        soundEnabled = !soundEnabled;
        soundToggle.setAttribute("aria-pressed", soundEnabled ? "true" : "false");
        soundToggle.querySelector(".toggle-button-icon").textContent = soundEnabled ? "üîä" : "üîà";
        if (soundEnabled) {
          playTwinkleSound();
        }
      }

      soundToggle.addEventListener("click", function () {
        toggleSound();
      });

      function createSnowflakes(count) {
        if (!snowLayer) return;
        snowLayer.innerHTML = "";
        var total = count;
        for (var i = 0; i < total; i++) {
          var flake = document.createElement("div");
          flake.className = "snowflake";

          var left = Math.random() * 100;
          var duration = 10 + Math.random() * 14;
          var delay = -Math.random() * duration;
          var size = 0.7 + Math.random() * 0.9;

          flake.style.left = left + "vw";
          flake.style.fontSize = size + "rem";
          flake.style.animationDuration = duration + "s";
          flake.style.animationDelay = delay + "s";
          snowLayer.appendChild(flake);
        }
      }

      function snowSliderToOpacity(v) {
        var ratio = v / 100;
        var eased = ratio * ratio;
        return 0.15 + eased * 0.9;
      }

      function updateSnowOpacity() {
        if (!snowLayer) return;
        var val = parseInt(snowSlider.value, 10) || 0;
        var opacity = snowSliderToOpacity(val);
        snowLayer.style.opacity = opacity.toFixed(2);
      }

      snowSlider.addEventListener("input", function () {
        updateSnowOpacity();
      });

      function createSticker(emoji, opts) {
        if (!stickerLayer) return null;
        var options = opts || {};
        var rect = stickerLayer.getBoundingClientRect();
        var sticker = document.createElement("div");
        sticker.className = "sticker bounce-in";
        sticker.textContent = emoji;

        var baseSize = 2.1;
        var randomScale = 0.95 + Math.random() * 0.5;
        sticker.style.fontSize = baseSize * randomScale + "rem";

        var margin = 40;
        var maxX = Math.max(rect.width - margin, margin);
        var maxY = Math.max(rect.height - margin, margin);
        var x = typeof options.x === "number" ? options.x : margin + Math.random() * (maxX - margin);
        var y = typeof options.y === "number" ? options.y : margin + Math.random() * (maxY - margin);
        sticker.style.left = x + "px";
        sticker.style.top = y + "px";

        stickerLayer.appendChild(sticker);
        makeDraggable(sticker);

        sticker.addEventListener("click", function (event) {
          event.stopPropagation();
          sticker.classList.remove("wiggle");
          void sticker.offsetWidth;
          sticker.classList.add("wiggle");
          playTwinkleSound();
        });

        playPlaceSound();
        return sticker;
      }

      function makeDraggable(el) {
        var isPointerDown = false;
        var pointerId = null;
        var offsetX = 0;
        var offsetY = 0;

        function onPointerDown(event) {
          if (event.button !== undefined && event.button !== 0) return;
          isPointerDown = true;
          pointerId = event.pointerId;
          el.setPointerCapture(pointerId);

          var areaRect = stickerLayer.getBoundingClientRect();
          var rect = el.getBoundingClientRect();
          offsetX = event.clientX - rect.left;
          offsetY = event.clientY - rect.top;

          el.style.transition = "transform 0.08s ease-out";
          el.style.zIndex = "6";

          function onMove(e) {
            if (!isPointerDown || e.pointerId !== pointerId) return;
            var x = e.clientX - areaRect.left - offsetX;
            var y = e.clientY - areaRect.top - offsetY;
            var maxX = areaRect.width - rect.width * 0.7;
            var maxY = areaRect.height - rect.height * 0.7;
            var clampedX = Math.max(-rect.width * 0.2, Math.min(maxX, x));
            var clampedY = Math.max(-rect.height * 0.2, Math.min(maxY, y));

            el.style.left = clampedX + "px";
            el.style.top = clampedY + "px";
          }

          function onUp(e) {
            if (e.pointerId !== pointerId) return;
            isPointerDown = false;
            try {
              el.releasePointerCapture(pointerId);
            } catch (err) {}
            el.style.transition = "";
            el.style.zIndex = "2";
            el.removeEventListener("pointermove", onMove);
            el.removeEventListener("pointerup", onUp);
            el.removeEventListener("pointercancel", onUp);
            playDropSound();
          }

          el.addEventListener("pointermove", onMove);
          el.addEventListener("pointerup", onUp);
          el.addEventListener("pointercancel", onUp);
        }

        el.addEventListener("pointerdown", onPointerDown);
      }

      function addInitialStickers() {
        var areaRect = stickerLayer.getBoundingClientRect();
        var positions = [
          { emoji: "üéÑ", x: areaRect.width * 0.18, y: areaRect.height * 0.45 },
          { emoji: "üéÅ", x: areaRect.width * 0.46, y: areaRect.height * 0.6 },
          { emoji: "‚õÑ", x: areaRect.width * 0.71, y: areaRect.height * 0.5 },
          { emoji: "‚≠ê", x: areaRect.width * 0.38, y: areaRect.height * 0.28 },
          { emoji: "üêß", x: areaRect.width * 0.2, y: areaRect.height * 0.7 }
        ];

        for (var i = 0; i < positions.length; i++) {
          var pos = positions[i];
          createSticker(pos.emoji, { x: pos.x, y: pos.y });
        }
      }

      paletteGrid.addEventListener("click", function (event) {
        var target = event.target;
        while (target && target !== paletteGrid && !target.dataset.emoji) {
          target = target.parentElement;
        }
        if (!target || !target.dataset || !target.dataset.emoji) return;
        var emoji = target.dataset.emoji;
        createSticker(emoji);
      });

      function surpriseParty() {
        var stickers = [];
        var paletteButtons = paletteGrid.querySelectorAll("[data-emoji]");
        if (!paletteButtons.length) return;
        var count = 7;
        for (var i = 0; i < count; i++) {
          var randomIndex = Math.floor(Math.random() * paletteButtons.length);
          var emoji = paletteButtons[randomIndex].dataset.emoji;
          var sticker = createSticker(emoji);
          if (sticker) {
            stickers.push(sticker);
          }
        }
        if (stickers.length) {
          playMagicSound();
          twinkleButton.classList.add("pressed");
          setTimeout(function () {
            twinkleButton.classList.remove("pressed");
          }, 300);
        }
      }

      function addGlowToStickers() {
        var stickers = stickerLayer.querySelectorAll(".sticker");
        if (!stickers.length) return;
        for (var i = 0; i < stickers.length; i++) {
          var s = stickers[i];
          s.classList.remove("glow");
          void s.offsetWidth;
          s.classList.add("glow");
        }
        playTwinkleSound();
      }

      function gentlyClearStickers() {
        var stickers = stickerLayer.querySelectorAll(".sticker");
        if (!stickers.length) return;
        playToneSequence([
          { freq: 440, dur: 0.2, volume: 0.14, type: "sine", offset: 0 },
          { freq: 392, dur: 0.2, volume: 0.14, type: "sine", offset: 0.12 },
          { freq: 349, dur: 0.22, volume: 0.14, type: "sine", offset: 0.22 }
        ]);
        var delay = 0;
        stickers.forEach(function (sticker) {
          setTimeout(function () {
            sticker.style.transition = "transform 0.25s ease, opacity 0.25s ease";
            sticker.style.transform = "translateY(30px) scale(0.1) rotate(8deg)";
            sticker.style.opacity = "0";
            setTimeout(function () {
              if (sticker.parentElement === stickerLayer) {
                stickerLayer.removeChild(sticker);
              }
            }, 260);
          }, delay);
          delay += 40;
        });
      }

      magicSnowButton.addEventListener("click", function () {
        magicSnowButton.classList.remove("pressed");
        void magicSnowButton.offsetWidth;
        magicSnowButton.classList.add("pressed");
        createSnowflakes(85);
        updateSnowOpacity();
        playMagicSound();
      });

      partyButton.addEventListener("click", function () {
        surpriseParty();
      });

      twinkleButton.addEventListener("click", function () {
        addGlowToStickers();
      });

      clearButton.addEventListener("click", function () {
        gentlyClearStickers();
      });

      function initialize() {
        createSnowflakes(80);
        updateSnowOpacity();
        setTimeout(function () {
          addInitialStickers();
        }, 60);
      }

      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", initialize);
      } else {
        initialize();
      }
    })();
  </script>
</body>
</html>

