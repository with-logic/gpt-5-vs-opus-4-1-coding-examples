<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Color Match Challenge</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="A fast-paced Stroop-style color match game. Click the ink color, not the word!"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --bg: #020617;
        --card: rgba(15, 23, 42, 0.96);
        --card-border: rgba(148, 163, 184, 0.6);
        --accent: #38bdf8;
        --accent-soft: rgba(56, 189, 248, 0.18);
        --accent-strong: #0ea5e9;
        --success: #4ade80;
        --danger: #f97373;
        --text-muted: #9ca3af;
        --text-soft: #e5e7eb;
      }

      * {
        box-sizing: border-box;
      }

      html,
      body {
        margin: 0;
        padding: 0;
      }

      body {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 16px;
        font-family: "Poppins", system-ui, -apple-system, BlinkMacSystemFont,
          "Segoe UI", sans-serif;
        color: var(--text-soft);
        background:
          radial-gradient(circle at top, #1d4ed8 0, transparent 55%),
          radial-gradient(circle at bottom, #db2777 0, transparent 55%),
          #020617;
        background-attachment: fixed;
        -webkit-font-smoothing: antialiased;
      }

      .game-shell {
        position: relative;
        width: min(960px, 100%);
        border-radius: 28px;
        padding: 24px 22px 26px;
        background:
          radial-gradient(circle at top left, rgba(56, 189, 248, 0.16), transparent 58%),
          radial-gradient(circle at bottom right, rgba(236, 72, 153, 0.18), transparent 56%),
          linear-gradient(135deg, rgba(15, 23, 42, 0.96), rgba(15, 23, 42, 0.98));
        border: 1px solid var(--card-border);
        box-shadow:
          0 30px 80px rgba(15, 23, 42, 0.9),
          0 0 0 1px rgba(15, 23, 42, 0.9);
        overflow: hidden;
        backdrop-filter: blur(26px) saturate(1.3);
      }

      .orb {
        position: absolute;
        border-radius: 999px;
        filter: blur(26px);
        mix-blend-mode: screen;
        opacity: 0.55;
        pointer-events: none;
      }

      .orb--cyan {
        width: 260px;
        height: 260px;
        background: radial-gradient(circle, #22d3ee, transparent 60%);
        top: -120px;
        right: -40px;
      }

      .orb--violet {
        width: 260px;
        height: 260px;
        background: radial-gradient(circle, #a855f7, transparent 60%);
        bottom: -130px;
        left: -40px;
      }

      .game-inner {
        position: relative;
        z-index: 1;
      }

      .header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: 16px;
        margin-bottom: 18px;
      }

      .title-block {
        max-width: 60%;
      }

      .app-title {
        margin: 0;
        font-size: clamp(1.6rem, 1.2rem + 1.4vw, 2.05rem);
        font-weight: 700;
        letter-spacing: 0.09em;
        text-transform: uppercase;
        display: inline-flex;
        align-items: center;
        gap: 0.4em;
      }

      .app-title span.app-title-pill {
        font-size: 0.8rem;
        padding: 0.16rem 0.6rem;
        border-radius: 999px;
        background: linear-gradient(
          120deg,
          rgba(56, 189, 248, 0.18),
          rgba(236, 72, 153, 0.18)
        );
        border: 1px solid rgba(148, 163, 184, 0.55);
        text-transform: none;
        letter-spacing: 0.06em;
      }

      .subtitle {
        margin: 6px 0 0;
        font-size: 0.9rem;
        color: var(--text-muted);
      }

      .hud {
        display: flex;
        flex-wrap: wrap;
        justify-content: flex-end;
        gap: 10px;
      }

      .pill {
        display: flex;
        align-items: center;
        gap: 10px;
        border-radius: 999px;
        padding: 8px 11px 8px 10px;
        background: radial-gradient(
          circle at top left,
          rgba(15, 23, 42, 0.98),
          rgba(15, 23, 42, 0.94)
        );
        border: 1px solid rgba(148, 163, 184, 0.55);
        box-shadow: 0 16px 30px rgba(15, 23, 42, 0.9);
        font-size: 0.8rem;
        letter-spacing: 0.04em;
        text-transform: uppercase;
        color: var(--text-muted);
        backdrop-filter: blur(16px);
        position: relative;
        overflow: hidden;
      }

      .pill::before {
        content: "";
        position: absolute;
        inset: 0;
        background: radial-gradient(
          circle at top left,
          rgba(148, 163, 184, 0.12),
          transparent
        );
        opacity: 0.5;
        pointer-events: none;
      }

      .pill-label {
        opacity: 0.85;
      }

      .pill-main {
        display: flex;
        align-items: baseline;
        gap: 4px;
      }

      .pill-number {
        font-size: 1.25rem;
        font-weight: 600;
        color: #e5e7eb;
      }

      .pill-unit {
        font-size: 0.75rem;
        text-transform: uppercase;
        color: var(--text-muted);
      }

      .timer-bar {
        width: 116px;
        height: 5px;
        border-radius: 999px;
        background: rgba(15, 23, 42, 0.95);
        overflow: hidden;
        position: relative;
      }

      .timer-bar-fill {
        position: absolute;
        inset: 0;
        transform-origin: left;
        transform: scaleX(1);
        background: linear-gradient(
          90deg,
          #22c55e 0%,
          #eab308 45%,
          #f97316 65%,
          #ef4444 100%
        );
        box-shadow: 0 0 16px rgba(34, 197, 94, 0.55);
        transition: transform 100ms linear, box-shadow 150ms ease-out;
      }

      .timer-low .timer-bar-fill {
        box-shadow: 0 0 22px rgba(248, 113, 113, 0.95);
      }

      .chip-row {
        display: flex;
        gap: 6px;
        margin-top: 4px;
      }

      .chip {
        font-size: 0.7rem;
        text-transform: uppercase;
        letter-spacing: 0.12em;
        padding: 3px 7px;
        border-radius: 999px;
        border: 1px solid rgba(148, 163, 184, 0.4);
        background: rgba(15, 23, 42, 0.9);
        color: var(--text-muted);
      }

      .chip strong {
        color: #e5e7eb;
        font-weight: 500;
      }

      .chip--streak-hot {
        border-color: rgba(74, 222, 128, 0.8);
        color: #bbf7d0;
        background: rgba(22, 163, 74, 0.25);
      }

      .main {
        display: grid;
        grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.3fr);
        gap: 24px;
        align-items: center;
      }

      @media (max-width: 820px) {
        .header {
          flex-direction: column;
          align-items: stretch;
        }

        .title-block {
          max-width: 100%;
        }

        .main {
          grid-template-columns: minmax(0, 1fr);
        }
      }

      @media (max-width: 600px) {
        .game-shell {
          padding: 20px 16px 20px;
          border-radius: 20px;
        }

        .app-title {
          font-size: 1.4rem;
        }
      }

      .panel {
        padding: 14px 16px 16px;
        border-radius: 18px;
        background: radial-gradient(
            circle at top left,
            rgba(15, 23, 42, 1),
            rgba(15, 23, 42, 0.97)
          );
        border: 1px solid rgba(30, 64, 175, 0.72);
        box-shadow:
          0 18px 36px rgba(15, 23, 42, 0.95),
          0 0 0 1px rgba(15, 23, 42, 0.9);
        position: relative;
        overflow: hidden;
      }

      .panel::before {
        content: "";
        position: absolute;
        inset: 0;
        background:
          radial-gradient(circle at top, rgba(56, 189, 248, 0.12), transparent 60%),
          radial-gradient(circle at bottom, rgba(236, 72, 153, 0.1), transparent 65%);
        opacity: 0.9;
        mix-blend-mode: soft-light;
        pointer-events: none;
      }

      .panel-inner {
        position: relative;
        z-index: 1;
      }

      .prompt-label {
        font-size: 0.8rem;
        letter-spacing: 0.14em;
        text-transform: uppercase;
        color: var(--text-muted);
        margin-bottom: 8px;
      }

      .prompt-label strong {
        color: var(--accent);
        font-weight: 600;
      }

      .color-word-wrapper {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 96px;
        margin-top: 2px;
        margin-bottom: 4px;
      }

      .color-word {
        font-weight: 700;
        font-size: clamp(2.6rem, 2.2rem + 1.7vw, 3.8rem);
        letter-spacing: 0.25em;
        text-transform: uppercase;
        text-align: center;
        text-shadow:
          0 0 18px rgba(15, 23, 42, 0.95),
          0 0 32px rgba(15, 23, 42, 0.9);
        transform-origin: center;
        will-change: transform, opacity;
      }

      .color-word--enter {
        animation: wordEnter 260ms ease-out;
      }

      @keyframes wordEnter {
        from {
          opacity: 0;
          transform: translateY(6px) scale(0.96);
        }
        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }

      .message-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 10px;
        margin-top: 2px;
      }

      .feedback-message {
        font-size: 0.82rem;
        color: var(--text-muted);
        min-height: 1.2em;
      }

      .feedback-message--correct {
        color: #bbf7d0;
      }

      .feedback-message--wrong {
        color: #fecaca;
      }

      .streak-indicator {
        font-size: 0.8rem;
        color: var(--text-muted);
        text-align: right;
      }

      .streak-indicator strong {
        color: #bef264;
        font-weight: 600;
      }

      .controls {
        margin-top: 10px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 10px;
        flex-wrap: wrap;
      }

      .hint {
        font-size: 0.72rem;
        text-transform: uppercase;
        letter-spacing: 0.16em;
        color: var(--text-muted);
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .hint-dot {
        width: 6px;
        height: 6px;
        border-radius: 999px;
        background: var(--accent);
        box-shadow: 0 0 10px rgba(56, 189, 248, 0.9);
      }

      .primary-button {
        border: 0;
        border-radius: 999px;
        padding: 8px 14px;
        font-size: 0.85rem;
        letter-spacing: 0.14em;
        text-transform: uppercase;
        font-weight: 600;
        cursor: pointer;
        color: #0f172a;
        background: radial-gradient(
          circle at top left,
          #e0f2fe,
          #7dd3fc 40%,
          #38bdf8 75%
        );
        box-shadow:
          0 16px 32px rgba(15, 23, 42, 0.9),
          0 0 0 1px rgba(56, 189, 248, 0.9);
        display: inline-flex;
        align-items: center;
        gap: 6px;
        transition:
          transform 140ms ease-out,
          box-shadow 140ms ease-out,
          filter 140ms ease-out;
      }

      .primary-button-icon {
        width: 14px;
        height: 14px;
        border-radius: 999px;
        background: radial-gradient(circle at 30% 20%, #0ea5e9, #0369a1);
        box-shadow:
          0 0 18px rgba(56, 189, 248, 0.95),
          inset 0 0 0 1px rgba(248, 250, 252, 0.5);
      }

      .primary-button:active {
        transform: translateY(1px) scale(0.98);
        box-shadow:
          0 10px 22px rgba(15, 23, 42, 0.9),
          0 0 0 1px rgba(56, 189, 248, 0.9);
        filter: brightness(0.98);
      }

      .primary-button:focus-visible {
        outline: 2px solid #f9fafb;
        outline-offset: 2px;
      }

      .primary-button[disabled] {
        cursor: default;
        opacity: 0.7;
        box-shadow:
          0 10px 20px rgba(15, 23, 42, 0.85),
          0 0 0 1px rgba(148, 163, 184, 0.6);
        background: radial-gradient(
          circle at top left,
          #cbd5f5,
          #93c5fd 42%,
          #60a5fa 78%
        );
      }

      .buttons-panel {
        padding: 14px 16px 16px;
        border-radius: 18px;
        background: radial-gradient(
            circle at top right,
            rgba(15, 23, 42, 1),
            rgba(15, 23, 42, 0.97)
          );
        border: 1px solid rgba(148, 163, 184, 0.6);
        box-shadow:
          0 18px 36px rgba(15, 23, 42, 0.95),
          0 0 0 1px rgba(15, 23, 42, 0.9);
      }

      .buttons-header {
        display: flex;
        justify-content: space-between;
        align-items: baseline;
        margin-bottom: 10px;
        gap: 10px;
      }

      .buttons-title {
        font-size: 0.9rem;
        letter-spacing: 0.12em;
        text-transform: uppercase;
        color: var(--text-muted);
      }

      .buttons-subtitle {
        font-size: 0.8rem;
        color: var(--text-muted);
        text-align: right;
      }

      .buttons-grid {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 10px;
      }

      @media (max-width: 540px) {
        .buttons-grid {
          grid-template-columns: minmax(0, 1fr);
        }
      }

      .color-button {
        position: relative;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 10px;
        padding: 10px 12px 11px;
        border-radius: 999px;
        border: 0;
        cursor: pointer;
        width: 100%;
        font-size: 0.95rem;
        font-weight: 600;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: #020617;
        transform: translateY(0);
        background: radial-gradient(
          circle at top left,
          var(--btn-soft),
          var(--btn-strong)
        );
        box-shadow:
          0 18px 32px rgba(15, 23, 42, 0.98),
          0 0 0 1px rgba(15, 23, 42, 0.9);
        transition:
          transform 120ms ease-out,
          box-shadow 120ms ease-out,
          filter 120ms ease-out;
      }

      .color-button::before {
        content: "";
        position: absolute;
        inset: 1px;
        border-radius: inherit;
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.16),
          rgba(255, 255, 255, 0.02)
        );
        mix-blend-mode: soft-light;
        opacity: 0.75;
        pointer-events: none;
      }

      .color-button-inner {
        position: relative;
        z-index: 1;
        display: flex;
        align-items: center;
        justify-content: space-between;
        width: 100%;
        gap: 10px;
      }

      .color-button-label {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 0;
      }

      .color-button-name {
        font-size: 0.9rem;
      }

      .color-button-shortcut {
        font-size: 0.7rem;
        opacity: 0.7;
        letter-spacing: 0.1em;
      }

      .color-button-swatch {
        width: 20px;
        height: 20px;
        border-radius: 999px;
        border: 2px solid rgba(15, 23, 42, 0.6);
        box-shadow:
          0 0 0 1px rgba(255, 255, 255, 0.35),
          0 0 14px rgba(15, 23, 42, 0.9);
      }

      .color-button:active {
        transform: translateY(1px) scale(0.97);
        box-shadow:
          0 13px 24px rgba(15, 23, 42, 0.98),
          0 0 0 1px rgba(15, 23, 42, 0.95);
        filter: brightness(0.98);
      }

      .color-button:focus-visible {
        outline: 2px solid #f9fafb;
        outline-offset: 2px;
      }

      .color-button[disabled] {
        cursor: default;
        opacity: 0.7;
        box-shadow:
          0 10px 20px rgba(15, 23, 42, 0.9),
          0 0 0 1px rgba(15, 23, 42, 1);
        filter: grayscale(0.15);
      }

      @keyframes buttonPulse {
        0% {
          transform: translateY(0) scale(1);
        }
        50% {
          transform: translateY(1px) scale(0.97);
        }
        100% {
          transform: translateY(0) scale(1);
        }
      }

      @keyframes buttonCorrect {
        0% {
          box-shadow:
            0 18px 32px rgba(15, 23, 42, 0.98),
            0 0 0 1px rgba(15, 23, 42, 0.9);
        }
        50% {
          box-shadow:
            0 18px 40px rgba(22, 163, 74, 0.9),
            0 0 0 1px rgba(74, 222, 128, 1);
        }
        100% {
          box-shadow:
            0 18px 32px rgba(15, 23, 42, 0.98),
            0 0 0 1px rgba(15, 23, 42, 0.9);
        }
      }

      @keyframes buttonWrong {
        0%,
        100% {
          transform: translateX(0);
        }
        25% {
          transform: translateX(-4px);
        }
        75% {
          transform: translateX(4px);
        }
      }

      .color-button--pulse {
        animation: buttonPulse 150ms ease-out;
      }

      .color-button--correct {
        animation: buttonCorrect 220ms ease-out;
      }

      .color-button--wrong {
        animation: buttonWrong 180ms ease-out;
      }

      .btn-red {
        --btn-soft: #fecaca;
        --btn-strong: #f97373;
      }

      .btn-orange {
        --btn-soft: #fed7aa;
        --btn-strong: #fb923c;
      }

      .btn-yellow {
        --btn-soft: #fef3c7;
        --btn-strong: #facc15;
      }

      .btn-green {
        --btn-soft: #bbf7d0;
        --btn-strong: #4ade80;
      }

      .btn-blue {
        --btn-soft: #bfdbfe;
        --btn-strong: #60a5fa;
      }

      .btn-purple {
        --btn-soft: #e9d5ff;
        --btn-strong: #a855f7;
      }

      .btn-pink {
        --btn-soft: #f9a8d4;
        --btn-strong: #ec4899;
      }

      .btn-cyan {
        --btn-soft: #a5f3fc;
        --btn-strong: #22d3ee;
      }

      .footer {
        display: flex;
        justify-content: space-between;
        align-items: baseline;
        margin-top: 14px;
        gap: 12px;
        font-size: 0.75rem;
        color: var(--text-muted);
      }

      .footer a {
        color: var(--accent);
        text-decoration: none;
      }

      .footer a:hover {
        text-decoration: underline;
      }

      .overlay {
        position: absolute;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        pointer-events: none;
      }

      .overlay-content {
        max-width: 380px;
        width: 100%;
        padding: 16px 18px;
        border-radius: 20px;
        background: radial-gradient(
            circle at top,
            rgba(30, 64, 175, 0.96),
            rgba(15, 23, 42, 0.98)
          );
        border: 1px solid rgba(129, 140, 248, 0.7);
        box-shadow:
          0 26px 60px rgba(15, 23, 42, 0.96),
          0 0 0 1px rgba(15, 23, 42, 1);
        text-align: left;
        transform: translateY(12px);
        opacity: 0;
        transition:
          opacity 180ms ease-out,
          transform 180ms ease-out;
      }

      .overlay.visible {
        pointer-events: auto;
      }

      .overlay.visible .overlay-content {
        opacity: 1;
        transform: translateY(0);
      }

      .overlay-heading {
        font-size: 0.95rem;
        text-transform: uppercase;
        letter-spacing: 0.16em;
        color: var(--text-muted);
        margin-bottom: 6px;
      }

      .overlay-score {
        font-size: 1.6rem;
        font-weight: 700;
        margin-bottom: 4px;
      }

      .overlay-summary {
        font-size: 0.8rem;
        color: var(--text-soft);
        margin-bottom: 8px;
      }

      .overlay-grid {
        display: grid;
        grid-template-columns: repeat(3, minmax(0, 1fr));
        gap: 6px;
        margin-bottom: 10px;
      }

      .overlay-stat {
        padding: 6px 8px;
        border-radius: 12px;
        background: rgba(15, 23, 42, 0.9);
        border: 1px solid rgba(148, 163, 184, 0.65);
        font-size: 0.7rem;
      }

      .overlay-stat-label {
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.1em;
        margin-bottom: 2px;
      }

      .overlay-stat-value {
        font-weight: 600;
        color: #e5e7eb;
      }

      .overlay-actions {
        display: flex;
        justify-content: flex-end;
        gap: 8px;
        margin-top: 4px;
      }

      .overlay-button {
        border-radius: 999px;
        border: 0;
        padding: 6px 12px;
        font-size: 0.78rem;
        letter-spacing: 0.14em;
        text-transform: uppercase;
        cursor: pointer;
        font-weight: 600;
        background: rgba(15, 23, 42, 0.9);
        color: var(--text-soft);
        border: 1px solid rgba(148, 163, 184, 0.9);
      }

      .overlay-button--primary {
        background: linear-gradient(
          130deg,
          rgba(56, 189, 248, 0.2),
          rgba(129, 140, 248, 0.9)
        );
        border-color: rgba(129, 140, 248, 0.9);
      }

      .overlay-button:focus-visible {
        outline: 2px solid #f9fafb;
        outline-offset: 2px;
      }

      .sr-only {
        border: 0;
        clip: rect(0 0 0 0);
        height: 1px;
        width: 1px;
        margin: -1px;
        padding: 0;
        overflow: hidden;
        position: absolute;
        white-space: nowrap;
      }
    </style>
  </head>
  <body>
    <div class="game-shell" aria-labelledby="app-title">
      <div class="orb orb--cyan" aria-hidden="true"></div>
      <div class="orb orb--violet" aria-hidden="true"></div>
      <div class="game-inner">
        <header class="header">
          <div class="title-block">
            <h1 id="app-title" class="app-title">
              Color Match
              <span class="app-title-pill">30&nbsp;Second Challenge</span>
            </h1>
            <p class="subtitle">
              Your brain wants to read the word. Your score depends on the
              <strong>ink color</strong>.
            </p>
          </div>
          <div class="hud">
            <div class="pill" id="timer-pill" aria-label="Time remaining">
              <div class="pill-main">
                <span class="pill-label">Time</span>
                <span class="pill-number" id="time-label">30.0</span>
                <span class="pill-unit">sec</span>
              </div>
              <div class="timer-bar" aria-hidden="true">
                <div class="timer-bar-fill" id="timer-bar-fill"></div>
              </div>
            </div>
            <div class="pill" aria-label="Score and streak">
              <div class="pill-main">
                <span class="pill-label">Score</span>
                <span class="pill-number" id="score-label">0</span>
                <span class="pill-unit">pts</span>
              </div>
              <div class="chip-row">
                <span class="chip">
                  Best&nbsp;<strong id="best-score-label">0</strong>
                </span>
                <span class="chip" id="streak-chip">
                  Streak&nbsp;<strong id="streak-label">0</strong>x
                </span>
              </div>
            </div>
          </div>
        </header>

        <main class="main">
          <section class="panel" aria-live="polite">
            <div class="panel-inner">
              <p class="prompt-label">
                Click the color of the <strong>ink</strong>, not the word.
              </p>
              <div class="color-word-wrapper">
                <div
                  id="color-word"
                  class="color-word"
                  aria-label="Color challenge word"
                >
                  READY?
                </div>
              </div>
              <div class="message-row">
                <p id="feedback" class="feedback-message">
                  Press&nbsp;<strong>Start</strong>, then race for the highest
                  score.
                </p>
                <p id="streak-indicator" class="streak-indicator">
                  Streak: <strong>0</strong>x
                </p>
              </div>
              <div class="controls">
                <div class="hint" aria-hidden="true">
                  <span class="hint-dot"></span>
                  <span>Keys 1–8 also pick colors.</span>
                </div>
                <button
                  id="start-button"
                  type="button"
                  class="primary-button"
                >
                  <span class="primary-button-icon" aria-hidden="true"></span>
                  <span id="start-label">Start 30s Run</span>
                </button>
              </div>
            </div>
          </section>

          <section
            class="buttons-panel"
            aria-label="Color choices"
            aria-describedby="buttons-tip"
          >
            <div class="buttons-header">
              <p id="buttons-tip" class="buttons-title">
                Tap the matching ink color
              </p>
              <p class="buttons-subtitle">
                Ignore the word’s meaning. Trust the color.
              </p>
            </div>
            <div id="buttons-grid" class="buttons-grid"></div>
          </section>
        </main>

        <footer class="footer">
          <span>Fast, intuitive, and a little bit mean to your brain.</span>
          <span>Pro tip: short streaks beat slow perfection.</span>
        </footer>

        <div
          id="overlay"
          class="overlay"
          role="dialog"
          aria-modal="true"
          aria-labelledby="overlay-heading"
          aria-describedby="overlay-summary"
        >
          <div class="overlay-content">
            <p id="overlay-heading" class="overlay-heading">Run complete</p>
            <p class="overlay-score">
              <span id="overlay-score">0</span>&nbsp;pts
            </p>
            <p id="overlay-summary" class="overlay-summary">
              Nice warm-up! Try a faster rhythm to push your streak higher.
            </p>
            <div class="overlay-grid">
              <div class="overlay-stat">
                <div class="overlay-stat-label">Best</div>
                <div class="overlay-stat-value" id="overlay-best">0</div>
              </div>
              <div class="overlay-stat">
                <div class="overlay-stat-label">Accuracy</div>
                <div class="overlay-stat-value" id="overlay-accuracy">
                  0%
                </div>
              </div>
              <div class="overlay-stat">
                <div class="overlay-stat-label">Rounds</div>
                <div class="overlay-stat-value" id="overlay-rounds">0</div>
              </div>
            </div>
            <div class="overlay-actions">
              <button
                type="button"
                class="overlay-button"
                id="overlay-close"
              >
                Close
              </button>
              <button
                type="button"
                class="overlay-button overlay-button--primary"
                id="overlay-restart"
              >
                Play again
              </button>
            </div>
          </div>
        </div>

        <p class="sr-only" aria-live="assertive" id="sr-status"></p>
      </div>
    </div>

    <script>
      (function () {
        "use strict";

        var GAME_DURATION_MS = 30000;
        var STATE = {
          running: false,
          score: 0,
          bestScore: 0,
          streak: 0,
          correct: 0,
          total: 0,
          rounds: 0,
          currentAnswer: null,
          timerStart: 0,
          timerId: null,
        };

        var COLORS = [
          {
            name: "RED",
            key: "red",
            buttonClass: "btn-red",
            ink: "#ef4444",
          },
          {
            name: "ORANGE",
            key: "orange",
            buttonClass: "btn-orange",
            ink: "#f97316",
          },
          {
            name: "YELLOW",
            key: "yellow",
            buttonClass: "btn-yellow",
            ink: "#eab308",
          },
          {
            name: "GREEN",
            key: "green",
            buttonClass: "btn-green",
            ink: "#22c55e",
          },
          {
            name: "BLUE",
            key: "blue",
            buttonClass: "btn-blue",
            ink: "#3b82f6",
          },
          {
            name: "PURPLE",
            key: "purple",
            buttonClass: "btn-purple",
            ink: "#a855f7",
          },
          {
            name: "PINK",
            key: "pink",
            buttonClass: "btn-pink",
            ink: "#ec4899",
          },
          {
            name: "CYAN",
            key: "cyan",
            buttonClass: "btn-cyan",
            ink: "#22d3ee",
          },
        ];

        var colorWord = document.getElementById("color-word");
        var feedback = document.getElementById("feedback");
        var streakIndicator = document.getElementById("streak-indicator");
        var startButton = document.getElementById("start-button");
        var startLabel = document.getElementById("start-label");
        var buttonsGrid = document.getElementById("buttons-grid");
        var timerLabel = document.getElementById("time-label");
        var timerBarFill = document.getElementById("timer-bar-fill");
        var timerPill = document.getElementById("timer-pill");
        var scoreLabel = document.getElementById("score-label");
        var bestScoreLabel = document.getElementById("best-score-label");
        var streakLabel = document.getElementById("streak-label");
        var streakChip = document.getElementById("streak-chip");
        var overlay = document.getElementById("overlay");
        var overlayScore = document.getElementById("overlay-score");
        var overlayBest = document.getElementById("overlay-best");
        var overlayAccuracy = document.getElementById("overlay-accuracy");
        var overlayRounds = document.getElementById("overlay-rounds");
        var overlaySummary = document.getElementById("overlay-summary");
        var overlayClose = document.getElementById("overlay-close");
        var overlayRestart = document.getElementById("overlay-restart");
        var srStatus = document.getElementById("sr-status");

        var colorButtons = [];
        var keyToButton = {};

        function init() {
          var storedBest = null;
          try {
            storedBest = window.localStorage.getItem("colorMatchBest");
          } catch (e) {
            storedBest = null;
          }
          var bestValue = parseInt(storedBest, 10);
          if (!isNaN(bestValue) && bestValue > 0) {
            STATE.bestScore = bestValue;
          }
          bestScoreLabel.textContent = STATE.bestScore;

          createButtons();
          attachEvents();
          updateStreak();
          updateTimer(GAME_DURATION_MS);
        }

        function createButtons() {
          var frag = document.createDocumentFragment();
          var maxShortcut = Math.min(COLORS.length, 8);
          for (var i = 0; i < COLORS.length; i++) {
            var color = COLORS[i];
            var button = document.createElement("button");
            button.type = "button";
            button.className =
              "color-button " + color.buttonClass + " color-button--idle";
            button.setAttribute(
              "aria-label",
              "Pick " + color.name.toLowerCase() + " ink"
            );
            button.dataset.colorKey = color.key;

            var inner = document.createElement("div");
            inner.className = "color-button-inner";

            var label = document.createElement("div");
            label.className = "color-button-label";

            var nameSpan = document.createElement("span");
            nameSpan.className = "color-button-name";
            nameSpan.textContent = color.name;
            label.appendChild(nameSpan);

            var shortcutSpan = document.createElement("span");
            shortcutSpan.className = "color-button-shortcut";
            var shortcutIndex = i + 1;
            if (shortcutIndex <= maxShortcut) {
              shortcutSpan.textContent = "[" + shortcutIndex + "]";
              keyToButton[String(shortcutIndex)] = button;
            } else {
              shortcutSpan.textContent = "\u00A0";
            }
            label.appendChild(shortcutSpan);

            var swatch = document.createElement("span");
            swatch.className = "color-button-swatch";
            swatch.style.background = color.ink;

            inner.appendChild(label);
            inner.appendChild(swatch);
            button.appendChild(inner);
            frag.appendChild(button);

            (function (c, btn) {
              btn.addEventListener("click", function () {
                handleGuess(c, btn);
              });
            })(color, button);

            colorButtons.push(button);
          }
          buttonsGrid.appendChild(frag);
          setButtonsEnabled(false);
        }

        function attachEvents() {
          startButton.addEventListener("click", function () {
            if (STATE.running) {
              endGame();
            } else {
              startGame();
            }
          });

          overlayClose.addEventListener("click", function () {
            hideOverlay();
          });

          overlayRestart.addEventListener("click", function () {
            hideOverlay();
            startGame();
          });

          document.addEventListener("keydown", function (event) {
            if (!STATE.running) {
              return;
            }
            var key = event.key;
            if (keyToButton[key]) {
              event.preventDefault();
              keyToButton[key].click();
            }
          });
        }

        function randomIndex(max) {
          return Math.floor(Math.random() * max);
        }

        function startGame() {
          resetState();
          STATE.running = true;
          STATE.timerStart = performance.now();
          startLabel.textContent = "End run";
          setButtonsEnabled(true);
          nextRound();
          scheduleTimer();
          feedback.textContent = "Go! Trust the color, not the word.";
          feedback.className = "feedback-message";
          announce("New run started. 30 seconds.");
        }

        function resetState() {
          clearTimer();
          STATE.score = 0;
          STATE.streak = 0;
          STATE.correct = 0;
          STATE.total = 0;
          STATE.rounds = 0;
          STATE.currentAnswer = null;
          updateScore();
          updateStreak();
          updateTimer(GAME_DURATION_MS);
          timerPill.classList.remove("timer-low");
        }

        function endGame() {
          if (!STATE.running) {
            return;
          }
          STATE.running = false;
          clearTimer();
          setButtonsEnabled(false);
          updateTimer(0);
          timerPill.classList.add("timer-low");
          startLabel.textContent = "Start 30s Run";
          var improved = maybeStoreBest();
          showOverlay(improved);
          announce(
            "Run complete. Score " +
              STATE.score +
              " points in " +
              STATE.rounds +
              " rounds."
          );
        }

        function clearTimer() {
          if (STATE.timerId !== null) {
            cancelAnimationFrame(STATE.timerId);
            STATE.timerId = null;
          }
        }

        function scheduleTimer() {
          function tick(now) {
            if (!STATE.running) {
              return;
            }
            var elapsed = now - STATE.timerStart;
            var remaining = GAME_DURATION_MS - elapsed;
            if (remaining <= 0) {
              updateTimer(0);
              endGame();
              return;
            }
            updateTimer(remaining);
            STATE.timerId = requestAnimationFrame(tick);
          }
          STATE.timerId = requestAnimationFrame(tick);
        }

        function updateTimer(remainingMs) {
          if (remainingMs < 0) remainingMs = 0;
          if (remainingMs > GAME_DURATION_MS) remainingMs = GAME_DURATION_MS;
          var fraction = remainingMs / GAME_DURATION_MS;
          timerBarFill.style.transform = "scaleX(" + fraction + ")";
          timerLabel.textContent = (remainingMs / 1000).toFixed(1);
          if (remainingMs <= 7000) {
            timerPill.classList.add("timer-low");
          } else {
            timerPill.classList.remove("timer-low");
          }
        }

        function updateScore() {
          scoreLabel.textContent = STATE.score;
          bestScoreLabel.textContent = STATE.bestScore;
        }

        function updateStreak() {
          streakLabel.textContent = STATE.streak;
          streakIndicator.innerHTML = "Streak: <strong>" + STATE.streak + "</strong>x";
          if (STATE.streak >= 4) {
            streakChip.classList.add("chip--streak-hot");
          } else {
            streakChip.classList.remove("chip--streak-hot");
          }
        }

        function setButtonsEnabled(enabled) {
          for (var i = 0; i < colorButtons.length; i++) {
            colorButtons[i].disabled = !enabled;
          }
        }

        function nextRound() {
          if (!STATE.running) {
            return;
          }
          STATE.rounds += 1;

          var textColor = COLORS[randomIndex(COLORS.length)];
          var inkColor;
          if (Math.random() < 0.35) {
            inkColor = textColor;
          } else {
            do {
              inkColor = COLORS[randomIndex(COLORS.length)];
            } while (inkColor.name === textColor.name);
          }
          STATE.currentAnswer = inkColor.key;

          colorWord.textContent = textColor.name;
          colorWord.style.color = inkColor.ink;

          colorWord.classList.remove("color-word--enter");
          void colorWord.offsetWidth;
          colorWord.classList.add("color-word--enter");
        }

        function basePointsForStreak(streak) {
          if (streak >= 10) return 25;
          if (streak >= 6) return 20;
          if (streak >= 3) return 15;
          return 10;
        }

        function feedbackForScore(streak, score) {
          if (streak >= 10) return "Blazing! Your brain is on fire.";
          if (streak >= 6) return "Locked in. Keep the streak alive.";
          if (streak >= 3) return "Nice rhythm – ride that streak.";
          if (score >= 120) return "Sharp! Try pushing for longer streaks.";
          if (score >= 60) return "Good flow. A bit faster next run.";
          return "Great warm-up. Trust the color a little faster.";
        }

        function handleGuess(color, button) {
          if (!STATE.running || !STATE.currentAnswer) {
            return;
          }
          var isCorrect = color.key === STATE.currentAnswer;
          STATE.total += 1;

          button.classList.remove(
            "color-button--pulse",
            "color-button--correct",
            "color-button--wrong"
          );
          void button.offsetWidth;
          button.classList.add("color-button--pulse");

          if (isCorrect) {
            STATE.correct += 1;
            STATE.streak += 1;
            var gained = basePointsForStreak(STATE.streak);
            STATE.score += gained;
            feedback.textContent =
              "+" + gained + " pts · streak " + STATE.streak + "x";
            feedback.className =
              "feedback-message feedback-message--correct";
            button.classList.add("color-button--correct");
            announce("Correct. Streak " + STATE.streak + "x.");
          } else {
            var wasAnswer = STATE.currentAnswer;
            var correctName = wasAnswer
              ? wasAnswer.toUpperCase()
              : "unknown";
            STATE.streak = 0;
            STATE.score = Math.max(0, STATE.score - 5);
            feedback.textContent =
              "Wrong – that ink was " + correctName + ". -5 pts.";
            feedback.className = "feedback-message feedback-message--wrong";
            button.classList.add("color-button--wrong");
            announce("Wrong. That ink was " + correctName + ".");
          }

          updateScore();
          updateStreak();

          setTimeout(function () {
            if (STATE.running) {
              nextRound();
            }
          }, 220);
        }

        function maybeStoreBest() {
          if (STATE.score <= STATE.bestScore) {
            return false;
          }
          STATE.bestScore = STATE.score;
          bestScoreLabel.textContent = STATE.bestScore;
          try {
            window.localStorage.setItem(
              "colorMatchBest",
              String(STATE.bestScore)
            );
          } catch (e) {
            /* ignore */
          }
          return true;
        }

        function showOverlay(improved) {
          overlayScore.textContent = STATE.score;
          overlayBest.textContent = STATE.bestScore;
          overlayRounds.textContent = STATE.rounds;
          var accuracy =
            STATE.total === 0
              ? 0
              : Math.round((STATE.correct / STATE.total) * 100);
          overlayAccuracy.textContent = accuracy + "%";

          var message;
          if (STATE.score === 0) {
            message =
              "Take a moment to sync with the rules, then go again.";
          } else if (improved) {
            message =
              "New personal best! Your eyes and reactions are in sync.";
          } else {
            message = feedbackForScore(STATE.streak, STATE.score);
          }
          overlaySummary.textContent = message;

          overlay.classList.add("visible");
        }

        function hideOverlay() {
          overlay.classList.remove("visible");
        }

        function announce(text) {
          srStatus.textContent = text;
        }

        if (document.readyState === "loading") {
          document.addEventListener("DOMContentLoaded", init);
        } else {
          init();
        }
      })();
    </script>
  </body>
</html>

