<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="color-scheme" content="light dark" />
    <title>Markdown → Slides</title>
    <style>
      :root {
        --bg: #0b1220;
        --bg2: #07101d;
        --surface: rgba(255, 255, 255, 0.06);
        --surface2: rgba(255, 255, 255, 0.09);
        --border: rgba(255, 255, 255, 0.12);
        --text: rgba(255, 255, 255, 0.92);
        --muted: rgba(255, 255, 255, 0.65);
        --faint: rgba(255, 255, 255, 0.45);
        --shadow: 0 16px 44px rgba(0, 0, 0, 0.55);
        --shadow2: 0 10px 30px rgba(0, 0, 0, 0.35);
        --accent: #5eead4;
        --accent2: #60a5fa;
        --accent3: #a78bfa;
        --danger: #fb7185;
        --good: #34d399;
        --warn: #fbbf24;
        --ring: 0 0 0 3px rgba(94, 234, 212, 0.28);
        --radius: 16px;
        --radius2: 22px;
        --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New",
          monospace;
        --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji",
          "Segoe UI Emoji";
        --slide-w: 1280px;
        --slide-h: 720px;
      }

      [data-theme="light"] {
        --bg: #f6f7fb;
        --bg2: #eef1f8;
        --surface: rgba(10, 22, 56, 0.06);
        --surface2: rgba(10, 22, 56, 0.08);
        --border: rgba(10, 22, 56, 0.12);
        --text: rgba(10, 22, 56, 0.92);
        --muted: rgba(10, 22, 56, 0.68);
        --faint: rgba(10, 22, 56, 0.46);
        --shadow: 0 16px 44px rgba(10, 22, 56, 0.16);
        --shadow2: 0 10px 30px rgba(10, 22, 56, 0.12);
        --accent: #0ea5e9;
        --accent2: #2563eb;
        --accent3: #7c3aed;
        --ring: 0 0 0 3px rgba(14, 165, 233, 0.25);
      }

      * {
        box-sizing: border-box;
      }

      html,
      body {
        height: 100%;
      }

      body {
        margin: 0;
        font-family: var(--sans);
        color: var(--text);
        background: radial-gradient(1100px 600px at 20% 0%, rgba(96, 165, 250, 0.18), transparent 55%),
          radial-gradient(1000px 700px at 110% 20%, rgba(167, 139, 250, 0.16), transparent 55%),
          radial-gradient(900px 700px at 30% 120%, rgba(94, 234, 212, 0.14), transparent 55%),
          linear-gradient(180deg, var(--bg), var(--bg2));
        overflow: hidden;
      }

      a {
        color: inherit;
        text-decoration: none;
      }

      .app {
        height: 100%;
        display: grid;
        grid-template-rows: auto 1fr;
      }

      .topbar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 14px;
        padding: 14px 16px;
        border-bottom: 1px solid var(--border);
        background: linear-gradient(180deg, rgba(255, 255, 255, 0.06), rgba(255, 255, 255, 0.02));
        backdrop-filter: blur(10px);
      }

      .brand {
        display: flex;
        align-items: baseline;
        gap: 12px;
        min-width: 260px;
      }

      .brand .name {
        font-size: 14px;
        letter-spacing: 0.06em;
        text-transform: uppercase;
        font-weight: 650;
      }

      .brand .badge {
        font-size: 12px;
        color: var(--muted);
        border: 1px solid var(--border);
        background: rgba(255, 255, 255, 0.05);
        padding: 5px 10px;
        border-radius: 999px;
      }

      .controls {
        display: flex;
        gap: 10px;
        align-items: center;
        flex-wrap: wrap;
        justify-content: flex-end;
      }

      .btn {
        appearance: none;
        border: 1px solid var(--border);
        background: rgba(255, 255, 255, 0.06);
        color: var(--text);
        padding: 9px 11px;
        border-radius: 12px;
        font-size: 13px;
        font-weight: 600;
        letter-spacing: 0.01em;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        cursor: pointer;
        transition: transform 140ms ease, background 140ms ease, border-color 140ms ease;
        user-select: none;
      }

      .btn:hover {
        background: rgba(255, 255, 255, 0.09);
        border-color: rgba(255, 255, 255, 0.22);
        transform: translateY(-1px);
      }

      .btn:active {
        transform: translateY(0px);
      }

      .btn:focus-visible {
        outline: none;
        box-shadow: var(--ring);
      }

      .icon {
        width: 16px;
        height: 16px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        flex: 0 0 auto;
      }

      .icon svg {
        width: 16px;
        height: 16px;
        stroke: currentColor;
      }

      .btn.primary {
        border-color: rgba(94, 234, 212, 0.35);
        background: linear-gradient(180deg, rgba(94, 234, 212, 0.2), rgba(94, 234, 212, 0.08));
      }

      [data-theme="light"] .btn.primary {
        border-color: rgba(37, 99, 235, 0.3);
        background: linear-gradient(180deg, rgba(37, 99, 235, 0.16), rgba(37, 99, 235, 0.07));
      }

      .btn.ghost {
        background: transparent;
      }

      .workspace {
        padding: 16px;
        display: grid;
        grid-template-columns: minmax(340px, 1fr) minmax(480px, 1.2fr);
        gap: 14px;
        height: 100%;
        min-height: 0;
      }

      @media (max-width: 980px) {
        body {
          overflow: auto;
        }
        .workspace {
          grid-template-columns: 1fr;
          height: auto;
          min-height: unset;
        }
      }

      .panel {
        border-radius: var(--radius2);
        border: 1px solid var(--border);
        background: rgba(255, 255, 255, 0.05);
        box-shadow: var(--shadow2);
        overflow: hidden;
        display: grid;
        grid-template-rows: auto 1fr auto;
        min-height: 0;
      }

      .panel-head {
        padding: 12px 14px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        border-bottom: 1px solid var(--border);
        background: linear-gradient(180deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.03));
      }

      .panel-title {
        display: flex;
        align-items: center;
        gap: 10px;
        font-weight: 700;
        letter-spacing: 0.01em;
        font-size: 13px;
      }

      .dot {
        width: 10px;
        height: 10px;
        border-radius: 999px;
        background: linear-gradient(135deg, var(--accent), var(--accent2));
        box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.06);
      }

      .panel-actions {
        display: flex;
        gap: 8px;
        align-items: center;
        flex-wrap: wrap;
        justify-content: flex-end;
      }

      .pill {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 6px 10px;
        border-radius: 999px;
        border: 1px solid var(--border);
        color: var(--muted);
        font-size: 12px;
        background: rgba(255, 255, 255, 0.04);
      }

      .pill strong {
        color: var(--text);
        font-weight: 700;
      }

      .panel-foot {
        padding: 12px 14px;
        border-top: 1px solid var(--border);
        display: flex;
        justify-content: space-between;
        gap: 12px;
        align-items: center;
        color: var(--muted);
        font-size: 12px;
        background: rgba(255, 255, 255, 0.02);
      }

      .kbd {
        font-family: var(--mono);
        font-size: 11px;
        color: var(--text);
        background: rgba(255, 255, 255, 0.06);
        border: 1px solid var(--border);
        padding: 2px 6px;
        border-radius: 8px;
      }

      .editor-wrap {
        height: 100%;
        min-height: 0;
        position: relative;
      }

      textarea#editor {
        width: 100%;
        height: 100%;
        resize: none;
        border: none;
        outline: none;
        background: transparent;
        color: var(--text);
        padding: 16px 16px 18px;
        font-family: var(--mono);
        font-size: 13.5px;
        line-height: 1.55;
        letter-spacing: 0.01em;
        overflow: auto;
      }

      textarea#editor::selection {
        background: rgba(94, 234, 212, 0.28);
      }

      [data-theme="light"] textarea#editor::selection {
        background: rgba(37, 99, 235, 0.22);
      }

      .preview-wrap {
        height: 100%;
        min-height: 0;
        display: grid;
        place-items: center;
        background: radial-gradient(900px 520px at 40% 20%, rgba(255, 255, 255, 0.08), transparent 55%),
          rgba(255, 255, 255, 0.02);
      }

      .stage {
        position: relative;
        width: var(--slide-w);
        height: var(--slide-h);
        transform-origin: 0 0;
      }

      .deck {
        position: absolute;
        inset: 0;
        border-radius: 26px;
        overflow: hidden;
        box-shadow: var(--shadow);
        background: rgba(255, 255, 255, 0.02);
        border: 1px solid rgba(255, 255, 255, 0.16);
      }

      [data-theme="light"] .deck {
        border: 1px solid rgba(10, 22, 56, 0.14);
      }

      .slide {
        position: absolute;
        inset: 0;
        padding: 74px 88px 64px;
        display: grid;
        grid-template-rows: auto 1fr auto;
        gap: 18px;
        opacity: 0;
        transform: translateX(22px);
        transition: opacity 180ms ease, transform 220ms ease;
        background: radial-gradient(1200px 720px at 0% 0%, rgba(96, 165, 250, 0.12), transparent 52%),
          radial-gradient(900px 660px at 110% 10%, rgba(167, 139, 250, 0.12), transparent 56%),
          radial-gradient(1000px 700px at 30% 120%, rgba(94, 234, 212, 0.11), transparent 55%),
          linear-gradient(180deg, rgba(255, 255, 255, 0.06), rgba(255, 255, 255, 0.02));
        pointer-events: none;
      }

      [data-theme="light"] .slide {
        background: radial-gradient(1200px 720px at 0% 0%, rgba(14, 165, 233, 0.12), transparent 52%),
          radial-gradient(900px 660px at 110% 10%, rgba(124, 58, 237, 0.1), transparent 56%),
          radial-gradient(1000px 700px at 30% 120%, rgba(37, 99, 235, 0.09), transparent 55%),
          linear-gradient(180deg, rgba(255, 255, 255, 0.86), rgba(255, 255, 255, 0.72));
      }

      .slide::before {
        content: "";
        position: absolute;
        inset: 0;
        pointer-events: none;
        background: linear-gradient(90deg, rgba(94, 234, 212, 0.55), rgba(96, 165, 250, 0.35), rgba(167, 139, 250, 0.28));
        opacity: 0.12;
        filter: blur(1px);
      }

      [data-theme="light"] .slide::before {
        background: linear-gradient(90deg, rgba(14, 165, 233, 0.55), rgba(37, 99, 235, 0.35), rgba(124, 58, 237, 0.28));
        opacity: 0.1;
      }

      .slide.active {
        opacity: 1;
        transform: translateX(0);
        pointer-events: auto;
      }

      .slide.before {
        opacity: 0;
        transform: translateX(-22px);
      }

      .slide.after {
        opacity: 0;
        transform: translateX(22px);
      }

      .slide .chrome {
        position: absolute;
        left: 0;
        right: 0;
        top: 0;
        height: 62px;
        padding: 18px 22px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 14px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.14);
        background: linear-gradient(180deg, rgba(0, 0, 0, 0.22), transparent);
        backdrop-filter: blur(12px);
      }

      [data-theme="light"] .slide .chrome {
        background: linear-gradient(180deg, rgba(255, 255, 255, 0.72), transparent);
        border-bottom: 1px solid rgba(10, 22, 56, 0.12);
      }

      .slide .chrome .brandmark {
        display: flex;
        align-items: center;
        gap: 12px;
        font-weight: 700;
        letter-spacing: 0.02em;
        text-transform: uppercase;
        font-size: 12px;
        color: var(--muted);
      }

      .slide .chrome .brandmark .mark {
        width: 10px;
        height: 10px;
        border-radius: 3px;
        background: linear-gradient(135deg, var(--accent), var(--accent2), var(--accent3));
        box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.08);
      }

      .slide .chrome .meta {
        font-family: var(--mono);
        font-size: 11px;
        color: var(--muted);
        opacity: 0.85;
      }

      .slide .content {
        position: relative;
        z-index: 1;
        align-self: center;
        min-height: 0;
      }

      .slide .footer {
        position: relative;
        z-index: 1;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
        color: var(--muted);
        font-size: 12px;
        padding-top: 8px;
        border-top: 1px solid rgba(255, 255, 255, 0.12);
      }

      [data-theme="light"] .slide .footer {
        border-top: 1px solid rgba(10, 22, 56, 0.12);
      }

      .slide .footer .fine {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .slide .footer .chip {
        padding: 5px 10px;
        border-radius: 999px;
        border: 1px solid rgba(255, 255, 255, 0.14);
        background: rgba(255, 255, 255, 0.04);
        color: var(--muted);
        font-size: 11px;
      }

      [data-theme="light"] .slide .footer .chip {
        border: 1px solid rgba(10, 22, 56, 0.12);
        background: rgba(10, 22, 56, 0.05);
      }

      /* Markdown typography */
      .md h1 {
        font-size: 52px;
        line-height: 1.05;
        margin: 0 0 14px;
        letter-spacing: -0.02em;
      }

      .md h2 {
        font-size: 34px;
        margin: 0 0 12px;
        letter-spacing: -0.01em;
      }

      .md h3 {
        font-size: 22px;
        margin: 0 0 10px;
      }

      .md p {
        margin: 0 0 12px;
        font-size: 20px;
        line-height: 1.45;
        color: rgba(255, 255, 255, 0.9);
      }

      [data-theme="light"] .md p {
        color: rgba(10, 22, 56, 0.9);
      }

      .md strong {
        color: var(--text);
      }

      .md .muted {
        color: var(--muted);
      }

      .md .small {
        font-size: 14px;
        line-height: 1.45;
      }

      .md ul,
      .md ol {
        margin: 8px 0 0 24px;
        padding: 0;
        font-size: 20px;
        line-height: 1.45;
      }

      .md li {
        margin: 8px 0;
      }

      .md blockquote {
        margin: 16px 0;
        padding: 14px 18px;
        border-left: 4px solid rgba(94, 234, 212, 0.55);
        background: rgba(255, 255, 255, 0.05);
        border-radius: 14px;
        color: var(--text);
      }

      [data-theme="light"] .md blockquote {
        border-left-color: rgba(37, 99, 235, 0.55);
        background: rgba(10, 22, 56, 0.05);
      }

      .md blockquote p {
        margin: 0;
        font-size: 20px;
      }

      .md code {
        font-family: var(--mono);
        font-size: 0.92em;
        padding: 0.14em 0.38em;
        border-radius: 10px;
        border: 1px solid rgba(255, 255, 255, 0.14);
        background: rgba(255, 255, 255, 0.06);
      }

      [data-theme="light"] .md code {
        border: 1px solid rgba(10, 22, 56, 0.14);
        background: rgba(10, 22, 56, 0.06);
      }

      .md pre {
        margin: 14px 0 0;
        padding: 14px 16px;
        border-radius: 16px;
        border: 1px solid rgba(255, 255, 255, 0.16);
        background: rgba(2, 6, 23, 0.6);
        overflow: auto;
        box-shadow: 0 12px 28px rgba(0, 0, 0, 0.35);
      }

      [data-theme="light"] .md pre {
        background: rgba(255, 255, 255, 0.72);
        box-shadow: 0 12px 28px rgba(10, 22, 56, 0.14);
      }

      .md pre code {
        border: none;
        background: transparent;
        padding: 0;
        font-size: 14px;
        line-height: 1.55;
        color: var(--text);
      }

      .md table {
        width: 100%;
        border-collapse: collapse;
        overflow: hidden;
        border-radius: 14px;
        margin-top: 12px;
        font-size: 18px;
      }

      .md th,
      .md td {
        border: 1px solid rgba(255, 255, 255, 0.14);
        padding: 10px 12px;
        text-align: left;
        background: rgba(255, 255, 255, 0.03);
      }

      [data-theme="light"] .md th,
      [data-theme="light"] .md td {
        border: 1px solid rgba(10, 22, 56, 0.14);
        background: rgba(10, 22, 56, 0.03);
      }

      .md th {
        background: rgba(255, 255, 255, 0.06);
      }

      [data-theme="light"] .md th {
        background: rgba(10, 22, 56, 0.06);
      }

      .md hr {
        border: none;
        height: 1px;
        background: rgba(255, 255, 255, 0.14);
        margin: 16px 0;
      }

      [data-theme="light"] .md hr {
        background: rgba(10, 22, 56, 0.14);
      }

      .md img {
        max-width: 100%;
        height: auto;
        border-radius: 18px;
        border: 1px solid rgba(255, 255, 255, 0.14);
        box-shadow: 0 12px 32px rgba(0, 0, 0, 0.25);
        margin-top: 10px;
      }

      [data-theme="light"] .md img {
        border: 1px solid rgba(10, 22, 56, 0.14);
        box-shadow: 0 12px 32px rgba(10, 22, 56, 0.16);
      }

      .md .callout {
        display: grid;
        gap: 10px;
        margin-top: 10px;
        padding: 14px 16px;
        border-radius: 16px;
        border: 1px solid rgba(94, 234, 212, 0.35);
        background: linear-gradient(180deg, rgba(94, 234, 212, 0.12), rgba(94, 234, 212, 0.04));
      }

      [data-theme="light"] .md .callout {
        border-color: rgba(37, 99, 235, 0.28);
        background: linear-gradient(180deg, rgba(37, 99, 235, 0.1), rgba(37, 99, 235, 0.04));
      }

      .md .cols {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 18px;
        align-items: start;
      }

      .md .metric {
        display: grid;
        gap: 6px;
        padding: 14px 16px;
        border-radius: 16px;
        border: 1px solid rgba(255, 255, 255, 0.14);
        background: rgba(255, 255, 255, 0.04);
      }

      [data-theme="light"] .md .metric {
        border: 1px solid rgba(10, 22, 56, 0.14);
        background: rgba(10, 22, 56, 0.04);
      }

      .md .metric .k {
        font-size: 13px;
        color: var(--muted);
        letter-spacing: 0.03em;
        text-transform: uppercase;
        font-weight: 650;
      }

      .md .metric .v {
        font-size: 36px;
        font-weight: 800;
        letter-spacing: -0.02em;
      }

      .md .metric .d {
        font-size: 14px;
        color: var(--muted);
      }

      .md .bar {
        height: 10px;
        border-radius: 999px;
        border: 1px solid rgba(255, 255, 255, 0.12);
        background: rgba(255, 255, 255, 0.05);
        overflow: hidden;
      }

      .md .bar > span {
        display: block;
        height: 100%;
        width: var(--w, 60%);
        border-radius: inherit;
        background: linear-gradient(90deg, var(--accent), var(--accent2));
        box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.08) inset;
      }

      .overlay {
        position: absolute;
        left: 18px;
        right: 18px;
        bottom: 16px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 14px;
        pointer-events: none;
      }

      .indicator {
        pointer-events: none;
        color: rgba(255, 255, 255, 0.78);
        font-family: var(--mono);
        font-size: 12px;
        padding: 7px 10px;
        border-radius: 999px;
        background: rgba(0, 0, 0, 0.28);
        border: 1px solid rgba(255, 255, 255, 0.14);
        backdrop-filter: blur(10px);
      }

      [data-theme="light"] .indicator {
        background: rgba(255, 255, 255, 0.7);
        color: rgba(10, 22, 56, 0.7);
        border: 1px solid rgba(10, 22, 56, 0.14);
      }

      .progress {
        flex: 1;
        height: 10px;
        border-radius: 999px;
        border: 1px solid rgba(255, 255, 255, 0.14);
        background: rgba(0, 0, 0, 0.2);
        overflow: hidden;
        backdrop-filter: blur(10px);
      }

      [data-theme="light"] .progress {
        background: rgba(255, 255, 255, 0.6);
        border: 1px solid rgba(10, 22, 56, 0.14);
      }

      .progress > div {
        height: 100%;
        width: 0%;
        border-radius: inherit;
        background: linear-gradient(90deg, var(--accent), var(--accent2), var(--accent3));
        transition: width 240ms ease;
      }

      .toast {
        position: fixed;
        left: 50%;
        bottom: 16px;
        transform: translateX(-50%);
        background: rgba(0, 0, 0, 0.55);
        color: rgba(255, 255, 255, 0.92);
        border: 1px solid rgba(255, 255, 255, 0.16);
        border-radius: 14px;
        padding: 10px 12px;
        font-size: 13px;
        backdrop-filter: blur(10px);
        box-shadow: 0 16px 44px rgba(0, 0, 0, 0.35);
        opacity: 0;
        pointer-events: none;
        transition: opacity 180ms ease, transform 180ms ease;
        z-index: 1000;
      }

      .toast.show {
        opacity: 1;
        transform: translateX(-50%) translateY(-6px);
      }

      .modal {
        position: fixed;
        inset: 0;
        display: grid;
        place-items: center;
        background: rgba(0, 0, 0, 0.55);
        backdrop-filter: blur(10px);
        z-index: 1200;
      }

      .modal-card {
        width: min(920px, calc(100vw - 28px));
        border-radius: 22px;
        border: 1px solid rgba(255, 255, 255, 0.16);
        background: rgba(9, 14, 27, 0.78);
        box-shadow: 0 24px 70px rgba(0, 0, 0, 0.55);
        overflow: hidden;
      }

      [data-theme="light"] .modal-card {
        border: 1px solid rgba(10, 22, 56, 0.14);
        background: rgba(255, 255, 255, 0.92);
        box-shadow: 0 24px 70px rgba(10, 22, 56, 0.22);
      }

      .modal-head {
        padding: 14px 16px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        border-bottom: 1px solid var(--border);
        background: rgba(255, 255, 255, 0.04);
      }

      .modal-title {
        font-weight: 800;
        letter-spacing: -0.01em;
      }

      .modal-body {
        padding: 16px;
        display: grid;
        gap: 14px;
      }

      .grid {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 12px;
      }

      @media (max-width: 780px) {
        .grid {
          grid-template-columns: 1fr;
        }
      }

      .card {
        border-radius: 18px;
        border: 1px solid var(--border);
        background: rgba(255, 255, 255, 0.04);
        padding: 14px 14px 12px;
        display: grid;
        gap: 10px;
      }

      .card h4 {
        margin: 0;
        font-size: 14px;
        letter-spacing: -0.01em;
      }

      .card p {
        margin: 0;
        color: var(--muted);
        font-size: 12px;
        line-height: 1.45;
      }

      .card .row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
      }

      .help {
        border-top: 1px solid var(--border);
        padding-top: 12px;
        color: var(--muted);
        font-size: 12.5px;
        line-height: 1.55;
      }

      .help ul {
        margin: 8px 0 0 20px;
      }

      .presenting .topbar,
      .presenting .editor-panel {
        display: none;
      }

      .presenting .workspace {
        grid-template-columns: 1fr;
        padding: 0;
        gap: 0;
      }

      .presenting .preview-panel {
        border-radius: 0;
        border: none;
        box-shadow: none;
        background: transparent;
      }

      .presenting .preview-panel .panel-head,
      .presenting .preview-panel .panel-foot {
        display: none;
      }

      .presenting .preview-wrap {
        background: transparent;
      }

      @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
          transition-duration: 0.001ms !important;
          animation-duration: 0.001ms !important;
          scroll-behavior: auto !important;
        }
      }

      /* A tiny embedded highlight theme (inspired by github-dark) */
      .hljs {
        color: var(--text);
      }
      .hljs-comment,
      .hljs-quote {
        color: rgba(255, 255, 255, 0.52);
      }
      [data-theme="light"] .hljs-comment,
      [data-theme="light"] .hljs-quote {
        color: rgba(10, 22, 56, 0.55);
      }
      .hljs-keyword,
      .hljs-selector-tag,
      .hljs-subst {
        color: #93c5fd;
      }
      [data-theme="light"] .hljs-keyword,
      [data-theme="light"] .hljs-selector-tag,
      [data-theme="light"] .hljs-subst {
        color: #1d4ed8;
      }
      .hljs-string,
      .hljs-title,
      .hljs-section,
      .hljs-name,
      .hljs-type,
      .hljs-attribute,
      .hljs-symbol,
      .hljs-bullet,
      .hljs-addition,
      .hljs-variable,
      .hljs-template-tag,
      .hljs-template-variable {
        color: #34d399;
      }
      [data-theme="light"] .hljs-string,
      [data-theme="light"] .hljs-title,
      [data-theme="light"] .hljs-section,
      [data-theme="light"] .hljs-name,
      [data-theme="light"] .hljs-type,
      [data-theme="light"] .hljs-attribute,
      [data-theme="light"] .hljs-symbol,
      [data-theme="light"] .hljs-bullet,
      [data-theme="light"] .hljs-addition,
      [data-theme="light"] .hljs-variable,
      [data-theme="light"] .hljs-template-tag,
      [data-theme="light"] .hljs-template-variable {
        color: #047857;
      }
      .hljs-number,
      .hljs-literal,
      .hljs-tag .hljs-attr,
      .hljs-tag .hljs-name {
        color: #fbbf24;
      }
      [data-theme="light"] .hljs-number,
      [data-theme="light"] .hljs-literal,
      [data-theme="light"] .hljs-tag .hljs-attr,
      [data-theme="light"] .hljs-tag .hljs-name {
        color: #b45309;
      }
    </style>
  </head>
  <body data-theme="dark">
    <div class="app" id="app">
      <header class="topbar">
        <div class="brand">
          <div class="name">Markdown → Slides</div>
          <div class="badge">Live preview • Business-ready</div>
        </div>
        <div class="controls">
          <button class="btn" id="btnSamples" type="button" title="Load a sample deck">
            <span class="icon" aria-hidden="true"
              ><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M7 3h7l3 3v15H7z"></path>
                <path d="M14 3v4h4"></path>
                <path d="M9 11h6"></path>
                <path d="M9 15h6"></path></svg></span
            ><span>Sample</span>
          </button>
          <button class="btn" id="btnHelp" type="button" title="Keyboard shortcuts">
            <span class="icon" aria-hidden="true"
              ><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 18h.01"></path>
                <path
                  d="M9.09 9a3 3 0 1 1 5.82 1c0 2-3 2-3 4"></path>
                <path d="M22 12a10 10 0 1 1-20 0 10 10 0 0 1 20 0Z"></path></svg></span
            ><span>Help</span>
          </button>
          <button class="btn" id="btnTheme" type="button" title="Toggle theme (T)">
            <span class="icon" aria-hidden="true"
              ><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path
                  d="M12 3a7 7 0 1 0 7 7c0-.46-.05-.92-.14-1.36A8.5 8.5 0 1 1 12 3Z"></path></svg></span
            ><span>Theme</span>
          </button>
          <button class="btn primary" id="btnFullscreen" type="button" title="Enter full-screen (F)">
            <span class="icon" aria-hidden="true"
              ><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M8 3H5a2 2 0 0 0-2 2v3"></path>
                <path d="M16 3h3a2 2 0 0 1 2 2v3"></path>
                <path d="M8 21H5a2 2 0 0 1-2-2v-3"></path>
                <path d="M16 21h3a2 2 0 0 0 2-2v-3"></path></svg></span
            ><span>Full screen</span>
          </button>
        </div>
      </header>

      <main class="workspace">
        <section class="panel editor-panel" aria-label="Markdown editor">
          <div class="panel-head">
            <div class="panel-title"><span class="dot" aria-hidden="true"></span>Markdown</div>
            <div class="panel-actions">
              <span class="pill" id="statsPill" title="Slide count and word count">
                <strong id="pillSlides">0</strong> slides · <strong id="pillWords">0</strong> words
              </span>
              <button class="btn ghost" id="btnReset" type="button" title="Restore last saved draft">
                <span class="icon" aria-hidden="true"
                  ><svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M3 12a9 9 0 1 0 3-6.7"></path>
                    <path d="M3 4v6h6"></path></svg></span
                ><span>Restore</span>
              </button>
            </div>
          </div>
          <div class="editor-wrap">
            <textarea id="editor" spellcheck="false" aria-label="Markdown input"></textarea>
          </div>
          <div class="panel-foot">
            <div>
              Slide break: a line that is exactly <span class="kbd">---</span> (outside code fences).
            </div>
            <div>
              Navigate: <span class="kbd">←</span>/<span class="kbd">→</span> · Present: <span class="kbd">F</span> ·
              Theme: <span class="kbd">T</span>
            </div>
          </div>
        </section>

        <section class="panel preview-panel" aria-label="Slides preview">
          <div class="panel-head">
            <div class="panel-title"><span class="dot" aria-hidden="true"></span>Preview</div>
            <div class="panel-actions">
              <span class="pill" title="Current slide">
                <strong id="pillCurrent">1</strong>/<span id="pillTotal">1</span>
              </span>
              <button class="btn ghost" id="btnPrev" type="button" title="Previous slide (←)">
                <span class="icon" aria-hidden="true"
                  ><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M15 18l-6-6 6-6"></path></svg></span
                ><span>Prev</span>
              </button>
              <button class="btn ghost" id="btnNext" type="button" title="Next slide (→)">
                <span class="icon" aria-hidden="true"
                  ><svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M9 18l6-6-6-6"></path></svg></span
                ><span>Next</span>
              </button>
            </div>
          </div>
          <div class="preview-wrap" id="previewWrap">
            <div class="stage" id="stage">
              <div class="deck" id="deck" aria-live="polite"></div>
              <div class="overlay" aria-hidden="true">
                <div class="indicator" id="indicator">1 / 1</div>
                <div class="progress"><div id="progressBar"></div></div>
              </div>
            </div>
          </div>
          <div class="panel-foot">
            <div>Click slide to advance · Shift+click to go back</div>
            <div><span class="kbd">?</span> for help</div>
          </div>
        </section>
      </main>
    </div>

    <div class="modal" id="modal" hidden aria-modal="true" role="dialog">
      <div class="modal-card">
        <div class="modal-head">
          <div class="modal-title" id="modalTitle">Menu</div>
          <button class="btn" id="btnCloseModal" type="button" title="Close (Esc)">Close</button>
        </div>
        <div class="modal-body" id="modalBody"></div>
      </div>
    </div>

    <div class="toast" id="toast" role="status" aria-live="polite"></div>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.11/dist/purify.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/lib/common.min.js"></script>
    <script>
      (() => {
        "use strict";

        const STORAGE = {
          markdown: "md2slides.markdown.v1",
          draft: "md2slides.draft.v1",
          theme: "md2slides.theme.v1",
        };

        const $ = (sel) => document.querySelector(sel);
        const elApp = $("#app");
        const elEditor = $("#editor");
        const elDeck = $("#deck");
        const elStage = $("#stage");
        const elPreviewWrap = $("#previewWrap");
        const elIndicator = $("#indicator");
        const elProgressBar = $("#progressBar");
        const elPillCurrent = $("#pillCurrent");
        const elPillTotal = $("#pillTotal");
        const elPillSlides = $("#pillSlides");
        const elPillWords = $("#pillWords");
        const elStatsPill = $("#statsPill");
        const elToast = $("#toast");
        const elModal = $("#modal");
        const elModalTitle = $("#modalTitle");
        const elModalBody = $("#modalBody");

        const btnPrev = $("#btnPrev");
        const btnNext = $("#btnNext");
        const btnTheme = $("#btnTheme");
        const btnFullscreen = $("#btnFullscreen");
        const btnSamples = $("#btnSamples");
        const btnHelp = $("#btnHelp");
        const btnReset = $("#btnReset");
        const btnCloseModal = $("#btnCloseModal");

        const SAMPLE_DECKS = [
          {
            id: "qbr",
            title: "Quarterly Business Review",
            subtitle: "Executive-ready, metrics + plan",
            markdown: `# Q4 Business Review
**Acme Corp** · Growth & Operations

<div class="callout">
<div><strong>Objective</strong>: Align on performance, priorities, and next-quarter commitments.</div>
<div class="muted small">Tip: Use <code>---</code> to break slides. Press <code>F</code> to present.</div>
</div>

---

## Agenda
- Highlights & outcomes
- KPI snapshot
- Customer signals
- Roadmap & resourcing
- Decisions / next steps

---

## Highlights (Q4)
<div class="cols">
  <div class="metric">
    <div class="k">ARR growth</div>
    <div class="v">+18%</div>
    <div class="d">Driven by mid-market expansion</div>
    <div class="bar"><span style="--w: 72%"></span></div>
  </div>
  <div class="metric">
    <div class="k">Gross retention</div>
    <div class="v">96.4%</div>
    <div class="d">Best-in-class onboarding</div>
    <div class="bar"><span style="--w: 86%"></span></div>
  </div>
</div>

---

## KPI Snapshot

| Metric | Q3 | Q4 | Δ |
|---|---:|---:|---:|
| New pipeline | $12.1M | $14.7M | +21% |
| Win rate | 24% | 27% | +3pts |
| NPS | 46 | 52 | +6 |
| Time-to-value | 21d | 16d | -5d |

---

## Customer Signals
> “The new dashboard eliminated our weekly manual reporting.”
>
> — VP Operations, Top-10 account

**Themes**
- Faster workflows & fewer handoffs
- Greater trust through visibility
- Requests: granular permissions, bulk actions

---

## Roadmap (Next 90 days)
<div class="callout">
<div><strong>Bet #1</strong> — Self-serve analytics (enterprise-ready)</div>
<div><strong>Bet #2</strong> — Admin controls (roles & audit)</div>
<div><strong>Bet #3</strong> — Performance (p95 under 800ms)</div>
</div>

---

## Decision Needed
### Approve resourcing for Q1
- Add 1 backend engineer (data pipelines)
- Add 1 QA (automation)
- Maintain current GTM spend

<div class="callout">
<div><strong>Outcome</strong>: Ship key enterprise asks by week 7, reduce churn risk.</div>
</div>

---

## Appendix: Example Code Block
\`\`\`ts
type KPI = { name: string; q3: number; q4: number };
const delta = (k: KPI) => ((k.q4 - k.q3) / k.q3) * 100;
\`\`\`
`,
          },
          {
            id: "kickoff",
            title: "Project Kickoff",
            subtitle: "Clean template for teams",
            markdown: `# Project Kickoff
**Initiative**: Modernize the Customer Portal

<div class="callout">
<div><strong>North Star</strong>: Reduce customer effort while improving security and reliability.</div>
<div class="muted small">Keyboard: <code>←</code>/<code>→</code> to navigate, <code>T</code> theme, <code>F</code> full-screen.</div>
</div>

---

## Success Criteria
- +10pts NPS on portal interactions
- 40% fewer support tickets for login/access
- p95 page loads under 1.2s
- Clear ownership & delivery cadence

---

## Scope
<div class="cols">
  <div class="metric">
    <div class="k">In scope</div>
    <div class="d">Auth refresh, navigation, account management, billing UI, observability</div>
  </div>
  <div class="metric">
    <div class="k">Out of scope</div>
    <div class="d">Core billing logic, pricing changes, CRM migration</div>
  </div>
</div>

---

## Milestones
| Phase | Target | Deliverable |
|---|---|---|
| Discovery | Week 1–2 | flows, risks, architecture |
| Build | Week 3–6 | feature complete |
| Hardening | Week 7 | perf + security |
| Launch | Week 8 | rollout + monitoring |

---

## Roles & Rituals
- Product: requirements, prioritization
- Eng: architecture, delivery
- Design: IA, UX, accessibility
- Weekly demo + decision log

---

## Risks / Mitigations
- Legacy auth dependencies → staged migration + feature flags
- Performance regressions → perf budgets + dashboards
- Stakeholder churn → weekly visibility & clear decision points
`,
          },
        ];

        const DEFAULT_MARKDOWN = SAMPLE_DECKS[0].markdown;

        let slides = [];
        let current = 0;
        let lastRenderedMarkdown = "";
        let toastTimer = null;
        let renderTimer = null;

        function toast(message) {
          if (!message) return;
          elToast.textContent = message;
          elToast.classList.add("show");
          window.clearTimeout(toastTimer);
          toastTimer = window.setTimeout(() => elToast.classList.remove("show"), 1700);
        }

        function setTheme(theme) {
          const next = theme === "light" ? "light" : "dark";
          document.body.setAttribute("data-theme", next);
          localStorage.setItem(STORAGE.theme, next);
          toast(next === "light" ? "Theme: Light" : "Theme: Dark");
          updateCounts();
        }

        function toggleTheme() {
          const curr = document.body.getAttribute("data-theme") || "dark";
          setTheme(curr === "dark" ? "light" : "dark");
        }

        function normalizeNewlines(text) {
          return (text || "").replace(/\r\n/g, "\n");
        }

        function splitSlides(markdown) {
          const src = normalizeNewlines(markdown);
          const lines = src.split("\n");
          const out = [];
          let buf = [];
          let inFence = false;
          let fenceToken = null; // ``` or ~~~

          for (let i = 0; i < lines.length; i++) {
            const line = lines[i];
            const fenceMatch = line.match(/^\s*(```+|~~~+)\s*(\w+)?\s*$/);
            if (fenceMatch) {
              const token = fenceMatch[1].slice(0, 3);
              if (!inFence) {
                inFence = true;
                fenceToken = token;
              } else if (fenceToken === token) {
                inFence = false;
                fenceToken = null;
              }
              buf.push(line);
              continue;
            }

            if (!inFence && line.trim() === "---") {
              out.push(buf.join("\n").trim());
              buf = [];
              continue;
            }
            buf.push(line);
          }
          out.push(buf.join("\n").trim());
          return out.map((s) => s.trim()).filter((s, idx, arr) => s.length > 0 || arr.length === 1);
        }

        function wordCount(text) {
          const t = (text || "").trim();
          if (!t) return 0;
          return t
            .replace(/[`*_>#\-\[\]\(\)!|]/g, " ")
            .split(/\s+/)
            .filter(Boolean).length;
        }

        function clamp(n, a, b) {
          return Math.min(b, Math.max(a, n));
        }

        function updateScale() {
          const rect = elPreviewWrap.getBoundingClientRect();
          const pad = 26;
          const maxW = Math.max(240, rect.width - pad * 2);
          const maxH = Math.max(200, rect.height - pad * 2);
          const scale = Math.min(maxW / 1280, maxH / 720);
          elStage.style.transform = `scale(${scale.toFixed(4)})`;
        }

        function isPresenting() {
          return document.body.classList.contains("presenting");
        }

        function enterPresentMode() {
          document.body.classList.add("presenting");
          updateScale();
        }

        function exitPresentMode() {
          document.body.classList.remove("presenting");
          updateScale();
        }

        async function toggleFullscreen() {
          try {
            if (document.fullscreenElement) {
              await document.exitFullscreen();
              return;
            }
            await elApp.requestFullscreen({ navigationUI: "hide" });
          } catch (e) {
            toast("Full screen unavailable");
          }
        }

        function renderSlides(keepIndex = true) {
          const markdown = normalizeNewlines(elEditor.value);
          if (markdown === lastRenderedMarkdown && slides.length) return;
          lastRenderedMarkdown = markdown;
          localStorage.setItem(STORAGE.draft, markdown);

          slides = splitSlides(markdown);
          if (!keepIndex) current = 0;
          current = clamp(current, 0, Math.max(0, slides.length - 1));

          const frag = document.createDocumentFragment();
          for (let i = 0; i < slides.length; i++) {
            const slide = document.createElement("section");
            slide.className = "slide";
            slide.setAttribute("role", "group");
            slide.setAttribute("aria-roledescription", "slide");
            slide.setAttribute("aria-label", `Slide ${i + 1} of ${slides.length}`);
            slide.dataset.index = String(i);

            const chrome = document.createElement("div");
            chrome.className = "chrome";
            chrome.innerHTML = `
              <div class="brandmark"><span class="mark" aria-hidden="true"></span><span>Markdown → Slides</span></div>
              <div class="meta">${new Date().toLocaleDateString(undefined, { year: "numeric", month: "short" })}</div>
            `;

            const content = document.createElement("div");
            content.className = "content md";

            const raw = slides[i];
            const html = window.marked
              ? window.marked.parse(raw, { gfm: true, breaks: true, headerIds: false, mangle: false })
              : `<pre>${escapeHtml(raw)}</pre>`;
            content.innerHTML = window.DOMPurify ? window.DOMPurify.sanitize(html) : html;

            const footer = document.createElement("div");
            footer.className = "footer";
            footer.innerHTML = `
              <div class="fine">
                <span class="chip">Confidential</span>
                <span class="chip">v1.0</span>
              </div>
              <div class="fine"><span>${i + 1} / ${slides.length}</span></div>
            `;

            slide.appendChild(chrome);
            slide.appendChild(content);
            slide.appendChild(footer);

            frag.appendChild(slide);
          }

          elDeck.innerHTML = "";
          elDeck.appendChild(frag);

          // Highlight code blocks (optional)
          if (window.hljs) {
            elDeck.querySelectorAll("pre code").forEach((node) => {
              try {
                window.hljs.highlightElement(node);
              } catch {
                // ignore
              }
            });
          }

          applySlideState();
          updateCounts();
        }

        function escapeHtml(text) {
          return (text || "")
            .replaceAll("&", "&amp;")
            .replaceAll("<", "&lt;")
            .replaceAll(">", "&gt;")
            .replaceAll('"', "&quot;")
            .replaceAll("'", "&#039;");
        }

        function updateCounts() {
          elPillTotal.textContent = String(Math.max(1, slides.length));
          elPillCurrent.textContent = String(clamp(current + 1, 1, Math.max(1, slides.length)));
          elIndicator.textContent = `${clamp(current + 1, 1, Math.max(1, slides.length))} / ${Math.max(1, slides.length)}`;
          const pct = slides.length <= 1 ? 0 : (current / (slides.length - 1)) * 100;
          elProgressBar.style.width = `${pct.toFixed(2)}%`;

          elPillSlides.textContent = String(Math.max(1, slides.length));
          elPillWords.textContent = String(wordCount(elEditor.value));
          elStatsPill.title = `${Math.max(1, slides.length)} slides · ${wordCount(elEditor.value)} words`;
        }

        function applySlideState() {
          const nodes = Array.from(elDeck.querySelectorAll(".slide"));
          for (let i = 0; i < nodes.length; i++) {
            const n = nodes[i];
            n.classList.toggle("active", i === current);
            n.classList.toggle("before", i < current);
            n.classList.toggle("after", i > current);
            n.setAttribute("aria-hidden", i === current ? "false" : "true");
          }
          updateCounts();
        }

        function goTo(idx) {
          if (!slides.length) return;
          const next = clamp(idx, 0, slides.length - 1);
          if (next === current) return;
          current = next;
          applySlideState();
        }

        function next() {
          goTo(current + 1);
        }

        function prev() {
          goTo(current - 1);
        }

        function openModal({ title, body }) {
          elModalTitle.textContent = title;
          elModalBody.innerHTML = "";
          elModalBody.appendChild(body);
          elModal.hidden = false;
          btnCloseModal.focus();
        }

        function closeModal() {
          elModal.hidden = true;
        }

        function buildSamplesModal() {
          const wrap = document.createElement("div");
          wrap.style.display = "grid";
          wrap.style.gap = "14px";

          const grid = document.createElement("div");
          grid.className = "grid";

          for (const deck of SAMPLE_DECKS) {
            const card = document.createElement("div");
            card.className = "card";
            card.innerHTML = `
              <div class="row">
                <h4>${escapeHtml(deck.title)}</h4>
                <button class="btn primary" type="button">Load</button>
              </div>
              <p>${escapeHtml(deck.subtitle)}</p>
            `;
            const btn = card.querySelector("button");
            btn.addEventListener("click", () => {
              elEditor.value = deck.markdown;
              localStorage.setItem(STORAGE.markdown, deck.markdown);
              renderSlides(false);
              closeModal();
              toast(`Loaded: ${deck.title}`);
            });
            grid.appendChild(card);
          }

          const help = document.createElement("div");
          help.className = "help";
          help.innerHTML = `
            <div><strong>Tip</strong>: Your draft auto-saves locally. Use <span class="kbd">Restore</span> if you overwrite it.</div>
          `;

          wrap.appendChild(grid);
          wrap.appendChild(help);
          return wrap;
        }

        function buildHelpModal() {
          const wrap = document.createElement("div");
          wrap.style.display = "grid";
          wrap.style.gap = "14px";

          const card = document.createElement("div");
          card.className = "card";
          card.innerHTML = `
            <h4>Keyboard shortcuts</h4>
            <div class="help" style="border-top: none; padding-top: 0;">
              <ul>
                <li><span class="kbd">←</span>/<span class="kbd">→</span> previous/next slide</li>
                <li><span class="kbd">PageUp</span>/<span class="kbd">PageDown</span> previous/next slide</li>
                <li><span class="kbd">Home</span>/<span class="kbd">End</span> first/last slide</li>
                <li><span class="kbd">F</span> toggle full-screen presentation</li>
                <li><span class="kbd">T</span> toggle theme</li>
                <li><span class="kbd">Esc</span> close dialogs / exit full-screen</li>
              </ul>
            </div>
          `;

          const card2 = document.createElement("div");
          card2.className = "card";
          card2.innerHTML = `
            <h4>Formatting tips</h4>
            <div class="help" style="border-top: none; padding-top: 0;">
              <ul>
                <li>Use Markdown headings (<span class="kbd">#</span>, <span class="kbd">##</span>) for slide structure</li>
                <li>Slide breaks are a line that is exactly <span class="kbd">---</span> (outside code fences)</li>
                <li>Embed simple layout helpers: <span class="kbd">&lt;div class="cols"&gt;</span>, <span class="kbd">metric</span>, <span class="kbd">callout</span></li>
              </ul>
            </div>
          `;

          wrap.appendChild(card);
          wrap.appendChild(card2);
          return wrap;
        }

        function isTypingTarget(target) {
          if (!target) return false;
          const tag = (target.tagName || "").toUpperCase();
          return tag === "INPUT" || tag === "TEXTAREA" || target.isContentEditable;
        }

        function debounceRender() {
          window.clearTimeout(renderTimer);
          renderTimer = window.setTimeout(() => renderSlides(true), 120);
        }

        function restoreSavedDraft() {
          const draft = localStorage.getItem(STORAGE.draft);
          if (!draft) return toast("No saved draft found");
          elEditor.value = draft;
          renderSlides(true);
          toast("Restored last draft");
        }

        function initMarkdown() {
          const saved = localStorage.getItem(STORAGE.markdown);
          const draft = localStorage.getItem(STORAGE.draft);
          const initial = draft || saved || DEFAULT_MARKDOWN;
          elEditor.value = initial;
          lastRenderedMarkdown = "";
          renderSlides(false);
        }

        function initTheme() {
          const stored = localStorage.getItem(STORAGE.theme);
          if (stored === "light" || stored === "dark") {
            document.body.setAttribute("data-theme", stored);
          }
        }

        // Events
        btnPrev.addEventListener("click", prev);
        btnNext.addEventListener("click", next);
        btnTheme.addEventListener("click", toggleTheme);
        btnFullscreen.addEventListener("click", toggleFullscreen);
        btnSamples.addEventListener("click", () => openModal({ title: "Sample decks", body: buildSamplesModal() }));
        btnHelp.addEventListener("click", () => openModal({ title: "Help", body: buildHelpModal() }));
        btnReset.addEventListener("click", restoreSavedDraft);
        btnCloseModal.addEventListener("click", closeModal);

        elModal.addEventListener("click", (e) => {
          if (e.target === elModal) closeModal();
        });

        elEditor.addEventListener("input", () => {
          localStorage.setItem(STORAGE.markdown, elEditor.value);
          debounceRender();
        });

        elDeck.addEventListener("click", (e) => {
          const target = e.target;
          if (target && target.closest && target.closest("a")) return;
          if (e.shiftKey) return prev();
          return next();
        });

        // Lightweight swipe navigation (mobile / trackpads)
        let swipe = null;
        elDeck.addEventListener("pointerdown", (e) => {
          if (e.pointerType === "mouse" && e.button !== 0) return;
          swipe = { x: e.clientX, y: e.clientY, t: performance.now() };
        });
        elDeck.addEventListener("pointerup", (e) => {
          if (!swipe) return;
          const dt = performance.now() - swipe.t;
          const dx = e.clientX - swipe.x;
          const dy = e.clientY - swipe.y;
          swipe = null;
          if (dt > 750) return;
          if (Math.abs(dx) < 70) return;
          if (Math.abs(dx) < Math.abs(dy) * 1.2) return;
          if (dx < 0) next();
          else prev();
        });

        document.addEventListener("keydown", (e) => {
          if (!elModal.hidden) {
            if (e.key === "Escape") {
              e.preventDefault();
              closeModal();
            }
            return;
          }

          const key = e.key;
          const typing = isTypingTarget(e.target);

          if (key === "?" || (key === "/" && e.shiftKey)) {
            e.preventDefault();
            openModal({ title: "Help", body: buildHelpModal() });
            return;
          }

          if (key === "t" || key === "T") {
            e.preventDefault();
            toggleTheme();
            return;
          }

          if (key === "f" || key === "F") {
            e.preventDefault();
            toggleFullscreen();
            return;
          }

          // Don't steal arrow keys while editing unless presenting
          if (typing && !isPresenting() && !e.altKey && !e.metaKey && !e.ctrlKey) return;

          if (key === "ArrowRight" || key === "PageDown" || key === " " || key === "Enter") {
            e.preventDefault();
            next();
            return;
          }

          if (key === "ArrowLeft" || key === "PageUp" || key === "Backspace") {
            e.preventDefault();
            prev();
            return;
          }

          if (key === "Home") {
            e.preventDefault();
            goTo(0);
            return;
          }

          if (key === "End") {
            e.preventDefault();
            goTo(slides.length - 1);
            return;
          }

          if (key === "Escape") {
            if (document.fullscreenElement) {
              e.preventDefault();
              document.exitFullscreen().catch(() => {});
              return;
            }
          }
        });

        document.addEventListener("fullscreenchange", () => {
          if (document.fullscreenElement) {
            enterPresentMode();
            toast("Presentation mode");
          } else {
            exitPresentMode();
            toast("Exited presentation");
          }
        });

        window.addEventListener("resize", () => updateScale());

        // Init
        if (window.marked) {
          window.marked.setOptions({
            gfm: true,
            breaks: true,
            headerIds: false,
            mangle: false,
          });
        }
        initTheme();
        initMarkdown();
        updateScale();
      })();
    </script>
  </body>
</html>
