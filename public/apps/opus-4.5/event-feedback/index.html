<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Feedback Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ec 100%);
            min-height: 100vh;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
        }

        .ai-summary-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
            overflow: hidden;
        }

        .ai-summary-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 60%);
            pointer-events: none;
        }

        .search-input {
            transition: all 0.3s ease;
            border: 2px solid #e2e8f0;
        }

        .search-input:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);
            outline: none;
        }

        .table-header {
            background: linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%);
            cursor: pointer;
            user-select: none;
            transition: background 0.2s ease;
        }

        .table-header:hover {
            background: linear-gradient(180deg, #e2e8f0 0%, #cbd5e1 100%);
        }

        .table-row {
            transition: all 0.2s ease;
        }

        .table-row:hover {
            background-color: #f8fafc;
            transform: scale(1.002);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        }

        .rating-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            border-radius: 9999px;
            font-weight: 600;
            font-size: 0.8rem;
        }

        .rating-5 { background: #dcfce7; color: #166534; }
        .rating-4 { background: #d1fae5; color: #065f46; }
        .rating-3 { background: #fef3c7; color: #92400e; }
        .rating-2 { background: #fed7aa; color: #9a3412; }
        .rating-1 { background: #fecaca; color: #991b1b; }

        .sort-icon {
            transition: transform 0.2s ease;
        }

        .feedback-cell {
            max-width: 400px;
            line-height: 1.5;
        }

        .close-btn {
            transition: all 0.2s ease;
        }

        .close-btn:hover {
            transform: rotate(90deg);
            background: rgba(255, 255, 255, 0.2);
        }

        .pulse-dot {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .stats-card {
            background: white;
            border-radius: 12px;
            padding: 16px 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            border: 1px solid #e2e8f0;
        }

        .fade-in {
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .star-icon {
            color: #fbbf24;
        }

        .scrollbar-thin::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .scrollbar-thin::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }

        .scrollbar-thin::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        .scrollbar-thin::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
    </style>
</head>
<body class="p-6 lg:p-8">
    <div id="app" class="max-w-7xl mx-auto">
        <!-- Header -->
        <header class="mb-8">
            <div class="flex items-center gap-3 mb-2">
                <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center">
                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/>
                    </svg>
                </div>
                <div>
                    <h1 class="text-2xl lg:text-3xl font-bold text-gray-800">Event Feedback Dashboard</h1>
                    <p class="text-gray-500 text-sm">Comprehensive insights from participant feedback</p>
                </div>
            </div>
        </header>

        <!-- AI Summary Section -->
        <div id="aiSummary" class="ai-summary-card rounded-2xl p-6 mb-6 text-white fade-in">
            <div class="flex justify-between items-start">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-8 h-8 rounded-lg bg-white/20 flex items-center justify-center">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                        </svg>
                    </div>
                    <div>
                        <h2 class="font-semibold text-lg flex items-center gap-2">
                            AI-Powered Summary
                            <span class="pulse-dot w-2 h-2 bg-green-400 rounded-full"></span>
                        </h2>
                        <p class="text-white/70 text-sm">Automated analysis of feedback trends</p>
                    </div>
                </div>
                <button onclick="closeAiSummary()" class="close-btn p-2 rounded-lg hover:bg-white/10">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="bg-white/10 rounded-xl p-4 backdrop-blur-sm">
                <p class="leading-relaxed">
                    <strong>Key Insights:</strong> Overall sentiment is highly positive with an average rating of <span id="avgRating" class="font-bold">4.2</span>/5.
                    The <span id="topEvent" class="font-semibold">"Annual Tech Summit 2024"</span> received the highest engagement.
                    Participants particularly appreciated the networking opportunities and speaker quality.
                    Areas for improvement include session timing and venue accessibility.
                    <span id="totalFeedback" class="font-semibold">30</span> feedback submissions analyzed across <span id="uniqueEvents" class="font-semibold">8</span> events.
                </p>
            </div>
            <div class="flex gap-4 mt-4">
                <div class="bg-white/10 rounded-lg px-4 py-2">
                    <span class="text-white/70 text-xs uppercase tracking-wide">Positive</span>
                    <p class="text-xl font-bold" id="positiveCount">24</p>
                </div>
                <div class="bg-white/10 rounded-lg px-4 py-2">
                    <span class="text-white/70 text-xs uppercase tracking-wide">Neutral</span>
                    <p class="text-xl font-bold" id="neutralCount">4</p>
                </div>
                <div class="bg-white/10 rounded-lg px-4 py-2">
                    <span class="text-white/70 text-xs uppercase tracking-wide">Needs Attention</span>
                    <p class="text-xl font-bold" id="negativeCount">2</p>
                </div>
            </div>
        </div>

        <!-- Search and Stats Bar -->
        <div class="glass-card rounded-2xl p-4 mb-6">
            <div class="flex flex-col lg:flex-row gap-4 items-center justify-between">
                <div class="relative w-full lg:w-96">
                    <svg class="absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                    </svg>
                    <input
                        type="text"
                        id="searchInput"
                        placeholder="Search by event, participant, or feedback..."
                        class="search-input w-full pl-12 pr-4 py-3 rounded-xl bg-white text-gray-700 placeholder-gray-400"
                        oninput="handleSearch(this.value)"
                    >
                </div>
                <div class="flex gap-3 text-sm">
                    <div class="stats-card flex items-center gap-2">
                        <svg class="w-4 h-4 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                        </svg>
                        <span class="text-gray-500">Showing</span>
                        <span id="visibleCount" class="font-semibold text-gray-800">30</span>
                        <span class="text-gray-500">entries</span>
                    </div>
                    <div class="stats-card flex items-center gap-2">
                        <svg class="w-4 h-4 text-amber-500" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                        </svg>
                        <span class="text-gray-500">Avg Rating</span>
                        <span id="displayAvgRating" class="font-semibold text-gray-800">4.2</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Table -->
        <div class="glass-card rounded-2xl overflow-hidden">
            <div class="overflow-x-auto scrollbar-thin">
                <table class="w-full">
                    <thead>
                        <tr class="border-b border-gray-200">
                            <th class="table-header px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider" onclick="sortTable('date')">
                                <div class="flex items-center gap-2">
                                    Date
                                    <span id="sort-date" class="sort-icon text-gray-400">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"/>
                                        </svg>
                                    </span>
                                </div>
                            </th>
                            <th class="table-header px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider" onclick="sortTable('event')">
                                <div class="flex items-center gap-2">
                                    Event Name
                                    <span id="sort-event" class="sort-icon text-gray-400">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"/>
                                        </svg>
                                    </span>
                                </div>
                            </th>
                            <th class="table-header px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider" onclick="sortTable('participant')">
                                <div class="flex items-center gap-2">
                                    Participant
                                    <span id="sort-participant" class="sort-icon text-gray-400">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"/>
                                        </svg>
                                    </span>
                                </div>
                            </th>
                            <th class="table-header px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider" onclick="sortTable('rating')">
                                <div class="flex items-center gap-2">
                                    Rating
                                    <span id="sort-rating" class="sort-icon text-gray-400">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"/>
                                        </svg>
                                    </span>
                                </div>
                            </th>
                            <th class="table-header px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider" onclick="sortTable('feedback')">
                                <div class="flex items-center gap-2">
                                    Feedback
                                    <span id="sort-feedback" class="sort-icon text-gray-400">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"/>
                                        </svg>
                                    </span>
                                </div>
                            </th>
                        </tr>
                    </thead>
                    <tbody id="tableBody" class="divide-y divide-gray-100">
                        <!-- Data will be inserted here -->
                    </tbody>
                </table>
            </div>

            <!-- Empty State -->
            <div id="emptyState" class="hidden py-16 text-center">
                <svg class="w-16 h-16 mx-auto text-gray-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                <h3 class="text-lg font-medium text-gray-600 mb-1">No results found</h3>
                <p class="text-gray-400">Try adjusting your search terms</p>
            </div>
        </div>

        <!-- Footer -->
        <footer class="mt-6 text-center text-gray-400 text-sm">
            <p>Event Feedback Dashboard â€¢ Last updated: <span id="lastUpdated"></span></p>
        </footer>
    </div>

    <script>
        // Sample data generation
        const eventNames = [
            "Annual Tech Summit 2024",
            "Product Innovation Workshop",
            "Leadership Excellence Conference",
            "Digital Marketing Masterclass",
            "Agile Transformation Summit",
            "Customer Success Symposium",
            "Data Analytics Forum",
            "Startup Pitch Night"
        ];

        const firstNames = [
            "James", "Emma", "Michael", "Sophia", "William", "Olivia", "Alexander", "Isabella",
            "Benjamin", "Mia", "Daniel", "Charlotte", "Henry", "Amelia", "Sebastian", "Harper",
            "Christopher", "Evelyn", "Andrew", "Abigail", "Joseph", "Emily", "David", "Elizabeth",
            "Matthew", "Sofia", "Lucas", "Avery", "Jackson", "Ella"
        ];

        const lastNames = [
            "Anderson", "Martinez", "Thompson", "Garcia", "Robinson", "Clark", "Rodriguez", "Lewis",
            "Lee", "Walker", "Hall", "Allen", "Young", "King", "Wright", "Scott", "Torres", "Nguyen",
            "Hill", "Flores", "Green", "Adams", "Nelson", "Baker", "Gonzalez", "Carter", "Mitchell",
            "Perez", "Roberts", "Turner"
        ];

        const feedbackTemplates = [
            "The event exceeded my expectations in every way. The speakers were incredibly knowledgeable and engaging, and the networking opportunities were fantastic. I particularly enjoyed the breakout sessions on emerging technologies and their practical applications in our industry.",
            "Overall a solid event with great content. The venue was excellent and well-organized. However, I felt some sessions ran a bit long and could have been more interactive. The catering was top-notch and the Q&A portions were especially valuable.",
            "Excellent organization and valuable insights from industry leaders. The hands-on workshops were particularly useful for applying concepts immediately. Would definitely recommend to colleagues and look forward to attending future events.",
            "Good event but room for improvement. The morning sessions were excellent, but afternoon energy dropped. Suggest adding more interactive elements and shorter break times. The keynote speaker was absolutely phenomenal though.",
            "This was one of the best professional development events I've attended. The diversity of topics covered was impressive, and I walked away with actionable strategies I can implement right away. The mobile app for scheduling was very helpful.",
            "Informative sessions with practical takeaways. The panel discussions brought diverse perspectives that sparked great conversations. Only suggestion would be to provide more detailed materials for post-event reference.",
            "The networking aspect of this event was invaluable. I made several meaningful connections that have already led to collaborative opportunities. The format encouraged interaction which I really appreciated.",
            "Well-structured event with clear learning objectives. Each session built upon the previous one effectively. The facilitators were professional and responsive to participant questions and needs throughout.",
            "Fantastic experience overall. The blend of theory and practical application was perfect. I especially appreciated the case studies from real companies facing similar challenges. Will definitely attend next year.",
            "The event provided tremendous value for the investment. Content was current and relevant to today's business challenges. Speakers were accessible during breaks for follow-up questions which added personal touch.",
            "Impressed by the caliber of speakers and depth of content. The event was well-paced with adequate breaks. Venue acoustics were excellent and seating was comfortable for the full-day program.",
            "Great event for both beginners and experienced professionals. The tiered session tracks allowed me to choose content appropriate to my level. Appreciated the inclusion of emerging trends alongside foundational topics.",
            "The workshop components were exceptionally well-designed. Getting hands-on experience with new tools and methodologies was incredibly valuable. Facilitators were patient and thorough in their explanations.",
            "Thoroughly enjoyed the collaborative atmosphere of this event. The mix of presentations and group activities kept energy levels high. Would love to see even more peer-to-peer learning opportunities.",
            "Strong content delivery with memorable presentations. The use of multimedia and live demonstrations enhanced understanding significantly. Post-event resources and recording access are much appreciated.",
        ];

        const negativeTemplates = [
            "The event had potential but fell short in execution. Technical difficulties interrupted several presentations, and the venue was uncomfortably crowded. Hope these issues are addressed for future events.",
            "Disappointed with the content depth. Many sessions covered basics rather than advanced topics as advertised. The networking lunch was too short to have meaningful conversations with other attendees."
        ];

        function generateRandomDate() {
            const start = new Date(2024, 0, 1);
            const end = new Date(2024, 11, 31);
            const date = new Date(start.getTime() + Math.random() * (end.getTime() - start.getTime()));
            return date;
        }

        function formatDate(date) {
            const options = { year: 'numeric', month: 'short', day: 'numeric' };
            return date.toLocaleDateString('en-US', options);
        }

        function generateData() {
            const data = [];
            for (let i = 0; i < 30; i++) {
                const rating = Math.random() < 0.8 ? Math.floor(Math.random() * 2) + 4 : Math.floor(Math.random() * 3) + 1;
                const feedbackPool = rating >= 4 ? feedbackTemplates : negativeTemplates;

                data.push({
                    id: i + 1,
                    date: generateRandomDate(),
                    event: eventNames[Math.floor(Math.random() * eventNames.length)],
                    participant: `${firstNames[Math.floor(Math.random() * firstNames.length)]} ${lastNames[Math.floor(Math.random() * lastNames.length)]}`,
                    rating: rating,
                    feedback: feedbackPool[Math.floor(Math.random() * feedbackPool.length)]
                });
            }
            return data.sort((a, b) => b.date - a.date);
        }

        let feedbackData = generateData();
        let filteredData = [...feedbackData];
        let currentSort = { column: 'date', direction: 'desc' };

        function renderStars(rating) {
            let stars = '';
            for (let i = 1; i <= 5; i++) {
                if (i <= rating) {
                    stars += '<svg class="w-4 h-4 star-icon inline" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>';
                } else {
                    stars += '<svg class="w-4 h-4 text-gray-300 inline" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>';
                }
            }
            return stars;
        }

        function renderTable() {
            const tbody = document.getElementById('tableBody');
            const emptyState = document.getElementById('emptyState');

            if (filteredData.length === 0) {
                tbody.innerHTML = '';
                emptyState.classList.remove('hidden');
                return;
            }

            emptyState.classList.add('hidden');

            tbody.innerHTML = filteredData.map(row => `
                <tr class="table-row bg-white">
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900">${formatDate(row.date)}</div>
                        <div class="text-xs text-gray-400">${row.date.toLocaleDateString('en-US', { weekday: 'short' })}</div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="flex items-center">
                            <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-indigo-100 to-purple-100 flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                                </svg>
                            </div>
                            <span class="text-sm font-medium text-gray-800">${row.event}</span>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="w-8 h-8 rounded-full bg-gradient-to-br from-emerald-400 to-teal-500 flex items-center justify-center text-white text-xs font-bold mr-3">
                                ${row.participant.split(' ').map(n => n[0]).join('')}
                            </div>
                            <span class="text-sm text-gray-700">${row.participant}</span>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex flex-col gap-1">
                            <span class="rating-badge rating-${row.rating}">
                                ${row.rating}.0
                            </span>
                            <div class="flex gap-0.5">
                                ${renderStars(row.rating)}
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4">
                        <p class="text-sm text-gray-600 feedback-cell leading-relaxed">${row.feedback}</p>
                    </td>
                </tr>
            `).join('');

            document.getElementById('visibleCount').textContent = filteredData.length;

            // Calculate and display average rating
            const avgRating = (filteredData.reduce((sum, row) => sum + row.rating, 0) / filteredData.length).toFixed(1);
            document.getElementById('displayAvgRating').textContent = avgRating;
        }

        function handleSearch(query) {
            const searchTerm = query.toLowerCase().trim();

            if (!searchTerm) {
                filteredData = [...feedbackData];
            } else {
                filteredData = feedbackData.filter(row =>
                    row.event.toLowerCase().includes(searchTerm) ||
                    row.participant.toLowerCase().includes(searchTerm) ||
                    row.feedback.toLowerCase().includes(searchTerm) ||
                    formatDate(row.date).toLowerCase().includes(searchTerm)
                );
            }

            applySorting();
            renderTable();
        }

        function sortTable(column) {
            if (currentSort.column === column) {
                currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
            } else {
                currentSort.column = column;
                currentSort.direction = 'asc';
            }

            applySorting();
            updateSortIcons();
            renderTable();
        }

        function applySorting() {
            const { column, direction } = currentSort;

            filteredData.sort((a, b) => {
                let valueA, valueB;

                switch (column) {
                    case 'date':
                        valueA = a.date.getTime();
                        valueB = b.date.getTime();
                        break;
                    case 'event':
                        valueA = a.event.toLowerCase();
                        valueB = b.event.toLowerCase();
                        break;
                    case 'participant':
                        valueA = a.participant.toLowerCase();
                        valueB = b.participant.toLowerCase();
                        break;
                    case 'rating':
                        valueA = a.rating;
                        valueB = b.rating;
                        break;
                    case 'feedback':
                        valueA = a.feedback.toLowerCase();
                        valueB = b.feedback.toLowerCase();
                        break;
                    default:
                        return 0;
                }

                if (valueA < valueB) return direction === 'asc' ? -1 : 1;
                if (valueA > valueB) return direction === 'asc' ? 1 : -1;
                return 0;
            });
        }

        function updateSortIcons() {
            const columns = ['date', 'event', 'participant', 'rating', 'feedback'];

            columns.forEach(col => {
                const icon = document.getElementById(`sort-${col}`);
                if (col === currentSort.column) {
                    if (currentSort.direction === 'asc') {
                        icon.innerHTML = `
                            <svg class="w-4 h-4 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"/>
                            </svg>
                        `;
                    } else {
                        icon.innerHTML = `
                            <svg class="w-4 h-4 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                            </svg>
                        `;
                    }
                } else {
                    icon.innerHTML = `
                        <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"/>
                        </svg>
                    `;
                }
            });
        }

        function closeAiSummary() {
            const summary = document.getElementById('aiSummary');
            summary.style.transition = 'all 0.3s ease-out';
            summary.style.opacity = '0';
            summary.style.transform = 'translateY(-20px)';
            setTimeout(() => {
                summary.style.display = 'none';
            }, 300);
        }

        function updateSummaryStats() {
            const avgRating = (feedbackData.reduce((sum, row) => sum + row.rating, 0) / feedbackData.length).toFixed(1);
            const uniqueEvents = [...new Set(feedbackData.map(row => row.event))].length;
            const positiveCount = feedbackData.filter(row => row.rating >= 4).length;
            const neutralCount = feedbackData.filter(row => row.rating === 3).length;
            const negativeCount = feedbackData.filter(row => row.rating <= 2).length;

            // Find top event
            const eventCounts = {};
            feedbackData.forEach(row => {
                eventCounts[row.event] = (eventCounts[row.event] || 0) + 1;
            });
            const topEvent = Object.keys(eventCounts).reduce((a, b) => eventCounts[a] > eventCounts[b] ? a : b);

            document.getElementById('avgRating').textContent = avgRating;
            document.getElementById('displayAvgRating').textContent = avgRating;
            document.getElementById('totalFeedback').textContent = feedbackData.length;
            document.getElementById('uniqueEvents').textContent = uniqueEvents;
            document.getElementById('topEvent').textContent = `"${topEvent}"`;
            document.getElementById('positiveCount').textContent = positiveCount;
            document.getElementById('neutralCount').textContent = neutralCount;
            document.getElementById('negativeCount').textContent = negativeCount;
        }

        function init() {
            renderTable();
            updateSummaryStats();
            updateSortIcons();

            // Set last updated time
            document.getElementById('lastUpdated').textContent = new Date().toLocaleString('en-US', {
                month: 'short',
                day: 'numeric',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // Initialize the dashboard
        init();
    </script>
</body>
</html>
