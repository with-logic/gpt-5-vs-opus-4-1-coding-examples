<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÑ Magical Holiday Card for Kids! üéÖ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', 'Chalkboard', cursive;
            overflow: hidden;
            background: linear-gradient(180deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            user-select: none;
        }

        /* Snowfall */
        .snowflake {
            position: fixed;
            top: -10px;
            color: white;
            font-size: 1em;
            text-shadow: 0 0 5px rgba(255,255,255,0.8);
            animation: fall linear infinite;
            pointer-events: none;
            z-index: 1000;
        }

        @keyframes fall {
            0% {
                transform: translateY(-10px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0.3;
            }
        }

        /* Main Card */
        .card-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .holiday-card {
            position: relative;
            width: 900px;
            height: 600px;
            background: linear-gradient(180deg, #87CEEB 0%, #E0F6FF 40%, #FFFFFF 100%);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4), inset 0 0 100px rgba(255,255,255,0.3);
            overflow: hidden;
            border: 8px solid #c41e3a;
        }

        /* Ground/Snow */
        .ground {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 150px;
            background: linear-gradient(180deg, #f0f8ff 0%, #ffffff 100%);
            border-radius: 50% 50% 0 0 / 30px 30px 0 0;
        }

        .ground::before {
            content: '';
            position: absolute;
            top: -20px;
            width: 100%;
            height: 40px;
            background: radial-gradient(ellipse at 50% 100%, rgba(200,230,255,0.8) 0%, transparent 70%);
        }

        /* Christmas Tree */
        .tree {
            position: absolute;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            cursor: pointer;
            transition: transform 0.3s;
        }

        .tree:hover {
            transform: translateX(-50%) scale(1.05);
        }

        .tree-trunk {
            width: 40px;
            height: 60px;
            background: linear-gradient(90deg, #5D4037 0%, #8B4513 50%, #5D4037 100%);
            margin: 0 auto;
            border-radius: 5px;
        }

        .tree-layer {
            width: 0;
            height: 0;
            margin: 0 auto;
            position: relative;
        }

        .tree-layer-1 {
            border-left: 60px solid transparent;
            border-right: 60px solid transparent;
            border-bottom: 80px solid #228B22;
        }

        .tree-layer-2 {
            border-left: 80px solid transparent;
            border-right: 80px solid transparent;
            border-bottom: 100px solid #2E8B2E;
            margin-top: -30px;
        }

        .tree-layer-3 {
            border-left: 100px solid transparent;
            border-right: 100px solid transparent;
            border-bottom: 120px solid #346B34;
            margin-top: -40px;
        }

        .tree-star {
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 50px;
            animation: twinkle 1s ease-in-out infinite alternate;
            cursor: pointer;
        }

        @keyframes twinkle {
            0% { transform: translateX(-50%) scale(1) rotate(0deg); text-shadow: 0 0 20px gold; }
            100% { transform: translateX(-50%) scale(1.2) rotate(10deg); text-shadow: 0 0 40px gold, 0 0 60px orange; }
        }

        /* Tree Ornaments */
        .ornament {
            position: absolute;
            font-size: 24px;
            cursor: pointer;
            transition: transform 0.2s;
            animation: swing 2s ease-in-out infinite;
        }

        .ornament:hover {
            transform: scale(1.3);
        }

        @keyframes swing {
            0%, 100% { transform: rotate(-5deg); }
            50% { transform: rotate(5deg); }
        }

        /* Title */
        .title {
            position: absolute;
            top: 20px;
            width: 100%;
            text-align: center;
            font-size: 42px;
            color: #c41e3a;
            text-shadow: 3px 3px 0 #fff, -1px -1px 0 #fff, 1px -1px 0 #fff, -1px 1px 0 #fff;
            animation: bounce 2s ease-in-out infinite;
            z-index: 10;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* Draggable Items Palette */
        .palette {
            position: fixed;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 100;
            border: 4px solid #c41e3a;
        }

        .palette-title {
            text-align: center;
            color: #c41e3a;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .palette-item {
            font-size: 36px;
            cursor: grab;
            padding: 8px;
            border-radius: 10px;
            transition: all 0.2s;
            text-align: center;
            background: linear-gradient(135deg, #fff5f5 0%, #ffe0e0 100%);
        }

        .palette-item:hover {
            transform: scale(1.2);
            background: linear-gradient(135deg, #fff 0%, #ffd0d0 100%);
            box-shadow: 0 5px 15px rgba(196,30,58,0.3);
        }

        .palette-item:active {
            cursor: grabbing;
        }

        /* Placed Items */
        .placed-item {
            position: absolute;
            font-size: 40px;
            cursor: move;
            transition: transform 0.1s;
            z-index: 50;
            filter: drop-shadow(2px 2px 3px rgba(0,0,0,0.3));
        }

        .placed-item:hover {
            transform: scale(1.2);
            z-index: 60;
        }

        .placed-item.dragging {
            opacity: 0.8;
            transform: scale(1.3);
            z-index: 100;
        }

        /* Santa */
        .santa {
            position: absolute;
            bottom: 120px;
            right: 80px;
            font-size: 80px;
            animation: santaWave 1s ease-in-out infinite;
            cursor: pointer;
            filter: drop-shadow(3px 3px 5px rgba(0,0,0,0.3));
        }

        @keyframes santaWave {
            0%, 100% { transform: rotate(-5deg); }
            50% { transform: rotate(5deg); }
        }

        .santa:hover {
            animation: santaJump 0.5s ease-in-out;
        }

        @keyframes santaJump {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-30px); }
        }

        /* Snowman */
        .snowman {
            position: absolute;
            bottom: 110px;
            left: 80px;
            font-size: 70px;
            cursor: pointer;
            animation: wobble 3s ease-in-out infinite;
            filter: drop-shadow(3px 3px 5px rgba(0,0,0,0.3));
        }

        @keyframes wobble {
            0%, 100% { transform: rotate(-3deg); }
            50% { transform: rotate(3deg); }
        }

        /* Reindeer */
        .reindeer {
            position: absolute;
            top: 100px;
            right: 150px;
            font-size: 50px;
            animation: fly 4s ease-in-out infinite;
            cursor: pointer;
        }

        @keyframes fly {
            0%, 100% { transform: translateY(0) translateX(0); }
            25% { transform: translateY(-20px) translateX(10px); }
            50% { transform: translateY(0) translateX(20px); }
            75% { transform: translateY(-15px) translateX(10px); }
        }

        /* Sleigh */
        .sleigh {
            position: absolute;
            top: 80px;
            left: 100px;
            font-size: 45px;
            animation: sleighRide 6s ease-in-out infinite;
            cursor: pointer;
        }

        @keyframes sleighRide {
            0%, 100% { transform: translateX(0) translateY(0); }
            50% { transform: translateX(50px) translateY(-10px); }
        }

        /* Moon */
        .moon {
            position: absolute;
            top: 30px;
            right: 50px;
            font-size: 60px;
            animation: glow 3s ease-in-out infinite;
            cursor: pointer;
        }

        @keyframes glow {
            0%, 100% { filter: drop-shadow(0 0 20px #fffacd); }
            50% { filter: drop-shadow(0 0 40px #fff8dc) drop-shadow(0 0 60px #ffefd5); }
        }

        /* Houses */
        .house {
            position: absolute;
            bottom: 100px;
            font-size: 55px;
            cursor: pointer;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3));
        }

        .house:hover {
            animation: houseLight 0.3s ease-in-out;
        }

        @keyframes houseLight {
            0%, 100% { filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3)); }
            50% { filter: drop-shadow(0 0 20px #ffff00) drop-shadow(2px 2px 4px rgba(0,0,0,0.3)); }
        }

        /* Gift boxes */
        .gift {
            position: absolute;
            font-size: 45px;
            cursor: pointer;
            animation: giftShake 2s ease-in-out infinite;
        }

        @keyframes giftShake {
            0%, 100% { transform: rotate(0deg); }
            10% { transform: rotate(-5deg); }
            20% { transform: rotate(5deg); }
            30% { transform: rotate(0deg); }
        }

        /* Message */
        .message {
            position: absolute;
            bottom: 20px;
            width: 100%;
            text-align: center;
            font-size: 28px;
            color: #2E8B2E;
            text-shadow: 2px 2px 0 #fff;
            animation: colorChange 3s ease-in-out infinite;
        }

        @keyframes colorChange {
            0%, 100% { color: #c41e3a; }
            33% { color: #228B22; }
            66% { color: #FFD700; }
        }

        /* Sparkles */
        .sparkle {
            position: absolute;
            pointer-events: none;
            font-size: 20px;
            animation: sparkleAnim 1s ease-out forwards;
            z-index: 200;
        }

        @keyframes sparkleAnim {
            0% { transform: scale(0) rotate(0deg); opacity: 1; }
            50% { transform: scale(1.5) rotate(180deg); opacity: 1; }
            100% { transform: scale(0) rotate(360deg); opacity: 0; }
        }

        /* Sound Toggle */
        .sound-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.95);
            border: 3px solid #c41e3a;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 30px;
            cursor: pointer;
            z-index: 200;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sound-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 20px rgba(196,30,58,0.4);
        }

        /* Candy Cane border animation */
        .card-container::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            background: repeating-linear-gradient(
                45deg,
                #c41e3a,
                #c41e3a 10px,
                #fff 10px,
                #fff 20px
            );
            z-index: -1;
            border-radius: 30px;
            animation: candyRotate 20s linear infinite;
        }

        /* Lights string */
        .lights {
            position: absolute;
            top: 80px;
            left: 0;
            width: 100%;
            height: 30px;
            display: flex;
            justify-content: space-around;
            z-index: 5;
        }

        .light-bulb {
            width: 15px;
            height: 20px;
            border-radius: 50% 50% 50% 50%;
            animation: lightBlink 1s ease-in-out infinite;
            cursor: pointer;
        }

        .light-bulb:nth-child(odd) { animation-delay: 0s; }
        .light-bulb:nth-child(even) { animation-delay: 0.5s; }

        @keyframes lightBlink {
            0%, 100% { opacity: 1; filter: brightness(1.5) drop-shadow(0 0 10px currentColor); }
            50% { opacity: 0.5; filter: brightness(0.8); }
        }

        /* Instructions */
        .instructions {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.95);
            padding: 10px 25px;
            border-radius: 30px;
            font-size: 16px;
            color: #333;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            border: 3px solid #228B22;
            z-index: 100;
        }

        /* Confetti burst */
        .confetti {
            position: fixed;
            pointer-events: none;
            z-index: 300;
        }

        /* Stars twinkling in sky */
        .sky-star {
            position: absolute;
            color: white;
            animation: twinkleStar 2s ease-in-out infinite;
        }

        @keyframes twinkleStar {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.3); }
        }

        /* Aurora effect */
        .aurora {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 200px;
            background: linear-gradient(
                180deg,
                rgba(100, 200, 100, 0.1) 0%,
                rgba(100, 150, 200, 0.1) 30%,
                rgba(200, 100, 200, 0.05) 60%,
                transparent 100%
            );
            animation: auroraMove 8s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes auroraMove {
            0%, 100% { opacity: 0.5; transform: translateX(-20px); }
            50% { opacity: 0.8; transform: translateX(20px); }
        }

        /* Smoke from chimney */
        .smoke {
            position: absolute;
            width: 20px;
            height: 20px;
            background: rgba(200,200,200,0.6);
            border-radius: 50%;
            animation: smokeRise 3s ease-out infinite;
        }

        @keyframes smokeRise {
            0% { transform: translateY(0) scale(1); opacity: 0.6; }
            100% { transform: translateY(-80px) scale(2); opacity: 0; }
        }

        /* Penguin */
        .penguin {
            position: absolute;
            bottom: 115px;
            font-size: 50px;
            cursor: pointer;
            animation: penguinWaddle 1s ease-in-out infinite;
        }

        @keyframes penguinWaddle {
            0%, 100% { transform: rotate(-5deg) translateX(0); }
            50% { transform: rotate(5deg) translateX(5px); }
        }
    </style>
</head>
<body>
    <button class="sound-toggle" id="soundToggle" title="Toggle Sound">üîä</button>

    <div class="card-container">
        <div class="holiday-card" id="card">
            <!-- Aurora effect -->
            <div class="aurora"></div>

            <!-- Sky stars -->
            <div id="skyStars"></div>

            <!-- Christmas Lights -->
            <div class="lights" id="lights"></div>

            <!-- Title -->
            <h1 class="title">üéÑ Happy Holidays! üéÖ</h1>

            <!-- Moon -->
            <div class="moon" onclick="playSound('twinkle'); createSparkles(event)">üåô</div>

            <!-- Sleigh -->
            <div class="sleigh" onclick="playSound('bells'); createSparkles(event)">üõ∑</div>

            <!-- Reindeer -->
            <div class="reindeer" onclick="playSound('bells'); createSparkles(event)">ü¶å</div>

            <!-- Christmas Tree -->
            <div class="tree" onclick="playSound('chime'); createSparkles(event)">
                <div class="tree-star" onclick="playSound('magic'); event.stopPropagation();">‚≠ê</div>
                <div class="tree-layer tree-layer-1"></div>
                <div class="tree-layer tree-layer-2"></div>
                <div class="tree-layer tree-layer-3"></div>
                <div class="tree-trunk"></div>
                <!-- Tree ornaments -->
                <span class="ornament" style="top: 60px; left: -30px;">üî¥</span>
                <span class="ornament" style="top: 80px; left: 20px;">üîµ</span>
                <span class="ornament" style="top: 120px; left: -50px;">üü°</span>
                <span class="ornament" style="top: 140px; left: 40px;">üü¢</span>
                <span class="ornament" style="top: 170px; left: -20px;">üü£</span>
                <span class="ornament" style="top: 200px; left: 30px;">üî¥</span>
            </div>

            <!-- Santa -->
            <div class="santa" onclick="playSound('hoho'); createSparkles(event)">üéÖ</div>

            <!-- Snowman -->
            <div class="snowman" onclick="playSound('pop'); createSparkles(event)">‚õÑ</div>

            <!-- Penguin -->
            <div class="penguin" style="left: 180px;" onclick="playSound('pop'); createSparkles(event)">üêß</div>

            <!-- Houses -->
            <div class="house" style="left: 30px;" onclick="playSound('chime'); createSparkles(event)">üè†</div>
            <div class="house" style="right: 200px;" onclick="playSound('chime'); createSparkles(event)">üè°</div>

            <!-- Gifts -->
            <div class="gift" style="bottom: 110px; left: 380px;" onclick="playSound('unwrap'); createSparkles(event)">üéÅ</div>
            <div class="gift" style="bottom: 105px; left: 420px;" onclick="playSound('unwrap'); createSparkles(event)">üéÄ</div>
            <div class="gift" style="bottom: 110px; right: 180px;" onclick="playSound('unwrap'); createSparkles(event)">üéÅ</div>

            <!-- Ground -->
            <div class="ground"></div>

            <!-- Message -->
            <p class="message">‚ú® Wishing You Joy & Magic! ‚ú®</p>

            <!-- Placed items container -->
            <div id="placedItems"></div>
        </div>
    </div>

    <!-- Draggable Items Palette -->
    <div class="palette">
        <div class="palette-title">üé® Drag & Drop!</div>
        <div class="palette-item" draggable="true" data-emoji="üéÑ">üéÑ</div>
        <div class="palette-item" draggable="true" data-emoji="‚≠ê">‚≠ê</div>
        <div class="palette-item" draggable="true" data-emoji="üéÅ">üéÅ</div>
        <div class="palette-item" draggable="true" data-emoji="ü¶å">ü¶å</div>
        <div class="palette-item" draggable="true" data-emoji="üêß">üêß</div>
        <div class="palette-item" draggable="true" data-emoji="‚ùÑÔ∏è">‚ùÑÔ∏è</div>
        <div class="palette-item" draggable="true" data-emoji="üç™">üç™</div>
        <div class="palette-item" draggable="true" data-emoji="ü•õ">ü•õ</div>
        <div class="palette-item" draggable="true" data-emoji="üß¶">üß¶</div>
        <div class="palette-item" draggable="true" data-emoji="üîî">üîî</div>
        <div class="palette-item" draggable="true" data-emoji="üåü">üåü</div>
        <div class="palette-item" draggable="true" data-emoji="üç¨">üç¨</div>
        <div class="palette-item" draggable="true" data-emoji="‚òÉÔ∏è">‚òÉÔ∏è</div>
        <div class="palette-item" draggable="true" data-emoji="üé∂">üé∂</div>
    </div>

    <div class="instructions">
        üñ±Ô∏è Drag items from the palette onto the card! Click anything for sounds! ‚ú®
    </div>

    <script>
        // Audio Context for sound generation
        let audioCtx = null;
        let soundEnabled = true;

        function initAudio() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        // Sound toggle
        document.getElementById('soundToggle').addEventListener('click', function() {
            soundEnabled = !soundEnabled;
            this.textContent = soundEnabled ? 'üîä' : 'üîá';
            if (soundEnabled) {
                initAudio();
                playSound('chime');
            }
        });

        // Sound generation functions
        function playSound(type) {
            if (!soundEnabled) return;
            initAudio();

            const now = audioCtx.currentTime;

            switch(type) {
                case 'bells':
                    playBells(now);
                    break;
                case 'chime':
                    playChime(now);
                    break;
                case 'pop':
                    playPop(now);
                    break;
                case 'hoho':
                    playHoHo(now);
                    break;
                case 'magic':
                    playMagic(now);
                    break;
                case 'twinkle':
                    playTwinkle(now);
                    break;
                case 'unwrap':
                    playUnwrap(now);
                    break;
                case 'drop':
                    playDrop(now);
                    break;
            }
        }

        function playBells(now) {
            const frequencies = [830, 1046, 1318];
            frequencies.forEach((freq, i) => {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.type = 'sine';
                osc.frequency.value = freq;
                gain.gain.setValueAtTime(0.15, now + i * 0.1);
                gain.gain.exponentialDecayTo = function(v, t) { this.exponentialRampToValueAtTime(v, t); };
                gain.gain.exponentialRampToValueAtTime(0.001, now + i * 0.1 + 0.5);
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                osc.start(now + i * 0.1);
                osc.stop(now + i * 0.1 + 0.5);
            });
        }

        function playChime(now) {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(1200, now);
            osc.frequency.exponentialRampToValueAtTime(800, now + 0.3);
            gain.gain.setValueAtTime(0.2, now);
            gain.gain.exponentialRampToValueAtTime(0.001, now + 0.3);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start(now);
            osc.stop(now + 0.3);
        }

        function playPop(now) {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(400, now);
            osc.frequency.exponentialRampToValueAtTime(150, now + 0.1);
            gain.gain.setValueAtTime(0.3, now);
            gain.gain.exponentialRampToValueAtTime(0.001, now + 0.1);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start(now);
            osc.stop(now + 0.1);
        }

        function playHoHo(now) {
            [0, 0.2, 0.4].forEach((delay, i) => {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150 - i * 20, now + delay);
                gain.gain.setValueAtTime(0.15, now + delay);
                gain.gain.exponentialRampToValueAtTime(0.001, now + delay + 0.15);
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                osc.start(now + delay);
                osc.stop(now + delay + 0.15);
            });
        }

        function playMagic(now) {
            for (let i = 0; i < 5; i++) {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.type = 'sine';
                osc.frequency.setValueAtTime(800 + i * 200, now + i * 0.08);
                gain.gain.setValueAtTime(0.1, now + i * 0.08);
                gain.gain.exponentialRampToValueAtTime(0.001, now + i * 0.08 + 0.3);
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                osc.start(now + i * 0.08);
                osc.stop(now + i * 0.08 + 0.3);
            }
        }

        function playTwinkle(now) {
            const notes = [523, 659, 784, 1047];
            notes.forEach((freq, i) => {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.type = 'sine';
                osc.frequency.value = freq;
                gain.gain.setValueAtTime(0.1, now + i * 0.1);
                gain.gain.exponentialRampToValueAtTime(0.001, now + i * 0.1 + 0.4);
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                osc.start(now + i * 0.1);
                osc.stop(now + i * 0.1 + 0.4);
            });
        }

        function playUnwrap(now) {
            const noise = audioCtx.createBufferSource();
            const buffer = audioCtx.createBuffer(1, audioCtx.sampleRate * 0.2, audioCtx.sampleRate);
            const data = buffer.getChannelData(0);
            for (let i = 0; i < data.length; i++) {
                data[i] = Math.random() * 2 - 1;
            }
            noise.buffer = buffer;
            const gain = audioCtx.createGain();
            const filter = audioCtx.createBiquadFilter();
            filter.type = 'highpass';
            filter.frequency.value = 2000;
            gain.gain.setValueAtTime(0.3, now);
            gain.gain.exponentialRampToValueAtTime(0.001, now + 0.2);
            noise.connect(filter);
            filter.connect(gain);
            gain.connect(audioCtx.destination);
            noise.start(now);
            noise.stop(now + 0.2);
        }

        function playDrop(now) {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(600, now);
            osc.frequency.exponentialRampToValueAtTime(200, now + 0.15);
            gain.gain.setValueAtTime(0.2, now);
            gain.gain.exponentialRampToValueAtTime(0.001, now + 0.15);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start(now);
            osc.stop(now + 0.15);
        }

        // Snowfall
        function createSnowflake() {
            const snowflake = document.createElement('div');
            snowflake.className = 'snowflake';
            snowflake.textContent = ['‚ùÑ', '‚ùÖ', '‚ùÜ', '‚úß', '‚ú¶'][Math.floor(Math.random() * 5)];
            snowflake.style.left = Math.random() * 100 + 'vw';
            snowflake.style.fontSize = (Math.random() * 15 + 10) + 'px';
            snowflake.style.animationDuration = (Math.random() * 5 + 5) + 's';
            snowflake.style.opacity = Math.random() * 0.7 + 0.3;
            document.body.appendChild(snowflake);

            setTimeout(() => snowflake.remove(), 10000);
        }

        setInterval(createSnowflake, 200);

        // Create initial snowflakes
        for (let i = 0; i < 30; i++) {
            setTimeout(createSnowflake, i * 100);
        }

        // Christmas Lights
        function createLights() {
            const lightsContainer = document.getElementById('lights');
            const colors = ['#ff0000', '#00ff00', '#0066ff', '#ffff00', '#ff00ff', '#00ffff', '#ff6600', '#ff0066'];
            for (let i = 0; i < 20; i++) {
                const light = document.createElement('div');
                light.className = 'light-bulb';
                light.style.backgroundColor = colors[i % colors.length];
                light.style.color = colors[i % colors.length];
                light.onclick = () => playSound('chime');
                lightsContainer.appendChild(light);
            }
        }
        createLights();

        // Sky stars
        function createSkyStars() {
            const container = document.getElementById('skyStars');
            for (let i = 0; i < 15; i++) {
                const star = document.createElement('div');
                star.className = 'sky-star';
                star.textContent = ['‚ú¶', '‚úß', '‚ãÜ', '‚ú∂'][Math.floor(Math.random() * 4)];
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 25 + '%';
                star.style.fontSize = (Math.random() * 10 + 8) + 'px';
                star.style.animationDelay = Math.random() * 2 + 's';
                container.appendChild(star);
            }
        }
        createSkyStars();

        // Sparkles on click
        function createSparkles(event) {
            const sparkles = ['‚ú®', '‚≠ê', 'üåü', 'üí´', '‚ú¶'];
            for (let i = 0; i < 8; i++) {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                sparkle.textContent = sparkles[Math.floor(Math.random() * sparkles.length)];
                sparkle.style.left = (event.clientX + (Math.random() - 0.5) * 60) + 'px';
                sparkle.style.top = (event.clientY + (Math.random() - 0.5) * 60) + 'px';
                sparkle.style.animationDelay = Math.random() * 0.2 + 's';
                document.body.appendChild(sparkle);
                setTimeout(() => sparkle.remove(), 1000);
            }
        }

        // Drag and Drop functionality
        const paletteItems = document.querySelectorAll('.palette-item');
        const card = document.getElementById('card');
        const placedItemsContainer = document.getElementById('placedItems');

        let draggedEmoji = null;

        paletteItems.forEach(item => {
            item.addEventListener('dragstart', (e) => {
                draggedEmoji = e.target.dataset.emoji;
                e.dataTransfer.setData('text/plain', draggedEmoji);
                e.target.style.opacity = '0.5';
                playSound('pop');
            });

            item.addEventListener('dragend', (e) => {
                e.target.style.opacity = '1';
            });
        });

        card.addEventListener('dragover', (e) => {
            e.preventDefault();
        });

        card.addEventListener('drop', (e) => {
            e.preventDefault();
            if (draggedEmoji) {
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                createPlacedItem(draggedEmoji, x, y);
                playSound('drop');
                createSparkles(e);
            }
        });

        function createPlacedItem(emoji, x, y) {
            const item = document.createElement('div');
            item.className = 'placed-item';
            item.textContent = emoji;
            item.style.left = (x - 20) + 'px';
            item.style.top = (y - 20) + 'px';

            // Make placed items draggable within the card
            let isDragging = false;
            let startX, startY, origX, origY;

            item.addEventListener('mousedown', (e) => {
                isDragging = true;
                item.classList.add('dragging');
                startX = e.clientX;
                startY = e.clientY;
                origX = parseInt(item.style.left);
                origY = parseInt(item.style.top);
                playSound('pop');
            });

            document.addEventListener('mousemove', (e) => {
                if (isDragging) {
                    const dx = e.clientX - startX;
                    const dy = e.clientY - startY;
                    item.style.left = (origX + dx) + 'px';
                    item.style.top = (origY + dy) + 'px';
                }
            });

            document.addEventListener('mouseup', () => {
                if (isDragging) {
                    isDragging = false;
                    item.classList.remove('dragging');
                }
            });

            // Click to create sparkles
            item.addEventListener('click', (e) => {
                if (!isDragging) {
                    playSound('chime');
                    createSparkles(e);
                }
            });

            // Double click to remove
            item.addEventListener('dblclick', () => {
                playSound('pop');
                item.style.transform = 'scale(0)';
                setTimeout(() => item.remove(), 200);
            });

            placedItemsContainer.appendChild(item);
        }

        // Add some default placed items
        setTimeout(() => {
            createPlacedItem('‚≠ê', 200, 150);
            createPlacedItem('‚ùÑÔ∏è', 700, 120);
            createPlacedItem('üç™', 500, 450);
            createPlacedItem('üß¶', 150, 350);
            createPlacedItem('üîî', 750, 250);
        }, 500);

        // Click anywhere on card for fun
        card.addEventListener('click', (e) => {
            if (e.target === card || e.target.className === 'ground' || e.target.className === 'aurora') {
                createSparkles(e);
            }
        });

        // Confetti burst on title click
        document.querySelector('.title').addEventListener('click', (e) => {
            playSound('magic');
            for (let i = 0; i < 30; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.textContent = ['üéä', 'üéâ', '‚ú®', 'üåü', '‚≠ê'][Math.floor(Math.random() * 5)];
                confetti.style.left = e.clientX + 'px';
                confetti.style.top = e.clientY + 'px';
                confetti.style.fontSize = (Math.random() * 20 + 15) + 'px';

                const angle = (Math.PI * 2 * i) / 30;
                const velocity = Math.random() * 200 + 100;
                const vx = Math.cos(angle) * velocity;
                const vy = Math.sin(angle) * velocity;

                document.body.appendChild(confetti);

                let x = e.clientX;
                let y = e.clientY;
                let opacity = 1;
                let rotation = 0;

                const animate = () => {
                    x += vx * 0.02;
                    y += vy * 0.02 + 2;
                    opacity -= 0.02;
                    rotation += 5;

                    confetti.style.left = x + 'px';
                    confetti.style.top = y + 'px';
                    confetti.style.opacity = opacity;
                    confetti.style.transform = `rotate(${rotation}deg)`;

                    if (opacity > 0) {
                        requestAnimationFrame(animate);
                    } else {
                        confetti.remove();
                    }
                };

                requestAnimationFrame(animate);
            }
        });

        // Initial sound prompt
        document.body.addEventListener('click', function initSound() {
            initAudio();
            document.body.removeEventListener('click', initSound);
        }, { once: true });
    </script>
</body>
</html>
