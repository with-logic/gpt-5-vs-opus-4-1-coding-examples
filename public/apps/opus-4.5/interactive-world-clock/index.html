<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive World Clock</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --morning-start: #ffecd2;
            --morning-end: #fcb69f;
            --afternoon-start: #a1c4fd;
            --afternoon-end: #c2e9fb;
            --evening-start: #fa709a;
            --evening-end: #fee140;
            --night-start: #0c1445;
            --night-end: #1a1a4e;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #fff;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 30px 0 40px;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            color: rgba(255, 255, 255, 0.6);
            font-size: 1rem;
            font-weight: 300;
        }

        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .add-city-container {
            position: relative;
            display: flex;
            gap: 10px;
        }

        .city-input-wrapper {
            position: relative;
        }

        #citySearch {
            padding: 12px 20px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.05);
            color: #fff;
            font-size: 1rem;
            width: 280px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        #citySearch:focus {
            outline: none;
            border-color: #667eea;
            background: rgba(255, 255, 255, 0.1);
        }

        #citySearch::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: rgba(30, 30, 50, 0.98);
            border-radius: 12px;
            margin-top: 5px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            display: none;
            backdrop-filter: blur(20px);
        }

        .suggestions.active {
            display: block;
        }

        .suggestion-item {
            padding: 12px 20px;
            cursor: pointer;
            transition: background 0.2s ease;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .suggestion-item:last-child {
            border-bottom: none;
        }

        .suggestion-item:hover {
            background: rgba(102, 126, 234, 0.3);
        }

        .suggestion-city {
            font-weight: 500;
            color: #fff;
        }

        .suggestion-country {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.5);
        }

        .toggle-container {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(255, 255, 255, 0.05);
            padding: 8px 16px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }

        .toggle-label {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .toggle-switch {
            position: relative;
            width: 60px;
            height: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .toggle-switch.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .toggle-knob {
            position: absolute;
            top: 3px;
            left: 3px;
            width: 24px;
            height: 24px;
            background: #fff;
            border-radius: 50%;
            transition: transform 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .toggle-switch.active .toggle-knob {
            transform: translateX(30px);
        }

        .clocks-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
            padding: 10px;
        }

        .clock-card {
            border-radius: 24px;
            padding: 30px;
            position: relative;
            overflow: hidden;
            transition: all 0.4s ease;
            cursor: default;
            min-height: 220px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .clock-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: inherit;
            z-index: -1;
        }

        .clock-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .clock-card.morning {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #5d4e37;
        }

        .clock-card.afternoon {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
        }

        .clock-card.evening {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: #5d3a4a;
        }

        .clock-card.night {
            background: linear-gradient(135deg, #0c1445 0%, #302b63 100%);
            color: #fff;
        }

        .remove-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 32px;
            height: 32px;
            border: none;
            background: rgba(0, 0, 0, 0.2);
            color: inherit;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: all 0.3s ease;
            font-size: 1.2rem;
        }

        .clock-card:hover .remove-btn {
            opacity: 1;
        }

        .remove-btn:hover {
            background: rgba(255, 0, 0, 0.4);
            transform: scale(1.1);
        }

        .time-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .city-name {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .country-name {
            font-size: 0.9rem;
            opacity: 0.7;
            margin-bottom: 15px;
        }

        .time-display {
            font-size: 3.5rem;
            font-weight: 700;
            letter-spacing: -2px;
            line-height: 1;
            margin-bottom: 5px;
        }

        .time-seconds {
            font-size: 1.5rem;
            opacity: 0.7;
            font-weight: 400;
        }

        .date-display {
            font-size: 0.95rem;
            opacity: 0.8;
            margin-top: 10px;
        }

        .time-period {
            display: inline-block;
            padding: 4px 10px;
            background: rgba(0, 0, 0, 0.15);
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            margin-top: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: rgba(255, 255, 255, 0.5);
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: rgba(255, 255, 255, 0.7);
        }

        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: -1;
        }

        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: #fff;
            border-radius: 50%;
            opacity: 0.5;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.8; }
        }

        .clock-card.adding {
            animation: cardAppear 0.5s ease forwards;
        }

        @keyframes cardAppear {
            from {
                opacity: 0;
                transform: scale(0.8) translateY(20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .clock-card.removing {
            animation: cardRemove 0.4s ease forwards;
        }

        @keyframes cardRemove {
            to {
                opacity: 0;
                transform: scale(0.8) translateY(-20px);
            }
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8rem;
            }

            .controls {
                flex-direction: column;
            }

            #citySearch {
                width: 100%;
            }

            .clocks-grid {
                grid-template-columns: 1fr;
            }

            .time-display {
                font-size: 2.8rem;
            }
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }
    </style>
</head>
<body>
    <div class="stars" id="stars"></div>

    <div class="container">
        <header>
            <h1>üåç World Clock</h1>
            <p class="subtitle">Track time across the globe in real-time</p>
        </header>

        <div class="controls">
            <div class="add-city-container">
                <div class="city-input-wrapper">
                    <input type="text" id="citySearch" placeholder="Search for a city..." autocomplete="off">
                    <div class="suggestions" id="suggestions"></div>
                </div>
            </div>

            <div class="toggle-container">
                <span class="toggle-label">12h</span>
                <div class="toggle-switch" id="formatToggle">
                    <div class="toggle-knob"></div>
                </div>
                <span class="toggle-label">24h</span>
            </div>
        </div>

        <div class="clocks-grid" id="clocksGrid">
            <!-- Clock cards will be inserted here -->
        </div>
    </div>

    <script>
        // Comprehensive city database with timezones
        const cities = [
            { city: "New York", country: "United States", timezone: "America/New_York" },
            { city: "Los Angeles", country: "United States", timezone: "America/Los_Angeles" },
            { city: "Chicago", country: "United States", timezone: "America/Chicago" },
            { city: "Houston", country: "United States", timezone: "America/Chicago" },
            { city: "Phoenix", country: "United States", timezone: "America/Phoenix" },
            { city: "San Francisco", country: "United States", timezone: "America/Los_Angeles" },
            { city: "Seattle", country: "United States", timezone: "America/Los_Angeles" },
            { city: "Miami", country: "United States", timezone: "America/New_York" },
            { city: "Denver", country: "United States", timezone: "America/Denver" },
            { city: "Boston", country: "United States", timezone: "America/New_York" },
            { city: "London", country: "United Kingdom", timezone: "Europe/London" },
            { city: "Manchester", country: "United Kingdom", timezone: "Europe/London" },
            { city: "Edinburgh", country: "United Kingdom", timezone: "Europe/London" },
            { city: "Paris", country: "France", timezone: "Europe/Paris" },
            { city: "Lyon", country: "France", timezone: "Europe/Paris" },
            { city: "Marseille", country: "France", timezone: "Europe/Paris" },
            { city: "Berlin", country: "Germany", timezone: "Europe/Berlin" },
            { city: "Munich", country: "Germany", timezone: "Europe/Berlin" },
            { city: "Frankfurt", country: "Germany", timezone: "Europe/Berlin" },
            { city: "Hamburg", country: "Germany", timezone: "Europe/Berlin" },
            { city: "Rome", country: "Italy", timezone: "Europe/Rome" },
            { city: "Milan", country: "Italy", timezone: "Europe/Rome" },
            { city: "Madrid", country: "Spain", timezone: "Europe/Madrid" },
            { city: "Barcelona", country: "Spain", timezone: "Europe/Madrid" },
            { city: "Amsterdam", country: "Netherlands", timezone: "Europe/Amsterdam" },
            { city: "Brussels", country: "Belgium", timezone: "Europe/Brussels" },
            { city: "Vienna", country: "Austria", timezone: "Europe/Vienna" },
            { city: "Zurich", country: "Switzerland", timezone: "Europe/Zurich" },
            { city: "Geneva", country: "Switzerland", timezone: "Europe/Zurich" },
            { city: "Stockholm", country: "Sweden", timezone: "Europe/Stockholm" },
            { city: "Oslo", country: "Norway", timezone: "Europe/Oslo" },
            { city: "Copenhagen", country: "Denmark", timezone: "Europe/Copenhagen" },
            { city: "Helsinki", country: "Finland", timezone: "Europe/Helsinki" },
            { city: "Warsaw", country: "Poland", timezone: "Europe/Warsaw" },
            { city: "Prague", country: "Czech Republic", timezone: "Europe/Prague" },
            { city: "Budapest", country: "Hungary", timezone: "Europe/Budapest" },
            { city: "Athens", country: "Greece", timezone: "Europe/Athens" },
            { city: "Lisbon", country: "Portugal", timezone: "Europe/Lisbon" },
            { city: "Dublin", country: "Ireland", timezone: "Europe/Dublin" },
            { city: "Moscow", country: "Russia", timezone: "Europe/Moscow" },
            { city: "St. Petersburg", country: "Russia", timezone: "Europe/Moscow" },
            { city: "Istanbul", country: "Turkey", timezone: "Europe/Istanbul" },
            { city: "Tokyo", country: "Japan", timezone: "Asia/Tokyo" },
            { city: "Osaka", country: "Japan", timezone: "Asia/Tokyo" },
            { city: "Kyoto", country: "Japan", timezone: "Asia/Tokyo" },
            { city: "Seoul", country: "South Korea", timezone: "Asia/Seoul" },
            { city: "Beijing", country: "China", timezone: "Asia/Shanghai" },
            { city: "Shanghai", country: "China", timezone: "Asia/Shanghai" },
            { city: "Hong Kong", country: "China", timezone: "Asia/Hong_Kong" },
            { city: "Shenzhen", country: "China", timezone: "Asia/Shanghai" },
            { city: "Taipei", country: "Taiwan", timezone: "Asia/Taipei" },
            { city: "Singapore", country: "Singapore", timezone: "Asia/Singapore" },
            { city: "Bangkok", country: "Thailand", timezone: "Asia/Bangkok" },
            { city: "Ho Chi Minh City", country: "Vietnam", timezone: "Asia/Ho_Chi_Minh" },
            { city: "Hanoi", country: "Vietnam", timezone: "Asia/Ho_Chi_Minh" },
            { city: "Manila", country: "Philippines", timezone: "Asia/Manila" },
            { city: "Jakarta", country: "Indonesia", timezone: "Asia/Jakarta" },
            { city: "Bali", country: "Indonesia", timezone: "Asia/Makassar" },
            { city: "Kuala Lumpur", country: "Malaysia", timezone: "Asia/Kuala_Lumpur" },
            { city: "Mumbai", country: "India", timezone: "Asia/Kolkata" },
            { city: "Delhi", country: "India", timezone: "Asia/Kolkata" },
            { city: "Bangalore", country: "India", timezone: "Asia/Kolkata" },
            { city: "Chennai", country: "India", timezone: "Asia/Kolkata" },
            { city: "Kolkata", country: "India", timezone: "Asia/Kolkata" },
            { city: "Dubai", country: "UAE", timezone: "Asia/Dubai" },
            { city: "Abu Dhabi", country: "UAE", timezone: "Asia/Dubai" },
            { city: "Doha", country: "Qatar", timezone: "Asia/Qatar" },
            { city: "Riyadh", country: "Saudi Arabia", timezone: "Asia/Riyadh" },
            { city: "Tel Aviv", country: "Israel", timezone: "Asia/Jerusalem" },
            { city: "Jerusalem", country: "Israel", timezone: "Asia/Jerusalem" },
            { city: "Cairo", country: "Egypt", timezone: "Africa/Cairo" },
            { city: "Johannesburg", country: "South Africa", timezone: "Africa/Johannesburg" },
            { city: "Cape Town", country: "South Africa", timezone: "Africa/Johannesburg" },
            { city: "Lagos", country: "Nigeria", timezone: "Africa/Lagos" },
            { city: "Nairobi", country: "Kenya", timezone: "Africa/Nairobi" },
            { city: "Casablanca", country: "Morocco", timezone: "Africa/Casablanca" },
            { city: "Sydney", country: "Australia", timezone: "Australia/Sydney" },
            { city: "Melbourne", country: "Australia", timezone: "Australia/Melbourne" },
            { city: "Brisbane", country: "Australia", timezone: "Australia/Brisbane" },
            { city: "Perth", country: "Australia", timezone: "Australia/Perth" },
            { city: "Auckland", country: "New Zealand", timezone: "Pacific/Auckland" },
            { city: "Wellington", country: "New Zealand", timezone: "Pacific/Auckland" },
            { city: "Honolulu", country: "United States", timezone: "Pacific/Honolulu" },
            { city: "Anchorage", country: "United States", timezone: "America/Anchorage" },
            { city: "Toronto", country: "Canada", timezone: "America/Toronto" },
            { city: "Vancouver", country: "Canada", timezone: "America/Vancouver" },
            { city: "Montreal", country: "Canada", timezone: "America/Montreal" },
            { city: "Mexico City", country: "Mexico", timezone: "America/Mexico_City" },
            { city: "Cancun", country: "Mexico", timezone: "America/Cancun" },
            { city: "S√£o Paulo", country: "Brazil", timezone: "America/Sao_Paulo" },
            { city: "Rio de Janeiro", country: "Brazil", timezone: "America/Sao_Paulo" },
            { city: "Buenos Aires", country: "Argentina", timezone: "America/Argentina/Buenos_Aires" },
            { city: "Lima", country: "Peru", timezone: "America/Lima" },
            { city: "Bogot√°", country: "Colombia", timezone: "America/Bogota" },
            { city: "Santiago", country: "Chile", timezone: "America/Santiago" },
            { city: "Reykjavik", country: "Iceland", timezone: "Atlantic/Reykjavik" },
            { city: "Kathmandu", country: "Nepal", timezone: "Asia/Kathmandu" },
            { city: "Colombo", country: "Sri Lanka", timezone: "Asia/Colombo" },
            { city: "Dhaka", country: "Bangladesh", timezone: "Asia/Dhaka" },
            { city: "Karachi", country: "Pakistan", timezone: "Asia/Karachi" },
            { city: "Lahore", country: "Pakistan", timezone: "Asia/Karachi" }
        ];

        // Application state
        let selectedCities = [];
        let is24Hour = false;
        let updateInterval = null;

        // DOM Elements
        const citySearch = document.getElementById('citySearch');
        const suggestions = document.getElementById('suggestions');
        const clocksGrid = document.getElementById('clocksGrid');
        const formatToggle = document.getElementById('formatToggle');
        const starsContainer = document.getElementById('stars');

        // Initialize
        function init() {
            createStars();
            loadSavedCities();
            loadSavedFormat();
            setupEventListeners();
            startClock();
        }

        // Create background stars
        function createStars() {
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                star.style.width = Math.random() * 2 + 1 + 'px';
                star.style.height = star.style.width;
                starsContainer.appendChild(star);
            }
        }

        // Load saved cities from localStorage
        function loadSavedCities() {
            const saved = localStorage.getItem('worldClockCities');
            if (saved) {
                selectedCities = JSON.parse(saved);
            } else {
                // Default cities
                selectedCities = [
                    cities.find(c => c.city === "New York"),
                    cities.find(c => c.city === "London"),
                    cities.find(c => c.city === "Tokyo"),
                    cities.find(c => c.city === "Sydney")
                ];
            }
            renderClocks();
        }

        // Load saved format preference
        function loadSavedFormat() {
            const saved = localStorage.getItem('worldClockFormat');
            if (saved === '24') {
                is24Hour = true;
                formatToggle.classList.add('active');
            }
        }

        // Save cities to localStorage
        function saveCities() {
            localStorage.setItem('worldClockCities', JSON.stringify(selectedCities));
        }

        // Save format preference
        function saveFormat() {
            localStorage.setItem('worldClockFormat', is24Hour ? '24' : '12');
        }

        // Setup event listeners
        function setupEventListeners() {
            citySearch.addEventListener('input', handleSearch);
            citySearch.addEventListener('focus', handleSearch);
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.city-input-wrapper')) {
                    suggestions.classList.remove('active');
                }
            });

            formatToggle.addEventListener('click', () => {
                is24Hour = !is24Hour;
                formatToggle.classList.toggle('active');
                saveFormat();
                renderClocks();
            });
        }

        // Handle city search
        function handleSearch() {
            const query = citySearch.value.toLowerCase().trim();
            if (query.length === 0) {
                suggestions.classList.remove('active');
                return;
            }

            const matches = cities.filter(c =>
                (c.city.toLowerCase().includes(query) ||
                 c.country.toLowerCase().includes(query)) &&
                !selectedCities.some(sc => sc.city === c.city && sc.country === c.country)
            ).slice(0, 8);

            if (matches.length > 0) {
                suggestions.innerHTML = matches.map(c => `
                    <div class="suggestion-item" data-city="${c.city}" data-country="${c.country}">
                        <div class="suggestion-city">${c.city}</div>
                        <div class="suggestion-country">${c.country}</div>
                    </div>
                `).join('');
                suggestions.classList.add('active');

                // Add click handlers
                suggestions.querySelectorAll('.suggestion-item').forEach(item => {
                    item.addEventListener('click', () => {
                        const city = cities.find(c =>
                            c.city === item.dataset.city &&
                            c.country === item.dataset.country
                        );
                        if (city) {
                            addCity(city);
                        }
                    });
                });
            } else {
                suggestions.classList.remove('active');
            }
        }

        // Add a city
        function addCity(city) {
            selectedCities.push(city);
            saveCities();
            citySearch.value = '';
            suggestions.classList.remove('active');
            renderClocks(true);
        }

        // Remove a city
        function removeCity(index) {
            const card = clocksGrid.children[index];
            card.classList.add('removing');
            setTimeout(() => {
                selectedCities.splice(index, 1);
                saveCities();
                renderClocks();
            }, 400);
        }

        // Get time period based on hour
        function getTimePeriod(hour) {
            if (hour >= 5 && hour < 12) return 'morning';
            if (hour >= 12 && hour < 17) return 'afternoon';
            if (hour >= 17 && hour < 21) return 'evening';
            return 'night';
        }

        // Get icon for time period
        function getTimeIcon(period) {
            const icons = {
                morning: 'üåÖ',
                afternoon: '‚òÄÔ∏è',
                evening: 'üåÜ',
                night: 'üåô'
            };
            return icons[period];
        }

        // Get period label
        function getPeriodLabel(period) {
            const labels = {
                morning: 'Morning',
                afternoon: 'Afternoon',
                evening: 'Evening',
                night: 'Night'
            };
            return labels[period];
        }

        // Format time for a timezone
        function getTimeForTimezone(timezone) {
            const now = new Date();
            const options = {
                timeZone: timezone,
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: !is24Hour
            };

            const timeStr = now.toLocaleTimeString('en-US', options);

            const dateOptions = {
                timeZone: timezone,
                weekday: 'short',
                month: 'short',
                day: 'numeric'
            };
            const dateStr = now.toLocaleDateString('en-US', dateOptions);

            // Get hour for determining period
            const hourOptions = { timeZone: timezone, hour: 'numeric', hour12: false };
            const hour = parseInt(now.toLocaleTimeString('en-US', hourOptions));

            return { time: timeStr, date: dateStr, hour };
        }

        // Render clocks
        function renderClocks(isAdding = false) {
            if (selectedCities.length === 0) {
                clocksGrid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <div class="empty-state-icon">üåç</div>
                        <h3>No cities added</h3>
                        <p>Search for a city above to get started</p>
                    </div>
                `;
                return;
            }

            clocksGrid.innerHTML = selectedCities.map((city, index) => {
                const { time, date, hour } = getTimeForTimezone(city.timezone);
                const period = getTimePeriod(hour);
                const icon = getTimeIcon(period);

                // Split time into main time and seconds/period
                let mainTime, extra;
                if (is24Hour) {
                    const parts = time.split(':');
                    mainTime = `${parts[0]}:${parts[1]}`;
                    extra = `:${parts[2]}`;
                } else {
                    const match = time.match(/(\d+:\d+):(\d+)\s*(AM|PM)/i);
                    if (match) {
                        mainTime = match[1];
                        extra = `:${match[2]} ${match[3]}`;
                    } else {
                        mainTime = time;
                        extra = '';
                    }
                }

                const animClass = isAdding && index === selectedCities.length - 1 ? 'adding' : '';

                return `
                    <div class="clock-card ${period} ${animClass}" data-index="${index}">
                        <button class="remove-btn" onclick="removeCity(${index})" title="Remove city">√ó</button>
                        <div>
                            <div class="time-icon">${icon}</div>
                            <div class="city-name">${city.city}</div>
                            <div class="country-name">${city.country}</div>
                        </div>
                        <div>
                            <div class="time-display">
                                ${mainTime}<span class="time-seconds">${extra}</span>
                            </div>
                            <div class="date-display">${date}</div>
                            <span class="time-period">${getPeriodLabel(period)}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Update times without full re-render
        function updateTimes() {
            selectedCities.forEach((city, index) => {
                const card = clocksGrid.children[index];
                if (!card || card.classList.contains('empty-state')) return;

                const { time, date, hour } = getTimeForTimezone(city.timezone);
                const period = getTimePeriod(hour);
                const icon = getTimeIcon(period);

                // Update period class
                card.className = `clock-card ${period}`;

                // Split time
                let mainTime, extra;
                if (is24Hour) {
                    const parts = time.split(':');
                    mainTime = `${parts[0]}:${parts[1]}`;
                    extra = `:${parts[2]}`;
                } else {
                    const match = time.match(/(\d+:\d+):(\d+)\s*(AM|PM)/i);
                    if (match) {
                        mainTime = match[1];
                        extra = `:${match[2]} ${match[3]}`;
                    } else {
                        mainTime = time;
                        extra = '';
                    }
                }

                // Update DOM elements
                const timeDisplay = card.querySelector('.time-display');
                const iconEl = card.querySelector('.time-icon');
                const periodEl = card.querySelector('.time-period');
                const dateEl = card.querySelector('.date-display');

                if (timeDisplay) {
                    timeDisplay.innerHTML = `${mainTime}<span class="time-seconds">${extra}</span>`;
                }
                if (iconEl) iconEl.textContent = icon;
                if (periodEl) periodEl.textContent = getPeriodLabel(period);
                if (dateEl) dateEl.textContent = date;
            });
        }

        // Start the clock updates
        function startClock() {
            updateTimes();
            updateInterval = setInterval(updateTimes, 1000);
        }

        // Initialize the app
        init();
    </script>
</body>
</html>
