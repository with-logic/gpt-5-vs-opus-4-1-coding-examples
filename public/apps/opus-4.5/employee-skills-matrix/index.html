<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Skills Matrix | HR Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        hr: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        * {
            font-family: 'Inter', sans-serif;
        }

        .proficiency-cell {
            transition: all 0.2s ease;
        }

        .proficiency-cell:hover {
            transform: scale(1.1);
            z-index: 10;
        }

        .skill-row:hover {
            background-color: rgba(14, 165, 233, 0.05);
        }

        .employee-header:hover {
            background-color: rgba(14, 165, 233, 0.1);
        }

        .modal-overlay {
            backdrop-filter: blur(4px);
        }

        .tooltip {
            position: absolute;
            background: #1e293b;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .tooltip.visible {
            opacity: 1;
        }

        .matrix-container {
            overflow-x: auto;
        }

        .matrix-container::-webkit-scrollbar {
            height: 8px;
        }

        .matrix-container::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }

        .matrix-container::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        .matrix-container::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.3s ease forwards;
        }

        @keyframes pulse-ring {
            0% { transform: scale(0.8); opacity: 1; }
            100% { transform: scale(1.3); opacity: 0; }
        }

        .skill-gap-indicator {
            position: relative;
        }

        .skill-gap-indicator::after {
            content: '';
            position: absolute;
            inset: -4px;
            border-radius: 50%;
            border: 2px solid #ef4444;
            animation: pulse-ring 1.5s ease-out infinite;
        }

        .stats-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
        }

        .header-gradient {
            background: linear-gradient(135deg, #0369a1 0%, #0ea5e9 50%, #38bdf8 100%);
        }
    </style>
</head>
<body class="bg-slate-50 min-h-screen">
    <div id="app"></div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        // Data Store
        const store = {
            employees: [
                { id: 1, name: "Sarah Johnson", role: "Senior Developer", department: "Engineering", avatar: "SJ" },
                { id: 2, name: "Michael Chen", role: "Product Manager", department: "Product", avatar: "MC" },
                { id: 3, name: "Emily Davis", role: "UX Designer", department: "Design", avatar: "ED" },
                { id: 4, name: "James Wilson", role: "DevOps Engineer", department: "Engineering", avatar: "JW" },
                { id: 5, name: "Lisa Anderson", role: "Data Analyst", department: "Analytics", avatar: "LA" },
                { id: 6, name: "David Brown", role: "Frontend Developer", department: "Engineering", avatar: "DB" },
                { id: 7, name: "Anna Martinez", role: "Backend Developer", department: "Engineering", avatar: "AM" },
                { id: 8, name: "Robert Taylor", role: "QA Engineer", department: "Quality", avatar: "RT" },
            ],
            skills: [
                { id: 1, name: "JavaScript", category: "Programming", required: true },
                { id: 2, name: "Python", category: "Programming", required: true },
                { id: 3, name: "React", category: "Frontend", required: true },
                { id: 4, name: "Node.js", category: "Backend", required: false },
                { id: 5, name: "SQL", category: "Database", required: true },
                { id: 6, name: "AWS", category: "Cloud", required: true },
                { id: 7, name: "Docker", category: "DevOps", required: false },
                { id: 8, name: "Agile/Scrum", category: "Methodology", required: true },
                { id: 9, name: "UI/UX Design", category: "Design", required: false },
                { id: 10, name: "Data Analysis", category: "Analytics", required: false },
                { id: 11, name: "Machine Learning", category: "AI/ML", required: false },
                { id: 12, name: "TypeScript", category: "Programming", required: false },
            ],
            proficiencies: {
                // Format: "employeeId-skillId": level (0-4)
                "1-1": 4, "1-2": 3, "1-3": 4, "1-4": 3, "1-5": 2, "1-6": 2, "1-7": 1, "1-8": 3, "1-12": 4,
                "2-1": 2, "2-2": 1, "2-3": 2, "2-5": 3, "2-8": 4, "2-9": 3, "2-10": 3,
                "3-1": 1, "3-3": 3, "3-8": 3, "3-9": 4, "3-10": 2,
                "4-1": 2, "4-2": 3, "4-4": 3, "4-5": 2, "4-6": 4, "4-7": 4, "4-8": 3,
                "5-2": 4, "5-5": 4, "5-8": 2, "5-10": 4, "5-11": 3,
                "6-1": 4, "6-3": 4, "6-8": 3, "6-9": 2, "6-12": 3,
                "7-1": 3, "7-2": 4, "7-4": 4, "7-5": 4, "7-6": 3, "7-7": 3, "7-8": 3,
                "8-1": 2, "8-2": 2, "8-5": 2, "8-8": 4,
            },
            proficiencyLevels: [
                { level: 0, name: "No Knowledge", color: "bg-slate-100", textColor: "text-slate-400", description: "No experience with this skill" },
                { level: 1, name: "Beginner", color: "bg-amber-100", textColor: "text-amber-700", description: "Basic understanding, needs guidance" },
                { level: 2, name: "Intermediate", color: "bg-yellow-200", textColor: "text-yellow-800", description: "Can work independently on simple tasks" },
                { level: 3, name: "Advanced", color: "bg-emerald-200", textColor: "text-emerald-800", description: "Strong skills, can mentor others" },
                { level: 4, name: "Expert", color: "bg-emerald-500", textColor: "text-white", description: "Deep expertise, go-to person" },
            ],
            categories: ["All", "Programming", "Frontend", "Backend", "Database", "Cloud", "DevOps", "Methodology", "Design", "Analytics", "AI/ML"],
            departments: ["All", "Engineering", "Product", "Design", "Analytics", "Quality"]
        };

        // State
        let state = {
            selectedCategory: "All",
            selectedDepartment: "All",
            searchQuery: "",
            showAddEmployeeModal: false,
            showAddSkillModal: false,
            editingCell: null,
            viewMode: "matrix", // matrix, analytics
        };

        // Utility Functions
        function getProficiency(employeeId, skillId) {
            return store.proficiencies[`${employeeId}-${skillId}`] || 0;
        }

        function setProficiency(employeeId, skillId, level) {
            store.proficiencies[`${employeeId}-${skillId}`] = level;
            render();
        }

        function getFilteredSkills() {
            let skills = store.skills;
            if (state.selectedCategory !== "All") {
                skills = skills.filter(s => s.category === state.selectedCategory);
            }
            if (state.searchQuery) {
                const query = state.searchQuery.toLowerCase();
                skills = skills.filter(s => s.name.toLowerCase().includes(query));
            }
            return skills;
        }

        function getFilteredEmployees() {
            let employees = store.employees;
            if (state.selectedDepartment !== "All") {
                employees = employees.filter(e => e.department === state.selectedDepartment);
            }
            return employees;
        }

        function calculateSkillCoverage(skillId) {
            const employees = getFilteredEmployees();
            const skilled = employees.filter(e => getProficiency(e.id, skillId) >= 2).length;
            return Math.round((skilled / employees.length) * 100);
        }

        function calculateEmployeeScore(employeeId) {
            const skills = getFilteredSkills();
            const total = skills.reduce((sum, skill) => sum + getProficiency(employeeId, skill.id), 0);
            return Math.round((total / (skills.length * 4)) * 100);
        }

        function getSkillGaps() {
            const gaps = [];
            store.skills.filter(s => s.required).forEach(skill => {
                const coverage = calculateSkillCoverage(skill.id);
                if (coverage < 50) {
                    gaps.push({ skill, coverage });
                }
            });
            return gaps.sort((a, b) => a.coverage - b.coverage);
        }

        function getTopPerformers() {
            return store.employees
                .map(e => ({ employee: e, score: calculateEmployeeScore(e.id) }))
                .sort((a, b) => b.score - a.score)
                .slice(0, 5);
        }

        // Tooltip
        const tooltip = document.getElementById('tooltip');
        function showTooltip(event, text) {
            tooltip.textContent = text;
            tooltip.classList.add('visible');
            const rect = event.target.getBoundingClientRect();
            tooltip.style.left = rect.left + rect.width / 2 - tooltip.offsetWidth / 2 + 'px';
            tooltip.style.top = rect.top - tooltip.offsetHeight - 8 + 'px';
        }

        function hideTooltip() {
            tooltip.classList.remove('visible');
        }

        // Render Functions
        function render() {
            const app = document.getElementById('app');
            app.innerHTML = `
                ${renderHeader()}
                <main class="max-w-[1600px] mx-auto px-6 py-6">
                    ${renderStats()}
                    ${renderFilters()}
                    ${state.viewMode === 'matrix' ? renderMatrix() : renderAnalytics()}
                </main>
                ${state.showAddEmployeeModal ? renderAddEmployeeModal() : ''}
                ${state.showAddSkillModal ? renderAddSkillModal() : ''}
            `;
            attachEventListeners();
        }

        function renderHeader() {
            return `
                <header class="header-gradient text-white shadow-lg">
                    <div class="max-w-[1600px] mx-auto px-6 py-5">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-4">
                                <div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center backdrop-blur-sm">
                                    <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                    </svg>
                                </div>
                                <div>
                                    <h1 class="text-2xl font-bold">Employee Skills Matrix</h1>
                                    <p class="text-hr-100 text-sm">HR Team Development Dashboard</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-3">
                                <div class="bg-white/10 rounded-lg p-1 flex">
                                    <button onclick="setViewMode('matrix')" class="px-4 py-2 rounded-md text-sm font-medium transition-all ${state.viewMode === 'matrix' ? 'bg-white text-hr-700' : 'text-white hover:bg-white/10'}">
                                        Matrix View
                                    </button>
                                    <button onclick="setViewMode('analytics')" class="px-4 py-2 rounded-md text-sm font-medium transition-all ${state.viewMode === 'analytics' ? 'bg-white text-hr-700' : 'text-white hover:bg-white/10'}">
                                        Analytics
                                    </button>
                                </div>
                                <button onclick="openAddEmployeeModal()" class="bg-white/20 hover:bg-white/30 text-white px-4 py-2.5 rounded-lg text-sm font-medium transition-all flex items-center gap-2 backdrop-blur-sm">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"></path>
                                    </svg>
                                    Add Employee
                                </button>
                                <button onclick="openAddSkillModal()" class="bg-white text-hr-700 hover:bg-hr-50 px-4 py-2.5 rounded-lg text-sm font-medium transition-all flex items-center gap-2 shadow-sm">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                    </svg>
                                    Add Skill
                                </button>
                            </div>
                        </div>
                    </div>
                </header>
            `;
        }

        function renderStats() {
            const skillGaps = getSkillGaps();
            const topPerformers = getTopPerformers();
            const avgCoverage = Math.round(store.skills.reduce((sum, s) => sum + calculateSkillCoverage(s.id), 0) / store.skills.length);

            return `
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                    <div class="stats-card rounded-xl p-5 border border-slate-200 shadow-sm">
                        <div class="flex items-center gap-3">
                            <div class="w-12 h-12 bg-hr-100 rounded-xl flex items-center justify-center">
                                <svg class="w-6 h-6 text-hr-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                                </svg>
                            </div>
                            <div>
                                <p class="text-sm text-slate-500 font-medium">Team Members</p>
                                <p class="text-2xl font-bold text-slate-800">${store.employees.length}</p>
                            </div>
                        </div>
                    </div>
                    <div class="stats-card rounded-xl p-5 border border-slate-200 shadow-sm">
                        <div class="flex items-center gap-3">
                            <div class="w-12 h-12 bg-emerald-100 rounded-xl flex items-center justify-center">
                                <svg class="w-6 h-6 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path>
                                </svg>
                            </div>
                            <div>
                                <p class="text-sm text-slate-500 font-medium">Skills Tracked</p>
                                <p class="text-2xl font-bold text-slate-800">${store.skills.length}</p>
                            </div>
                        </div>
                    </div>
                    <div class="stats-card rounded-xl p-5 border border-slate-200 shadow-sm">
                        <div class="flex items-center gap-3">
                            <div class="w-12 h-12 bg-violet-100 rounded-xl flex items-center justify-center">
                                <svg class="w-6 h-6 text-violet-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                                </svg>
                            </div>
                            <div>
                                <p class="text-sm text-slate-500 font-medium">Avg. Coverage</p>
                                <p class="text-2xl font-bold text-slate-800">${avgCoverage}%</p>
                            </div>
                        </div>
                    </div>
                    <div class="stats-card rounded-xl p-5 border border-slate-200 shadow-sm">
                        <div class="flex items-center gap-3">
                            <div class="w-12 h-12 ${skillGaps.length > 0 ? 'bg-red-100' : 'bg-emerald-100'} rounded-xl flex items-center justify-center">
                                <svg class="w-6 h-6 ${skillGaps.length > 0 ? 'text-red-600' : 'text-emerald-600'}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                                </svg>
                            </div>
                            <div>
                                <p class="text-sm text-slate-500 font-medium">Skill Gaps</p>
                                <p class="text-2xl font-bold ${skillGaps.length > 0 ? 'text-red-600' : 'text-emerald-600'}">${skillGaps.length}</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderFilters() {
            return `
                <div class="bg-white rounded-xl border border-slate-200 p-4 mb-6 shadow-sm">
                    <div class="flex flex-wrap items-center gap-4">
                        <div class="flex-1 min-w-[200px]">
                            <div class="relative">
                                <svg class="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                </svg>
                                <input type="text"
                                    placeholder="Search skills..."
                                    value="${state.searchQuery}"
                                    onchange="setSearchQuery(this.value)"
                                    oninput="setSearchQuery(this.value)"
                                    class="w-full pl-10 pr-4 py-2.5 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-hr-500 focus:border-transparent text-sm">
                            </div>
                        </div>
                        <div class="flex items-center gap-2">
                            <label class="text-sm font-medium text-slate-600">Category:</label>
                            <select onchange="setCategory(this.value)" class="px-3 py-2.5 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-hr-500 text-sm bg-white">
                                ${store.categories.map(cat => `
                                    <option value="${cat}" ${state.selectedCategory === cat ? 'selected' : ''}>${cat}</option>
                                `).join('')}
                            </select>
                        </div>
                        <div class="flex items-center gap-2">
                            <label class="text-sm font-medium text-slate-600">Department:</label>
                            <select onchange="setDepartment(this.value)" class="px-3 py-2.5 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-hr-500 text-sm bg-white">
                                ${store.departments.map(dept => `
                                    <option value="${dept}" ${state.selectedDepartment === dept ? 'selected' : ''}>${dept}</option>
                                `).join('')}
                            </select>
                        </div>
                        <div class="flex items-center gap-3 ml-auto">
                            <div class="flex items-center gap-2 text-xs">
                                ${store.proficiencyLevels.map(level => `
                                    <div class="flex items-center gap-1">
                                        <span class="w-4 h-4 rounded ${level.color} border border-slate-200"></span>
                                        <span class="text-slate-500">${level.name}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderMatrix() {
            const skills = getFilteredSkills();
            const employees = getFilteredEmployees();

            if (skills.length === 0 || employees.length === 0) {
                return `
                    <div class="bg-white rounded-xl border border-slate-200 p-12 text-center shadow-sm">
                        <svg class="w-16 h-16 text-slate-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <p class="text-slate-500 text-lg">No matching results found</p>
                        <p class="text-slate-400 text-sm mt-1">Try adjusting your filters</p>
                    </div>
                `;
            }

            return `
                <div class="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden">
                    <div class="matrix-container">
                        <table class="w-full">
                            <thead>
                                <tr class="bg-slate-50 border-b border-slate-200">
                                    <th class="sticky left-0 z-20 bg-slate-50 px-4 py-3 text-left min-w-[200px]">
                                        <span class="text-xs font-semibold text-slate-500 uppercase tracking-wider">Skill / Employee</span>
                                    </th>
                                    ${employees.map(emp => `
                                        <th class="px-3 py-3 text-center min-w-[100px] employee-header cursor-pointer" onclick="showEmployeeDetails(${emp.id})">
                                            <div class="flex flex-col items-center gap-1">
                                                <div class="w-10 h-10 rounded-full bg-gradient-to-br from-hr-400 to-hr-600 flex items-center justify-center text-white text-sm font-semibold shadow-sm">
                                                    ${emp.avatar}
                                                </div>
                                                <span class="text-xs font-medium text-slate-700 truncate max-w-[90px]">${emp.name.split(' ')[0]}</span>
                                                <span class="text-[10px] text-slate-400">${calculateEmployeeScore(emp.id)}%</span>
                                            </div>
                                        </th>
                                    `).join('')}
                                    <th class="px-4 py-3 text-center min-w-[80px] bg-slate-100">
                                        <span class="text-xs font-semibold text-slate-500 uppercase tracking-wider">Coverage</span>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                ${skills.map((skill, idx) => {
                                    const coverage = calculateSkillCoverage(skill.id);
                                    const isLowCoverage = skill.required && coverage < 50;
                                    return `
                                        <tr class="skill-row border-b border-slate-100 ${idx % 2 === 0 ? 'bg-white' : 'bg-slate-50/50'}">
                                            <td class="sticky left-0 z-10 ${idx % 2 === 0 ? 'bg-white' : 'bg-slate-50'} px-4 py-3 border-r border-slate-100">
                                                <div class="flex items-center gap-3">
                                                    <div class="flex flex-col">
                                                        <div class="flex items-center gap-2">
                                                            <span class="font-medium text-slate-800 text-sm">${skill.name}</span>
                                                            ${skill.required ? '<span class="px-1.5 py-0.5 bg-red-100 text-red-600 text-[10px] font-medium rounded">Required</span>' : ''}
                                                        </div>
                                                        <span class="text-xs text-slate-400">${skill.category}</span>
                                                    </div>
                                                </div>
                                            </td>
                                            ${employees.map(emp => {
                                                const level = getProficiency(emp.id, skill.id);
                                                const levelInfo = store.proficiencyLevels[level];
                                                return `
                                                    <td class="px-3 py-3 text-center">
                                                        <button
                                                            onclick="cycleProficiency(${emp.id}, ${skill.id})"
                                                            onmouseenter="showTooltip(event, '${levelInfo.name}: ${levelInfo.description}')"
                                                            onmouseleave="hideTooltip()"
                                                            class="proficiency-cell w-10 h-10 rounded-lg ${levelInfo.color} ${levelInfo.textColor} font-semibold text-sm flex items-center justify-center mx-auto border border-slate-200/50 hover:shadow-md cursor-pointer">
                                                            ${level > 0 ? level : '-'}
                                                        </button>
                                                    </td>
                                                `;
                                            }).join('')}
                                            <td class="px-4 py-3 text-center bg-slate-50/80">
                                                <div class="flex items-center justify-center gap-2">
                                                    <div class="w-16 h-2 bg-slate-200 rounded-full overflow-hidden">
                                                        <div class="h-full ${coverage >= 75 ? 'bg-emerald-500' : coverage >= 50 ? 'bg-yellow-500' : 'bg-red-500'} rounded-full transition-all" style="width: ${coverage}%"></div>
                                                    </div>
                                                    <span class="text-xs font-medium ${coverage >= 75 ? 'text-emerald-600' : coverage >= 50 ? 'text-yellow-600' : 'text-red-600'} ${isLowCoverage ? 'skill-gap-indicator' : ''}">${coverage}%</span>
                                                </div>
                                            </td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderAnalytics() {
            const skillGaps = getSkillGaps();
            const topPerformers = getTopPerformers();
            const categoryStats = {};

            store.categories.filter(c => c !== 'All').forEach(cat => {
                const catSkills = store.skills.filter(s => s.category === cat);
                if (catSkills.length > 0) {
                    const avgCoverage = Math.round(catSkills.reduce((sum, s) => sum + calculateSkillCoverage(s.id), 0) / catSkills.length);
                    categoryStats[cat] = avgCoverage;
                }
            });

            return `
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Skill Gaps -->
                    <div class="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden">
                        <div class="px-6 py-4 border-b border-slate-200 bg-slate-50">
                            <h3 class="text-lg font-semibold text-slate-800 flex items-center gap-2">
                                <svg class="w-5 h-5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                                </svg>
                                Critical Skill Gaps
                            </h3>
                            <p class="text-sm text-slate-500 mt-1">Required skills with less than 50% team coverage</p>
                        </div>
                        <div class="p-6">
                            ${skillGaps.length === 0 ? `
                                <div class="text-center py-8">
                                    <div class="w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-3">
                                        <svg class="w-8 h-8 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                        </svg>
                                    </div>
                                    <p class="text-emerald-600 font-medium">No critical skill gaps!</p>
                                    <p class="text-sm text-slate-500">Your team has good coverage across all required skills.</p>
                                </div>
                            ` : `
                                <div class="space-y-4">
                                    ${skillGaps.map(gap => `
                                        <div class="flex items-center justify-between p-4 bg-red-50 rounded-lg border border-red-100">
                                            <div>
                                                <p class="font-medium text-slate-800">${gap.skill.name}</p>
                                                <p class="text-sm text-slate-500">${gap.skill.category}</p>
                                            </div>
                                            <div class="flex items-center gap-3">
                                                <div class="w-24 h-2 bg-red-200 rounded-full overflow-hidden">
                                                    <div class="h-full bg-red-500 rounded-full" style="width: ${gap.coverage}%"></div>
                                                </div>
                                                <span class="text-red-600 font-semibold text-sm w-12 text-right">${gap.coverage}%</span>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            `}
                        </div>
                    </div>

                    <!-- Top Performers -->
                    <div class="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden">
                        <div class="px-6 py-4 border-b border-slate-200 bg-slate-50">
                            <h3 class="text-lg font-semibold text-slate-800 flex items-center gap-2">
                                <svg class="w-5 h-5 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path>
                                </svg>
                                Top Performers
                            </h3>
                            <p class="text-sm text-slate-500 mt-1">Employees with highest skill coverage</p>
                        </div>
                        <div class="p-6">
                            <div class="space-y-3">
                                ${topPerformers.map((item, idx) => `
                                    <div class="flex items-center gap-4 p-3 ${idx === 0 ? 'bg-amber-50 border border-amber-200' : 'bg-slate-50 border border-slate-200'} rounded-lg">
                                        <div class="w-8 h-8 flex items-center justify-center ${idx === 0 ? 'bg-amber-500 text-white' : idx === 1 ? 'bg-slate-400 text-white' : idx === 2 ? 'bg-amber-700 text-white' : 'bg-slate-200 text-slate-600'} rounded-full font-bold text-sm">
                                            ${idx + 1}
                                        </div>
                                        <div class="w-10 h-10 rounded-full bg-gradient-to-br from-hr-400 to-hr-600 flex items-center justify-center text-white text-sm font-semibold">
                                            ${item.employee.avatar}
                                        </div>
                                        <div class="flex-1">
                                            <p class="font-medium text-slate-800">${item.employee.name}</p>
                                            <p class="text-sm text-slate-500">${item.employee.role}</p>
                                        </div>
                                        <div class="text-right">
                                            <p class="text-lg font-bold ${idx === 0 ? 'text-amber-600' : 'text-hr-600'}">${item.score}%</p>
                                            <p class="text-xs text-slate-400">skill score</p>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>

                    <!-- Category Coverage -->
                    <div class="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden lg:col-span-2">
                        <div class="px-6 py-4 border-b border-slate-200 bg-slate-50">
                            <h3 class="text-lg font-semibold text-slate-800 flex items-center gap-2">
                                <svg class="w-5 h-5 text-hr-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                </svg>
                                Coverage by Category
                            </h3>
                            <p class="text-sm text-slate-500 mt-1">Average team proficiency across skill categories</p>
                        </div>
                        <div class="p-6">
                            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
                                ${Object.entries(categoryStats).map(([cat, coverage]) => `
                                    <div class="bg-slate-50 rounded-xl p-4 text-center border border-slate-200">
                                        <div class="w-16 h-16 mx-auto mb-3 relative">
                                            <svg class="w-16 h-16 transform -rotate-90">
                                                <circle cx="32" cy="32" r="28" stroke="#e2e8f0" stroke-width="6" fill="none"/>
                                                <circle cx="32" cy="32" r="28" stroke="${coverage >= 75 ? '#10b981' : coverage >= 50 ? '#f59e0b' : '#ef4444'}" stroke-width="6" fill="none"
                                                    stroke-dasharray="${Math.PI * 56}"
                                                    stroke-dashoffset="${Math.PI * 56 * (1 - coverage / 100)}"
                                                    stroke-linecap="round"/>
                                            </svg>
                                            <span class="absolute inset-0 flex items-center justify-center font-bold text-slate-700">${coverage}%</span>
                                        </div>
                                        <p class="font-medium text-slate-700 text-sm">${cat}</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderAddEmployeeModal() {
            return `
                <div class="fixed inset-0 bg-black/50 modal-overlay z-50 flex items-center justify-center p-4" onclick="closeModals(event)">
                    <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md fade-in" onclick="event.stopPropagation()">
                        <div class="px-6 py-4 border-b border-slate-200">
                            <h3 class="text-xl font-semibold text-slate-800">Add New Employee</h3>
                            <p class="text-sm text-slate-500">Add a team member to the skills matrix</p>
                        </div>
                        <form onsubmit="addEmployee(event)" class="p-6 space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-1">Full Name</label>
                                <input type="text" name="name" required class="w-full px-4 py-2.5 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-hr-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-1">Role</label>
                                <input type="text" name="role" required class="w-full px-4 py-2.5 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-hr-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-1">Department</label>
                                <select name="department" required class="w-full px-4 py-2.5 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-hr-500 bg-white">
                                    ${store.departments.filter(d => d !== 'All').map(dept => `
                                        <option value="${dept}">${dept}</option>
                                    `).join('')}
                                </select>
                            </div>
                            <div class="flex gap-3 pt-4">
                                <button type="button" onclick="closeModals()" class="flex-1 px-4 py-2.5 border border-slate-200 rounded-lg text-slate-600 hover:bg-slate-50 font-medium transition-colors">
                                    Cancel
                                </button>
                                <button type="submit" class="flex-1 px-4 py-2.5 bg-hr-600 text-white rounded-lg hover:bg-hr-700 font-medium transition-colors">
                                    Add Employee
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
        }

        function renderAddSkillModal() {
            return `
                <div class="fixed inset-0 bg-black/50 modal-overlay z-50 flex items-center justify-center p-4" onclick="closeModals(event)">
                    <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md fade-in" onclick="event.stopPropagation()">
                        <div class="px-6 py-4 border-b border-slate-200">
                            <h3 class="text-xl font-semibold text-slate-800">Add New Skill</h3>
                            <p class="text-sm text-slate-500">Add a skill to track across the team</p>
                        </div>
                        <form onsubmit="addSkill(event)" class="p-6 space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-1">Skill Name</label>
                                <input type="text" name="name" required class="w-full px-4 py-2.5 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-hr-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-1">Category</label>
                                <select name="category" required class="w-full px-4 py-2.5 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-hr-500 bg-white">
                                    ${store.categories.filter(c => c !== 'All').map(cat => `
                                        <option value="${cat}">${cat}</option>
                                    `).join('')}
                                </select>
                            </div>
                            <div class="flex items-center gap-2">
                                <input type="checkbox" name="required" id="skillRequired" class="w-4 h-4 text-hr-600 rounded border-slate-300 focus:ring-hr-500">
                                <label for="skillRequired" class="text-sm font-medium text-slate-700">Required skill (will flag gaps if coverage is low)</label>
                            </div>
                            <div class="flex gap-3 pt-4">
                                <button type="button" onclick="closeModals()" class="flex-1 px-4 py-2.5 border border-slate-200 rounded-lg text-slate-600 hover:bg-slate-50 font-medium transition-colors">
                                    Cancel
                                </button>
                                <button type="submit" class="flex-1 px-4 py-2.5 bg-hr-600 text-white rounded-lg hover:bg-hr-700 font-medium transition-colors">
                                    Add Skill
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
        }

        // Event Handlers
        function setViewMode(mode) {
            state.viewMode = mode;
            render();
        }

        function setCategory(category) {
            state.selectedCategory = category;
            render();
        }

        function setDepartment(department) {
            state.selectedDepartment = department;
            render();
        }

        function setSearchQuery(query) {
            state.searchQuery = query;
            render();
        }

        function cycleProficiency(employeeId, skillId) {
            const current = getProficiency(employeeId, skillId);
            const next = (current + 1) % 5;
            setProficiency(employeeId, skillId, next);
        }

        function openAddEmployeeModal() {
            state.showAddEmployeeModal = true;
            render();
        }

        function openAddSkillModal() {
            state.showAddSkillModal = true;
            render();
        }

        function closeModals(event) {
            if (event && event.target !== event.currentTarget) return;
            state.showAddEmployeeModal = false;
            state.showAddSkillModal = false;
            render();
        }

        function addEmployee(event) {
            event.preventDefault();
            const form = event.target;
            const name = form.name.value;
            const role = form.role.value;
            const department = form.department.value;
            const avatar = name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);

            const newId = Math.max(...store.employees.map(e => e.id)) + 1;
            store.employees.push({ id: newId, name, role, department, avatar });

            closeModals();
        }

        function addSkill(event) {
            event.preventDefault();
            const form = event.target;
            const name = form.name.value;
            const category = form.category.value;
            const required = form.required.checked;

            const newId = Math.max(...store.skills.map(s => s.id)) + 1;
            store.skills.push({ id: newId, name, category, required });

            closeModals();
        }

        function showEmployeeDetails(employeeId) {
            const employee = store.employees.find(e => e.id === employeeId);
            if (!employee) return;

            const skills = store.skills.map(skill => ({
                skill,
                level: getProficiency(employeeId, skill.id),
                levelInfo: store.proficiencyLevels[getProficiency(employeeId, skill.id)]
            })).filter(s => s.level > 0).sort((a, b) => b.level - a.level);

            alert(`${employee.name}\n${employee.role} - ${employee.department}\n\nTop Skills:\n${skills.slice(0, 5).map(s => `â€¢ ${s.skill.name}: ${s.levelInfo.name}`).join('\n')}`);
        }

        function attachEventListeners() {
            // Close modals on escape
            document.onkeydown = (e) => {
                if (e.key === 'Escape') closeModals();
            };
        }

        // Initialize
        render();
    </script>
</body>
</html>
