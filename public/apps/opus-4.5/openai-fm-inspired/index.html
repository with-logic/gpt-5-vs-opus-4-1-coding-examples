<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VoiceCraft.fm - AI Text-to-Speech Playground</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        dark: {
                            50: '#f7f7f8',
                            100: '#ececf1',
                            200: '#d9d9e3',
                            300: '#c5c5d2',
                            400: '#acacbe',
                            500: '#8e8ea0',
                            600: '#565869',
                            700: '#40414f',
                            800: '#343541',
                            900: '#202123',
                            950: '#0d0d0f',
                        },
                        accent: {
                            purple: '#a855f7',
                            blue: '#3b82f6',
                            cyan: '#06b6d4',
                            green: '#10b981',
                            pink: '#ec4899',
                            orange: '#f97316',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0d0d0f 0%, #1a1a2e 50%, #0d0d0f 100%);
            min-height: 100vh;
            color: #ececf1;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #202123;
        }

        ::-webkit-scrollbar-thumb {
            background: #565869;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #8e8ea0;
        }

        /* Glassmorphism card */
        .glass-card {
            background: rgba(32, 33, 35, 0.7);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(86, 88, 105, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        /* Voice card hover effect */
        .voice-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .voice-card::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, transparent 0%, rgba(168, 85, 247, 0.1) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .voice-card:hover::before {
            opacity: 1;
        }

        .voice-card:hover {
            transform: translateY(-2px);
            border-color: rgba(168, 85, 247, 0.5);
            box-shadow: 0 8px 25px rgba(168, 85, 247, 0.15);
        }

        .voice-card.selected {
            border-color: #a855f7;
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.15) 0%, rgba(59, 130, 246, 0.1) 100%);
        }

        .voice-card.selected::after {
            content: '';
            position: absolute;
            top: 8px;
            right: 8px;
            width: 8px;
            height: 8px;
            background: #a855f7;
            border-radius: 50%;
            animation: pulse-dot 2s infinite;
        }

        @keyframes pulse-dot {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.2); }
        }

        /* Vibe pill */
        .vibe-pill {
            transition: all 0.2s ease;
            position: relative;
        }

        .vibe-pill:hover {
            transform: scale(1.02);
        }

        .vibe-pill.selected {
            background: linear-gradient(135deg, #a855f7 0%, #3b82f6 100%);
            color: white;
            border-color: transparent;
        }

        /* Waveform visualization */
        .waveform-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 3px;
            height: 60px;
        }

        .waveform-bar {
            width: 4px;
            background: linear-gradient(180deg, #a855f7 0%, #3b82f6 100%);
            border-radius: 2px;
            transition: height 0.1s ease;
        }

        /* Play button animation */
        .play-btn {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .play-btn::before {
            content: '';
            position: absolute;
            inset: -2px;
            background: linear-gradient(135deg, #a855f7, #3b82f6, #06b6d4, #a855f7);
            background-size: 300% 300%;
            border-radius: inherit;
            z-index: -1;
            animation: gradient-rotate 3s ease infinite;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .play-btn:hover::before {
            opacity: 1;
        }

        @keyframes gradient-rotate {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Textarea styling */
        .text-input {
            background: rgba(32, 33, 35, 0.5);
            border: 1px solid rgba(86, 88, 105, 0.3);
            transition: all 0.3s ease;
        }

        .text-input:focus {
            border-color: #a855f7;
            box-shadow: 0 0 0 3px rgba(168, 85, 247, 0.1);
            outline: none;
        }

        /* Loading animation */
        .loading-wave {
            display: flex;
            gap: 4px;
            align-items: center;
        }

        .loading-wave span {
            width: 6px;
            height: 6px;
            background: #a855f7;
            border-radius: 50%;
            animation: loading-bounce 1.4s ease-in-out infinite;
        }

        .loading-wave span:nth-child(1) { animation-delay: -0.32s; }
        .loading-wave span:nth-child(2) { animation-delay: -0.16s; }
        .loading-wave span:nth-child(3) { animation-delay: 0s; }

        @keyframes loading-bounce {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1.2); opacity: 1; }
        }

        /* Floating orbs background */
        .orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.3;
            pointer-events: none;
            z-index: 0;
        }

        .orb-1 {
            width: 400px;
            height: 400px;
            background: #a855f7;
            top: -100px;
            right: -100px;
            animation: float-orb 20s ease-in-out infinite;
        }

        .orb-2 {
            width: 300px;
            height: 300px;
            background: #3b82f6;
            bottom: -50px;
            left: -50px;
            animation: float-orb 25s ease-in-out infinite reverse;
        }

        .orb-3 {
            width: 200px;
            height: 200px;
            background: #06b6d4;
            top: 50%;
            left: 50%;
            animation: float-orb 15s ease-in-out infinite;
        }

        @keyframes float-orb {
            0%, 100% { transform: translate(0, 0) scale(1); }
            25% { transform: translate(30px, -30px) scale(1.1); }
            50% { transform: translate(-20px, 20px) scale(0.9); }
            75% { transform: translate(-30px, -20px) scale(1.05); }
        }

        /* Diamond icon for premium voices */
        .premium-icon {
            color: #f59e0b;
            font-size: 10px;
            margin-left: 4px;
        }

        /* Progress bar */
        .progress-bar {
            height: 4px;
            background: rgba(86, 88, 105, 0.3);
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #a855f7 0%, #3b82f6 100%);
            border-radius: 2px;
            transition: width 0.1s linear;
        }

        /* Tooltip */
        .tooltip {
            position: relative;
        }

        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(-8px);
            padding: 6px 12px;
            background: #343541;
            color: #ececf1;
            font-size: 12px;
            border-radius: 6px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s ease;
            z-index: 100;
        }

        .tooltip:hover::after {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(-4px);
        }

        /* Header animation */
        .logo-text {
            background: linear-gradient(135deg, #a855f7 0%, #3b82f6 50%, #06b6d4 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Shuffle button */
        .shuffle-btn {
            transition: all 0.3s ease;
        }

        .shuffle-btn:hover {
            transform: rotate(180deg);
        }

        /* Character count */
        .char-count {
            font-variant-numeric: tabular-nums;
        }

        /* Animation for generated text */
        @keyframes text-shimmer {
            0% { background-position: -100% 0; }
            100% { background-position: 200% 0; }
        }

        .generating-text {
            background: linear-gradient(90deg, #8e8ea0 0%, #ececf1 50%, #8e8ea0 100%);
            background-size: 200% 100%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: text-shimmer 2s linear infinite;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .voice-grid {
                grid-template-columns: repeat(2, 1fr) !important;
            }
            .vibe-grid {
                grid-template-columns: repeat(2, 1fr) !important;
            }
        }

        /* Audio player custom styling */
        audio::-webkit-media-controls-panel {
            background: #343541;
        }

        /* Fade in animation */
        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Stagger children animation */
        .stagger-in > * {
            opacity: 0;
            animation: fadeIn 0.4s ease forwards;
        }

        .stagger-in > *:nth-child(1) { animation-delay: 0.1s; }
        .stagger-in > *:nth-child(2) { animation-delay: 0.15s; }
        .stagger-in > *:nth-child(3) { animation-delay: 0.2s; }
        .stagger-in > *:nth-child(4) { animation-delay: 0.25s; }
        .stagger-in > *:nth-child(5) { animation-delay: 0.3s; }
        .stagger-in > *:nth-child(6) { animation-delay: 0.35s; }
    </style>
</head>
<body class="antialiased">
    <!-- Background orbs -->
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="orb orb-3"></div>

    <!-- Main container -->
    <div class="relative z-10 min-h-screen flex flex-col">
        <!-- Header -->
        <header class="py-6 px-6 lg:px-8">
            <div class="max-w-6xl mx-auto flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-purple-500 to-blue-500 flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path>
                        </svg>
                    </div>
                    <h1 class="text-2xl font-bold logo-text">VoiceCraft.fm</h1>
                </div>
                <div class="flex items-center gap-4">
                    <span class="text-sm text-dark-400">AI Text-to-Speech Playground</span>
                    <a href="https://github.com/openai/openai-fm" target="_blank" class="p-2 rounded-lg hover:bg-dark-700 transition-colors tooltip" data-tooltip="View on GitHub">
                        <svg class="w-5 h-5 text-dark-400 hover:text-white transition-colors" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                        </svg>
                    </a>
                </div>
            </div>
        </header>

        <!-- Main content -->
        <main class="flex-1 px-6 lg:px-8 pb-12">
            <div class="max-w-6xl mx-auto">
                <div class="grid lg:grid-cols-[1fr,380px] gap-8">
                    <!-- Left column - Text input and controls -->
                    <div class="space-y-6 stagger-in">
                        <!-- Text input card -->
                        <div class="glass-card rounded-2xl p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h2 class="text-lg font-semibold">Enter your text</h2>
                                <div class="flex items-center gap-2">
                                    <span class="text-sm text-dark-400 char-count"><span id="charCount">0</span> / 5,000</span>
                                </div>
                            </div>
                            <textarea
                                id="textInput"
                                class="text-input w-full h-48 p-4 rounded-xl resize-none text-white placeholder-dark-500"
                                placeholder="Type or paste your text here... Try something like: 'Welcome to the future of voice synthesis. This is VoiceCraft, where your words come alive with natural, expressive speech.'"
                                maxlength="5000"
                            ></textarea>

                            <!-- Preset text examples -->
                            <div class="mt-4">
                                <p class="text-sm text-dark-400 mb-2">Quick examples:</p>
                                <div class="flex flex-wrap gap-2">
                                    <button onclick="setPresetText('greeting')" class="px-3 py-1.5 text-xs rounded-lg bg-dark-700 hover:bg-dark-600 transition-colors">Greeting</button>
                                    <button onclick="setPresetText('story')" class="px-3 py-1.5 text-xs rounded-lg bg-dark-700 hover:bg-dark-600 transition-colors">Story opener</button>
                                    <button onclick="setPresetText('announcement')" class="px-3 py-1.5 text-xs rounded-lg bg-dark-700 hover:bg-dark-600 transition-colors">Announcement</button>
                                    <button onclick="setPresetText('meditation')" class="px-3 py-1.5 text-xs rounded-lg bg-dark-700 hover:bg-dark-600 transition-colors">Meditation</button>
                                    <button onclick="setPresetText('podcast')" class="px-3 py-1.5 text-xs rounded-lg bg-dark-700 hover:bg-dark-600 transition-colors">Podcast intro</button>
                                </div>
                            </div>
                        </div>

                        <!-- Vibes/Style selection -->
                        <div class="glass-card rounded-2xl p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h2 class="text-lg font-semibold">Speaking Style</h2>
                                <button onclick="randomizeVibe()" class="shuffle-btn p-2 rounded-lg hover:bg-dark-700 transition-colors tooltip" data-tooltip="Random style">
                                    <svg class="w-5 h-5 text-dark-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                    </svg>
                                </button>
                            </div>
                            <div class="vibe-grid grid grid-cols-3 sm:grid-cols-4 gap-2" id="vibeGrid">
                                <!-- Vibes will be populated by JS -->
                            </div>
                        </div>

                        <!-- Audio player and controls -->
                        <div class="glass-card rounded-2xl p-6">
                            <div class="flex items-center justify-between mb-4">
                                <h2 class="text-lg font-semibold">Audio Output</h2>
                                <div class="flex items-center gap-2">
                                    <button onclick="downloadAudio()" id="downloadBtn" class="p-2 rounded-lg hover:bg-dark-700 transition-colors tooltip disabled:opacity-50 disabled:cursor-not-allowed" data-tooltip="Download audio" disabled>
                                        <svg class="w-5 h-5 text-dark-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                                        </svg>
                                    </button>
                                    <button onclick="shareConfig()" class="p-2 rounded-lg hover:bg-dark-700 transition-colors tooltip" data-tooltip="Share configuration">
                                        <svg class="w-5 h-5 text-dark-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>

                            <!-- Waveform visualization -->
                            <div class="waveform-container mb-4" id="waveform">
                                <!-- Waveform bars will be generated by JS -->
                            </div>

                            <!-- Progress bar -->
                            <div class="progress-bar mb-4">
                                <div class="progress-fill" id="progressBar" style="width: 0%"></div>
                            </div>

                            <!-- Time display -->
                            <div class="flex items-center justify-between text-sm text-dark-400 mb-4">
                                <span id="currentTime">0:00</span>
                                <span id="duration">0:00</span>
                            </div>

                            <!-- Play button -->
                            <button
                                onclick="generateSpeech()"
                                id="generateBtn"
                                class="play-btn w-full py-4 px-6 rounded-xl bg-gradient-to-r from-purple-600 to-blue-600 text-white font-semibold text-lg flex items-center justify-center gap-3 hover:shadow-lg hover:shadow-purple-500/25 transition-all disabled:opacity-50 disabled:cursor-not-allowed"
                            >
                                <svg id="playIcon" class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M8 5v14l11-7z"/>
                                </svg>
                                <span id="btnText">Generate Speech</span>
                            </button>

                            <!-- Status message -->
                            <div id="statusMessage" class="mt-4 text-center text-sm text-dark-400 hidden">
                                <div class="loading-wave justify-center">
                                    <span></span>
                                    <span></span>
                                    <span></span>
                                </div>
                                <p class="mt-2 generating-text">Generating your audio...</p>
                            </div>
                        </div>
                    </div>

                    <!-- Right column - Voice selection -->
                    <div class="space-y-6 stagger-in">
                        <div class="glass-card rounded-2xl p-6 lg:sticky lg:top-6">
                            <div class="flex items-center justify-between mb-4">
                                <h2 class="text-lg font-semibold">Select Voice</h2>
                                <button onclick="randomizeVoice()" class="shuffle-btn p-2 rounded-lg hover:bg-dark-700 transition-colors tooltip" data-tooltip="Random voice">
                                    <svg class="w-5 h-5 text-dark-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                    </svg>
                                </button>
                            </div>
                            <div class="voice-grid grid grid-cols-2 gap-3" id="voiceGrid">
                                <!-- Voices will be populated by JS -->
                            </div>

                            <!-- Voice info -->
                            <div class="mt-6 p-4 rounded-xl bg-dark-800/50 border border-dark-600/30">
                                <div class="flex items-center gap-3 mb-2">
                                    <div id="voiceAvatar" class="w-10 h-10 rounded-full bg-gradient-to-br from-purple-500 to-blue-500 flex items-center justify-center text-white font-semibold">
                                        A
                                    </div>
                                    <div>
                                        <h3 id="voiceName" class="font-semibold">Alloy</h3>
                                        <p id="voiceDesc" class="text-sm text-dark-400">Neutral & balanced</p>
                                    </div>
                                </div>
                                <div class="flex items-center gap-4 mt-3">
                                    <div class="flex items-center gap-2">
                                        <span class="text-xs text-dark-500">Tone:</span>
                                        <div class="flex gap-1">
                                            <span id="toneBadge" class="px-2 py-0.5 text-xs rounded bg-purple-500/20 text-purple-400">Neutral</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Tips -->
                            <div class="mt-6 text-xs text-dark-500">
                                <p class="flex items-center gap-2">
                                    <svg class="w-4 h-4 text-yellow-500" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
                                    </svg>
                                    <span>Voices with âœ¦ support expressive styles</span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="py-6 px-6 lg:px-8 border-t border-dark-700/50">
            <div class="max-w-6xl mx-auto flex flex-col sm:flex-row items-center justify-between gap-4 text-sm text-dark-500">
                <p>Inspired by <a href="https://openai.fm" target="_blank" class="text-purple-400 hover:text-purple-300 transition-colors">OpenAI.fm</a></p>
                <p>Demo uses Web Speech API for voice synthesis</p>
            </div>
        </footer>
    </div>

    <!-- Hidden audio element -->
    <audio id="audioPlayer" class="hidden"></audio>

    <!-- Toast notification -->
    <div id="toast" class="fixed bottom-6 right-6 px-6 py-3 rounded-xl bg-dark-700 border border-dark-600 text-white shadow-xl transform translate-y-20 opacity-0 transition-all duration-300 z-50">
        <p id="toastMessage">Copied to clipboard!</p>
    </div>

    <script>
        // Voice definitions
        const voices = [
            { id: 'alloy', name: 'Alloy', desc: 'Neutral & balanced', tone: 'Neutral', premium: false, gradient: 'from-slate-400 to-slate-600' },
            { id: 'ash', name: 'Ash', desc: 'Warm & friendly', tone: 'Warm', premium: true, gradient: 'from-orange-400 to-red-500' },
            { id: 'ballad', name: 'Ballad', desc: 'Soft & melodic', tone: 'Soft', premium: true, gradient: 'from-pink-400 to-purple-500' },
            { id: 'coral', name: 'Coral', desc: 'Bright & energetic', tone: 'Bright', premium: false, gradient: 'from-coral-400 to-orange-500' },
            { id: 'echo', name: 'Echo', desc: 'Deep & resonant', tone: 'Deep', premium: false, gradient: 'from-blue-400 to-indigo-600' },
            { id: 'fable', name: 'Fable', desc: 'Storytelling style', tone: 'Narrative', premium: true, gradient: 'from-emerald-400 to-teal-600' },
            { id: 'onyx', name: 'Onyx', desc: 'Professional & clear', tone: 'Professional', premium: false, gradient: 'from-gray-600 to-gray-800' },
            { id: 'nova', name: 'Nova', desc: 'Youthful & dynamic', tone: 'Energetic', premium: true, gradient: 'from-violet-400 to-purple-600' },
            { id: 'sage', name: 'Sage', desc: 'Wise & calming', tone: 'Calm', premium: true, gradient: 'from-green-400 to-emerald-600' },
            { id: 'shimmer', name: 'Shimmer', desc: 'Expressive & lively', tone: 'Expressive', premium: true, gradient: 'from-cyan-400 to-blue-500' },
            { id: 'verse', name: 'Verse', desc: 'Poetic & rhythmic', tone: 'Artistic', premium: true, gradient: 'from-rose-400 to-pink-600' },
            { id: 'ember', name: 'Ember', desc: 'Passionate & bold', tone: 'Bold', premium: false, gradient: 'from-amber-400 to-orange-600' },
        ];

        // Vibe/style definitions
        const vibes = [
            { id: 'neutral', name: 'Neutral', emoji: 'ðŸ˜', instruction: '' },
            { id: 'professional', name: 'Professional', emoji: 'ðŸ‘”', instruction: 'Speak in a professional, business-like manner.' },
            { id: 'friendly', name: 'Friendly', emoji: 'ðŸ˜Š', instruction: 'Speak in a warm, friendly tone.' },
            { id: 'calm', name: 'Calm', emoji: 'ðŸ§˜', instruction: 'Speak slowly and calmly, like a meditation guide.' },
            { id: 'excited', name: 'Excited', emoji: 'ðŸŽ‰', instruction: 'Speak with excitement and enthusiasm!' },
            { id: 'dramatic', name: 'Dramatic', emoji: 'ðŸŽ­', instruction: 'Speak dramatically, like a theater actor.' },
            { id: 'storyteller', name: 'Storyteller', emoji: 'ðŸ“–', instruction: 'Speak like you are narrating an engaging story.' },
            { id: 'news', name: 'News Anchor', emoji: 'ðŸ“º', instruction: 'Speak like a professional news anchor.' },
            { id: 'auctioneer', name: 'Auctioneer', emoji: 'ðŸ”¨', instruction: 'Speak very fast like an auctioneer at an auction.' },
            { id: 'coach', name: 'Sports Coach', emoji: 'ðŸˆ', instruction: 'Speak like an encouraging sports coach giving a pep talk!' },
            { id: 'whisper', name: 'Whisper', emoji: 'ðŸ¤«', instruction: 'Speak in a soft whisper.' },
            { id: 'robot', name: 'Robot', emoji: 'ðŸ¤–', instruction: 'Speak in a monotone, robotic voice.' },
        ];

        // Preset texts
        const presetTexts = {
            greeting: "Hello and welcome! It's wonderful to have you here today. I hope you're ready for an amazing experience with the most advanced text-to-speech technology available.",
            story: "Once upon a time, in a land where technology and magic intertwined, there lived a curious inventor who dreamed of giving voice to the written word. Little did they know, their creation would change the world forever.",
            announcement: "Attention everyone! We have an exciting announcement to make. Starting today, you'll experience audio like never before. Get ready for crystal-clear, natural-sounding speech that brings your content to life.",
            meditation: "Take a deep breath in... and slowly release. Feel the tension melting away from your body. With each breath, you become more relaxed, more centered, more at peace with the present moment.",
            podcast: "Hey everyone, welcome back to another episode! I'm your host, and today we've got something really special lined up for you. Grab your headphones, get comfortable, and let's dive right in."
        };

        // State
        let selectedVoice = voices[0];
        let selectedVibe = vibes[0];
        let isPlaying = false;
        let isGenerating = false;
        let audioContext = null;
        let analyser = null;
        let currentUtterance = null;
        let waveformBars = [];

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initVoiceGrid();
            initVibeGrid();
            initWaveform();
            initTextInput();

            // Check for Web Speech API support
            if (!('speechSynthesis' in window)) {
                showToast('Web Speech API not supported in this browser');
            }
        });

        // Initialize voice grid
        function initVoiceGrid() {
            const grid = document.getElementById('voiceGrid');
            grid.innerHTML = voices.map(voice => `
                <button
                    onclick="selectVoice('${voice.id}')"
                    class="voice-card p-4 rounded-xl bg-dark-800/50 border border-dark-600/30 text-left transition-all ${voice.id === selectedVoice.id ? 'selected' : ''}"
                    data-voice="${voice.id}"
                >
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 rounded-full bg-gradient-to-br ${voice.gradient} flex items-center justify-center text-white font-semibold text-sm">
                            ${voice.name.charAt(0)}
                        </div>
                        <div>
                            <div class="flex items-center">
                                <span class="font-medium">${voice.name}</span>
                                ${voice.premium ? '<span class="premium-icon">âœ¦</span>' : ''}
                            </div>
                            <span class="text-xs text-dark-400">${voice.desc}</span>
                        </div>
                    </div>
                </button>
            `).join('');
        }

        // Initialize vibe grid
        function initVibeGrid() {
            const grid = document.getElementById('vibeGrid');
            grid.innerHTML = vibes.map(vibe => `
                <button
                    onclick="selectVibe('${vibe.id}')"
                    class="vibe-pill px-4 py-2 rounded-lg bg-dark-800/50 border border-dark-600/30 text-sm transition-all flex items-center gap-2 ${vibe.id === selectedVibe.id ? 'selected' : ''}"
                    data-vibe="${vibe.id}"
                >
                    <span>${vibe.emoji}</span>
                    <span>${vibe.name}</span>
                </button>
            `).join('');
        }

        // Initialize waveform
        function initWaveform() {
            const container = document.getElementById('waveform');
            const barCount = 40;
            container.innerHTML = '';
            waveformBars = [];

            for (let i = 0; i < barCount; i++) {
                const bar = document.createElement('div');
                bar.className = 'waveform-bar';
                bar.style.height = '4px';
                container.appendChild(bar);
                waveformBars.push(bar);
            }
        }

        // Initialize text input
        function initTextInput() {
            const textInput = document.getElementById('textInput');
            const charCount = document.getElementById('charCount');

            textInput.addEventListener('input', () => {
                charCount.textContent = textInput.value.length;
            });
        }

        // Select voice
        function selectVoice(voiceId) {
            selectedVoice = voices.find(v => v.id === voiceId);

            // Update UI
            document.querySelectorAll('.voice-card').forEach(card => {
                card.classList.toggle('selected', card.dataset.voice === voiceId);
            });

            // Update voice info
            document.getElementById('voiceAvatar').textContent = selectedVoice.name.charAt(0);
            document.getElementById('voiceAvatar').className = `w-10 h-10 rounded-full bg-gradient-to-br ${selectedVoice.gradient} flex items-center justify-center text-white font-semibold`;
            document.getElementById('voiceName').textContent = selectedVoice.name;
            document.getElementById('voiceDesc').textContent = selectedVoice.desc;
            document.getElementById('toneBadge').textContent = selectedVoice.tone;
        }

        // Select vibe
        function selectVibe(vibeId) {
            selectedVibe = vibes.find(v => v.id === vibeId);

            // Update UI
            document.querySelectorAll('.vibe-pill').forEach(pill => {
                pill.classList.toggle('selected', pill.dataset.vibe === vibeId);
            });
        }

        // Randomize voice
        function randomizeVoice() {
            const randomVoice = voices[Math.floor(Math.random() * voices.length)];
            selectVoice(randomVoice.id);
        }

        // Randomize vibe
        function randomizeVibe() {
            const randomVibe = vibes[Math.floor(Math.random() * vibes.length)];
            selectVibe(randomVibe.id);
        }

        // Set preset text
        function setPresetText(preset) {
            const textInput = document.getElementById('textInput');
            textInput.value = presetTexts[preset];
            document.getElementById('charCount').textContent = textInput.value.length;
        }

        // Generate speech using Web Speech API
        function generateSpeech() {
            const text = document.getElementById('textInput').value.trim();

            if (!text) {
                showToast('Please enter some text first');
                return;
            }

            if (isPlaying) {
                stopSpeech();
                return;
            }

            if (isGenerating) return;

            isGenerating = true;
            updateUIForGenerating();

            // Use Web Speech API
            const utterance = new SpeechSynthesisUtterance(text);

            // Map voice selection to available system voices
            const systemVoices = speechSynthesis.getVoices();
            if (systemVoices.length > 0) {
                // Try to match voice characteristics
                const voiceIndex = voices.indexOf(selectedVoice) % systemVoices.length;
                utterance.voice = systemVoices[voiceIndex];
            }

            // Apply vibe settings
            applyVibeToUtterance(utterance);

            utterance.onstart = () => {
                isGenerating = false;
                isPlaying = true;
                updateUIForPlaying();
                animateWaveform();
            };

            utterance.onend = () => {
                isPlaying = false;
                updateUIForStopped();
                resetWaveform();
                document.getElementById('downloadBtn').disabled = false;
            };

            utterance.onerror = (event) => {
                console.error('Speech error:', event);
                isGenerating = false;
                isPlaying = false;
                updateUIForStopped();
                resetWaveform();
                showToast('Speech generation failed');
            };

            // Simulate slight delay for effect
            setTimeout(() => {
                speechSynthesis.speak(utterance);
                currentUtterance = utterance;
            }, 500);
        }

        // Apply vibe settings to utterance
        function applyVibeToUtterance(utterance) {
            switch (selectedVibe.id) {
                case 'calm':
                    utterance.rate = 0.7;
                    utterance.pitch = 0.9;
                    break;
                case 'excited':
                    utterance.rate = 1.3;
                    utterance.pitch = 1.2;
                    break;
                case 'dramatic':
                    utterance.rate = 0.8;
                    utterance.pitch = 1.1;
                    break;
                case 'auctioneer':
                    utterance.rate = 1.8;
                    utterance.pitch = 1.1;
                    break;
                case 'whisper':
                    utterance.rate = 0.8;
                    utterance.pitch = 0.8;
                    utterance.volume = 0.4;
                    break;
                case 'robot':
                    utterance.rate = 0.9;
                    utterance.pitch = 0.5;
                    break;
                case 'coach':
                    utterance.rate = 1.2;
                    utterance.pitch = 1.3;
                    break;
                case 'news':
                    utterance.rate = 1.0;
                    utterance.pitch = 1.0;
                    break;
                case 'storyteller':
                    utterance.rate = 0.9;
                    utterance.pitch = 1.05;
                    break;
                default:
                    utterance.rate = 1.0;
                    utterance.pitch = 1.0;
            }
        }

        // Stop speech
        function stopSpeech() {
            speechSynthesis.cancel();
            isPlaying = false;
            updateUIForStopped();
            resetWaveform();
        }

        // Update UI states
        function updateUIForGenerating() {
            const btn = document.getElementById('generateBtn');
            const btnText = document.getElementById('btnText');
            const playIcon = document.getElementById('playIcon');
            const status = document.getElementById('statusMessage');

            btn.disabled = true;
            status.classList.remove('hidden');
        }

        function updateUIForPlaying() {
            const btn = document.getElementById('generateBtn');
            const btnText = document.getElementById('btnText');
            const playIcon = document.getElementById('playIcon');
            const status = document.getElementById('statusMessage');

            btn.disabled = false;
            btnText.textContent = 'Stop';
            playIcon.innerHTML = '<rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/>';
            status.classList.add('hidden');
        }

        function updateUIForStopped() {
            const btn = document.getElementById('generateBtn');
            const btnText = document.getElementById('btnText');
            const playIcon = document.getElementById('playIcon');
            const status = document.getElementById('statusMessage');

            btn.disabled = false;
            btnText.textContent = 'Generate Speech';
            playIcon.innerHTML = '<path d="M8 5v14l11-7z"/>';
            status.classList.add('hidden');
        }

        // Waveform animation
        let animationId = null;

        function animateWaveform() {
            const animate = () => {
                if (!isPlaying) return;

                waveformBars.forEach((bar, i) => {
                    const height = 4 + Math.random() * 50 * Math.sin(Date.now() / 100 + i * 0.5);
                    bar.style.height = `${Math.max(4, height)}px`;
                });

                animationId = requestAnimationFrame(animate);
            };
            animate();
        }

        function resetWaveform() {
            if (animationId) {
                cancelAnimationFrame(animationId);
                animationId = null;
            }
            waveformBars.forEach(bar => {
                bar.style.height = '4px';
            });
        }

        // Download audio (placeholder - would need actual audio data)
        function downloadAudio() {
            showToast('Audio download requires server-side generation');
        }

        // Share configuration
        function shareConfig() {
            const config = {
                voice: selectedVoice.id,
                vibe: selectedVibe.id,
                text: document.getElementById('textInput').value
            };

            const configString = btoa(JSON.stringify(config));
            const shareUrl = `${window.location.origin}${window.location.pathname}?config=${configString}`;

            navigator.clipboard.writeText(shareUrl).then(() => {
                showToast('Share link copied to clipboard!');
            }).catch(() => {
                showToast('Failed to copy link');
            });
        }

        // Load config from URL
        function loadConfigFromURL() {
            const params = new URLSearchParams(window.location.search);
            const configString = params.get('config');

            if (configString) {
                try {
                    const config = JSON.parse(atob(configString));
                    if (config.voice) selectVoice(config.voice);
                    if (config.vibe) selectVibe(config.vibe);
                    if (config.text) {
                        document.getElementById('textInput').value = config.text;
                        document.getElementById('charCount').textContent = config.text.length;
                    }
                } catch (e) {
                    console.error('Failed to load config:', e);
                }
            }
        }

        // Toast notification
        function showToast(message) {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');

            toastMessage.textContent = message;
            toast.classList.remove('translate-y-20', 'opacity-0');
            toast.classList.add('translate-y-0', 'opacity-100');

            setTimeout(() => {
                toast.classList.add('translate-y-20', 'opacity-0');
                toast.classList.remove('translate-y-0', 'opacity-100');
            }, 3000);
        }

        // Load voices when available
        speechSynthesis.onvoiceschanged = () => {
            // Voices loaded
        };

        // Load config from URL on page load
        window.addEventListener('load', loadConfigFromURL);
    </script>
</body>
</html>
