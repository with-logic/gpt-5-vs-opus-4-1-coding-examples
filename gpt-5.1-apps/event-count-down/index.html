<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Event Countdown Builder</title>
    <style>
      :root {
        color-scheme: light;
        --overlay: rgba(5, 7, 12, 0.75);
        --accent: #ffb347;
        --text: #f7fafc;
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        font-family: "Space Grotesk", system-ui, sans-serif;
        min-height: 100vh;
        display: grid;
        grid-template-columns: minmax(320px, 420px) 1fr;
      }
      form {
        padding: 2rem;
        background: #0e1118;
        color: #cbd5f5;
        display: grid;
        gap: 1rem;
      }
      label {
        font-size: 0.85rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: #94a3b8;
      }
      input {
        width: 100%;
        border-radius: 0.75rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
        background: rgba(255, 255, 255, 0.04);
        color: #fff;
        padding: 0.7rem 0.9rem;
        margin-top: 0.3rem;
        font: inherit;
      }
      button {
        border: none;
        border-radius: 0.75rem;
        padding: 0.9rem;
        background: var(--accent);
        color: #1a1a1a;
        font-weight: 600;
        cursor: pointer;
      }
      .preview {
        position: relative;
        overflow: hidden;
      }
      .background {
        position: absolute;
        inset: 0;
        background-size: cover;
        background-position: center;
        filter: brightness(0.5);
        transition: transform 0.4s ease;
      }
      .overlay {
        position: absolute;
        inset: 0;
        background: var(--overlay);
      }
      .content {
        position: relative;
        z-index: 1;
        color: var(--text);
        padding: clamp(2rem, 8vw, 5rem);
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
        min-height: 100vh;
        justify-content: center;
      }
      h1 {
        font-size: clamp(2.5rem, 6vw, 4.5rem);
        margin: 0;
      }
      .meta {
        font-size: 1.1rem;
        letter-spacing: 0.1em;
      }
      .countdown {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 1rem;
      }
      .unit {
        background: rgba(255, 255, 255, 0.07);
        border-radius: 1rem;
        padding: 1rem;
        text-align: center;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
      }
      .value {
        font-size: clamp(2rem, 5vw, 3.5rem);
        font-weight: 700;
        animation: pulse 1s ease infinite alternate;
      }
      @keyframes pulse {
        from {
          transform: scale(1);
        }
        to {
          transform: scale(1.05);
        }
      }
      @media (max-width: 900px) {
        body {
          grid-template-columns: 1fr;
        }
        .preview {
          min-height: 70vh;
        }
      }
    </style>
  </head>
  <body>
    <form id="settings">
      <div>
        <label>Event name
          <input type="text" name="title" value="Launch Night" required />
        </label>
      </div>
      <div>
        <label>Date & time
          <input type="datetime-local" name="datetime" value="2025-06-05T19:00" required />
        </label>
      </div>
      <div>
        <label>Location
          <input type="text" name="location" value="Pier 27 Â· San Francisco" />
        </label>
      </div>
      <div>
        <label>Background image
          <input type="file" name="image" accept="image/*" />
        </label>
      </div>
      <button type="button" id="calendar">Save to calendar</button>
    </form>
    <div class="preview">
      <div class="background" id="bg"></div>
      <div class="overlay"></div>
      <div class="content">
        <p class="meta" id="locationText"></p>
        <h1 id="eventTitle"></h1>
        <p id="eventDate"></p>
        <div class="countdown" id="countdown"></div>
      </div>
    </div>

    <script>
      const settings = document.getElementById("settings");
      const bg = document.getElementById("bg");
      const eventTitle = document.getElementById("eventTitle");
      const locationText = document.getElementById("locationText");
      const eventDate = document.getElementById("eventDate");
      const countdown = document.getElementById("countdown");
      const calendarBtn = document.getElementById("calendar");
      const titleField = settings.querySelector('[name="title"]');
      const dateField = settings.querySelector('[name="datetime"]');
      const locationField = settings.querySelector('[name="location"]');
      const imageField = settings.querySelector('[name="image"]');
      let targetDate = new Date(dateField.value);

      function updatePreview() {
        const data = new FormData(settings);
        const title = data.get("title");
        targetDate = new Date(data.get("datetime"));
        eventTitle.textContent = title;
        locationText.textContent = data.get("location");
        eventDate.textContent = targetDate.toLocaleString();
      }

      settings.addEventListener("input", updatePreview);
      updatePreview();

      imageField.addEventListener("change", (event) => {
        const file = event.target.files?.[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = () => {
          bg.style.backgroundImage = `url(${reader.result})`;
        };
        reader.readAsDataURL(file);
      });

      function tick() {
        const diff = targetDate - new Date();
        const totalSeconds = Math.max(0, Math.floor(diff / 1000));
        const days = Math.floor(totalSeconds / 86400);
        const hours = Math.floor((totalSeconds % 86400) / 3600);
        const minutes = Math.floor((totalSeconds % 3600) / 60);
        const seconds = totalSeconds % 60;
        const units = [
          { label: "Days", value: days },
          { label: "Hours", value: hours },
          { label: "Minutes", value: minutes },
          { label: "Seconds", value: seconds },
        ];
        countdown.innerHTML = units.map((unit) => `
          <div class="unit">
            <div class="value">${unit.value.toString().padStart(2, "0")}</div>
            <div>${unit.label}</div>
          </div>`).join("");
      }
      tick();
      setInterval(tick, 1000);

      document.addEventListener("mousemove", (event) => {
        const x = (event.clientX / window.innerWidth - 0.5) * 30;
        const y = (event.clientY / window.innerHeight - 0.5) * 30;
        bg.style.transform = `translate(${x}px, ${y}px)`;
      });

      calendarBtn.addEventListener("click", () => {
        const title = titleField.value;
        const location = locationField.value;
        const start = new Date(dateField.value);
        const end = new Date(start.getTime() + 60 * 60 * 1000);
        const format = (date) => date.toISOString().replace(/[-:]/g, "").replace(/\.\d+Z$/, "Z");
        const lines = [
          "BEGIN:VCALENDAR",
          "VERSION:2.0",
          "BEGIN:VEVENT",
          `SUMMARY:${title}`,
          `DTSTART:${format(start)}`,
          `DTEND:${format(end)}`,
          `LOCATION:${location}`,
          "END:VEVENT",
          "END:VCALENDAR",
        ];
        const blob = new Blob([lines.join("\n")], { type: "text/calendar" });
        const link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = `${title.replace(/\s+/g, "-")}.ics`;
        link.click();
      });
    </script>
  </body>
</html>
