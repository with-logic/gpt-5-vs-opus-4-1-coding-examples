<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Falling Fruit Catcher</title>
    <style>
      :root {
        color-scheme: light;
        --sky: linear-gradient(180deg, #9be7ff, #ffe6f7);
        --ground: #ffde7d;
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        font-family: "Baloo 2", "Comic Sans MS", cursive;
        display: flex;
        flex-direction: column;
        align-items: center;
        background: var(--sky);
        min-height: 100vh;
        color: #ff4f6f;
      }
      h1 {
        margin: 1rem 0 0.5rem;
      }
      .hud {
        display: flex;
        gap: 1rem;
        font-size: 1.2rem;
      }
      canvas {
        width: min(90vw, 600px);
        border: 8px solid white;
        border-radius: 1.5rem;
        box-shadow: 0 20px 60px rgba(255, 79, 111, 0.3);
        background: var(--ground);
      }
      button {
        margin-top: 0.5rem;
        border: none;
        border-radius: 999px;
        padding: 0.8rem 1.6rem;
        background: #ff4f6f;
        color: white;
        font-size: 1rem;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <h1>Falling Fruit Catcher</h1>
    <div class="hud">
      <span>Score: <strong id="score">0</strong></span>
      <span>Misses: <strong id="misses">0</strong>/3</span>
    </div>
    <canvas id="game" width="600" height="500"></canvas>
    <button id="restart">Restart</button>

    <script>
      const canvas = document.getElementById("game");
      const ctx = canvas.getContext("2d");
      const scoreEl = document.getElementById("score");
      const missesEl = document.getElementById("misses");
      const restartBtn = document.getElementById("restart");
      const basket = { x: canvas.width / 2 - 40, y: canvas.height - 50, width: 80, height: 30 };
      let fruits = [];
      let keys = {};
      let score = 0;
      let misses = 0;
      let gameOver = false;
      let animationId = null;

      function spawnFruit() {
        const colors = ["#ff4f6f", "#ffa94f", "#6ee3b4", "#6b6bff"];
        fruits.push({
          x: Math.random() * (canvas.width - 40) + 20,
          y: -30,
          radius: 25,
          speed: Math.random() * 1.5 + 2,
          color: colors[Math.floor(Math.random() * colors.length)],
        });
      }
      setInterval(spawnFruit, 1000);

      document.addEventListener("keydown", (event) => (keys[event.key] = true));
      document.addEventListener("keyup", (event) => (keys[event.key] = false));
      canvas.addEventListener("mousemove", (event) => {
        const rect = canvas.getBoundingClientRect();
        const pos = ((event.clientX - rect.left) / rect.width) * canvas.width;
        basket.x = pos - basket.width / 2;
      });

      function updateBasket() {
        if (keys["ArrowLeft"]) basket.x -= 5;
        if (keys["ArrowRight"]) basket.x += 5;
        basket.x = Math.max(0, Math.min(canvas.width - basket.width, basket.x));
      }

      function drawBasket() {
        ctx.fillStyle = "#ff9f45";
        ctx.fillRect(basket.x, basket.y, basket.width, basket.height);
        ctx.fillStyle = "#ff7845";
        ctx.fillRect(basket.x + 10, basket.y - 10, basket.width - 20, 10);
      }

      function updateFruits() {
        fruits.forEach((fruit) => {
          fruit.y += fruit.speed;
          if (
            fruit.y + fruit.radius > basket.y &&
            fruit.x > basket.x &&
            fruit.x < basket.x + basket.width &&
            fruit.y + fruit.radius < basket.y + basket.height + 20
          ) {
            fruit.caught = true;
            score += 10;
            scoreEl.textContent = score;
          }
          if (fruit.y > canvas.height + fruit.radius && !fruit.caught) {
            misses += 1;
            missesEl.textContent = misses;
            fruit.caught = true;
            if (misses >= 3) gameOver = true;
          }
        });
        fruits = fruits.filter((fruit) => !fruit.caught);
      }

      function drawFruits() {
        fruits.forEach((fruit) => {
          ctx.beginPath();
          ctx.fillStyle = fruit.color;
          ctx.arc(fruit.x, fruit.y, fruit.radius, 0, Math.PI * 2);
          ctx.fill();
          ctx.fillStyle = "#fff";
          ctx.font = "20px Baloo 2";
          ctx.fillText("ðŸ“", fruit.x - 14, fruit.y + 8);
        });
      }

      function loop() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        updateBasket();
        updateFruits();
        drawFruits();
        drawBasket();
        if (!gameOver) {
          animationId = requestAnimationFrame(loop);
        } else {
          animationId = null;
          ctx.fillStyle = "rgba(0,0,0,0.6)";
          ctx.fillRect(0, 0, canvas.width, canvas.height);
          ctx.fillStyle = "#fff";
          ctx.font = "36px Baloo 2";
          ctx.fillText("Game Over!", canvas.width / 2 - 100, canvas.height / 2);
        }
      }
      loop();

      restartBtn.addEventListener("click", () => {
        if (animationId) cancelAnimationFrame(animationId);
        score = 0;
        misses = 0;
        scoreEl.textContent = score;
        missesEl.textContent = misses;
        fruits = [];
        gameOver = false;
        loop();
      });
    </script>
  </body>
</html>
