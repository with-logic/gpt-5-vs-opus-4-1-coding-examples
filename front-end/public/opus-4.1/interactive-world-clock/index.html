<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive World Clock</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .control-group select, .control-group input {
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .btn-primary {
            background: #4CAF50;
            color: white;
        }

        .btn-primary:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #4CAF50;
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .clocks-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .clock-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .clock-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

        .clock-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .city-name {
            font-size: 1.5em;
            font-weight: 600;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .time-period-icon {
            font-size: 2em;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { filter: drop-shadow(0 0 5px currentColor); }
            to { filter: drop-shadow(0 0 15px currentColor); }
        }

        .delete-btn {
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .delete-btn:hover {
            background: #c82333;
            transform: scale(1.1);
        }

        .time-display {
            text-align: center;
            margin-bottom: 20px;
        }

        .current-time {
            font-size: 3em;
            font-weight: 300;
            margin-bottom: 5px;
            color: #333;
            font-family: 'Courier New', monospace;
        }

        .current-date {
            font-size: 1.1em;
            color: #666;
            margin-bottom: 10px;
        }

        .timezone-info {
            font-size: 0.9em;
            color: #888;
            background: #f8f9fa;
            padding: 5px 10px;
            border-radius: 15px;
            display: inline-block;
        }

        .time-period {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0.1;
            pointer-events: none;
        }

        .morning {
            background: linear-gradient(45deg, #FFE082, #FFF9C4);
        }

        .afternoon {
            background: linear-gradient(45deg, #FFCC80, #FFE0B2);
        }

        .evening {
            background: linear-gradient(45deg, #FFAB91, #FFCCBC);
        }

        .night {
            background: linear-gradient(45deg, #9FA8DA, #C5CAE9);
        }

        .local-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #4CAF50;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .no-clocks {
            text-align: center;
            background: white;
            padding: 50px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .no-clocks .icon {
            font-size: 4em;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .no-clocks h3 {
            color: #666;
            margin-bottom: 10px;
        }

        .no-clocks p {
            color: #888;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .control-group {
                width: 100%;
                max-width: 400px;
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .clocks-grid {
                grid-template-columns: 1fr;
            }
            
            .current-time {
                font-size: 2.5em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåç Interactive World Clock</h1>
            <p>Keep track of time across the globe</p>
        </div>

        <div class="controls">
            <div class="control-group">
                <label for="timezoneSelect">Add City:</label>
                <select id="timezoneSelect">
                    <option value="">Select a city</option>
                </select>
                <button class="btn btn-primary" onclick="addClock()">Add</button>
            </div>
            
            <div class="control-group">
                <label for="formatToggle">24H Format:</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="formatToggle" onchange="toggleTimeFormat()">
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <div class="clocks-grid" id="clocksGrid"></div>
    </div>

    <script>
        class WorldClock {
            constructor() {
                this.clocks = JSON.parse(localStorage.getItem('worldClocks')) || [];
                this.is24Hour = JSON.parse(localStorage.getItem('is24Hour')) || false;
                this.updateInterval = null;
                
                this.timeZones = [
                    { name: 'New York', timezone: 'America/New_York', country: 'USA' },
                    { name: 'London', timezone: 'Europe/London', country: 'UK' },
                    { name: 'Paris', timezone: 'Europe/Paris', country: 'France' },
                    { name: 'Berlin', timezone: 'Europe/Berlin', country: 'Germany' },
                    { name: 'Moscow', timezone: 'Europe/Moscow', country: 'Russia' },
                    { name: 'Dubai', timezone: 'Asia/Dubai', country: 'UAE' },
                    { name: 'Mumbai', timezone: 'Asia/Kolkata', country: 'India' },
                    { name: 'Singapore', timezone: 'Asia/Singapore', country: 'Singapore' },
                    { name: 'Tokyo', timezone: 'Asia/Tokyo', country: 'Japan' },
                    { name: 'Sydney', timezone: 'Australia/Sydney', country: 'Australia' },
                    { name: 'Los Angeles', timezone: 'America/Los_Angeles', country: 'USA' },
                    { name: 'Chicago', timezone: 'America/Chicago', country: 'USA' },
                    { name: 'Toronto', timezone: 'America/Toronto', country: 'Canada' },
                    { name: 'Mexico City', timezone: 'America/Mexico_City', country: 'Mexico' },
                    { name: 'S√£o Paulo', timezone: 'America/Sao_Paulo', country: 'Brazil' },
                    { name: 'Buenos Aires', timezone: 'America/Argentina/Buenos_Aires', country: 'Argentina' },
                    { name: 'Cape Town', timezone: 'Africa/Cape_Town', country: 'South Africa' },
                    { name: 'Cairo', timezone: 'Africa/Cairo', country: 'Egypt' },
                    { name: 'Istanbul', timezone: 'Europe/Istanbul', country: 'Turkey' },
                    { name: 'Seoul', timezone: 'Asia/Seoul', country: 'South Korea' },
                    { name: 'Beijing', timezone: 'Asia/Shanghai', country: 'China' },
                    { name: 'Hong Kong', timezone: 'Asia/Hong_Kong', country: 'Hong Kong' },
                    { name: 'Bangkok', timezone: 'Asia/Bangkok', country: 'Thailand' },
                    { name: 'Jakarta', timezone: 'Asia/Jakarta', country: 'Indonesia' }
                ];
                
                this.initializeApp();
            }

            initializeApp() {
                this.populateTimezoneSelect();
                this.updateFormatToggle();
                this.renderClocks();
                this.startUpdating();
                
                // Add local time by default if no clocks exist
                if (this.clocks.length === 0) {
                    this.addLocalClock();
                }
            }

            populateTimezoneSelect() {
                const select = document.getElementById('timezoneSelect');
                this.timeZones.forEach(tz => {
                    const option = document.createElement('option');
                    option.value = JSON.stringify(tz);
                    option.textContent = `${tz.name}, ${tz.country}`;
                    select.appendChild(option);
                });
            }

            addLocalClock() {
                const localTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
                const localCity = localTimezone.split('/').pop().replace(/_/g, ' ');
                
                const localClock = {
                    id: Date.now(),
                    name: localCity,
                    timezone: localTimezone,
                    country: 'Local',
                    isLocal: true
                };
                
                this.clocks.push(localClock);
                this.saveClocks();
                this.renderClocks();
            }

            addClock() {
                const select = document.getElementById('timezoneSelect');
                const selectedValue = select.value;
                
                if (!selectedValue) return;
                
                const timezone = JSON.parse(selectedValue);
                
                // Check if clock already exists
                const exists = this.clocks.some(clock => clock.timezone === timezone.timezone);
                if (exists) {
                    alert('This city is already added!');
                    return;
                }
                
                const newClock = {
                    id: Date.now(),
                    name: timezone.name,
                    timezone: timezone.timezone,
                    country: timezone.country,
                    isLocal: false
                };
                
                this.clocks.push(newClock);
                this.saveClocks();
                this.renderClocks();
                
                select.value = '';
            }

            removeClock(id) {
                this.clocks = this.clocks.filter(clock => clock.id !== id);
                this.saveClocks();
                this.renderClocks();
            }

            toggleTimeFormat() {
                this.is24Hour = document.getElementById('formatToggle').checked;
                localStorage.setItem('is24Hour', JSON.stringify(this.is24Hour));
                this.renderClocks();
            }

            updateFormatToggle() {
                document.getElementById('formatToggle').checked = this.is24Hour;
            }

            getTimePeriod(hour) {
                if (hour >= 6 && hour < 12) return 'morning';
                if (hour >= 12 && hour < 17) return 'afternoon';
                if (hour >= 17 && hour < 21) return 'evening';
                return 'night';
            }

            getTimePeriodIcon(period) {
                const icons = {
                    morning: 'üåÖ',
                    afternoon: '‚òÄÔ∏è',
                    evening: 'üåá',
                    night: 'üåô'
                };
                return icons[period] || 'üïê';
            }

            formatTime(date, timezone) {
                const options = {
                    timeZone: timezone,
                    hour12: !this.is24Hour,
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                };
                return date.toLocaleTimeString('en-US', options);
            }

            formatDate(date, timezone) {
                const options = {
                    timeZone: timezone,
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                };
                return date.toLocaleDateString('en-US', options);
            }

            getTimezoneOffset(timezone) {
                const date = new Date();
                const utc = date.getTime() + (date.getTimezoneOffset() * 60000);
                const targetTime = new Date(utc + this.getTimezoneOffsetMs(timezone));
                const offset = -targetTime.getTimezoneOffset();
                const hours = Math.floor(Math.abs(offset) / 60);
                const minutes = Math.abs(offset) % 60;
                const sign = offset >= 0 ? '+' : '-';
                return `GMT${sign}${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
            }

            getTimezoneOffsetMs(timezone) {
                // This is a simplified approach - in production, you'd use a proper timezone library
                try {
                    const now = new Date();
                    const utc = new Date(now.getTime() + now.getTimezoneOffset() * 60000);
                    const target = new Date(utc.toLocaleString('en-US', { timeZone: timezone }));
                    return target.getTime() - utc.getTime();
                } catch (e) {
                    return 0;
                }
            }

            renderClocks() {
                const container = document.getElementById('clocksGrid');
                
                if (this.clocks.length === 0) {
                    container.innerHTML = `
                        <div class="no-clocks">
                            <div class="icon">üïê</div>
                            <h3>No clocks added yet</h3>
                            <p>Add your first city to get started</p>
                        </div>
                    `;
                    return;
                }
                
                container.innerHTML = this.clocks.map(clock => {
                    const now = new Date();
                    const clockTime = this.formatTime(now, clock.timezone);
                    const clockDate = this.formatDate(now, clock.timezone);
                    const timezoneOffset = this.getTimezoneOffset(clock.timezone);
                    
                    // Get hour for time period detection
                    const hour = parseInt(now.toLocaleTimeString('en-US', {
                        timeZone: clock.timezone,
                        hour: '2-digit',
                        hour12: false
                    }));
                    
                    const period = this.getTimePeriod(hour);
                    const periodIcon = this.getTimePeriodIcon(period);
                    
                    return `
                        <div class="clock-card">
                            <div class="time-period ${period}"></div>
                            ${clock.isLocal ? '<div class="local-indicator">Local Time</div>' : ''}
                            
                            <div class="clock-header">
                                <div class="city-name">
                                    <span class="time-period-icon">${periodIcon}</span>
                                    <div>
                                        <div>${clock.name}</div>
                                        <small style="color: #666; font-weight: normal;">${clock.country}</small>
                                    </div>
                                </div>
                                ${!clock.isLocal ? `<button class="delete-btn" onclick="worldClock.removeClock(${clock.id})">√ó</button>` : ''}
                            </div>
                            
                            <div class="time-display">
                                <div class="current-time">${clockTime}</div>
                                <div class="current-date">${clockDate}</div>
                                <div class="timezone-info">${timezoneOffset}</div>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            startUpdating() {
                this.updateInterval = setInterval(() => {
                    this.renderClocks();
                }, 1000);
            }

            saveClocks() {
                localStorage.setItem('worldClocks', JSON.stringify(this.clocks));
            }
        }

        // Global functions
        window.addClock = function() {
            worldClock.addClock();
        };

        window.toggleTimeFormat = function() {
            worldClock.toggleTimeFormat();
        };

        // Initialize the world clock
        const worldClock = new WorldClock();

        // Handle page visibility change to optimize performance
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                clearInterval(worldClock.updateInterval);
            } else {
                worldClock.startUpdating();
            }
        });
    </script>
</body>
</html>