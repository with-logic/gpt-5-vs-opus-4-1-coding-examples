<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skills Matrix | TalentOS</title>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --level-0: #f3f4f6; /* None */
            --level-1: #bae6fd; /* Beginner */
            --level-2: #60a5fa; /* Intermediate */
            --level-3: #2563eb; /* Advanced */
            --level-4: #1e40af; /* Expert */
            --text-dark: #1f2937;
            --border: #e5e7eb;
        }

        body {
            font-family: 'Open Sans', sans-serif;
            background-color: #f9fafb;
            color: var(--text-dark);
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            overflow-x: auto;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border);
            padding-bottom: 20px;
        }

        h1 { margin: 0; color: #111827; }

        .legend {
            display: flex;
            gap: 15px;
            font-size: 0.85rem;
        }

        .legend-item { display: flex; align-items: center; gap: 5px; }
        .swatch { width: 16px; height: 16px; border-radius: 4px; }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        th, td {
            border: 1px solid var(--border);
            padding: 12px;
            text-align: center;
        }

        th {
            background-color: #f9fafb;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        /* Employee Names Column */
        td:first-child, th:first-child {
            text-align: left;
            position: sticky;
            left: 0;
            background-color: #f9fafb;
            z-index: 20; /* Higher than headers */
            font-weight: 600;
        }
        
        /* Cell Interactions */
        .skill-cell {
            cursor: pointer;
            transition: background-color 0.1s;
            user-select: none;
            color: transparent; /* Hide number, show color */
        }
        
        .skill-cell:hover { opacity: 0.8; }

        /* Controls */
        .controls {
            margin-top: 20px;
            display: flex;
            gap: 10px;
        }

        button {
            padding: 8px 16px;
            background: #4b5563;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        button.primary { background: #2563eb; }
        button:hover { opacity: 0.9; }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            width: 300px;
        }
        
        input {
            width: 100%;
            padding: 8px;
            margin: 10px 0;
            box-sizing: border-box;
        }

    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Employee Skills Matrix</h1>
            <div class="legend">
                <div class="legend-item"><div class="swatch" style="background:var(--level-0)"></div> None</div>
                <div class="legend-item"><div class="swatch" style="background:var(--level-1)"></div> Beginner</div>
                <div class="legend-item"><div class="swatch" style="background:var(--level-2)"></div> Intermediate</div>
                <div class="legend-item"><div class="swatch" style="background:var(--level-3)"></div> Advanced</div>
                <div class="legend-item"><div class="swatch" style="background:var(--level-4)"></div> Expert</div>
            </div>
        </header>

        <table id="matrixTable">
            <!-- JS renders this -->
        </table>

        <div class="controls">
            <button class="primary" onclick="showAddEmployee()">+ Add Employee</button>
            <button class="primary" onclick="showAddSkill()">+ Add Skill</button>
            <button onclick="resetData()">Reset Data</button>
        </div>
    </div>

    <!-- Modals -->
    <div id="empModal" class="modal">
        <div class="modal-content">
            <h3>Add Employee</h3>
            <input type="text" id="newEmpName" placeholder="Name">
            <button class="primary" onclick="addEmployee()">Add</button>
            <button onclick="closeModals()">Cancel</button>
        </div>
    </div>

    <div id="skillModal" class="modal">
        <div class="modal-content">
            <h3>Add Skill</h3>
            <input type="text" id="newSkillName" placeholder="Skill (e.g. React, Python)">
            <button class="primary" onclick="addSkill()">Add</button>
            <button onclick="closeModals()">Cancel</button>
        </div>
    </div>

    <script>
        // Data Structure
        let employees = ['Alice Johnson', 'Bob Smith', 'Charlie Brown'];
        let skills = ['HTML/CSS', 'JavaScript', 'Python', 'SQL', 'Project Mgmt'];
        
        // Matrix: object with key "empIndex-skillIndex" -> level (0-4)
        let matrix = {};

        // Load or Init
        function init() {
            const saved = localStorage.getItem('skillsMatrix');
            if (saved) {
                const data = JSON.parse(saved);
                employees = data.employees;
                skills = data.skills;
                matrix = data.matrix;
            } else {
                // Random dummy data
                employees.forEach((_, ei) => {
                    skills.forEach((_, si) => {
                        matrix[`${ei}-${si}`] = Math.floor(Math.random() * 5);
                    });
                });
            }
            render();
        }

        function save() {
            localStorage.setItem('skillsMatrix', JSON.stringify({ employees, skills, matrix }));
        }

        function render() {
            const table = document.getElementById('matrixTable');
            table.innerHTML = '';

            // Header Row
            const thead = document.createElement('thead');
            const trHead = document.createElement('tr');
            trHead.innerHTML = '<th>Employee</th>' + skills.map(s => `<th>${s}</th>`).join('');
            thead.appendChild(trHead);
            table.appendChild(thead);

            // Body
            const tbody = document.createElement('tbody');
            employees.forEach((emp, empIndex) => {
                const tr = document.createElement('tr');
                let html = `<td>${emp}</td>`;
                
                skills.forEach((_, skillIndex) => {
                    const key = `${empIndex}-${skillIndex}`;
                    const level = matrix[key] || 0;
                    const colorVar = `var(--level-${level})`;
                    html += `<td class="skill-cell" 
                                 style="background-color: ${colorVar}" 
                                 onclick="cycleLevel(${empIndex}, ${skillIndex})"
                                 title="Level: ${level}">${level}</td>`;
                });
                
                tr.innerHTML = html;
                tbody.appendChild(tr);
            });
            table.appendChild(tbody);
        }

        function cycleLevel(empIndex, skillIndex) {
            const key = `${empIndex}-${skillIndex}`;
            let level = matrix[key] || 0;
            level = (level + 1) % 5;
            matrix[key] = level;
            save();
            render();
        }

        // Add Employee
        function showAddEmployee() { document.getElementById('empModal').style.display = 'flex'; }
        function addEmployee() {
            const name = document.getElementById('newEmpName').value;
            if (name) {
                employees.push(name);
                save();
                render();
                closeModals();
                document.getElementById('newEmpName').value = '';
            }
        }

        // Add Skill
        function showAddSkill() { document.getElementById('skillModal').style.display = 'flex'; }
        function addSkill() {
            const name = document.getElementById('newSkillName').value;
            if (name) {
                skills.push(name);
                save();
                render();
                closeModals();
                document.getElementById('newSkillName').value = '';
            }
        }

        function closeModals() {
            document.querySelectorAll('.modal').forEach(m => m.style.display = 'none');
        }

        function resetData() {
            if(confirm('Clear all data?')) {
                localStorage.removeItem('skillsMatrix');
                location.reload();
            }
        }

        init();

    </script>
</body>
</html>
